Gs
 I.C.S.515 | I.C.S. VISIBILITÀ, RILEVAMENTO E RISPOSTA GIAC Response and Industrial Defence (GRID)
 515.2
 Visibilità e identificazione degli asset
 GIAC
 CERTIFICAZIONI
 SAN
 LA FONTE PIÙ AFFIDABILE PER LA FORMAZIONE, LA CERTIFICAZIONE E LA RICERCA SULLA SICUREZZA DELLE INFORMAZIONI | sans.org

© 2021 Robert M. Lee. Tutti i diritti riservati a Robert M. Lee e/o al SANS Institute.
 SI PREGA DI LEGGERE I TERMINI E LE CONDIZIONI DEL PRESENTE CONTRATTO DI LICENZA DEL CORSO
("CLA") ATTENTAMENTE PRIMA DI UTILIZZARE QUALSIASI CORSO ASSOCIATO AL CORSO SANS. QUESTO È UN CONTRATTO LEGALE ED ESECUTIVO TRA TE (L'UTENTE) E SENZA ISTITUTO PER IL CORSO. ACCETTI CHE IL PRESENTE CONTRATTO È ESECUTIVO COME QUALSIASI ACCORDO NEGOZIATO SCRITTA FIRMATO DA TE.
 Con questo CLA, SANS Institute concede all'Utente una licenza personale e non esclusiva per utilizzare il Courseware in conformità ai termini del presente accordo. Il Courseware include tutto il materiale stampato, inclusi libri di testo e cartelle di lavoro di laboratorio, nonché qualsiasi supporto digitale o di altro tipo, macchina virtuale e/o set di dati distribuiti da SANS Institute all'Utente per l'utilizzo nella classe SANS associata al Courseware. L'utente accetta che il CLA costituisce la dichiarazione completa ed esclusiva dell'accordo tra SANS Institute e l'utente e che questo CLA sostituisce qualsiasi proposta, accordo o altra comunicazione orale o scritta relativa all'oggetto del presente CLA.
 ACCETTANDO QUESTO CORSO, L'UTENTE ACCETTA DI ESSERE VINCOLATO AI TERMINI DEL PRESENTE CLA. ACCETTANDO QUESTO SOFTWARE, L'UTENTE ACCETTA CHE QUALSIASI VIOLAZIONE DEI TERMINI DEL PRESENTE CLA PUÒ CAUSARE DANNI IRREPARABILI E LESIONI SIGNIFICATIVE A SANS INSTITUTE E CHE IL SANS INSTITUTE PUÒ APPLICARE QUESTE DISPOSIZIONI MEDIANTE INGIUNZIONE (SENZA NECESSITÀ DI POSTARE CAUZIONE) PRESTAZIONI SPECIFICHE O ALTRO RILIEVO EQUO.
 Se l'Utente non è d'accordo, può restituire il Courseware al SANS Institute per un rimborso completo, se applicabile.
 L'utente non può copiare, riprodurre, ripubblicare, distribuire, visualizzare, modificare o creare opere derivate basate su tutto o parte del Courseware, su qualsiasi supporto sia stampato, elettronico o altro, per qualsiasi scopo, senza il previo consenso scritto dell'Istituto SANS. Inoltre, l'Utente non può vendere, affittare, noleggiare, scambiare o trasferire in altro modo il Courseware in alcun modo, forma o formato senza l'espresso consenso scritto di SANS Institute.
 Se una qualsiasi disposizione del presente CLA viene dichiarata inapplicabile in qualsiasi giurisdizione, tale disposizione sarà considerata separabile dal presente CLA e non pregiudicherà il resto dello stesso. Un emendamento o un'addendum al presente CLA potrebbe accompagnare il presente Courseware.
 SANS riconosce che tutti i software e/o strumenti, grafica, immagini, tabelle, diagrammi o grafici presentati in questo Courseware sono di proprietà esclusiva dei rispettivi proprietari di marchi/registrati/copyright, tra cui:
 AirDrop, AirPort, AirPort Time Capsule, Apple, Apple Remote Desktop, Apple TV, App Nap, Torna al mio Mac, Boot Camp, Cocoa, FaceTime, FileVault, Finder, FireWire, logo FireWire, iCal, iChat, iLife, iMac, iMessage , iPad, iPad Air, iPad Mini, iPhone, iPhoto, iPod, iPod classic, iPod shuffle, iPod nano, iPod touch, iTunes, logo iTunes, iWork, portachiavi, Keynote, Mac, logo Mac, MacBook, MacBook Air, MacBook Pro , Macintosh, Mac OS, Mac Pro, Numbers, OS X, Pages, Passbook, Retina, Safari, Siri, Spaces, Spotlight, C'è un'app per questo, Time Capsule, Time Machine, Touch ID, Xcode, Xserve, App Store, e iCloud sono marchi registrati di Apple Inc.
 PMP® e PMBOK® sono marchi registrati di PMI.
 SOF-ELK@® è un marchio registrato di Lewes Technology Consulting, LLC. Utilizzato con permesso.
 SIFT® è un marchio registrato di Harbingers, LLC. Utilizzato con permesso.
 Legge applicabile: il presente Contratto sarà regolato dalle leggi dello Stato del Maryland, USA.
 I.C.S.$515_2 GO1_07
 wv ve © © Vedi ew BH wH

» © S&S&S&S&
 UN
 FF © GF OG BG FG
 I.C.S.515.2 I.C.S. Visibilità, rilevamento e risposta

| Visibilità e asset
 Identificazione SANS

© 2021 Robert M.Lee | Tutti i diritti riservati | Versione GOI_07
 Il SANS I.C.S.515 —I.C.S. Il corso Visibilità, rilevamento e risposta è stato sviluppato da Robert M. Lee con il contributo di un gruppo di esperti, le cui diverse esperienze lavorative, conoscenze e competenze si sono realmente fuse per coprire le aree di contenuto specifiche di questo corso. L'autore desidera ringraziarli per il loro sostegno e contributo. Si prega di consultare la pagina seguente.
 Robert M. Lee
 Robert M. Lee è CEO e fondatore della società di sicurezza informatica industriale (I.C.S./OT/IIoT) Dragos, Inc. È un istruttore senior SANS e autore del corso SANS I.C.S.515 — “I.C.S. Visibilità, rilevamento e risposta” e autore principale di SANS FOR578 – “Cyber ​​Threat Intelligence”. Attualmente è anche un impiegato del servizio speciale del Dipartimento dell'Energia nel comitato consultivo per l'elettricità in qualità di vicepresidente del comitato per la sicurezza nazionale sulla resilienza della rete.
 Robert ha iniziato la sua carriera nel campo della sicurezza informatica negli Stati UnitiAir Force, dove ha prestato servizio come ufficiale delle operazioni di guerra informatica presso la National Security Agency. Ha svolto missioni di difesa, intelligence e attacco in varie organizzazioni governative, inclusa l'istituzione di una missione di scoperta delle minacce I.C.S./SCADA unica nel suo genere che unisce insieme risposta agli incidenti, caccia alle minacce e intelligence sulle minacce. Infine, Robert è autore del libro SCADA and Me, Threat Intelligence and Me, Santa and Me e del webcomic settimanale
 http://www. LittleBobbyComic.com
 Robert può essere trovato su Twitter @RobertMLee o contattato via e-mail all'indirizzo: RLee@Dragos.com

© 2021 Robert M. Lee 1 Contributi di:
 Tim Conway
 Tim Conway è attualmente il responsabile del curriculum dell'I.C.S. La sicurezza al SANS. È stato responsabile dello sviluppo, della revisione e dell'implementazione dei componenti tecnici del SANS I.C.S. e offerte di prodotti SCADA ed è l'autore del corso I.C.S.456 — NERC CIP Essentials. In precedenza è stato direttore della conformità CIP e della tecnologia operativa presso la Northern Indiana Public Service Company (NIPSCO). È stato responsabile della tecnologia operativa, della conformità CIP NERC e degli ambienti di formazione NERC per i dipartimenti operativi all'interno di NIPSCO Electric. Nel corso della sua carriera, Tim ha lavorato per otto anni come ingegnere dei sistemi informatici EMS presso NIPSCO, con responsabilità sui server del sistema di controllo e sull'infrastruttura di rete di supporto. Tim è stato in precedenza presidente dell'RFC CIPC, è l'attuale presidente del NERC CIP Interpretation Drafting Team, attuale membro del comitato consultivo NESCO, attuale presidente del NERC CIPC GridEx 2013 Working Group e attuale presidente di NBISE Smart Pannello di sicurezza informatica della griglia.
 2
 Michele Assante
 Michael Assante è stato fondamentale nella creazione di questo corso ed è stata la sua visione che mi ha spinto a crearlo. Questa lezione è dedicata alla sua memoria. Per quelli di voi che non conoscevano Mike, è quasi garantito che la carriera che vi ha portato all'I.C.S. la comunità è stata influenzata da lui ad un certo punto. Ho scritto questo blog su ciò che Mike ha significato per me e sul perché non sarei dove sono oggi senza di lui, spero che queste parole aiutino a mantenere vivo il suo ricordo in questa classe: http://www.robertmlee.org/goodbye-mike -assante-grazie-per-letteralmente-tutto/
 Jeff Shearer e Jason Dely sono entrambi membri del team SANS “SROC” che aiuta a creare e testare componenti tecnici per i laboratori. È grazie al loro lavoro e alla dedizione con Tim che sono stati possibili i kit in classe e le interazioni con loro. Sono stati le menti dietro gran parte del lavoro pratico sui kit e hanno aiutato immensamente.
 Anche i membri del team Dragos hanno contribuito in modo significativo al corso attraverso le proprie ricerche e innumerevoli
 conversazioni. Inoltre, Austin Scott, Grant Freter, Jackson Evans-Davies e altri hanno gestito il poligono e hanno eseguito la squadra rossa dell'I.C.S. raggio d'azione del quartier generale Dragos utilizzato nello scenario del corso.
 2 © 2021 Robert M. Lee

// (
 Q

/
 ww ww et oo 6§§ &§ © S&S S&H Ho Hw Ww
 sistema operativo e
 eh
 quindi G&G G&G G&G &S & & S&S J
 Sezione 2 Schema
 I.C.S. Protocolli Lab 2.3: I.C.S. . Analisi
 Laboratorio 2.4: I.C.S. Mappatura della rete I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 3
 3
 1CS515| I.C.S. Visibilità, rilevamento e risposta

"Dato che non possiamo mai sapere cosa ci aspetta, dobbiamo sapere qual è la nostra postura in tempo reale (nel contesto della consapevolezza situazionale globale) e avere la capacità di rafforzare le difese di fronte a un avversario determinato e capace con l'intento di aggirando le nostre difese o sfruttando tali difese per i propri scopi." —Richard Schaeffer, ex direttore della NSA Information Assurance Division (IAD), luglio 2014
 Nella Sezione 1 abbiamo appreso l'intelligence sulle minacce e i suoi usi per la difesa attiva. Nella Sezione 2, gli obiettivi sono comprendere lo scopo dell'identificazione e della visibilità delle risorse. Realizzeremo questo obiettivo comprendendo alcune metodologie chiave come l'analisi dei gioielli della corona e i quadri di gestione delle collezioni. Metteremo in pratica queste metodologie sfruttando i laboratori con I.C.S nativi. e comunicazioni IT per la scoperta delle risorse che culminano in una migliore comprensione di I.C.S. protocolli. L’intelligenza è inutile se non hai una buona comprensione di te stesso e di ciò che ti sta a cuore. Questo ci preparerà per la Sezione 3 dove potremo utilizzare queste informazioni rapidamente
 scopi di sicurezza.
 4 © 2021 Robert M. Lee
 4 ee F&F §& CF SF CF CF OC FSF FF we YS
 ww Td w~ ow oo) 7
 Noi
 Phifeats 4» Intelligenza " * Consumo

(FASE 2)
 Fabiano ae

+ AOD Wiebbelt SER IINRINY Bite 0 raion
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Gli attacchi informatici mirati sono in aumento e rappresentano un serio rischio per I.C.S. ambienti. La ricerca e la decostruzione degli incidenti stanno iniziando a mostrare che gli aggressori stanno sviluppando strumenti compatibili con I.C.S. e si sono dotati di conoscenze di base su I.C.S. tecnologie e architetture per avere successo.Il successo di questi attacchi dipende dalle capacità esistenti dell'I.C.S. vulnerabilità e l’incapacità delle strategie difensive esistenti di far fronte a campagne di attacco prolungate. Molti I.C.S. le difese sono state ottimizzate per proteggere dagli attacchi informatici non strutturati e non diretti/mirati. La maggior parte delle strategie si basa su una forte difesa perimetrale con una certa protezione basata su host e una buona igiene della sicurezza. Queste difese sono efficaci contro alcune minacce, ma non riescono a bloccare o individuare i tentativi di intrusione più avanzati. Molte difese, se violate, forniscono poca o nessuna conoscenza di dove sia stato l’avversario e di cosa stia accadendo all’interno della rete di controllo. Dobbiamo evolvere oltre la difesa statica focalizzata sul perimetro e costruire nuovi modelli per integrare le strategie di difesa.
 Benefici
 Questo passaggio del ciclo ti consentirà di aiutare i team di architettura e difesa a rimanere consapevoli dell'aspetto della topologia di rete. Basandosi su questa conoscenza della rete, puoi identificare le stranezze della rete e associarle ad avvisi ed eventi sulla rete per identificare il tipo di avversari che le difese tradizionali non troveranno. Puoi aiutare a prendere decisioni sulla necessità o meno di una risposta agli incidenti e fornire il contesto al team. Puoi anche identificare le parti critiche della rete su cui il team dovrebbe concentrarsi. La fase di identificazione delle risorse e NSM è il punto fermo che tiene insieme il ciclo di difesa attiva. In termini più chiari, le persone che operano in questa fase dovrebbero pensare di avere quattro obiettivi principali:

* Identificare le risorse di rete e le connessioni che i team di architettura e difesa hanno mancato e trasmetterli a tali team affinché li conoscano e li utilizzino.

* Fornire raccomandazioni ai team di architettura e difesa in merito alla segmentazione della rete, ai punti di strozzatura e ai sensori aggiuntivi che potrebbero avvantaggiare NSM.

* Identificare le minacce nella rete oltre ciò che le difese tradizionali troverebbero e fornire raccomandazioni al team di difesa per la messa a punto dei sensori e delle risorse di difesa.

* Identificare se una minaccia è sufficientemente grave da avviare una risposta all'incidente e fornire raccomandazioni al management in merito offrendo al contempo il contesto agli eventi.

© 2021 Robert M. Lee 5
 5
 Obiettivi dello scenario del corso (1)

* Raffineria di Calistoga
* Quali sono i nomi e gli IP delle Stazioni Operatore (HMI/EWS/Historian)
 Qual è la marca e il modello del 10.10.20.10?

*Quali sono l'indirizzo IP e il dominio dell'avversario?

* Qual è il nome del file di progetto dannoso?

* Cosa ha fatto l'avversario al PLC di sicurezza?

* Qual è la routine dannosa nella logica e cosa fa?

* Qual è la causa principale dell'attacco?
 L’incidente è collegato all’incidente di C3P0?

°

*C3PO:
* Creare una topologia della rete di controllo.

* Qual è l'azione dannosa sull'HMI? _

* Quale registro è stato manipolato con quale valore?

* Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.5IS | I.C.S. Visibilità, rilevamento e risposta 6
 
 6 © 2021 Robert M. Lee

/

\

/
 Ww Ww Ww S Caso di studio: il disastro di Bhopal
 o. I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 7
 

© 2021 Robert M. Lee Panoramica sul disastro industriale di Bhopal

+ Disastro industriale di Bhopal, India, la notte tra il 2 e il 3 dicembre 1984
¢ Impianto di pesticidi della Union Carbide India Limited (UCIL).

+ Negligenza aziendale e problemi di sicurezza hanno provocato una fuga di gas di isocianato di metile (MIC) \
* Oltre 3.000 morti (stime fino a 20.000) e centinaia di migliaia di feriti
+ Il più grande incidente di sicurezza industriale fino a quel momento

| e È considerato uno dei principali catalizzatori dell'incremento della cultura della sicurezza nell'industria
: + La gestione della sicurezza dei processi ha ricevuto molta più attenzione e le aziende hanno iniziato
—--—3) monitorare gli investimenti e gli sforzi in materia di sicurezza a livello di consiglio di amministrazione per incoraggiare una cultura della sicurezza _
 I.C.S.515 | (Visibilità, rilevamento e risposta del CS 8
 Nelle notti tra il 2 e il 3 dicembre del 1984 si verificò un incidente sul lavoro, fino ad allora il peggiore del suo genere. Un investimento insufficiente in controlli di sicurezza/formazione/attrezzature/manutenzione e una cultura di negligenza aziendale hanno portato a un incidente prevenibile in cui si è verificato un rilascio di gas isocianato di metile (MIC) (utilizzato nella produzione di pesticidi) nell'area di Bhopal, in India. La “baraccopoli” che si era costruita intorno allo stabilimento era priva di risorse, con personale ospedaliero scarso, e dipendeva dallo stabilimento per gran parte della sua economia. Il rilascio del gas ha ucciso immediatamente circa 3.000 persone e numeri non ufficiali stimano che altre 16.000 persone moriranno nelle prossime settimane. Centinaia di migliaia furono ferite (si stima che circa 700.000 persone) e il gas MIC fu notato per l'aumento dei tassi di mortalità tra la popolazione indiana, un aumento significativo di aborti spontanei e difetti alla nascita e problemi di salute generali. Inizialmente l'azienda e il suo personale hanno preso le distanze dall'incidente. Fu solo quando intervenne la Corte Suprema indiana che la società alla fine accettò la responsabilità e pagò circa 500 milioni di dollari in sinistri e investimenti in
 la comunità.Questo orrendo caso di studio è in questa classe per ricordare i tipi di conseguenze che possono verificarsi nei siti industriali anche senza azioni dannose intraprese dagli avversari. Nonostante tutto l’orrore, l’unica cosa positiva che è emersa dall’incidente di Bhopal è stata la rivitalizzazione delle iniziative e degli sforzi per la sicurezza in tutta la comunità industriale. L'ingegneria della sicurezza si è sviluppata maggiormente nella propria pratica e impegno con competenze specializzate, formazione, attrezzature, certificazione e risorse per garantire che le aziende possano ridurre i danni ambientali e umani derivanti da
 guasti nei siti industriali.
 Riferimento: https://en.wikipedia.org/wiki/Bhopal_disaster
 8 © 2021 Robert M. Lee
 Ww, w wy wy ww ww

=
“pe 4s

"COME
 Sistemi di esempio in un processo MIC
 Lavaggio generale del gas
 Gas pulito
 Gas di aspirazione al compressore
 Liquido Restringente da Condensatore
 Liquido scrubbante puro
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Alcuni dei componenti industriali con cui avere familiarità in questo caso e come conoscenza generale sarebbero il depuratore del gas, la torre di combustione e il serbatoio/refrigeratore di refrigerazione.
 Uno scrubber di gas è un processo industriale per pulire i gas di scarico. In questo esempio, lo scrubber prende il gas vapore (MIC in questo caso di studio) e lo mette in contatto con un liquido che consente il passaggio di alcuni componenti gassosi mentre i componenti gassosi che sarebbero considerati rifiuti o non desiderati nel gas pulito vengono sciolti nel liquido. Ad esempio, in un altro settore, il gas naturale, il gas naturale non trasformato (o “gas acido”) contiene idrogeno solforato che danneggerebbe apparecchiature e generatori. Uno scrubber del gas può rimuovere i contaminanti in modo che il gas naturale possa essere utilizzato senza danneggiare le apparecchiature. Dal punto di vista della sicurezza, e nel contesto di Bhopal, il depuratore di gas avrebbe potuto pulire il gas MIC con soda caustica, neutralizzandone gli effetti non appena veniva rilasciato.
 Un camino a fiaccola è un processo che può avere considerazioni sia economiche che di sicurezza. In alcuni processi industriali, è più costoso tentare di utilizzare e trasportare il gas prodotto di scarto piuttosto che bruciarlo semplicemente. Pertanto, il gas potrebbe essere indesiderato e bruciarsi nel tempo. Separatamente, può verificarsi una sovrapressione delle apparecchiature dell'impianto in cui il gas viene estratto come sottoprodotto (ad esempio, l'estrazione del petrolio) e durante l'avvio, l'arresto, la manutenzione dell'impianto o semplicemente eventi di sovrapressione non pianificati. Le valvole di sicurezza rilasciano il gas nel camino per essere bruciato in sicurezza invece di consentire un'esplosione, danni alle apparecchiature o fuoriuscite di gas.
 Le unità di refrigerazione vengono sfruttate in molti ambienti industriali, compresi i sistemi di riscaldamento, ventilazione e raffreddamento
(HVAC) negli edifici. Nel contesto di Bhopal, il sistema di refrigerazione era collegato a serbatoi di stoccaggio di azoto e MIC ad elevata purezza. L'aumento della temperatura può portare rapidamente ad un'accelerazione delle reazioni chimiche, pertanto la temperatura deve essere mantenuta a livelli adeguati. Pertanto, il sistema di refrigerazione, anche se una piccola parte del processo, diventa una parte critica soprattutto dal punto di vista della sicurezza.
 In tutti questi diversi processi, ci sarebbero tecnologie fondamentali per qualsiasi processo industriale come valvole, sensori e, infine, allarmi per gli operatori quando si verifica una deviazione nel sistema oltre la norma prevista.

© 2021 Robert M. Lee 9
 I sistemi di refrigerazione raffreddano il gas
 prima che vengano spinti I sistemi/camini di combustione bruciano in tutto il sistema Il lavaggio del gas rimuove il gas infiammabile indesiderato o
 contenimento da situazioni di sovrapressione del gas
 9 Riferimento: https://emis. vito.be/en/bat/tools-overview/sheets/ gas-scrubbing-general
 https://en.wikipedia.org/wiki/Gas_flare http://siglercommercial.com/wp-content/uploads/201 7/10/03-Water-Cooled-Chillers.pdf
 10 © 2021 Robert M. Lee

~~ 7 eo oO oo Oo
 o- rw noi noi cuciamo ww ew noi noi noi ww & ww wy
 nd
 Processo MIC a Bhopal
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 All'UCC un semplice modello di come questi sistemi si sono riuniti può essere trovato nell'immagine sulla diapositiva. La raffinazione MIC entrerebbe nei serbatoi di stoccaggio miscelata con azoto ad elevata purezza in modo che non vi sia ossidazione. I serbatoi fungono da deposito per l'utilizzo del MIC nel processo di produzione dei pesticidi.
 Qui possiamo vedere più chiaramente che il Vent Gas Scrubber e la Flare Tower sono presenti dal punto di vista della sicurezza. Se i serbatoi sono sovrapressurizzati, o se devono scaricare gas, lo faranno attraverso una valvola di sicurezza verso lo scrubber del gas o la torre di torcia (o idealmente attraverso lo scrubber del gas verso la torre di torcia). Ciò che non è facilmente visibile qui, però, è che in questo progetto solo 2 serbatoi dovrebbero essere pieni di MIC e il terzo serbatoio dovrebbe essere utilizzato solo come serbatoio di troppopieno in modo che se il serbatoio 610 o 611 presenta problemi, il MIC possa essere conservato in sicurezza nel 619 Lo scrubber del gas qui aveva una capacità di 190 libbre all'ora (molto inferiore a quella richiesta laddove alcune strutture dispongono di scrubber che funzionavano a 60.000 libbre all'ora).L'unità di refrigerazione non viene utilizzata per il trabocco ma viene utilizzata per mantenere la temperatura nei serbatoi. La MIC in questo processo dovrebbe essere conservata a 0 gradi centigradi.
 Riferimento: Ramificazioni dell'UCC.pdf

© 2021 Robert M. Lee 11
 W
 P&ID IC
 SERBATOIO DI STOCCAGGIO DEL MICROFONO

(@FO COLLETTORE DI SFIATO DI PROCESSO (PVH) DAL COLLETTORE DI AZOTO AD ALTA PUREZZA AL RITORNO DELLA POMPA DI TRASFERIMENTO
 DALL'UNITÀ DI REFRIGERAZIONE AL COLLETTORE DI SFIATO DELLA VALVOLA DI SICUREZZA (RVVH}
 DA MIC REFINING STILL (MRS)
 ALL'UNITÀ DERIVATI
€}
 Pi ~ INDICATORE PRESSIONE TIA ~ INDICATORE/ALLARME TEMPERATURA PIC ~ INDICATORE/REGOLATORE PRESSIONE LIA = INDICATORE/ALLARME LIVELLO
 I.C.S.51I5 | I.C.S. Visibilità, rilevamento e risposta
 Nella diapositiva è contenuta un'altra vista del processo MIC, da uno schema di tubazioni e strumentazione (PID o P&ID). Qui puoi vedere come il processo fisico dovrebbe interagire con le apparecchiature tecniche come valvole, pompe e indicatori. Il danneggiamento di uno qualsiasi di questi componenti potrebbe comportare la perdita di vista o di controllo del processo da parte degli operatori.
 Riferimento: Process-Reliability.pdf
 12 © 2021 Robert M. Lee
 2

= 2 2)

™- wowww
 ww noi wow noi ww noi wb ww ww

)
 wo w noi noi

_> «
 3
 Cronologia del disastro di Bhopal
 oud 21-23 24 dicembre ed
: oe es i L'acqua è entrata nel serbatoio E610 niyo eeobE Dee : Lavaggio di diversi tubi per un fag dove venivano trasportate 42 tonnellate di MIC Img WV °"Kers ed Odore e manutenzione MIC Immagazzinato : ha visto la perdita
 40:00 dicembre 00:15 dicembre attivato, lo spray antincendio non è vuoto L'operatore si è accorto che la pressione era aumentata, ma non abbastanza alta e quindi non è riuscito a ridurre la portata al suo valore massimo di 55 psi raggiungendo la cima della torre. pressione in E610 e una valvola di sicurezza è saltata fuori Tentativo di rilasciare il gas come T: informato la polizia; non si è verificata alcuna mobilitazione significativa del Freon drenato
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 20:00 del 24 dicembre
 Lavaggio di più tubazioni per manutenzione.
 Le tende antiscivolo richieste come procedura di sicurezza non sono state installate a causa della scarsa formazione. La valvola di spurgo (troppopieno) era bloccata, quindi l'acqua non veniva scaricata correttamente.
 9-13, 13:00, 24 dicembre
 L'acqua si è riversata nel serbatoio E610 dove erano immagazzinate 42 tonnellate di MIC.
 Acqua e MIC creano una reazione che aumenta rapidamente la pressione e la temperatura. Gli allarmi della temperatura erano stati precedentemente disattivati ​​e la pressione rientrava in un intervallo accettabile.
 23:30, 24 dicembre I lavoratori hanno notato l'odore del MIC e hanno visto la perdita.
 00:15 dicembre 3"4 L'operatore si è accorto che la pressione è salita al valore massimo di 55 psi e una valvola di sicurezza è saltata fuori rilasciando il gas.
 00:40 del 34 dicembre Sirene a gas attivate, portati spruzzatori d'acqua antincendio, ma non abbastanza alti da raggiungere la cima della torre. I tentativi di raffreddare il gas fallirono poiché il freon del sistema di refrigerazione era stato scaricato
 1:00 del 34 dicembre Il serbatoio di riserva 619E non era vuoto e quindi non è riuscito a ridurre la pressione nell'E610
 La polizia è stata informata, ma non si è verificata alcuna mobilitazione significativa.
 Riferimento: Bhopal RCA.pdf

© 2021 Robert M. Lee 13 Analisi delle cause principali

* Si sono verificati gravi negligenze aziendali, errori umani ed errori di sistema
 Spesso negli incidenti industriali non si tratta di un unico guasto ma di una serie di guasti a cui può essere difficile pensare in anticipo, sebbene alcuni siano evidenti

* Principali errori di sistema:

°
 Il depuratore del gas di sfiato non era in funzione o non aveva una capacità sufficiente al momento dell'incidente La torre di combustione era in manutenzione da settimane (lavoro normalmente di 8 ore) Unità di refrigerazione offline per risparmiare denaro e freon spedito ad altri impianti Rilevamento inadeguato della temperatura nei serbatoi
 Un serbatoio doveva essere un troppopieno di emergenza, ma al suo interno era immagazzinato MIC Progettazione e manutenzione inadeguate delle tubazioni per impedire il flusso d'acqua nel serbatoio
 I.C.S.515 | Visibilità, rilevamento e risposta di 1CS
 L'analisi delle cause profonde è un processo comune da eseguire dopo un guasto o un incidente nel mondo industriale. Ciò si collega molto bene con ciò che è necessario nell’analisi forense digitale e nella risposta agli incidenti. Sfortunatamente, con la crescente complessità dei nostri ambienti industriali e senza un’adeguata pianificazione anticipata, diventa sempre più difficile eseguire l’analisi delle cause profonde. Se non si pianifica in modo appropriato quali dati sarebbero necessari, da quali sistemi o persone, potresti non essere mai in grado di eseguire l’analisi delle cause profonde e, quindi, non puoi imparare e migliorare l’ambiente contro il rischio successivo.
 Ci sono stati numerosi problemi che si sono verificati a Bhopal. Alcuni dei problemi di sistema su cui concentrarsi erano intorno al
 scarsa manutenzione e progettazione delle apparecchiature di sicurezza.
 Ad esempio, il depuratore di gas è stato costruito per gestire una portata di 88 Kg di MIC all'ora, ma la portata dell'impianto era in realtà di 20.000 Kg/ora. I serbatoi di stoccaggio dovevano trasportare 5 tonnellate al giorno e il MIC non dovrebbe esserlo
 conservati per lunghi periodi di tempo; Tuttavia, il MIC veniva immagazzinato per mesi di seguito e i serbatoi contenevano 55 tonnellate di MIC
 loro. I sistemi di sicurezza che avrebbero potuto aiutare, come le valvole di sicurezza e di controllo della pressione, non avevano funzionato
 mesi e ha avuto grossi problemi di manutenzione. La valvola di sicurezza MIC indicava 10 psi, ma la pressione effettiva era di 40 psi.L'unità di refrigerazione avrebbe dovuto mantenere la MIC al di sotto dei 5 gradi Celsius, ma è stata spenta per risparmiare denaro
 la temperatura era ambiente. Il Freon dell'unità veniva spedito ad altri impianti, quindi quando l'unità veniva attivata, veniva spedito ad altri impianti
 non aveva Freon ad aiutarlo. I sensori di temperatura nel processo non funzionavano correttamente da anni, così come gli operatori
 aveva disabilitato proattivamente gli allarmi di alta temperatura nella sala di controllo. Di conseguenza non è stata effettuata alcuna registrazione regolare della temperatura nei fogli di registro, il che avrebbe potuto individuare la reazione fuori controllo molto prima.
 Al di là dei fallimenti del sistema, vi è stata una significativa carenza di preparazione, formazione e investimenti in termini di come gestire la pianificazione e la risposta alle emergenze. Il personale dell'impianto, la polizia e il personale medico erano impreparati all'incidente, amplificando l'impatto sulla popolazione locale.
 Riferimento: Ramificazioni dell'UCC.pdf
 14

© 2021 Robert M. Lee
 14

¥Y FY © SS @w ef oo & noi mamma owt oe m, = -

)

¥ ww Ww S

)
 ww f
~~ come noi

-)
 emes e lezioni apprese applicate al cyberso
 Capire cosa può andare storto (conseguenza)
 Mappalo su Cyber
 È possibile utilizzare mezzi informatici per compromettere i gioielli della corona?
 Quali sono i fiori all'occhiello dell'operazione?
 Quale sarebbe l'impatto se fallissero o fallissero? Quale sarebbe il percorso di attacco e come verremmo manipolati? prevenire/rilevare/rispondere?
 Phe 1 6 NADAS Wl sas
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Bhopal ha molti corollari alla sicurezza informatica. I meccanismi di prevenzione hanno fallito nel tempo o non sono stati mantenuti adeguatamente. Atrofia dei controlli preventivi nell’I.C.S. reti è comune (qualsiasi regola nei firewall, nuove connessioni, mancato mantenimento delle difese). Senza la capacità di identificare quell’atrofia (visibilità) non è possibile mantenere il valore dei controlli preventivi. Inoltre, l'incapacità di rilevare problemi (indicatori di temperatura e pressione, nonché allarmi nella mappa del mondo fisico, nonché punti di raccolta e rilevamenti nella sicurezza informatica) e rispondere ad essi
(avere un piano e prepararlo/provarlo) ti lascia impreparato agli eventi.
 I gioielli della corona sono quei componenti dell'ambiente che sono fondamentali per il suo funzionamento. Ad esempio, un'unità di refrigerazione disattivata, gli allarmi disattivati, il depuratore di gas disattivato e la torre di segnalazione disattivata erano tutti gioielli della corona e il loro guasto ha portato alla perdita di vite umane. Il moderno ambiente industriale sta diventando così complesso che non è più possibile sperare di proteggere tutto. Ma dovresti sforzarti di iniziare con i gioielli della corona e capire “come potrebbe un avversario utilizzare il cyber come mezzo per compromettere questi gioielli della corona?” Iniziare con il processo fisico e i suoi elementi di controllo per determinare ciò che è importante, e poi mapparlo a ritroso su quali percorsi di attacco sono ora possibili attraverso l’abilitazione digitale di tali componenti è un modo molto praticabile per eseguire l’analisi delle conseguenze.
 È anche facile condannare tale digitalizzazione. Ad esempio, sarebbe facile dire che il sistema di sicurezza non dovrebbe essere collegato in rete. Ciò può essere vero in molti casi, ma in questo caso altri stabilimenti UCC hanno deciso di collegare in rete i propri sistemi di sicurezza in modo da poter identificare i problemi più rapidamente ed essere più proattivi con la manutenzione. Questi sforzi hanno portato al salvataggio di vite umane e dell’ambiente. Gran parte della digitalizzazione che avviene nel settore industriale non è solo finalizzata al valore aziendale, ma anche alla sicurezza e al valore della produzione. Sebbene sia facile criticare la questione dal punto di vista della sicurezza informatica, è importante vedere i problemi in modo più olistico e quindi determinare quali controlli compensativi devono essere applicati per ridurre il rischio informatico consentendo al contempo il business.

© 2021 Robert M. Lee 15
 È
 Inventari delle risorse e quadri di gestione delle collezioni
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee
 16
 ry
 ww w ww ww

"S
 Importanza dell'I.C.S. Identificazione delle risorse
 Le soluzioni di sicurezza avanzate sono più attive su. motivi di sicurezza fondamentale
 Minaccia ene acarhalietaa’ NSM, e l'Incidente peepee richiede la conoscenza della rete
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 Se non sai quali risorse hai sulla tua rete, o anche quali reti ti appartengono, è quasi impossibile difenderle. Creazione dell'I.C.S. gli inventari delle risorse possono essere incredibilmente impegnativi a causa del numero di sistemi, fornitori e appaltatori presenti sulla rete in un dato momento. I tradizionali strumenti di gestione delle risorse IT utili come Nmap e altre forme di scansione attiva possono essere dannosi per I.C.S. reti. Pertanto sono necessari metodi precisi, misurati e validati.
 I.C.S. L'inventario riguarda anche il tipo di software, firmware, componenti e configurazioni che operano su una risorsa. Adottare un approccio sistematico per identificare questi aspetti è fondamentale per comprendere la rete e quella che sarebbe considerata un’attività normale. Gli ingegneri di processo potrebbero già disporre di questo tipo di informazioni, quindi assicurati di visualizzarle come difensore attivo e assicurarti che siano utilizzabili per la sicurezza della rete.(Cioè, assicurati che sia archiviato in modo tale da poterlo utilizzare.)
 È fondamentale comprendere quali dispositivi si trovano su ciascun segmento di rete, come sono in grado (non necessariamente configurati) di comunicare tra loro e come attraversano segmenti e reti. Dobbiamo comprendere i percorsi di attacco e iniziare a raccogliere le informazioni necessarie per determinare le superfici di attacco esistenti e potenziali. Ciò richiede una conoscenza approfondita del tuo I.C.S.. Molte organizzazioni non raccolgono informazioni sufficienti per identificare i percorsi di attacco e creare modelli completi di superficie di attacco. In questa sezione, | condividerà alcuni suggerimenti e strumenti su come identificare le tue risorse e preparare la tua infrastruttura a raccogliere un numero sufficiente di informazioni del giusto tipo per avere successo.
 I dati e gli artefatti presentati nei report di intelligence sulle minacce potrebbero non essere utili senza comprendere se tali artefatti sono presenti sulla rete. Quando Windows XP raggiunse la fine del suo ciclo di vita, Oracle annunciò che non avrebbe più supportato Java 7. Se un rapporto di intelligence sulle minacce discutesse dell'utilizzo di exploit basati su Java 7 da parte di un avversario, sarebbe estremamente utile sapere se Java 7 operava su il tuo ambiente. Fai affidamento su Java 7 nel tuo sistema I.C.S. sistema? Puoi scoprirlo velocemente? In caso contrario, un difensore attivo dovrebbe collaborare rapidamente con il personale dell'architettura per aiutare a eseguire le procedure I.C.S. identificazione del bene. In definitiva è responsabilità del team di architettura, ma i difensori attivi possiedono competenze e abilità professionali utili all'identificazione e alla verifica delle risorse.

© 2021 Robert M. Lee 17
 ib
 Quando l'I.C.S. le risorse si guastano, l'impatto immediato è più importante che capire se il guasto è il risultato di comportamenti dannosi, errori di configurazione o guasti hardware. Capire cosa ha causato il guasto del dispositivo diventerà rapidamente importante per risolvere la situazione in futuro e preservare le operazioni. È fondamentale identificare le risorse e a cosa sono collegate. Quali altre risorse fanno affidamento sul dispositivo guasto? Identificare in anticipo risorse e dipendenze può far risparmiare tempo prezioso e ore al personale.
 Conosci te stesso Per difendere attivamente il tuo I.C.S., devi prima di tutto conoscere il tuo ambiente. La conoscenza che cerchi se ne va
 oltre le semplici mappe di rete, estendendosi al modo in cui l'I.C.S. comunica. Questo è un ambito in cui una soluzione all’80% non fornirà una difesa credibile. Innumerevoli valutazioni sul campo hanno confermato che l’alta fedeltà e la conoscenza accurata del sistema sono difficili da trovare. "Come costruito" di solito non riflette la condizione attuale "come gestito". Tutti i percorsi di attacco esistenti dovrebbero essere identificati e intesi come elemento fondamentale per costruire la propria difesa. Percorsi verso il tuo I.C.S. includerà connessioni di rete, schemi di accesso remoto, spostamento di dati e file utilizzando dispositivi mobili e tutte le interazioni che coinvolgono dispositivi informatici. Il secondo imperativo è sforzarsi di sapere come un avversario potrebbe intromettersi, muoversi e agire all’interno del sistema. Non puoi possedere una conoscenza utile del tuo avversario se non hai la capacità di monitorare tutto il tuo I.C.S.. Molti I.C.S. le linee guida sulla sicurezza spiegano come costruire difese progettate per contrastare le minacce informatiche non strutturate e non mirate. Questo corso è progettato per andare oltre tale guida e fornire i metodi, le conoscenze e le competenze necessarie per lavorare attivamente
 difendi il tuo I.C.S. da tutte le minacce.
 La conoscenza della rete è una cosa che i difensori dovrebbero sempre avere
 In definitiva, i difensori dovrebbero sempre avere una piena comprensione della rete e gli aggressori dovrebbero sempre lavorare sodo per ottenerla. Gli avversari dovrebbero essere in svantaggio. Anche se l’argomento può sembrare idealistico o addirittura controverso, dal punto di vista tecnico la difesa è più facile dell’attacco. (Spesso sono il personale e gli obiettivi aziendali a causare conflitti!) Difensori ben preparati che comprendono il proprio spazio informativo
(topologia della rete e livelli di attività/basi di riferimento) rileveranno rapidamente le anomalie quando gli aggressori entrano nei loro ambienti. Un avversario non "vince" penetrando in una rete. L'avversario ha obiettivi e risultati attesi; negare obiettivi come il furto della proprietà intellettuale o il danneggiamento dei dispositivi è una vittoria per i difensori. Gli avversari sono bravi quando sfruttano i propri punti di forza, ricercano e imparano a conoscere gli ambienti di rete e automatizzano il più possibile i loro processi. Personale automazione e I.C.S. gli ingegneri dovrebbero avere familiarità con l'idea di ricerca e automazione dei processi. Usa i tuoi punti di forza!
 La conoscenza del campo di battaglia (delle vostre reti) è il più grande vantaggio del difensore rispetto all'attaccante. La mancanza di preparazione per sfruttare questo importante vantaggio lascia la maggior parte del vantaggio a un attaccante. Le valutazioni sul campo hanno storicamente dimostrato che molte organizzazioni hanno una conoscenza incompleta della propria rete
 topologie, flussi di dati e host.Ma è difficile!
 Lo abbiamo sentito tutti più e più volte: "La difesa è dura!" C'è del merito in questa linea quando infrastrutture in costante cambiamento, utenti negligenti e fornitori e appaltatori di terze parti hanno libero accesso. È difficile anche quando persone come l'operatore vogliono amministrare il sistema o controllare l'HMI da remoto senza preoccuparsi della sicurezza. Queste sono sfide che rendono difficile la difesa. Ma la difesa è fattibile. Non esiste una soluzione facile, ma la difesa può, e
 dovrebbe avere il sopravvento sull'offensiva.
 È importante che i difensori abbiano un approccio metodologico e un proprio piano di attacco per la difesa. La sicurezza è un processo. I.C.S. le persone, soprattutto, dovrebbero comprendere i processi. Sono necessari vari strumenti, vari metodi, messa a punto, eliminazione di alcune soluzioni/fornitori e ripetizione fino al perfezionamento del processo.
 18 © 2021 Robert M. Lee
 w.m
 UN
 wy FF S&S WM WO WM WH
 w
 a] eh

. w
 wv ww wow wo & & &
 oT di wow 8S YS YS WH Ww Hw WH Ww

“5 45
 45
 Ricorda inoltre che la sicurezza della rete ruota attorno a molte relazioni di fiducia. Chiunque ti fidi per connettersi alla tua rete si fida anche delle altre persone. Pertanto, ciascuna connessione alla rete può averne una serie di altre
connessioni "attendibili", creando un collegamento tra reti di cui potresti non fidarti o di cui potresti non essere a conoscenza. La tua rete di fornitori che si connette in remoto a te... sì, ora fa parte della tua rete così come tutto ciò a cui si connettono i fornitori. Nella comunità abbiamo assistito numerose volte a casi in cui infezioni provenienti da una rete esterna diffondevano malware in I.C.S. reti. Ciò accorcia di fatto l’I.C.S. Kill Chain e rende molto più difficile identificare e rimediare alle intrusioni. In alcune diapositive, questo concetto di comprensione delle reti di cui sei responsabile e a cosa sono connesse verrà discusso in modo più approfondito.
 Per ora ricordiamo che un attivo I.C.S. La difesa richiede un team completamente integrato che aiuti a identificare e analizzare i comportamenti sospetti e a ideare azioni di sicurezza attive per interrompere il progresso della catena di uccisione. Alcune delle informazioni di cui hai bisogno esistono al di fuori della tua organizzazione e richiedono il coordinamento con il tuo I.C.S. produttori o integratori per ottimizzare a
azione di difesa “sicura”. È inoltre necessario integrare ruoli funzionali all'interno della propria organizzazione per pianificare, testare ed eseguire azioni difensive. Rivediamo alcuni dei ruoli importanti da includere nell'architettura della difesa attiva da I.C.S.410.
 Le persone sono abituate a compilare parti del processo che non possono essere automatizzate. Ruoli comuni per le persone dell'I.C.S. ambiente sono:
 1) Ingegnere di processo: progetta i sistemi e i processi utilizzati nell'ambiente di controllo 2) Tecnico sul campo: mantiene e ripara i dispositivi di campo
 3) Programmatore: implementa i singoli passaggi del processo come codice e distribuisce il codice sui controller
 4) Operatore: lavora nel centro operativo gestendo e controllando da remoto il processo
 Questi ruoli tradizionali devono essere potenziati e attrezzati per integrarsi con i ruoli legati alla tecnologia dell’informazione e alla sicurezza informatica per affrontare le sfide della complessità, del cambiamento e delle minacce informatiche.
 I fornitori (produttori di I.C.S.) progettano e costruiscono i componenti utilizzati nei sistemi di controllo, come PLC e HMI. Molti fornitori offrono servizi di integrazione per i loro prodotti o vendono sistemi completi chiavi in ​​mano. Molti fornitori hanno diverse linee di prodotti e hanno milioni e milioni di righe nei loro codici base. Anche se quasi tutti gli I.C.S. i fornitori hanno iniziato ad adottare la sicurezza nel loro ciclo di vita di sviluppo, la loro base di codice legacy unita ai cicli di aggiornamento lenti nella maggior parte delle impostazioni di controllo rappresentano una sfida di sicurezza per I.C.S. Comunità. I.C.S. i fornitori sono preziosi alleati per aiutare a coordinare i piani di difesa e assistere durante gli incidenti. I rapporti contrattuali dovrebbero essere rivisti per assicurarsi di avere il loro supporto e di avere aspettative reciproche su ciò che possono fornire.
 I.C.S. i fornitori includono, a titolo esemplificativo, ABB, Alstom (Areva), GE, GE Fanuc, Hitachi, Honeywell, Mitsubishi, Rockwell Automation, Schneider Electric, Invensys, Emerson, Siemens e Yokogawa.
 Persino il personale in loco o i PoC dei fornitori non comprendono nativamente la sicurezza informatica (e forse non se ne preoccupano nemmeno); tuttavia, hanno assolutamente la conoscenza della rete e del processo richiesto. Le loro esperienze e la comprensione della rete sono vitali per il tuo successo, quindi assicurati di interfacciarti con questo personale. Non sottovalutare mai l'importanza di prendere una bevanda fredda con qualcuno e chiedere: "Che cosa ti preoccupa di più?" oppure "Se dovessi compromettere la struttura, come lo faresti?" Queste e altre domande non solo illuminano le aree che dovresti esaminare, ma aiutano anche a creare relazioni di fiducia tra te e le persone. Quando si verifica un'intrusione, vuoi che le persone in rete si sentano a proprio agio nel venire da te e segnalare le "stranezze" della rete."Le stranezze potrebbero essere il primo motivo per cui si verifica un incidente e lo stesso personale potrebbe sapere come aiutarti.

© 2021 Robert M. Lee 19 Identificare I.C.S. Risorse

_ Determinare l'area di responsabilità v Trovare e utilizzare le informazioni esistenti a
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Come discusso in precedenza, è estremamente importante identificare le varie risorse di cui disponi e le reti a cui sei connesso. Puoi fidarti dei tuoi fornitori e di tutte le reti a cui sono connessi. Potresti fidarti delle reti IT aziendali e potresti anche fidarti di tutte le reti della tua organizzazione di cui non sei responsabile; ma dal punto di vista della sicurezza non dovresti. Qualsiasi connessione in entrata e flusso di dati provenienti dall'esterno delle aree di tua responsabilità devono essere interrogati e monitorati. Fidarsi ma verificare.
 Determinare l'area di responsabilità (AOR):
 Scopri il tuo AOR, anche se non hai la proprietà/il controllo su tutti i dispositivi al suo interno. Se sei responsabile della rete, allora devi sapere tutto su di essa e tutto ciò a cui si connette. La direzione dovrebbe identificarti qual è il tuo ruolo e su quali reti hai autorità. Se non può, aiutalo a determinarlo ed elabora un piano per quello che dovrebbe essere considerato il tuo AOR.
 Trova e utilizza le informazioni in uscita
 Identificare mappe, diagrammi ed elenchi di inventario esistenti dal personale che già lavora lì, copie di backup o esistenti, fornitori che forniscono supporto (dovrebbero conoscere i propri dispositivi) e così via. Assicurati di includere tutte le risorse, anche se non ritieni che siano un I.C.S. risorsa. Ad esempio, anche se il tuo UPS non fa parte del tuo OT ma è connesso alla tua rete tramite SNMP, ora rientra nella tua responsabilità. Se la disattivazione del server di fatturazione avrà un impatto sulla capacità di eseguire ordini attraverso la pipeline e quindi porterà alla chiusura della pipeline, allora quel server di fatturazione fa parte dei tuoi sforzi. Ciò non dovrebbe essere esteso agli effetti di terzo ordine. Ad esempio, provare a giustificare il modo in cui la rimozione del sito Web comporterebbe l'interruzione delle operazioni attraverso effetti di ordine 2™ o 3 si estenderebbe troppo agli sforzi di sicurezza aziendale e fungerebbe da distrazione.
 Convalidare le informazioni note
 Qualsiasi informazione fornita da altri dovrebbe essere convalidata: convalida sempre le informazioni. Non dare per scontato che esista realmente solo perché è su una mappa. Allo stesso modo, solo perché qualcosa non è sulla mappa non significa che non esista. È estremamente comune nel settore fare una passeggiata nello stabilimento, indicare un dispositivo e chiedere: "Che cos'è?" La risposta "Non lo so, è lì da quando sono arrivato qui" non è né divertente da ascoltare né accettabile dal punto di vista della sicurezza. Non limitarti a disconnettere le cose con cui non hai familiarità, ma scopri cosa sono e documentale.
 20 © 2021 Robert M. Lee
 20
 oh
 VD)
 ww ww ww w
 vr P OP OP Oh wh HH HS Hw
 w
 Noi
>7
 noi ww wo & ww] noi ww noi ww noi noi w&
 La fase di convalida viene eseguita valutando quanto sono dettagliate le informazioni ricevute, quando sono state aggiornate l'ultima volta e dando uno sguardo critico alla natura attendibile dei dati ricevuti. Ciò ti consentirà di passare alla raccolta e alla documentazione delle informazioni per convalidare (e potenzialmente eliminare le informazioni errate) ciò che è meno probabile che sia accurato per primo. È un metodo per valutare e dare priorità alle informazioni.
 Raccogliere
 Quando si esegue la raccolta, utilizzare innanzitutto i metodi di raccolta meno invasivi. Ad esempio, se puoi utilizzare la scansione passiva, fallo invece della scansione attiva. Se riesci a trovare le cose sulle mappe e a convalidarle tu stesso, cerca di evitare di disturbare il personale del sito. Quando è necessario spostarsi sul posto per identificare le risorse o preparare l'infrastruttura per la raccolta, provare a farlo in caso di tempi di inattività della produzione o dei test. A quel punto, puoi estrarre elementi come tabelle ARP e configurazioni da firewall, router e switch. (Ne parleremo più approfonditamente in alcune diapositive.) A volte sono necessari elmetti protettivi e ginocchiere, e va bene, ma può richiedere molto tempo. Scopri il più possibile nel modo meno invasivo le operazioni e il tuo tempo.
 Documento
 In questa fase puoi aggiungere/rimuovere risorse e connessioni di rete a tuo piacimento, ma includi sempre i record storici.
(Non buttare via le vecchie mappe.) Se le connessioni esistevano nel tuo ambiente ma non lo sono ora, forse verranno riattivate in futuro. Se un dispositivo non è più presente nella rete, è utile tenere traccia di cosa fosse quel dispositivo nel caso in cui non avrebbe dovuto essere rimosso.
 Quando ottieni un nuovo AOR, ricominci da capo questo processo. Qualunque cosa tu abbia identificato in precedenza ora diventa parte delle tue informazioni esistenti. Ma questo significa anche che ora devi convalidare nuovamente le informazioni conosciute. Man mano che acquisisci più reti o diventi responsabile di più reti, potresti scoprire cose sulla tua rete precedente che non sapevi. Ad esempio, potresti non sapere che uno switch di rete in una rete che non controlli era in realtà il punto ridondante di failover per il tuo router principale.Sarebbe stato utile saperlo inizialmente, ma man mano che impari di più su altre reti, spesso impari di più sulla tua.

© 2021 Robert M. Lee 21 Esempio di un record di inventario delle risorse
 Posizione Raffineria di Calistoga
 Posizione sul sito Rack 3 East Corridor
 Nome risorsa PLC di sicurezza Marca "Rockwell / Allen-Bradley".
 Modello | 1756 L71/B LOGIX5571 Numero di serie oa 011b7012
 Versione firmware 33.011
 Indirizzo IP /10.10.20.10
 1CS515| I.C.S. Visibilità, rilevamento e risposta =
 Gli inventari delle risorse sono disponibili in molte forme e il modo in cui registri e memorizzi le informazioni dipenderà in gran parte da ciò di cui hai bisogno dall'inventario. Questa diapositiva mostra un esempio di ciò che potresti trovare per un inventario dei dispositivi di controllo in un sistema I.C.S. rete. Il numero di serie e la versione del firmware potrebbero non essere tutto ciò di cui hai bisogno. Un errore comune dei professionisti della sicurezza è raccogliere e archiviare ogni possibile dato invece di quanto necessario per raggiungere i propri obiettivi. Ciò non significa che non vuoi registrare informazioni facili da ottenere che potrebbero essere utili in seguito, ma se non utilizzi la versione firmware per nulla (ad esempio, non eseguirai patch sui PLC e non ti interessa informazioni sull'ultimo firmware sul dispositivo), quindi impegnarsi per ottenere il firmware da ogni dispositivo potrebbe rappresentare una distrazione o, a seconda di come lo si raccoglie, qualche piccolo rischio per le operazioni.
 Tuttavia, ogni informazione può essere utile con il giusto caso d’uso. Se hai giustificato il motivo per cui hai bisogno delle informazioni e prevedi di fornire valore, in particolare al personale operativo, attraverso la raccolta e l'archiviazione
 di queste informazioni, procedere è l'ideale.
 Nella maggior parte delle organizzazioni, la raccolta del tipo di informazioni qui elencate sarà di grande valore non solo per la gestione delle vulnerabilità, ma anche per i casi d'uso che supportano il rilevamento delle minacce e la risposta agli incidenti.
 22 © 2021 Robert M. Lee
 vr noi wD w
 ww ww ‘>
 a>Ww
 Identificazione delle risorse con un budget limitato

° Individuare gli asset e documentarli
 non deve costare denaro:
* I prodotti a pagamento di solito aggiungono facilità, ma è possibile con strumenti open source o nativi
* Quattro metodologie di esempio:
* Ispezione fisica: richiede tempo e
 difficile in ambienti di grandi dimensioni
 Analisi del traffico: analisi della cattura dei pacchetti più sicura per I.C.S. ambienti
 Analisi dei file di configurazione: ottimo approccio per mappare le risorse conosciute
 Scansione: veloce consigliata solo in caso di interruzione del processo o quando ottimizzato con l'assistenza di I.C.S. fornitore
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Ci sono notizie costanti su quanti miliardi di dollari vale la comunità delle infrastrutture critiche. Cicli di acquisizione nell’ordine di milioni sono una norma del settore. E sembra che ci siano soldi disponibili praticamente per tutto, tranne che per l'unica cosa che vuoi fare. Tuttavia, man mano che i proprietari delle risorse si rendono conto che la comprensione e la sicurezza della rete possono favorire la dipendenza e ridurre i tempi di inattività, ulteriori finanziamenti potrebbero essere resi disponibili per la "sicurezza". Ma se fai parte del folto gruppo di persone che non dispone di budget per acquistare il prodotto più recente e migliore, è importante sapere come eseguire l'identificazione delle risorse con un budget limitato. Anche se puoi permetterti strumenti di fascia alta, devi capire che molti strumenti a pagamento svolgono funzioni eseguite dagli strumenti open source. Gli strumenti a pagamento di solito sono dotati di contratti di supporto, spesso accelerano il processo e possono far risparmiare ore preziose ai dipendenti. Tuttavia, è importante comprendere la scienza dietro gli strumenti a pagamento e come eseguire lo stesso tipo di processi con strumenti open source. Esistono quattro metodologie principali per eseguire l'identificazione delle risorse.
 Ispezione fisica
 L'ispezione fisica delle risorse può richiedere molto tempo ed essere difficile in ambienti di grandi dimensioni, soprattutto quelli dotati di reti geograficamente separate. Può anche essere pericoloso in alcune zone. Tuttavia, è utile sapere come eseguire ispezioni fisiche, come identificare le risorse e come tracciare la fibra in tutta la struttura per vedere cosa è collegato e a cosa. Non è necessariamente il miglior tipo di identificazione delle risorse, ma esistono scenari in cui è utile.
 Analisi del traffico
 L'analisi del traffico tende ad essere il metodo più sicuro e meno dispendioso in termini di tempo per eseguire l'identificazione delle risorse. Esisteranno differenze OSI Layer 1 tra vari tipi di dispositivi (come discusso in due diapositive) come seriale, Ethernet o wireless. Tuttavia, le informazioni e i dati devono essere trasmessi tra i dispositivi collegati. Comprendere quali sono i dati e come esaminarli può aiutare a identificare rapidamente le risorse. Ad esempio, Modbus TCP può rivelare gli indirizzi IP ed Ethernet di un dispositivo nonché gli I/O e i registri a cui si accede.
 Analisi del file di configurazione
 I file di configurazione possono aggiungere ulteriore convalida delle risorse connesse alla rete. È inoltre possibile esaminare documenti esistenti, ad esempio documenti tecnici e progetti di rete, per determinare come dovrebbe essere l'ambiente. Queste informazioni rappresentano un'ottima sovrapposizione ad altri tipi di identificazione delle risorse.© 2021 Robert M. Lee 23 Scansione attiva
 Le diverse metodologie di scansione attiva disponibili vanno da estremamente pericolose a non così rischiose a seconda dell'ambiente e degli approcci adottati. Sebbene sia la forma più rischiosa di identificazione delle risorse, può fornire le funzionalità di identificazione delle risorse più rapide e in molti casi otterrà più informazioni dalla risorsa per l'inventario. Tuttavia, poiché non disponiamo della topologia o del modo in cui avvengono effettivamente le comunicazioni, è possibile limitarle per motivi di sicurezza.
 24 © 2021 Robert M. Lee
 Per corteggiare oo © oo wow ww HS
 ip
 ww
 ww noi noi FF FSF DI SF BS BS GS WS WwW
 ov
 Ispezione fisica

* Forma più lenta di identificazione delle risorse ma importante per i dispositivi non collegati in rete e per correggere ciò che è logicamente presente attraverso altri metodi
 Importante per i sistemi dual homed, i controller con più schede e I/O e l'identificazione delle opportunità di raccolta (ad esempio, tracciamento del cavo fino agli switch)

* Le apparecchiature non collegate in rete, come le misure di sicurezza/protezione, possono fornire importanti informazioni su come affrontare il rischio informatico
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Prima di iniziare a tracciare la fibra o ispezionare fisicamente i dispositivi, assicurati che l'ambiente sia sicuro e che il personale che opera nell'area sappia della tua presenza. Provare a identificare i punti caldi come armadi di smistamento, apparecchiature, rack I/O e pannelli di distribuzione. Spesso esiste una sovrapposizione tra dispositivi in ​​configurazioni a rete e a stella, quindi identificare i punti centrali (come un router principale) e tracciare la fibra in modo gerarchico può aiutare a identificare i dispositivi. Contrassegnare un dispositivo dopo averlo ispezionato può essere utile, ma è probabile che distragga anche nell'ambiente di rete. Quindi conserva una buona documentazione utilizzando cose come i numeri di serie dei dispositivi.
 Riferimento immagine: https://www.researchgate.net/figure/Electric-control-cabinet_fig]_323150366

© 2021 Robert M. Lee 25 Analisi della configurazione
 Guke &

* Le configurazioni possono indicare come il sistema o la rete è progettata per funzionare. Le tabelle ARP identificano i dispositivi registrati. I firewall identificano i percorsi e i dispositivi consentiti. I controller identificano quali porte, protocolli, comandi e logica sono standard.
 I documenti di ingegneria e di rete possono identificare il layout fisico o logico

* Utile per conoscere l'intenzione della configurazione e del design ma limitato nell'identificare la realtà di come viene utilizzato
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Tabelle ARP
 Le tabelle ARP riveleranno gli accoppiamenti MAC e IP sulla rete. La raccolta di file di configurazione dai dispositivi in ​​rete, in particolare punti centrali come un router o uno switch, identificherà rapidamente i dispositivi registrati sulla rete, inclusi i dispositivi non autorizzati e gli sniffer passivi. Tuttavia, gli switch non gestiti non avranno tabelle ARP a cui è possibile accedere. Gli switch non gestiti mantengono comunque le tabelle ARP (solo gli hub e i ripetitori no) ma poiché non è possibile accedere al dispositivo, non è possibile raccogliere questi dati. Una buona metodologia consiste nell'identificare gli switch gestiti nella rete (sarà necessario farlo per raccogliere comunque passivamente il traffico da essi in seguito) ed esportare le tabelle ARP. Se sei locale, puoi esportare i file e visualizzarli in seguito. Se stai visualizzando le tabelle ARP da remoto, i file possono essere utilizzati in seguito, ma probabilmente è altrettanto utile visualizzarli e documentarli sul posto. Ciò contribuirà a ridurre gli errori poiché avrai il file originale da esaminare davanti a te.
 I fornitori possono avere comandi diversi per esportare o visualizzare la tabella ARP. Ad esempio, sugli switch Cisco, accederai allo switch e sulla riga di comando eseguirai il comando show arp per visualizzare la tabella ARP. Su un dispositivo Windows, accedi e quindi dalla riga di comando esegui il comando arp ~a. Si noti che il processo stesso è lo stesso. Accedi, esegui un comando specifico e visualizza la tabella arp. Dovresti documentare ciò che vedi ed esportare il file. Conservare copie dei file ti consentirà di conservare la documentazione storica e di verificare se ci sono stati cambiamenti nel tempo. Tuttavia, assicurati di archiviare questi file in modo sicuro (ovvero crittografati e protetti da password). Se su un computer sono presenti file di configurazione, elenchi di risorse e mappe di rete, è un tesoro da trovare per gli avversari. Non lasciare che copino i tuoi compiti.
 Molti PLC connessi tramite IP inviano solo una richiesta ARP al momento dell'avvio iniziale. Ciò significa che vedi il dispositivo registrato sullo switch con il suo indirizzo IP e MAC, ma non puoi osservare traffico ARP aggiuntivo nelle acquisizioni in tempo reale dei dati di rete. Cioè, se esegui Wireshark, non sorprenderti se molti dei tuoi PLC connessi tramite IP non inviano traffico ARP.
 Valore: Trova indirizzi IP associati agli indirizzi hardware Identifica i dispositivi passivi (potenziali sniffer) sulla rete 26 © 2021 Robert M.Lee
 26
 ovo ovo e wt ve oe
 wo
 ooo wo w wo w
 oh
 eC

@e ww we wow noi di Qe ww
 w
 SE SF ae ae fw
 oo 8 § %§%§ S&F FS WS WwW

“pe
 Fonte:
 Switch gestiti, router o singoli client Windows/Linux Metodologia:
 Switch, router e client hanno comandi simili ma specifici del fornitore
 Visualizza le tabelle ARP sul dispositivo o esporta il file per visualizzarlo successivamente
 Documentare gli asset osservati e conservare la documentazione storica per verificare e validare le modifiche nel tempo L’“I.C.S.” Aspetto:
 Molti dispositivi di controllo possono eseguire l'ARP solo quando vengono inizialmente accesi
 Quando i sistemi vengono riavviati o vengono completati i periodi di manutenzione, raccogliere le acquisizioni per raccogliere gli ARP
 Configurazioni del firewall
 Le configurazioni del firewall mostrano quali percorsi e porte sono aperti o filtrati sulla rete. Quando gli avversari si spostano nella rete, se non dispongono già di un accesso privilegiato, spesso raccolgono informazioni sul traffico di rete attraverso mezzi passivi o attivi. Molti di noi sanno che un firewall può aiutare a tenere lontani gli aggressori negando loro l’accesso a specifici intervalli IP e sottoreti, nonché a porte e servizi. Tuttavia, un firewall può anche influenzare la visione della rete da parte dell'avversario. Una volta completate le scansioni e la raccolta delle informazioni degli aggressori, non vedranno tutto il traffico e i dispositivi dietro un firewall adeguatamente configurato. Poiché l'aggressore non saprà dell'esistenza di tali dispositivi, probabilmente non sarà il primo a essere colpito. Comprendere la topologia della rete non è utile solo per l'identificazione delle risorse e della rete, ma è anche utile per capire come pensare come l'avversario e identificare i punti chiave che potrebbero essere colpiti per primi.
 Tutti i firewall dispongono di file di configurazione e saranno accessibili tramite la riga di comando o una finestra di gestione remota. Determinare il tipo di firewall e cercare fornitore e manuali utente o Google (non utilizziamo Bing in questa classe) per il modo corretto di accedere ed esportare i file di configurazione. Le configurazioni di un sistema Linux possono essere visualizzate eseguendo iptables --L dalla riga di comando. Un firewall Windows può essere visualizzato eseguendo il comando netsh advfirewall firewall. La maggior parte dei firewall di fascia alta dispone di funzionalità di gestione remota in cui il semplice accesso all'interfaccia di gestione dei firewall rivela le opzioni per visualizzare e scaricare i file di configurazione. Inoltre, sono disponibili script di Windows PowerShell (una volta acquisite le nozioni di base) per molti tipi diversi di firewall per accelerare e automatizzare il processo di esportazione dei file di configurazione. L'esportazione delle configurazioni del firewall non ti consentirà di visualizzarle su qualsiasi sistema. È necessario disporre di apparecchiature di prova per visualizzare i file di configurazione o avere dimestichezza con l'analisi in Excel (molte regole di policy e file di configurazione consentono la visualizzazione di Exce!) oppure disporre di un prodotto a pagamento che esamini i file di configurazione supportati (come Firewall di Solar Wind Security Manager che può visualizzare file di configurazione di diversi fornitori e apportare modifiche secondo necessità.)
 Dopo aver visualizzato le configurazioni del firewall, assicurati di documentare i percorsi e le porte nel tuo ambiente e se sono filtrati o aperti. Concentrati sull'evidenziare le rotte e i porti aperti e poi annota sulla mappa della rete che tutto il resto è filtrato o chiuso. È utile non solo sapere quali indirizzi IP esistono sulla tua rete ma anche con quali porte sono attualmente configurati perché ciò aiuta a identificare il tipo di servizi che stanno eseguendo. Ad esempio, è probabile che un dispositivo connesso tramite IP con la porta 502 aperta esegua Modbus TCP.
 Valore: determinare percorsi e porte aperti o filtrati sulla rete Origine: file di configurazione del firewall Finestra di gestione remota Metodologia: identificare il tipo di firewall Ricerca di fornitori o manuali utente per i metodi di accesso ai file di configurazione Esaminare e documentare porte, servizi e percorsi esistenti L’“I.C.S.” Aspetto: L'accesso remoto è comune in un sistema I.C.S. e potrebbero essere usate raramente Non chiudere le porte senza comprenderle appieno o senza chiedere a tutte le parti coinvolte Monitorare le porte inutilizzate e impostare avvisi per un po' prima della chiusura
 Riferimento immagine: https://www.edrawmax.com/pid/

© 2021 Robert M. Lee 27 Analisi del traffico
 Analisi passiva del traffico di rete ed estrazione di informazioni dai record di comunicazione come l'analisi del protocollo
 Crea un inventario oltre ad essere fondamentale per creare una topologia della rete
 Essenziale per il rilevamento delle minacce e l'analisi delle cause principali di guasti/errori Il metodo più sicuro/veloce per ottenere il quadro più completo

[EER AE
 promainnncmnmiy Ethernet: 16
 Indirizzo w pacchetti Byt Vmware _66:eb:86
 AsixElec_8f:0a:a0 RsAutoma_03:8c:5¢ Rockwell_a0:a9:50
| Vmware_2e:92:98 PhoenixC_96:08:46 PhoenixC_96:80:07 PhoenixC_96:80:08 PhoenixC_b3:1f:ab LLDP_Mutticast 1¢:1b:0d:01:16:3e Siemens-_95:af:e1 Siemens-_95:af :e2 iPv6mcast_00:01:00:02 Trasmissione
 I.C.S.515 | I.C.S.Visibilità, rilevamento e risposta
 28
 DD@® oe oe
 w@®
 wo

™
 L'analisi del traffico, nota anche come scansione passiva, è un modo veloce e sicuro per analizzare le comunicazioni sulla rete. Ancora più importante, invece di fornirti semplicemente un inventario, ti aiuta a identificare come i sistemi comunicano e ti consente di analizzare i loro protocolli/comunicazioni/ecc. non solo per ulteriori informazioni sulle risorse ma anche per casi d'uso di rilevamento delle minacce. Si tratta di una parte essenziale dell'analisi dei sistemi, in particolare per l'analisi delle cause profonde, indipendentemente dal fatto che si tratti di un guasto

@
 o il problema deriva da una minaccia o da problemi di manutenzione.
 28

© 2021 Robert M. Lee
 oe @ 1D @ 7 o ® @ nD
 o
>>
 wo we wo we See ee Oe we eS we I SS
 Scansione attiva

* Interrogare un dispositivo con comunicazioni di rete per richiedere informazioni Può essere fatto male (scansione casuale dei dispositivi) e bene
(utilizzando le comunicazioni native
 e previsto I.C.S. protocolli) Aiuta a creare un inventario ma non il modo in cui i dispositivi comunicano
 In qualsiasi forma rappresenta comunque un rischio per il dispositivo e le operazioni, è meglio utilizzarlo nei periodi di manutenzione o nei laboratori
 I.C.S.S15 | I.C.S. Visibilità, rilevamento e risposta
 Sebbene l'analisi del traffico (o scansione passiva) possa estrarre gran parte delle stesse informazioni trovate nella scansione attiva, deve comunque attraversare la rete per rendere possibili tali informazioni. 'questo può richiedere tempo e, in alcuni casi, potrebbe non accadere mai. La scansione attiva può sollecitare tali informazioni direttamente e su richiesta, rendendolo un metodo preferito quando è richiesto quel livello di informazioni. Tuttavia, sia che tu stia eseguendo una scansione in modo approssimativo (scansione nmap casuale su cose che non comprendi appieno) o utilizzando metodi o strumenti più professionali per sollecitare le informazioni con mezzi noti al dispositivo come I.C.S. protocolli, c’è assolutamente un rischio. Per qualche ragione, esiste un dibattito su questo argomento nella comunità, ma regolarmente gli studenti I.C.S.515 condividono storie sull'utilizzo anche di sistemi I.C.S. appositamente sviluppati. strumenti in modalità di scansione attiva e controller che si bloccano. Ci sono molte ragioni per cui ciò può accadere. A volte il dispositivo è in grado di gestire la comunicazione, ma solo una certa quantità di record di comunicazione. Ad esempio, un PLC specifico potrebbe essere in grado di avere solo 10 sessioni in un dato momento e un 11" legittimo causerà l'eliminazione di una sessione precedente, il che potrebbe rappresentare una comunicazione critica. Inoltre, devi già comprendere a fondo il tuo inventario per utilizzare questo tipo di metodo, che per certi versi può inficiare la necessità in primo luogo.
 Nella mia esperienza ho risposto a numerosi guasti di impianti nonché a interruzioni evidenti e costose dovute alla scansione attiva, anche con sistemi I.C.S appositamente costruiti. utensili. Di conseguenza, la fiducia tra IT e operazioni viene immediatamente distrutta per anni. Inoltre, se qualcosa va storto, anche se non si tratta del tuo strumento specializzato, quando l’impianto scatta o si verifica un guasto sulla rete, è probabile che lo strumento di scansione attivo sia il primo ad essere incolpato.
 Il mio consiglio è di sfruttare gli strumenti di scansione attivi non in modalità continua o in uno strumento distribuito in modo permanente, ma piuttosto come strumento di valutazione. Sfruttalo in un ambiente di laboratorio e poi in produzione con la supervisione delle operazioni durante i tempi di inattività, come un periodo di manutenzione. Inoltre, assicurati che ci sia uno scopo nella scansione, ovvero non farlo solo per comprendere una vulnerabilità per la quale comunque non farai nulla. Esiste un rischio, anche se piccolo, per qualsiasi tipo di azione intrapresa in un I.C.S., e deve avere un valore adeguato come rendimento per giustificare le azioni.
 Riferimento immagine: https://github.com/mushorg/conpot/issues/373

© 2021 Robert M. Lee 29
 29
 e” Sistemi di Sicurezza

° Sistemi di Sicurezza Attiva
* Richiede feedback o input elettronici
* Può essere un sistema di controllo come un PLC
* Spesso “prende il controllo” a un punto prestabilito
° Sistemi di Sicurezza Passiva
¢ Non richiede feedback elettronico
¢ Spesso integrato nel sistema complessivo
* In alcuni casi garantisce uno scenario di “fail-safe” come in un reattore nucleare
* I sistemi di sicurezza dovrebbero essere sistemi autonomi non collegati alla rete quando possibile
*L'identificazione dei sistemi di sicurezza collegati in rete rappresenta una scoperta e una discrepanza importanti, a meno che non sia assolutamente necessaria
 - * I controlli fisici non sono spesso dettagliati in un inventario delle risorse, ma è importante comprenderli
 Rif: Sistema Westinghouse AP1000
 I.C.S.S515 | I.C.S. Visibilità, rilevamento e risposta — 30
 I sistemi di sicurezza come il Safety Instrumented System (SIS) sono regolati nella loro progettazione da ISA 84.01/IEC61511 e nella loro funzione da IEC 61508. Esistono anche versioni aggiuntive come IEC 61513 per settori specifici (come quello nucleare). Questi standard sono solidi nel modo in cui i sistemi sono progettati e gestiti, considerando un'ampia varietà di problemi che un ingegnere non può prevedere. Sono progettati per garantire la sicurezza indipendentemente dalla causa dell’incidente, che si tratti di un terremoto o di un attacco informatico.
 Il motivo per cui è importante comprendere questi sistemi è perché ci sono aspetti dell’I.C.S. lavorare contro gli obiettivi di un attaccante.Se l'aggressore vuole arrecare danni fisici ed è presente un sistema di sicurezza, dovrà aggirarlo. Questo è più facile a dirsi che a farsi. I buoni sistemi di sicurezza sono progettati nel sistema e sono il sottoprodotto dell'ingegneria. Un sistema di sicurezza “attivo” è un sistema in grado di prendere decisioni in base a un setpoint. Consideriamo un PLC che governa un altro aspetto del processo; prende il controllo quando viene raggiunto un set point. Un sistema di sicurezza “passivo” sarebbe un aspetto del sistema coinvolto indipendentemente dalle decisioni logiche e senza feedback elettrico. Un esempio di sistema di sicurezza passivo sarebbe in un reattore nucleare dove si formano sacche di vapore che rallentano la reazione, provocando così un abbassamento del livello di potenza e della temperatura. Questo è un aspetto di come è progettato il sistema: "fail safe" indipendentemente dal feedback elettronico o dalle scelte dell'operatore. Molti sistemi di sicurezza passiva necessitano però che l'operatore faccia una scelta ad un certo punto, spesso ore o giorni dopo l'incidente.
 Un buon esempio di sistema di sicurezza passiva nelle centrali nucleari è il sistema nucleare AP1000 di Westinghouse. Questo è anche il luogo da cui proviene l'immagine:
 http://www.westinghousenuclear.com/New-Plants/AP1000-PWR/Safety/Passive-Safety-Systems
 Dal sito Westinghouse:
 I sistemi di sicurezza passiva dell’impianto AP1000 includono: Sistema di raffreddamento passivo del nucleo (PXS)
 Isolamento di contenimento
 30 © 2021 Robert M. Lee
 WM WS MW
 vr wT TF TP TT HT WP HP PW

. © & Sistema di raffreddamento a contenimento passivo (PCS)
 Sistema di abitabilità di emergenza della sala di controllo principale
 Iniezione di sicurezza ad alta pressione con serbatoi di reintegro (CMT) Iniezione di sicurezza a media pressione con accumulatori
 Refrigerante del reattore a bassa pressione prodotto dall'IRWST
 Rimozione passiva del calore residuo
 Sistema di depressurizzazione automatica

© 2021 Robert M. Lee
 31 Caso di studio: distribuzione dell'acqua

° La distribuzione dell'acqua spesso contiene
 zone di servizio
* I serbatoi rialzati immagazzinano l'acqua
¢ La pressione dell'acqua è calcolabile con l'altitudine
* Una pressione eccessiva sarebbe dannosa

° Sistema di sicurezza attiva:

+ La valvola di altitudine interrompe il flusso al serbatoio dopo il raggiungimento di un setpoint
* Spesso controllato e impostato localmente
« Sistema di sicurezza passiva:
* Dischi di rottura progettati per rompersi ad una pressione predeterminata

* Per vedere tutto sarebbe necessaria una combinazione dei diversi tipi di rilevamento delle risorse
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 2
 Per comprendere i sistemi di sicurezza attivi e passivi, considerare un sistema di distribuzione dell'acqua. A destra vediamo un HMI per il sistema di distribuzione dell'acqua. Descrive in dettaglio i serbatoi dell'acqua, le torri e vari componenti come le valvole che regolano il flusso dell'acqua. Se un aggressore o un difensore entrasse nella rete, l'HMI rivelerebbe molto sul sistema. Anche la scoperta di risorse connesse tramite protocolli IP aiuterebbe a imparare molto sul sistema. Tuttavia i sistemi di sicurezza sono dettagliati nei disegni tecnici e non nel traffico di rete. Ad esempio, ciascuna torre dell'acqua ha spesso un manometro sulla parte superiore e inferiore (sotterranea) della torre per determinare la pressione e quindi l'elevazione dell'acqua. Un sistema di sicurezza attivo sarebbe un sistema (forse un PLC ma forse un sistema di controllo fisico) che ha un punto fisso per la quantità consentita di acqua nel serbatoio. Questa è chiamata valvola di altitudine. Se il serbatoio supera il setpoint, la valvola di altitudine si chiuderà, garantendo che non fluisca più acqua nel serbatoio. Queste valvole sono spesso impostate localmente. Non è richiesto alcun controllo remoto o connettività.
 Un sistema di sicurezza passivo sarebbe qualcosa come un disco di rottura o di scoppio. Questi tipi di componenti aiutano il sistema a fallire nei punti progettati. Invece di consentire a uno scenario di sovrapressione di danneggiare la torre dell'acqua o le case delle persone, il disco di rottura è valutato a una pressione inferiore a quella della tubazione in modo che, se si verifica un'ondata pericolosa, il disco scoppierà per contribuire a ridurre la pressione dell'acqua in quel tubo. . Un altro esempio potrebbe essere un serbatoio di compensazione che consente all'acqua extra di fluire al suo interno.
 Tutto questo è stato dettagliato magistralmente da Patrick Coyle nel blog SANS a cui si fa riferimento di seguito (con raccomandazioni per rilevarlo sia dal lato SCADA che dal lato dello staff OT).
 Riferimento immagine: SystemVIEW da Intellisyssoftware.com
 Riferimento:
 https://ics.sans.org/blog/20 1 6/04/12/ics-cross-industry-learning-water-distribution-systems-and-how-to-earn-trust-of-operatives
 32 © 2021 Robert M. Lee
 7-7 2 2 vie wa a 'wy
 w è

“sp ap ap “ps “» “ ww > Ad ws w w w ws ~@ we ww
 Costruire una struttura per la gestione delle collezioni

* Non è sufficiente sapere cosa hai a disposizione per molti casi d'uso
*Quali dati producono gli asset?
*Dove vengono archiviati i dati?
*Per quanto tempo conservo i dati?

* Senza pensare ai casi d'uso, agli scenari di minaccia o agli scenari di risposta agli incidenti che desideri supportare, potresti non avere mai la giusta visibilità e raccolta nel tuo ambiente
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Ci sono molte ragioni per cui un inventario delle risorse può essere utile. Gli operatori e gli ingegneri vorranno queste informazioni per inventario, sostituzioni, componenti, ecc.La sicurezza, così come le operazioni, potrebbero volere che queste informazioni eliminino configurazioni errate o risolvano problemi nell'ambiente. E se intendi eseguire qualsiasi livello di rilevamento delle minacce o risposta agli incidenti, dovrai sapere di cosa hai.
 Ma sapere cosa hai da solo non è sufficiente. Sta diventando sempre più comune per le organizzazioni desiderarlo
"visibilità." Ma se non sai che tipo di scenari di risposta vuoi gestire, quali requisiti/casi d'uso hai come tipi specifici di TTP/tradecraft, o per quale tipo di scenari vuoi prepararti, potresti non inserire il giusto tipo di visibilità.
 Ad esempio, la scansione attiva (sondaggio, carezza gentile o qualunque nome le persone vogliano dare interrogando attivamente le informazioni da un sistema di controllo) non è realmente utile per gli scenari di rilevamento e risposta alle minacce. La scansione attiva, tuttavia, può essere utile per altri scopi come identificare le vulnerabilità in un prodotto; dato ciò che sappiamo sullo stato delle vulnerabilità, è necessario discutere dei compromessi e dei rischi. Ci sono pochissime cose che “non puoi fare” nel mondo di I.C.S. sicurezza. Ma le cose che stai facendo valgono il rischio e l’investimento è la vera domanda. La scansione attiva, come in questo esempio, ha assolutamente causato interruzioni e problemi agli impianti in tutto il mondo. Più volte all'anno questi casi emergono. Ma se questo rischio vale la pena per la tua organizzazione, allora non c’è niente di sbagliato in questo.
 In ogni caso, devo sapere cosa voglio collezionare e per cosa usarlo. Inoltre, non vogliamo trovarci in una situazione in cui adottiamo una strategia del tipo “raccogli tutto”; alla fine, hai così tanta raccolta che affoghi nei dati e tu e i tuoi analisti non sapete mai cosa stanno cercando e non siete abbastanza concentrati per trovarlo. È qui che entra in gioco il concetto di framework per la gestione delle collezioni.
 Un framework di gestione delle raccolte è la comprensione di ciò che hai, del tipo di dati che puoi ottenere dalle tue risorse, di dove li archivi e per quanto tempo li conservi. Puoi anche includere altre informazioni, ad esempio a quali tipi di domande i dati possono rispondere per te o scenari in cui li hai utilizzati in passato, in modo da poter creare playbook ripetibili o persino segmentare le cose per unità aziendali o scopi funzionali.

© 2021 Robert M. Lee 33
 33
 Quando possibile, disporre di un framework di gestione delle collezioni (CMF) è un investimento migliore rispetto al semplice avere un inventario delle risorse.
 L'articolo sui Collection Management Frameworks è stato scritto da Robert M. Lee, Mark Stacey e Ben Miller e può essere trovato qui: https://dragos.com/wp-content/uploads/CMF_For_I.C.S..pdf
 34 © 2021 Robert M. Lee
 wi
 o_o. Noi @&
 oD

' 7] 2 @

=
‘ey =» ea

'/_
 io' /-_
 sì
 A Se oS. a - cioè una ed

<s
 Esempio di gestione delle collezioni p
 Rete Windows Unità terminali umane remote Windows Interfaccia della macchina di monitoraggio dello storico dei dati umani
 Apparecchio macchina
 interfaccia
 Allarmi eventi di Windows Avvisi Registri eventi di Windows Registri Syslog
 Esplorazione, Azioni sullo sfruttamento interno, Installazione, Installazione, Azioni sull'installazione, Obiettivi Ricognizione, Azioni sugli Obiettivi Obiettivi } Azioni sul Comando e Obiettivi Controllo, Consegna,
 Azioni su
 Obiettivi
 Punti di impostazione delle chiavi di registro e acquisizione dei pacchetti Tag logici del controller delle chiavi di registro |
 Enterprise SIEM Local Enterprise SIEM Local Locale
 60 giorni 420 giorni 30 giorni 30 giorni 7 giorni
 1 CS $ 515 | I.C.S. Visibilità, rilevamento e risposta
 Qui, dal documento Dragos Collection Management Framework (CMF), vediamo parte di un CMF per una società di rete di trasmissione elettrica. In alto abbiamo identificato il sito o il luogo che stiamo guardando, come Centro di controllo o Sottostazione di trasmissione. Se dovessi andare lì per eseguire il rilevamento o la risposta alle minacce, una delle prime domande che avrai sarà: "cosa ho a disposizione in termini di dati?" Il CMF cerca di risolvere questo problema, in modo che tu sappia quale copertura puoi avere con qualsiasi diverso tipo di rilevamento delle minacce distribuito (dove posso vedere le minacce?) e tu sappia cosa sarà a tua disposizione negli scenari di risposta.
 Sotto ciascun sito, puoi dettagliare le diverse risorse che possiedi, i dati in loro possesso, l'archiviazione e il tempo di archiviazione. Qui, al CMF sono state aggiunte anche altre opzioni, come Segui sulla raccolta (se voglio passare a più dati dopo aver analizzato questi dati, sulla stessa risorsa, su cosa posso fare pivot?) e Tipo di domanda (che tipo di domande sulla kill chain che questi dati possono supportare?).
 Ad esempio, nel Centro di controllo disponiamo di un HMI Windows con registri eventi di Windows archiviati per 60 giorni nel SIEM aziendale. Se ho bisogno di estrarre più dati, posso ottenere le chiavi di registro. Dispongo anche di uno storico dei dati con allarmi archiviati localmente disponibili per 120 giorni. Poiché non sono nel SIEM, non potrò utilizzarli per il rilevamento delle minacce in modo nativo; ma in caso di incidente, ho 120 giorni di allarmi che possono aiutarmi a capire cosa sta succedendo nell'ambiente fisico.Ata colpo d'occhio, | può anche sovrapporsi ai tradecrafi/TTP delle minacce che mi preoccupano e rispondere alla domanda “se venissimo attaccati saremmo in grado di rilevare e rispondere a queste minacce?”. Ad esempio, supponiamo di avere una minaccia che esegue uno scenario di dirottamento SCADA in cui ruota attraverso l'Enterprise e compromette il Centro di controllo per aprire gli interruttori nella sottostazione di trasmissione. Esistono molti modi per scrivere rilevamenti per questo comportamento, ma probabilmente è meglio farlo con l'acquisizione di pacchetti (movimento laterale tra i sistemi e i comandi inviati alla sottostazione di trasmissione) e qualsiasi connettività di cui disponiamo dall'azienda al centro di controllo (come i registri VPN o registri del firewall). Tuttavia, i nostri dati si concentrano solo su host e allarmi. Non avremmo successo. Dobbiamo adattare la nostra collezione per supportare i casi d'uso che abbiamo.
 Come altro esempio, è bene sapere che nella sottostazione di trasmissione, i miei dati sono tutti locali (posso spazzare gli indicatori o cercare TTP tutti | voglio, ma ho visibilità 0 nella sottostazione di trasmissione, quindi 1 non vedrebbe

© 2021 Robert M. Lee 35
 35
 qualsiasi cosa lì), e risale solo a 30 giorni fa. Quindi, se cerco minacce basate sull’attività svolta prima di allora, non avrò successo.
 Per le organizzazioni più grandi, non è efficiente mappare ogni sito fisico e comprenderne la collezione unica. Invece, potremmo suddividere i nostri siti in classificazioni diverse. Ad esempio, potremmo dire siti di classe A, B e C. I siti di prima classe sono quelli che l'azienda e le operazioni ritengono più critici. I siti B sono alquanto critici. E i siti C, sebbene importanti, non riescono a tagliare il traguardo. In un centro di controllo di classe A o in una sottostazione di trasmissione di classe A, potremmo impostare un profilo su nove che ci aspettiamo 60 giorni di registri host archiviati centralmente, il nostro I.C.S. prodotto preferito per il monitoraggio della rete con log archiviati centralmente per 60 giorni, log Historian per 120 giorni archiviati centralmente e log VPN archiviati centralmente per 60 giorni. I siti possono fare di più e superare i tempi di archiviazione, ma devono avere quel livello di raccolta come profilo. Forse nei miei siti di classe B ho solo i registri del firewall per 30 giorni archiviati centralmente e un sistema I.C.S. soluzione di monitoraggio della rete con log archiviati centralmente per 30 giorni. E nei siti di classe C è tutto il resto (non devo nemmeno creare un profilo, altrimenti posso avere un livello molto basso).
 In questo modo, quando scriviamo rilevamenti o elaboriamo piani di risposta agli incidenti, sappiamo come prepararci per i diversi siti e qual è la copertura del rilevamento delle minacce nel nostro ambiente in base ai diversi tipi di dati richiesti per tali rilevamenti. Ci fornisce inoltre parametri e approfondimenti potenti non solo per i nostri scopi, ma per mostrare un ritorno sull'investimento per i nostri sforzi. Ad esempio, sarebbe utile tenere traccia della percentuale dei tuoi siti che sono siti di classe A, B e C ed essere in grado di dimostrare che, nel tempo, stiamo spostando più siti di classe C in un profilo di classe B e più siti di classe B in un profilo di classe A o anche aggiungendo tutti i nuovi scenari di minaccia e di risposta nella categoria di classe A e investendo per offrire una migliore copertura all'organizzazione.
 Tutto ciò può essere monitorato facilmente in Excel o in strumenti come Confluence e non necessita di software specializzato.
 36 © 2021 Robert M. Lee
 wv

?.
 sì”? @

= vw wow vb wes we oe wo ee eo ew
 eee es' Se ve we we ww
 Processi, Minaccia I
 Modellazione
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Non esiste un modo per costruire o modellare un CMF. Tuttavia, questo è un approccio utile per creare e mantenere un CMF per i propri scopi e necessità.
 Il processo è semplice e verrà esplorato in modo approfondito nelle prossime diapositive:

- Sviluppare nuovi requisiti (per cosa vogliamo innanzitutto il CMF? Quali sono i nostri rischi? Qual è il problema che stiamo risolvendo?)

- Sviluppare un piano di raccolta (costruire il CMF utilizzando ciò che sappiamo e abbiamo documentato o già compreso)

- Implementare (capire i processi e le procedure che sfrutteremo per utilizzare il CMF per soddisfare il requisito)

- Testare (assicurarsi che la nostra collezione sia ciò che pensavamo fosse e che i nostri processi/procedure funzionino con questa collezione)

- Aggiorna il piano di raccolta (aggiorna il CMF in seguito ai nostri test o prendi nota dei nuovi requisiti di cui abbiamo bisogno)
 Seguendo questi semplici passaggi puoi rapidamente arrivare a una migliore comprensione di ciò che fai e non sai nel tuo ambiente e sfruttarlo per i tuoi casi d'uso.

© 2021 Roberto M.Lee 37 Sviluppare nuovi requisiti

¢ I requisiti aiutano a concentrare gli sforzi di raccolta su un bisogno

¢ I requisiti provengono da diverse fonti:
¢ TIX: per quali scenari l'azienda vuole essere preparata?
* Analisi dei gioielli della corona: quali sono le risorse più importanti?
* Gestione del rischio: quali sono i rischi che devono essere mitigati?
* Modellazione delle minacce: cosa stanno effettivamente facendo gli avversari che sono rilevanti per noi?
* Trigger: nuovi eventi che guidano la raccolta, come la caccia alle minacce o gli incidenti

» Esempio di requisito:
* Rileva e rispondi alle compromissioni del sistema di sicurezza presso la raffineria di Calistoga
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Nella fase Sviluppa nuovi requisiti, stai cercando di identificare i requisiti che ti aiutano a concentrare i tuoi sforzi di raccolta. Troppo spesso gli analisti adottano l’approccio del “raccogliere tutto”. In alcuni I.C.S. luoghi, questo può essere incredibilmente oneroso, se non impossibile da realizzare. Ad esempio, una piattaforma petrolifera offshore non disporrà della larghezza di banda sui suoi metodi di connettività per riportare ogni registro e ogni fonte di dati a un centro operativo di sicurezza. Devi essere più mirato. Ancora più importante, se avessi effettivamente tutti i dati probabilmente affogheresti nei dati. Gli analisti stanno meglio quando determinano i loro requisiti e poi espandono la loro raccolta a ciò di cui hanno bisogno per soddisfare tali requisiti.
 Esistono molti modi per determinare i requisiti. Uno dei modi migliori è iniziare con pratiche di gestione del rischio di ciò che la tua organizzazione ha già dichiarato di essere preoccupata, analisi Crown Jewels su ciò che è più importante per l'azienda o con la modellazione delle minacce per determinare il tipo di minacce che vuoi essere preparato per. Probabilmente proverai uno o più di questi in un esercizio da tavolo (TTX) in cui includi personale di tutta l'organizzazione ed esegui una prova degli scenari che ti interessano. Ciò dovrebbe portare a domande ovvie come: saremmo in grado di determinare se quell’evento si è verificato con i nostri attuali sforzi di raccolta?
 Ad esempio, nella nostra raffineria di Calistoga potremmo essere pronti a rilevare e rispondere a una compromissione del sistema di sicurezza da parte di un avversario.
 38 © 2021 Robert M. Lee
 www wwfww
 w
 w wm w w wre ww ww ww wh
 Ww
 ow, scrivilo
 7D ahi

’ ve FS wwe ww ww © ww we © © © w w@&
 vw vw
 New York
 sviluppare una collezione P

* Determina quali origini dati ti occorrono per soddisfare i requisiti sfruttando le competenze del settore, la consapevolezza situazionale e/o le informazioni
* Documenta ciò che sai di avere in base alle conoscenze esistenti

= Raffineria di Calistoge Raffineria di Calistoga Raffineria di Calistoga' Raffineria di Calistoge
 Tipo di risorsa Sistema di sicurezza Triconex | Stazione di lavoro di ingegneria| Dispositivo di rete del controller di dominio Dispositivo di rete
 Tipo di dati Syslog Eventi host Windows _| Eventi host Windows _| Acquisizione dei pacchetti di analisi del traffico di rete
 Posizione di archiviazione dei dati SIEM aziendale locale SIEM aziendale. Apparecchio di rete Apparecchio di rete
 Tempo di archiviazione dei dati a 7 giorni 90 giorni 90 giorni 6 mesi 7 giorni e su richiesta
 I.C.S.SI5 | I.C.S. Visibilità, rilevamento e risposta 3
 Per soddisfare i nostri requisiti, in questo caso relativi al sistema di sicurezza della raffineria di Calistoga, dovremmo capire di quali fonti di dati disponiamo. Qui puoi adattare i campi CMF alle tue esigenze, ma per semplicità esamineremo Tipo di risorsa, Tipo di dati, Posizione di archiviazione dei dati e Tempo di archiviazione dei dati. Possiamo determinare il sistema di sicurezza, ad esempio un sistema di sicurezza Triconex che ha Syslog memorizzato localmente per 7 giorni. Ora sappiamo per quanto tempo dobbiamo cercare una minaccia (in modo proattivo o storico), dove dovremmo cercare e utilizzando quali tipi di rilevamenti (in questo caso solo syslog per quel dispositivo). Possiamo anche documentare gli altri sistemi rilevanti per questo requisito, come l'Engineering Workstation, il Domain Controller sulla rete e il fatto che questa rete dispone di un'appliance di rete che monitora il traffico e genera avvisi e approfondimenti.
 Il punto centrale del piano di raccolta è costruire il CMF utilizzando ciò che già sai. Non è ancora necessario

(ma va bene se fatto in parallelo) per esaminare i sistemi e i dati e convalidare ciò che effettivamente hai a tua disposizione.

© 2021 Robert M. Lee 39
* Per implementare un CMF creerai processi, procedure e/o playbook per utilizzare la raccolta per soddisfare i requisiti

° Esempi:
¢ L'indicatore scorre
* Creare un processo per consumare I0C relativi alle minacce che potrebbero compromettere i sistemi di sicurezza per l'ambito reattivo; in questo caso utilizzando i log basati su host nel SIEM e i rilevamenti di rete per l'appliance di rete
* Tattiche, tecniche e procedure
+ Creare rilevamenti più complessi nell'appliance di rete e nel SIEM per cercare comportamenti degli avversari oltre gli indicatori tecnici per il monitoraggio continuo

* Playbook

* Crea playbook per indagare rapidamente sulle origini dati in caso di rilevamento
 I.C.S.515 | I.C.S.Visibilità, rilevamento e risposta 40
 Nella fase di implementazione di questo processo, stai pensando ai requisiti che hai, alla raccolta che hai ora documentato e cercando di determinare come sfruttarla. Ad esempio, potresti scegliere di eseguire scansioni di indicatori per identificare le minacce dopo averle apprese da altre fonti. Non è raro che un analista esegua un indicatore attraverso il proprio strumento preferito, lo restituisca senza risultati e dichiari di non essere compromesso, quando in realtà potrebbe non aver mai avuto i dati in quello strumento per convalidare oppure invalidare la domanda appena posta tramite l'indicatore. Avendo il CMF, sappiamo immediatamente se è possibile trovare i dati che l'indicatore sta cercando, quindi possiamo creare alcuni buoni processi per eseguire controlli degli indicatori con maggiore sicurezza e rispetto al tipo di set di dati che possiamo includere nella ricerca.
 Allo stesso modo potremmo decidere di voler cercare anche tattiche, tecniche e procedure (TTP) che tratteremo più approfonditamente nel materiale della Sezione 3. Infine, potremmo scoprire che possiamo creare un manuale di indagine che cattura passo dopo passo ciò che dobbiamo fare per indagare rapidamente sugli avvisi che riceviamo e sfruttare appieno la raccolta di cui disponiamo.
 Esistono molti altri esempi, tra cui i manuali di risposta agli incidenti e la caccia alle minacce. In definitiva dipende dalle tue esigenze. Se il requisito fosse focalizzato a livello operativo, la procedura potrebbe includere personale operativo e processi per aiutare a identificare cose come dispositivi guasti o problemi operativi per il lavoro di analisi della causa principale quando si verificano incidenti o tempi di inattività.
 40 © 2021 Robert M. Lee
 rT mT TT MW WM WM WH

® w w w w w

.®
 oeeee Ww
 oe &

» bb YU eee euee & ww & ww w Ww
 ahi ©

( Didwehavetis Lae ds , és La raccolta differenziata che pensavamo? _ | ! sfrutta appieno la
| « Il SIEM era solo | _« Ci sono lacune nella configurazione?
 memorizzazione di 30 giorni di logs _ raccolta o processo? ¢ Gli eventi host su
' |» Non tutte le postazioni di lavoro di ingegneria | postazioni di lavoro presso i | arenotcollectingnew Calistoga Refinery ha _ __ registrazione dei processi abilitata: |
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 La fase di test è in realtà incentrata sulla quantificazione e qualificazione della nostra collezione, nonché su ciò che intendevamo fare nella fase di implementazione. Tutto questo fa parte di uno sforzo di convalida più ampio. Guardando ora oltre la documentazione e le conoscenze esistenti, avevi davvero i dati che pensavi di avere? Ci sono lacune nella raccolta o nei processi che ne ostacolano il successo? La qualità dei dati aveva senso? Ad esempio, potresti raccogliere log basati su host ma forse non stai raccogliendo gli eventi basati su host giusti per rispondere al requisito.
 Esistono molti modi per testare. Il primo consiste nell'eseguire gli sforzi nella fase di implementazione, come la valutazione di una notifica o l'esecuzione di un'analisi degli indicatori con qualcosa che sai essere presente (anche qualcosa non dannoso). Un altro modo eccellente è eseguire una caccia alle minacce che è essenzialmente una risposta all’incidente senza l’incidente. Se sei preoccupato per uno scenario di minaccia specifico, come la compromissione di un sistema di sicurezza, eseguire una caccia alla minaccia per quello scenario non solo confermerebbe per te che non sei attualmente compromesso, ma, cosa ancora più importante, rivelerebbe se i dati di cui avresti bisogno per la risposta agli incidenti sia effettivamente presente e assicurati che il tuo CMF soddisfi i tuoi requisiti.

© 2021 Robert M. Lee A
 A
 Aggiorna il piano di raccolta

° Aggiornare le informazioni in base alla fase di Test
* Da 90 giorni a 30 giorni in base SIEM

° Guidare nuove esigenze di raccolta o ottimizzazione in base alle esigenze
* Spostamento del registro di sistema locale e degli avvisi dall'appliance di rete al SIEM
 Tipo di dati del tipo di risorsa
 Posizione di archiviazione dei dati
 Tempo di archiviazione dei dati
 Sistema di sicurezza Triconex

_| Raffineria di Galistoge ©
 Stazione di lavoro di ingegneria
 Controller di dominio
 Raffineria di Colistoga
 Apparecchio di rete

_ Raffineria di Calistoga |
 Apparecchio di rete
 Syslog
 Eventi dell'host Windows
 Eventi dell'host Windows
 Analisi del traffico di rete
 Cattura dei pacchetti
 Locale
 SIEM aziendale
 SIEM aziendale
 Apparecchio di rete
 Apparecchio di rete
 7 giorni
 30 giorni
 30 giorni
 6 mesi
 7 giorni e su richiesta
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Nel piano di raccolta aggiornamenti puoi identificare le lacune nella raccolta da modificare, seguire i requisiti o determinare che è necessario ottimizzare il tuo CMF attuale. Ad esempio, nel nostro scenario stiamo dicendo che l'archiviazione locale dei dati su Triconex non è appropriata e vogliamo portarla nel SIEM. I 90 giorni di conservazione nel SIEM precedentemente compresi al momento della valutazione per l'I.C.S. reti in realtà è durato solo 30 giorni, buono a sapersi ora! E anche i log di Network Appliance sono qualcosa che vogliamo inserire nel SIEM. Ora disponiamo di alcune conoscenze aggiornate e convalidate e di alcune azioni da intraprendere per adattare la nostra raccolta per supportare meglio la capacità di rilevare e rispondere a questo scenario di minaccia.42

© 2021 Robert M. Lee
 42

"o») ww
 spento © OT OM OT TM MW MW WM WM WM wW
 7, 7. ww, ww wm wn ee ew eee be wee eee eee eee ee ee noi
 Ne
 Adattabilità al CMF

¢ I CMF possono essere adattati in qualsiasi modo per soddisfare le vostre esigenze
* Può essere utile collegare profili di configurazione, playbook e altro ancora
 Workstation di ingegneria con configurazione completa completa| _Domein Conteoller_| Apparecchio di rete | _Modifiche alla dissezione della dissezione dell'appliance di rete

. - vt N/D Risorsa completa —_Risorsa limitata Eventi host Windows| Windows Host Evens (Rete Taff Aaahss] pagina su Daecile
 Host standard Host standard

| contguration* Configurazione’ |e Protocollista Protocollo ist* Rilevamento completo Rilevamento completo Priorità Copertura Copertura Rilevamento Copertura
 SIEM aziendale Dispositivo di rete SIEM aziendale | _ Apparecchio di rete
 30 giorni 30 giorni mesi ‘| 7 giorni e su richiesta
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Come notato in precedenza, i CMF sono completamente adattabili alle vostre esigenze. Ecco però un esempio per rendere il concetto più tangibile. Ad esempio, ora è stata aggiunta una riga "Copertura dati" in Tipo di dati. La Copertura dati indica i dettagli sul tipo di dati disponibile. Ad esempio, non ci sono specifiche per Syslog oltre alla registrazione nativa, quindi è N/D. Gli eventi host di Windows possono essere configurati in molti modi per raccogliere diversi ID evento e informazioni, quindi è segnalato che questo sito utilizza la configurazione host standard che verrebbe sviluppata dal team di sicurezza in base ai propri requisiti. Potrebbe trattarsi di un collegamento ipertestuale che si collegherebbe a ciò che è attualmente il pacchetto di raccolta. Allo stesso modo, per l'appliance di rete esiste una Lista Protocolli che rimanda alla copertura dello strumento. Ad esempio, potresti avere alcuni I.C.S. protocolli come ModbusTCp, Pi-Connect e il protocollo Tristation. Il modo in cui compilarli dipende da te, ma in questo caso per semplicità il primo campo sarebbe Nessuna dissezione, Dissezione limitata, Modifiche di configurazione (ad esempio caricamenti, download, ecc.) o Dissezione completa del protocollo. La riga successiva ti dirà se anche la dissezione del protocollo non estrae dettagli sulle risorse, dettagli sulle risorse limitate o dettagli sulle risorse complete. L'ultima riga indica se sono presenti anche rilevamenti di minacce che sfruttano l'ispezione del protocollo con copertura di rilevamento limitata, prioritaria o completa rispetto agli scenari di minaccia e riguardano l'organizzazione. Avere assegnazioni logiche può essere molto più semplice da mantenere rispetto alla determinazione di ogni singolo codice funzione e valore elaborato in un protocollo e ciascuna di queste scelte, come la copertura del rilevamento prioritario, potrebbe collegarsi a una risorsa di conoscenza in cui tale elenco viene mantenuto e si evolve nel tempo.
 Ciò diventerà più tangibile quando discuteremo delle strategie di rilevamento nella Sezione 3.

© 2021 Robert M. Lee 43
 43
 CMF + controlli di sicurezza come profilo di raccolta

« I CMF possono essere utilizzati come requisito del pacchetto di raccolta e abbinati a controlli di sicurezza che forniscono la raccolta come profilo standard in tutta l'organizzazione

« I siti di classe A potrebbero richiedere: Registrazione dell'host su HMI, EWS e Historian integrati nel SIEM che raccoglie eventi ad alta e media priorità e archiviati per 1 anno Appliance di rete per I.C.S. dissezione del protocollo e avvisi integrati con il SIEM e archiviati per 1 anno Dispositivo di autenticazione multi-fattore con log di accesso al SIEM per 1 anno
° I siti di classe B potrebbero richiedere:
* Apparecchio di rete per I.C.S. dissezione del protocollo e avvisi al SIEM per 1 anno
*Appliance Multi-Factor Authentication con log di accesso al SIEM per 1 anno
*I siti di classe C potrebbero richiedere:
¢ Appliance Multi-Factor Authentication con log di accesso al SIEM per 6 mesi
 I.C.S.$15 | I.C.S. Visibilità, rilevamento e risposta
 I CMF possono essere strumenti molto potenti ma, soprattutto nelle organizzazioni di grandi dimensioni con molti siti, può essere noioso pensare di avere un CMF per ogni sito. Invece, puoi sfruttare la combinazione degli sforzi di tipo Crown Jewels Analysis per comprendere i diversi tipi di siti che possiedi. Ad esempio, potresti avere siti a rischio alto, medio e basso denominati anche siti di classe A, classe B o classe C. Potresti averlo anche per diversi tipi di infrastrutture, come un centro di controllo di classe A, B e C rispetto a una sottostazione di trasmissione di classe A, B e C. L'intenzione è quella di semplificare il processo in modo che il CMF rappresenti un profilo di raccolta minimo in quel sito.
 Ad esempio, un sito di Classe A avrà sempre almeno una certa quantità di raccolta, come analisi di rete e avvisi risalenti a 1 anno fa. Se fosse andato sopra | Quest'anno andrebbe bene, ma ora i team di sicurezza e operativi, nonché tutti gli addetti agli interventi di risposta agli incidenti, sanno su cosa possono contare in qualsiasi sito. Abbinando tutto ciò alle tecnologie di sicurezza che dispongono anch'esse di registri che desideri implementare in un determinato sito, puoi creare un profilo di raccolta eccezionale che consente pienamente ai difensori di comprendere ciò che hanno a disposizione in un determinato sito.Non c'è motivo di perdere tempo a rispondere o a indagare sui siti quando sai che non ci sono dati a supporto dell'indagine. Allo stesso modo, sapere quali dati sono disponibili su quali risorse riduce significativamente il tempo e gli sforzi per svolgere il lavoro di sicurezza in tali siti.
 44 © 2021 Robert M. Lee
 va)

">a
 rr wT ww WwW wh wh

@® YD wm nD w
 M
 7 oD wwwm™
 7 A 5b SE Ye Se ewe ee se ww eS 6 wo ww Sw w
 o
 ARG TERR AE SE CG I EEE EGS SY a ES TE a ara Scenario del corso:
 C3PO - Introduzione alle operazioni elettriche
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 45
 45
 Ulk Interconnessioni del sistema elettrico e Stati Uniti
 Interconnessione del Québec
 Interconnessioni; Possiamo essere d'accordo ~~ lì
: non è una singola “Griglia”
 Tul Tet ARIA
 La Russia l’ha attraversata
 Il ministro dell’Energia afferma che gli avversari hanno la capacità di bloccare Nesitere sulla rete elettrica statunitense
 Interconnessione Occidentale + Interconnessione 8: : en
¢
 io io io io
! 1
| La rete elettrica americana ha una porta sul retro vulnerabile... e
' IO
'
&

€ ercor ~~ Circa una volta ogni quattro giorni, parte della rete elettrica nazionale - un sistema il cui

“Interconnessione» .
 un fallimento potrebbe lasciare milioni di persone all’oscuro: viene colpito da un attacco informatico o fisico, rileva un’analisi MMRO MNPCC GRF MSERC [CiTexasRE MWECC USA TODAY dei registri energetici federali.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Quando senti parlare del sistema energetico in Nord America, potresti sentire alcune descrizioni diverse del layout del sistema energetico. In Nord America sono presenti 4 Interconnessioni sincrone Eastern Interconnection, ERCOT
(Texas), Quebec Interconnection e Western Interconnection, mentre negli Stati Uniti ci sono tre interconnessioni, Est, Ovest e Texas (ERCOT). Inoltre, in Nord America c’è il sistema elettrico del Messico, di cui una piccola parte è collegata alla Western Interconnection, e analogamente ci sono sistemi elettrici isolati in Alaska.
 Anche se potresti sentire persone diverse fare riferimento a numeri diversi quando spieghi il sistema elettrico negli Stati Uniti o in Nord America, la cosa principale da riconoscere è che l’unico modo sbagliato di parlare del sistema elettrico è riferirsi ad esso come a un’unica “rete”. Ciascuno dei sistemi di interconnessione elettrica funziona come un sistema sincrono con una frequenza comune e si collega tra loro per un flusso di energia limitato attraverso le linee di collegamento CC. La conversione da CA in un'interconnessione a CC e poi di nuovo ad CA in un'altra interconnessione garantisce che eventuali disturbi legati alla frequenza non si spostino da un'interconnessione all'altra. Dato che lo stoccaggio dell’energia elettrica ha una capacità limitata, stiamo effettivamente eseguendo la produzione di energia just in time per caricare, nel tentativo di bilanciare sempre l’offerta e la domanda in tempo reale.
 Riferimento: NERC Interconnections.pdf
 46 © 2021 Robert M. Lee
 46
 un wa ww
 TT TF TPT WM WD MW WM wW
 7 PF © PP OP wT WM w
 Noi
» SS AA noi YS VS BS UW WS WY WS noi SS ww wo wo wo ww w
 Frequenza del sistema
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Il sistema elettrico nordamericano funziona a 60 Hz mentre altre parti del mondo tendono a funzionare a circa 50 Hz. La frequenza è estremamente importante per la manutenzione del sistema elettrico; l'interruzione della frequenza può avere effetti catastrofici non solo nel collasso del sistema elettrico ma, se fatto nel modo giusto e in condizioni precise, anche nel danneggiamento delle apparecchiature.
 Riferimento: http://fnetpublic.utk.edu/frequencymap.html

© 2021 Robert M. Lee 47 Un sistema di alimentazione
 Chiave colore:
 Nero: generazione Blu: trasmissione
 vinto
 Linee di trasmissione 765, 500, 345, 230 e 138 kV ara
 Cliente della trasmissione
 Generazione di 138kKV o 230kV
 Trasformatore potenziato
 Diminuzione della sottostazione
 Sottotrasmissione del trasformatore
 Cliente 26kV e 69kV
 Cliente Primario 13kV e 4kV
 Cliente Secondario 120V e 240V
 httpv/en.wikipedia.org/wiki/File:E lectricity_grid_simple-_North_America.svg
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 Il grafico del sistema di alimentazione di riferimento mostra i componenti principali di un sistema elettrico. Se pensi ai vari componenti come a qualsiasi altro bene prodotto che viene consegnato a un cliente, puoi pensare a Power
 48

® &
 io)
 generazione come creazione del prodotto, trasformatore Step Up di generazione come imballaggio di un gran numero di prodotti per la consegna, sistema di trasmissione come trasporto di consegna a lungo raggio del prodotto, trasformatore Step Down come separazione dei pacchi per la consegna finale, sistema di distribuzione come la consegna al consumatore e Carica come
 varie tipologie di consumatori grandi e piccoli.
 Riferimento: rete-elettrica-semplice-Nord-America.pdf
 48

© 2021 Robert M. Lee
 rT TT TT VB VT TW WM wW
 wv w
 rw@®© oo
 7 Vv by &w we ww Se Sw SY © WY © © w wS w& w&
 eh
 Cliente

| ne

| Misuratore di potenza (%) potenza AC \ Misuratore di potenza (96)
 il nostro sistema di alimentazione I.C.S.515 .
 Trasmissione.
 Switchyard ea Breaker \ Gees a Close | RCP,
 Relè di protezione
 Chiudi | Colpa ve
 Ripristina
 Generatore
 Linee di trasmissione 765, 500, 345, 230.e 138 KV
 Richiusura Apri Chiudi

© 2021 SANS Prodotto negli Stati Uniti.

|
|
 Trasformatore step-down della sottostazione.
 Cliente Secondario 120V e 240V
 Distribuzione
 cnnTT
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 49
 Vedi le note della diapositiva precedente.

© 2021 Robert M. Lee
 49
 Tour del sito e discussione sulle operazioni - Generazione
 Come funziona una centrale elettrica
 Fonte: Edison Electric Institute (EEt)
 I.C.S.SI5S | I.C.S. Visibilità, rilevamento e risposta
 Sebbene esistano vari tipi di fonti di generazione di energia con sistemi molto complessi utilizzati per controllare e ottimizzare il processo, possiamo esaminare le nozioni di base in questo grafico fornito da EEI ed evidenziare la riga superiore di tre processi di generazione per carbone, gas naturale e nucleare come metodi che utilizzano diverse fonti di combustibile per surriscaldare l'acqua, progettati per muovere una turbina a vapore, che fa girare un generatore, producendo infine energia.
 Guardando la riga inferiore, vediamo Hydro che utilizza l'acqua per muovere una turbina mentre l'acqua si sposta da un'altitudine di alta a bassa pressione convertendo l'energia potenziale in energia elettrica. Successivamente, guardiamo al vento come fonte di “carburante” utilizzato per far girare le pale delle turbine e convertire l’energia eolica in energia elettrica. L’ultimo esempio evidenzia un enorme potenziale di crescita futura per l’energia per migliorare le capacità di cattura e conversione dell’energia solare e l’uso di componenti fotovoltaici per convertirla in energia elettrica.
 50 © 2021 Robert M. Lee
 50
 oo > ww
 rr ff fH TF TH TH TT TF MW TMT TFT RM PPM PW WM WM w
 w Sistemi di impianti di generazione
 Controllo automatico della generazione
 Sistema di controllo distribuito
 ww ww ww wo oS & & & w
 oe Fe wow ww S&S Ww
 ob'
 cz)
 Passa'
 Una centrale termica a carbone ha diversi importanti elementi di processo e di controllo:

¢ Sistemi di controllo distribuito primari: Movimentazione del carbone (trasportatore, frantumazione, ecc.) Controllo della caldaia Controllo del bruciatore Controllo della turbina Controllo automatico della generazione (AGC)
° Acqua Controllo acque reflue Controllo vapore (ricircolo).
* Emissioni di gas
 Monitoraggio dei biossidi di zolfo (Sox) e dei biossidi di azoto (NOx).
 Controlli della desolforazione dei fumi

* Controlli dei precipitatori elettrostatici dei rifiuti solidi (cenere, mosca, cenere) Controlli del sacco a maniche

¢ Storico

¢ Chimica dell'acqua

* Sistema di compressione

° Tasso di calore

* Monitoraggio delle vibrazioni

¢ Monitoraggio acustico

¢ Monitoraggio della sicurezza della turbina

¢ Movimentazione del carburante

© 2021 Robert M. Lee
 i 1 Loop Coal saeite Handling Scrub Syster eae
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 Monitoraggio delle turbine Emissioni di gas Raffreddamento dei rifiuti solidi Chimica dell'acqua Monitoraggio delle vibrazioni
 Sistema idrico
 Monitoraggio acustico
 51 anni, Interazioni e Risultati
 Una centrale elettrica tradizionale con più unità si collegherà al sistema elettrico e l’energia prodotta servirà il carico locale o immetterà il sistema elettrico più grande,
', a seconda del sistema di alimentazione, i flussi attraverso il sistema di trasmissione e le intervie.
 H Unidirezionale al cantiere
 File di progetto (Livello 2) File [schede dati, MSDS,] Patch firmware (Livello 1) Patch software (Livello 3 e 2) Hardware acquistato Software acquistato Parti/attrezzature Strumenti Fornitura di carburante Manodopera/Appaltatori Acqua di raffreddamento Prodotti chimici/materiali Consegne Posta (CD /DVD/USB/lettere)

= e
 Bidirezionale con sito
 AGC (Livello 2)
 SCADA (Livello 1 e 2)
 Protezione relè (Livello 0)
 Manutenzione remota Supporto (Livello 3,2,1) Turbina Remota Mont. (Livello 0) Replica storica (Livello 3) Plant-to-Enterprise (Livello 4-5) Internet (Livello 4)
 Calibrazione
 Telefono VOIP
 Centralino telefonico
 Telefono satellitare
 Trasmissione radio 900 Mhz
 Flusso di potenza
 pourruis

‘Unidirezionale da sito/@sito
 Risultati del laboratorio di chimica
 File (report, dati, immagini, ecc.) Ordini
 Posta/spedizione
 Cenere (rifiuti)
 Prodotti chimici usati (rifiuti)
 Rottame
 Acqua
 Apparecchiature/parti rimosse Monitoraggio delle emissioni
 1CSS15 | I.C.S. Visibilità, rilevamento e risposta
 Una centrale termica richiede una grande quantità di input, interazioni e output per funzionare correttamente. Molti di questi input, interazioni e output possono fornire opportunità di accesso o manipolazione. È importante notare che le centrali elettriche ricevono spedizioni, si collegano a sistemi esterni e richiedono dati fuori sede. Il modello qui presentato costituisce la base per stabilire una revisione delle superfici di attacco e dei potenziali percorsi di accesso.
 AGC = Controllo automatico della generazione SCADA = Controllo di supervisione e acquisizione dati
 52

© 2021 Robert M. Lee

&
 Tg'? FW WT VT MW ewwmen w
 7-7 7 woh © © woh ©
 Noi

’ vedi Sw YS wo ww ww ww wo wo w&
 ve Sb Sb &
 Trasformatore ad alta tensione della sottostazione
 Interruttore
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 Le sottostazioni sono punti del sistema energetico in cui i livelli di tensione vengono modificati e i percorsi elettrici si collegano. Contengono trasformatori, interruttori, interruttori, dispositivi di protezione, apparecchiature di monitoraggio, trasmissione CA flessibile
(FACTS) dispositivi per la stabilità della potenza come unità di monitoraggio di fase e una varietà di apparecchiature di controllo/comunicazione.Alcune sottostazioni possono avere collegamenti di comunicazione dedicati, a seconda della lontananza e della quantità di dati raccolti.

© 2021 Robert M. Lee 53 Funzioni della sottostazione di trasmissione
 Sottostazione Controllo Trasformazioni Flussi Energetici Controllo Tensione Protezione del Sistema

. es Relè Ni h Protezione delle apparecchiature ne ee Commutazione
+ Metri eh | Ui; Qualità dell'energia
 Eliminazione dei guasti
 I.C.S.$515 | I.C.S. Visibilità, rilevamento e risposta
 I proprietari e gli operatori delle risorse svolgono una varietà di funzioni nelle sottostazioni del campo di trasmissione attraverso la loro area di controllo. Sfruttando la commutazione del piazzale di trasmissione, le capacità di commutazione del carico dei trasformatori ad alta tensione e gli elementi dei banchi di condensatori in tutto il campo, i progettisti e gli operatori possono intervenire per garantire l'affidabilità dell'intero sistema elettrico. Inoltre, le entità progettano e realizzano apparecchiature e capacità di protezione negli ambienti delle sottostazioni per limitare gli impatti delle condizioni di guasto del sistema e intervenire durante le operazioni di emergenza.
 I dispositivi tipicamente presenti nelle sottostazioni di trasmissione includono: Relè di protezione (digitali ed elettromeccanici)
 Unità terminali remote (o telemetria) (RTU)
 Controller di automazione in tempo reale (RTAC)
 Dispositivi Elettronici Intelligenti (IED)
 Dispositivi di misurazione
 Ampia varietà di apparecchiature per le comunicazioni
 54 © 2021 Robert M. Lee
 oh ww
 rT TP Tr TT TT T DT MW WT WM SM WM SH
 ww, ww wi ww wm w
 a ib vee seieswswe ws swe & w&S & ww
 uo &
 ew» Yb &
 Controllo di supervisione e acquisizione dati
 Centro di controllo
 Server SCADA
 Comunicazioni
 Workstation del dispatcher: HMI “rr oooe2} Processore front-end
 Server di visualizzazione del server di allarme Historian * 800-900 Mhz
* Microonde
+ Fibra
+ Rame
 Relè RTU IED Misuratori
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 I centri di controllo del sistema a livello di trasmissione possono supportare funzioni che vanno dal coordinamento e bilanciamento dell'affidabilità alle operazioni di trasmissione.
 L'impronta normale di uno SCADA-EMS di trasmissione comprende interruttori, commutatori, linee, trasformatori e generatori, inclusi tutti i circuiti superiori a 100 kV, trasformatori con due o più terminali superiori a 100 kV e tutti i trasformatori step-up collegati a generatori superiori a 20MW. Per garantire l'affidabilità del centro di controllo, spesso esiste un centro primario e un centro di supporto responsabile di un'area di controllo.
 I centri di controllo della trasmissione ospitano applicazioni critiche tra cui terminali operatore di sistema, mappe e server di visualizzazione, server di allarmi, server di applicazioni SCADA, database e processori front-end. Questi sistemi centrali comunicano con i dispositivi di campo tramite una moltitudine di mezzi di comunicazione (radio, microonde, fibra e
 rame). Le principali comunicazioni SCADA sono:

* Collegamenti dati Inter-Control Center Communications Protocol (ICCP) ai centri di controllo.
* Collegamenti SCADA agli impianti tramite unità terminali remote (RTU) su vari protocolli come: IEC104, IEC61850, Distributed Network Protocol (DNP3.0).
 L'ICCP fornisce la visibilità necessaria sull'intero sistema elettrico per supportare il dispacciamento della generazione in tempo reale. I proprietari e gli operatori delle risorse sono distribuiti su più nodi ICCP. Idealmente, ciò impedisce un singolo punto di guasto e fornisce ulteriore visibilità durante le interruzioni.
 HMI = interfaccia uomo-macchina
 EMS = Sistema di Gestione dell'Energia
 RTU = Unità terminale remota
 IED = Dispositivo Elettronico Intelligente
 GSM = Sistema Globale per le Comunicazioni Mobili

© 2021 Robert M. Lee 55 Tour del sito e discussione sulle operazioni - Distribuzione
 Sottostazioni di distribuzione
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 I sistemi di distribuzione ricevono la maggior parte della loro elettricità dal sistema di trasmissione e quindi riducono la tensione per soddisfare le esigenze dei vari clienti nei loro territori serviti, compresi i clienti industriali, commerciali e residenziali. Le società di distribuzione sono in genere le entità che i clienti finali vedono come "società elettrica" ​​e, a seconda della particolare ubicazione, la società di distribuzione può far parte di un servizio di pubblica utilità più grande e integrato verticalmente o di operazioni di generazione, trasmissione, distribuzione e centro di controllo, oppure la società di distribuzione può essere un'entità autonoma che fornisce i servizi “pali, cavi e misurazione” ai clienti.
 Le sottostazioni di distribuzione varieranno notevolmente da struttura a struttura, a seconda del carico servito e dell'ubicazione.
 56 © 2021 Robert M. Lee
 wo. &
 rn @ 7 TF HW TT MW TF T DW MW WM W
 wv wm w

”, ?, wv.os F§ &F F&F FH Hee wHeweeeeee es
 eo e
 w
 Operazioni di distribuzione

¢ Il sistema di distribuzione di molti servizi può essere controllato dagli stessi centri di controllo o centri di dispacciamento che utilizzano un sistema SCADA comune o comunica con il sistema utilizzato per gestire gli impianti di trasmissione

¢ Molti facilitatori di distribuzione condividono lo stesso percorso di comunicazione o
 comunicare attraverso strutture di trasmissione

¢ I siti di distribuzione possono essere configurati come parte di una riduzione del carico dell'organizzazione o di uno schema di protezione speciale

* Le strutture di distribuzione possono anche sfruttare le tecnologie di automazione della distribuzione sul campo per rispondere alle mutevoli condizioni del sistema
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 57
 I sistemi di distribuzione sono generalmente considerati inferiori a 100 kV con tensioni di servizio primarie tipiche a 14,4 e 12,5
 kV e alimentazioni secondarie a 120, 240 e 480V decrementate in base alle specifiche esigenze del cliente.
 I feed di distribuzione ai clienti possono avere un paio di approcci progettati a seconda della posizione e della criticità
 carico. Questi includono:

¢ Un'unica alimentazione radiale da una sottostazione di distribuzione a un cliente

¢ Un'alimentazione ad anello con due linee attraverso percorsi geografici diversi che alimentano i clienti della stessa sottostazione di distribuzione

¢ Una doppia alimentazione con due circuiti provenienti da diverse sottostazioni di distribuzione che alimentano i clienti con circuito aperto

© 2021 Robert M. Lee 57 Tour del sito e discussione sulle operazioni - Centri di controllo
 Monitoraggio del sistema elettrico
— Controllo del sistema elettrico
 Equilibrio e coordinamento
 Gestione dinamica del carico
 Gestione degli errori del server SCADA o gestione delle interruzioni
Processore frontale Sicurezza del lavoro D i sp a t chi n g
 Workstation del dispatcher: HMI
 Server di visualizzazione del server di allarme storico
 I.C.S.St5 | Visibilità, rilevamento e risposta I.C.S
 I centri di controllo e i centri di spedizione comunicano con le posizioni sul campo e consumano dati dai dispositivi. Gli operatori eseguono azioni di controllo per garantire l'affidabilità e la sicurezza del sistema. Un centro di controllo della distribuzione rispecchierà alcune delle funzioni e capacità di un centro di controllo della trasmissione, meno la necessità di controllo della generazione.
 58 © 2021 Robert M. Lee
 oo wo w
 nom D7 DH TW DW DW WM W
 Q,
 ae, 2 wie Ww es we we Se BS w
 ew e w
 vo Beebe noi
 Centro di Controllo I.C.S. Applica
 Reti esterne
 Router
 av Patch: archivia e stampa
 Back Office — Repository di supporto Repository — Server miglia po
 Ing, Display di controllo
 Operatori OT Server Supe Workstanon Server

_Firewalts|
 Sottoreti singole o multiple
 Dispositivi
 Singolo o Murtipie | Sottoreti
 comm Directory Server Server
 io
 stima della quota S: analisi di contingenza
 SCADA/EMS — Simulazione del sistema
 Concentratori di dati di fasore
 Server di visualizzazione
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Questa è una vista di rete di alto livello dei sistemi tipici presenti attorno a un centro di controllo. Tieni presente che sono tutti server e PC Windows tipici. Considerandoli come sistemi IT e non OT/I.C.S. sarebbe un fallimento significativo che avrebbe un impatto maggiore rispetto a quello degli attori statali stranieri messi insieme.

© 2021 Robert M. Lee
 59 Prospettive BES
 Stazione di generazione
 Trasformatore potenziato
 Controllo della turbina Bilanciamento dei sistemi dell'impianto Sistema di controllo distribuito Sistema di pressione dell'aria Sistema di protezione relè Sistema di olio lubrificante Sistema di chimica dell'acqua Sistema di gestione del bruciatore Sistema di movimentazione del carbone Sistema di monitoraggio acustico Sistema di consumo di calore Gestione delle emissioni continue Sistema di controllo della caldaia
 FielBus FieldNet o Profinet Modbus FoxNet
 765, 500, 345, 230 e 138 kV
occhi

“Cliente trasmissione A3BRV da 230KV
 Controllo interruttore Controlli di commutazione Relè di protezione rospo Commutatori Trasformatori di corrente TA Trasformatori di potenziale PT Misurazione banchi di condensatori
 SANS I.C.S.. Versione 1.4
 stomer
 tè sedis
 Sistema di gestione dell'energia Server dati Server di visualizzazione Front-end di comunicazione Stimatori di stato Gestione allarmi Analisi di contingenza Storici Sistemi di supporto
 Distribuzione Automazione Banchi di condensatori Richiusure Controllo di commutazione Relè di protezione Trasformatori di corrente TA Trasformatori di potenziale PT Misurazione
 HEC61850| DNP3 | TCP tradizionale Landis & Gyr | REDAC 101/104
 Le società di servizi energetici dipendono fortemente da una catena di fornitura globale per fornire materiale fisico e componenti operativi. Molti paesi hanno riconosciuto il rischio di tempi di consegna lunghi che esiste in questa catena di approvvigionamento. e hanno intrapreso azioni
 per garantire che gli inventari delle attrezzature fisiche siano adeguati per le strutture ad alto rischio. Alcuni paesi hanno adottato requisiti specifici per la sicurezza informatica della catena di fornitura.
 60

© 2021 Robert M. Lee

»

®
 il 7 7 7 TOD DM Dw w
 mmm Ha incontrato es ss es ss a
 mm @

=
 ss &§ S&S
 wow Oo e
 Ve
 Lab 2.1 Funzionamento del processo
 I.C.S.SI5 | I.C.S. Visibilità, rilevamento e risposta 6!
 

© 2021 Robert M. Lee
 61 I.C.S. Visibilità della rete e protocolli di rilevamento IT
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S
 
 62 © 2021 Roberto M.Lee
 TT wonmrnmrnrrmrirrmrrTmemrTomenD PM HO OH H &
 Protocolli di rilevamento IT

* Le reti, incluso I.C.S., hanno * Protocolli di rilevamento comuni in I.C.S.
 ap
 Di
 ar
 quantità significative di dati utili per le reti:
 identificazione e visibilità degli asset
 I protocolli IT Discovery sono protocolli
 che contengono informazioni per identificare risorse e informazioni su di esse
 Numerosi I.C.S. i produttori sfruttano protocolli IT comuni anche sui controller (ad esempio Telnet)
 ARP ICMP SNMP HTTP TELNET FTP NETBIOS SMB
 DNS/MDNS LLMNR LLDP DHCP
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Quasi tutte le reti contengono quantità significative di informazioni nei protocolli nativi, eliminando la necessità di interrogare attivamente i dispositivi per ottenere le stesse informazioni. La maggior parte degli analisti è sorpresa di quanto si possa ottenere dalle reti semplicemente comprendendone i protocolli. Nell'I.C.S. reti, molti protocolli che non ti aspetteresti, ad esempio DNS, sono utilizzati da vari I.C.S. produttori di apparecchiature. Il DNS, ad esempio, può essere utilizzato per archiviare informazioni sulle risorse nelle reti Profinet. Inoltre, HTTP è comune, ad esempio, per le pagine di destinazione sui controller.
 Comprendere questi protocolli di rilevamento IT e il valore che contengono è un semplice passo iniziale per identificarli
 apparecchiature e le relative informazioni sulla rete.

© 2021 Robert M. Lee 63 Endpoint Wireshark

¢ Valore:
* Visualizza rapidamente gli endpoint di rete (tutti gli endpoint logici)
 Ethemet 33 | Canale in fibra ottica| FDD1| sPv4: 60 | 1Pv6: 3 (Px | IXTA| ncp| reve] cre] TP:.494
 Esegui su un'interfaccia o Ethernet En] su una cattura di pacchetti Indirizzo 4 Pacchetti 4 Byte 4 TxPackets ¢ TxBytes 4 RxPackets 4 Ra Passa il mouse sopra le statistiche Vmware defidd 15487 8407454 6665 | 16577238.822
« Vmware_chidaef 120 523393 517 640 Seleziona endpoint PhoenixC_0a:00:dd 7360 46512 46512 Visualizza vari livelli Trasmissione 1974 148 500 0 Rockwell_d0:34:3e 763 114876 58 848 75 (119937 7 TS718 1 3619 7941608 6965 551 Rockwell_28:32:08 4 794 PhoenixC_69 :aa:55 254 SiemensN\_0d:34:3¢ 17576

* Metodologia:
«Apri Wireshark
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Gli endpoint Wireshark sono tutti gli endpoint logici in ciascun protocollo identificabile sulla rete. Ad esempio, un endpoint Ethernet sarebbe l'indirizzo MAC. Un endpoint IP sarebbe l'indirizzo IP. E un endpoint TCP o UDP sarebbe il numero di porta. I.C.S. i protocolli sono ampiamente supportati in Wireshark, ma i dissettori endpoint in Wireshark non riconoscono nativamente I.C.S. endpoint. In altre parole, se visualizzi DNP3 nella versione predefinita di Wireshark, non puoi utilizzare Endpoint per determinare gli indirizzi oltre MAC, IP e numero di porta. Tienilo presente quando utilizzi gli endpoint; è un modo efficace per identificare molte delle risorse sulla rete, ma non è l'unico processo da utilizzare.
 La metodologia generale per l'utilizzo di Wireshark consiste nell'usarlo per aprire le acquisizioni di pacchetti (pcap) prelevate dalla rete o per acquisire e analizzare il traffico in tempo reale. Per elaborare il traffico in tempo reale, Wireshark deve essere eseguito su un computer Windows o Linux e, una volta aperto, deve essere assegnata un'interfaccia. Se Wireshark viene eseguito da un computer informatico tradizionale, non vede tutto il traffico della rete; osserva i dati trasmessi da o verso lo switch e altri dispositivi, nonché il traffico in transito tra quel sistema e qualsiasi altro sistema, come lo switch. Pertanto, quando si utilizza Wireshark, è meglio collegarlo a uno switch di rete. (Come eseguire questa operazione è discusso nella parte "NSM I.C.S. — Raccolta" della formazione di questa sezione. Inoltre, per monitorare il traffico su uno switch non gestito, è necessario "hub out", anch'esso discusso
 Dopo).
 Per utilizzare gli endpoint, apri Wireshark, fai clic su Acquisisci e scegli un'interfaccia dopo l'avvio dell'acquisizione e lasciala funzionare per un po'. Quindi, passa il mouse su Statistiche sulla barra degli strumenti e seleziona Endpoint dal menu a discesa. Qui puoi notare i diversi endpoint logici osservati sulla rete. È necessario creare un elenco di ciascun indirizzo Ethernet, ciascun indirizzo IP e quindi ciascuna porta associata agli IP. Questa analisi del traffico aiuta a identificare tutte le risorse e le reti attive sulla o connesse alla tua rete. Ricorda di eseguire Wireshark da tutti gli switch di rete disponibili
 e interfacce per avere una visione completa.
 64 © 2021 Robert M. Lee
 qn vn quando wmnwn en ww
 eo ® @ w wo © ww ww we ww ww ww © Sw we w
 wv wo wo Ww
 Conversazioni di Wireshark

° Valore:
* Visualizza rapidamente le connessioni in atto sulla rete (OSI 2-7)

| | | | |
_ Ethernet: 56| Canale in fibra ottica } FDDI| Pvd: 73} 1Pv6: 2) IPX | JXTA | PCN

* Metodologia:
* Apri Wireshark Indirizzo A 4 Porta A 4 IndirizzoB 4 PortaB 4 Pac Esegui su un'interfaccia o una cattura di pacchetto 10.25.22.252 58635 Odse22 so-tap
 Passa il mouse sopra le statistiche 10.25.22.252 58635 10.25.22.30 ff-sm 10.25.22.252 58635 10.25.2222 sm
 Seleziona conversazioni 10.25,22.252 $8535 1025.22.20 dnp Visualizza vari livelli 10.25.22.252 58635 10.25.2230 _profinet-rtrm 10.25,22.252 58635 1025.22.22 dnp 10.25,22,252 58 635 10.25.22.22 _profinet-rtm 10.25.22,252 58636 10.25.22.22 —_profinet -rtm 10,25.22.252 58636 25.10.22.22 dnp
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Wireshark Conversations utilizza la stessa configurazione e metodologia di Wireshark Endpoints perché sono solo opzioni diverse all'interno dello strumento. Endpoint identifica gli indirizzi logici sulla rete a ciascun livello di protocollo e Conversazioni identifica le comunicazioni tra tali indirizzi logici. Ad esempio, se vedi di avere un dispositivo Profinet-RTM con indirizzo IP 10.25.22.30, è utile sapere che sta comunicando con un dispositivo che utilizza la porta 58635 e l'indirizzo IP 10.25.22.252. L'identificazione di questo percorso mostra il traffico in tempo reale sulla tua rete e le diverse connessioni (o conversazioni) in atto. Un unico dispositivo comunicante con più I.C.S. le risorse potrebbero indicare un server SCADA o un HMI. Se hai visto protocolli o indirizzi IP che non ti aspettavi di vedere, è importante prenderne nota e poi indagare.
 Per utilizzare Conversazioni, apri Wireshark, eseguilo su un'interfaccia o elabora l'acquisizione di un pacchetto, passa il mouse su Statistiche e seleziona Conversazioni. I vari livelli visualizzati mostrano le connessioni logiche e il flusso di dati di ciascun livello di indirizzi logici. Prendi nota di questi per il tuo diagramma di rete. Tutte le stesse considerazioni sulla rete degli endpoint si applicano a Conversazioni. Assicurati di acquisire acquisizioni da ogni switch gestito nella tua rete e di utilizzare le tecniche Hub insegnate in seguito sugli switch non gestiti.

© 2021 Robert M. Lee 65 Utilizzo delle statistiche di Wireshark
 Vai a Cattura Analizza. Statistiche Strumenti di telefonia Interni
) Riepilogo o Riepilogo commenti
 Mostra la risoluzione dell'indirizzo
 Gerarchia dei protocolli
 sourte 9 conversazioni 192.168. 1. Endpoint PA 192.168.1.175 Lunghezze dei pacchetti...
 Utilizzando un'acquisizione di pacchetti di base, navighiamo verso gli endpoint di Wireshark e visualizziamo gli endpoint Ethernet e IPv4
 Per i nostri scopi ignoreremo gli indirizzi Multicast e Broadcast
 Tema: 22
 Indirizzo Vinware 66:26:86 Rockwell_a0: RsAutoma_03; PhoenixC_96:80:07 PhoenixC_96:08:46 Vmware b9:08:1e Phoenixt_ 96:80:08 LiDP_Multicast Vinware_20:92:98 Siemens

(Pv6meast_00:01:00:02 AsixElec_8f:0a:30 Trasmissione PhoenixC_b3:1&ab Teelb:0d,02:16:3¢ Vmware, 06:10:13 1PvGmeast 00:01:00:03
 iPv4mecast_00:00:16
(Pvameast_Effefe
 fo, teva: 18 v6: 9
 Pacchetti 390 996 239936 313113 292 982 297 528 14e 022
 6092 6330 22345 3 660
 Byte
 44 653 082 27 315 ​​307 36 826 806 17 888 800 17 675 060 17.942 796 402 180 478 263 2137235 293 310 75.905
 18 424 22.255 220 327 223322 7614 3768
 451
 355
 900
 3870
 2148
 Ethernet: 22
 Indirizzo 192.168.1.5 192.168.1.50 192.168.1.51 192.168,1.175 192.168.1.215 192.168.1.20 192.168.1.30 192.168.1193 10.0.0.254 192.16 8.1.21 Di
 224.0.0.252 192.168.1.1 192.166.1.253 224.0.0.22 239.255.255.250
 iPv4: 18 | IPv6:
 Pacchetti
 390 968 239 898 323075 147 962
 byte 44 648 958 27313027 36824 526 17 937 644 2126 a62 296 260 289 590 13906 7942
 14 080 4545 2220 1651
 351
 2360 3754
 370
 2148
 I.C.S.S515 | I.C.S. Visibilità, rilevamento e risposta
 Wireshark Statistics è un insieme di strumenti/plugin che ti consentono di esaminare elementi come endpoint, conversazioni e gerarchia di protocolli per determinare cosa c'è sulla rete dall'acquisizione dei pacchetti. Eseguirai gli stessi passaggi in
 il laboratorio per aiutarti a determinare cosa c'è.
 66

© 2021 Robert M. Lee
 onnne#nnnrvrnnrnnT Fe Wr rrwrwne = &

«, 7, wv wow FF FS WO WO WO © OS WS Ww
 ev ws SS ©
 oe §& wo
 noi & noi noi
 Gerarchia del protocollo Wireshark

° Valore:

* Identificare rapidamente i protocolli sezionati

* Metodologia:
 Apri Wireshark
 Esegui su un'interfaccia o su un'acquisizione di pacchetti Passa il mouse sopra le statistiche
 Seleziona Gerarchia protocolli
 Visualizza vari protocolli
 A esate Protocol eco hy Satie Capture Epp
 Pretoce! Pacchetti percentuali Y Frome Y Ghemet
 tnteietPrtecelVeneio &
 Utente Delagrern Protocollo!
'Muiticas oman Nama Systern LinkeJocal dutcart Home Reslution DHCP

© Internet Contot Protocollo messaggi Linkiocal Miticast Nome Resclutin

~ versione Procol intemet
 Protocollo datagramma utente! Simp Senice Discovery Proteccl
“Protocollo di gestione della rete Simpie che esce dal protocollo di ifermation e dal nome iOS Seve

< Servizio NatBIO5 Batagrom
‘Si (ercer Message Block Pretose!) Y SMB Mallet Pioteca! Microset Windows Bowee Potocel
 Nome dominio Muiucast Steen Unk-local Mutcot Meme Risoluzione Configurazione host dinamica Protacet
 Pacchetti Pesca Morsi 009 a
 Dota
© Fancmision Contrel Protecel NetBIOS Sesion Series Message Bock Potecol versione 2)
© S008 Geiwer Message Block retoce’) Y Protocollo pipe SMB
'Microslt Windows Lanman Remote AP Protscet
 Distbuled Computing Evitonment Remote Procediae Call|DCEIAPC)

' Distibuted Computing Eovronmert Remote Procede Call (OCERPC} DCK/PC Fndocint Manoes
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 Wireshark Conversations utilizza la stessa configurazione e metodologia di Wireshark Endpoints perché sono solo opzioni diverse all'interno dello strumento. Endpoint identifica gli indirizzi logici sulla rete a ciascun livello di protocollo e Conversazioni identifica le comunicazioni tra tali indirizzi logici.Ad esempio, se vedi di avere un dispositivo Profinet-RTM con indirizzo IP 10.25.22.30, è utile sapere che sta comunicando con un dispositivo che utilizza la porta 58635 e l'indirizzo IP 10.25.22.252. L'identificazione di questo percorso mostra il traffico in tempo reale sulla tua rete e le diverse connessioni (o conversazioni) in atto. Un unico dispositivo comunicante con più I.C.S. le risorse potrebbero indicare un server SCADA o un HMI. Se hai visto protocolli o indirizzi IP che non ti aspettavi di vedere, è importante prenderne nota e poi indagare.
 Per utilizzare Conversazioni, apri Wireshark, eseguilo su un'interfaccia o elabora l'acquisizione di un pacchetto, passa il mouse su Statistiche e seleziona Conversazioni. I vari livelli visualizzati mostrano le connessioni logiche e il flusso di dati di ciascun livello di indirizzi logici. Prendi nota di questi per il tuo diagramma di rete. Tutte le stesse considerazioni sulla rete degli endpoint si applicano a Conversazioni. Assicurati di acquisire acquisizioni da ogni switch gestito nella tua rete e di utilizzare le tecniche Hub insegnate in seguito sugli switch non gestiti.

© 2021 Robert M. Lee 67
 Di
 ARP e ICMP

° ARP scopre il livello di collegamento ” sexe 10:49106.456259 Lcroete e:58: G0 ho ha 28.29.22.12 Indirizzi Tell (ad esempio MAC) e : era eet etme
‘ ‘ pierre Sie eee indirizzo del livello Internet associato F Frou Saver to bytes ox viva (on bias), oo bytes coered Gov Hla] 2 EEnOnSct Ta) Vedere nonee Sraiion (aeenbesiOPeian}, Dots weer A7efoe.(Gansiahesfiile)

(ad es. IPv4) Fa reo npc taf San Tipo hardware: Ethernet £1)

* Lega insieme MAC e IP in I.C.S. tipo di protocollo: 1004 (@x08ee}
 Altro hardware: 6
 invece di visualizzare semplicemente il MAC nella dimensione del protocollo: 4 Opeode: request (2)
 il protocollo che potrebbe essere l'indirizzo del mittente MA, ultimo punto instradabile valutato da Tecpel MC
 ICMP è spesso utilizzato per oe TOA. Saree #5, 24525 ME , ce (peng) renest “Seema, seaedl/2506, stuzzica (risposta ts 70499)

. . quindi sì, 10e5428. 12706 10.25.22,200 18 28.22.191 TOP 74 tove (ping) Feply _Ldenoah, seqeii/201, t8lel24 (richiesta 1n 79482) diagnostica e reporting enT0r > Frawe Teva: 74 bye su cavo (362 vita), ™ byte catturati (S52 bit ) e

¢ Aiuta a mostrare i dispositivi attivi e > Imposta 5) Wonssoueu =

© Internet Contral Messaggio Protec:
 potenziali errori che si verificano er tee ep ee
 Tdentifter (LE): Sequenza Moeber Sequence Muster
 fa

> Dati (32 byte)
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Gli ARP sono molto comuni in I.C.S. reti. Sono estremamente utili per collegare l'indirizzo MAC con l'indirizzo IPv4. Se guardi semplicemente l'indirizzo MAC in un pacchetto, potrebbe essere l'ultimo punto instradabile (ad esempio, una porta Switch) a seconda della topologia della rete. Identificare e sfruttare le richieste e le risposte ARP è molto più definitivo in termini di collegamento di MAC e IP in un'unica risorsa.
 L'ICMP verrà visualizzato più spesso dove si verificano gli errori, ma ci sono alcuni I.C.S. dispositivi che utilizzeranno comunque ICMP per attività iniziali di tipo rilevamento o quando le connessioni vengono interrotte. Identificare questi protocolli può essere un modo semplice per identificare i percorsi tra i dispositivi e alcuni indirizzi attivi nell'ambiente. I dati ICMP (così come le risposte tramite UDP che identificano ad esempio quali porte sono chiuse) possono essere utilizzati anche per profilare i dispositivi. Il tempo di vita (TTL) spesso equivale al sistema operativo. Ad esempio, un TTL da 64 è probabilmente un dispositivo Linux mentre un TTL da 128 è probabilmente un dispositivo Windows.
 68 © 2021 Robert M. Lee
 68
 nn? © WP MF DHMH PWD * Se WP wMWwer Oo H &
 m™,

~~7@
 eo § §Y wb noi w&
 sistema operativo e

—)
 9
 NetBIOS e PMI
 NetBIOS ha tre servizi principali:

«Servizio dei nomi

* Servizio datagramma

* Servizio di sessione Consente comunicazioni e connessioni tra
 risorse
 SMB non è richiesto ma spesso è presente
 Trasferimenti di file, percorsi di cartelle,
 Stazione di lavoro UT, Stazione di lavoro, Doran e
 set)
 ser Protocollo Owtagran, Porta Src: 38, Porta Ost: 18 Servizio NetBIOS Ontagran

> $ 9 (servire il protocollo di blocco Kessoge)
 E $ 16 Protezione slot ingresso
 Protocal weg lnfe vass 126 Richiesta di sessione, a TOM-WORK<28> per SCADAZ<oe> 18.25.22.161 ness 60 Sessione positiva -espanse Mite 12:06:25.156415 18,25.22.101 10,25.22.200 SMa Negotiate Protece) Richiesta rage 164375: 126 byte su thecnet IZ catturato (1008 bit), vedere: Wihare_32:29:2¢ (00:0¢:29:3¢: LcrcHeFe_ec:55:fe (28:42: 22.208
 I nomi delle workstation, ecc. sono ~ servizi di sessione di rete
 tutti rilevabili in Netbios
 Tipo di messaggio: Richiesta di sessione, (@x61) 2 Flag: uno Lunghezza: 66 Nome chiamato: TOH-WORKC2@> (Servizio server) Nave chiamante: SCADA2<@@> (Workstation/Redirector)
 I.C.S.515 | [Visibilità, rilevamento e risposta del CS
 NetBIOS e SMB sono protocolli diversi e non è necessario che siano utilizzati insieme, ma spesso vengono utilizzati insieme. NetBIOS dispone di tre servizi principali e, soprattutto quando si utilizza SMB, può fornire informazioni sui nomi delle risorse, sull'associazione con altri dispositivi e connessioni, sui percorsi dei file e sui nomi delle cartelle quando si accede ad essi e
 Di più.
 Le cartelle condivise e altre comunicazioni basate su Windows SMB sono incredibilmente comuni ai livelli L2 e L3 di I.C.S.reti e può aiutare non solo a identificare le risorse ma anche la topologia mostrando le interconnessioni tra
 risorse.

© 2021 Robert M. Lee 69 Servizio nomi NetBIOS

* NBNS fa parte del protocollo NetBIOS e funziona in modo simile al DNS per le risoluzioni degli indirizzi

¢ Può contenere informazioni sul nome host per i dispositivi ed è ampiamente utilizzato su I.C.S. basati su Windows. come HMI, EWS e storici dei dati
 File Modifica Visualizza Vai Acquisisci Analizza Statistiche Telefonia Strumenti wireless Guida
 2faeabeaaeaku
 N. Ora Sorgente Destinazione Protocollo Lunghezza Info
 3@1... 10:47:18.633532 18.25.22.100 1@.25.22.255 NBNS 92 Interrogazione nome NB VTSCADA<1c> 302... 10:47:19.383352 10.25.22.100 1@.25.22.255 NBNS 92 [ Nam N D E
 3@2.. 10:47:20.133404 1@.25.22.100 10.25.22.255 NBNS 92 Interrogazione nome 304. 10:47:21.612604 10.25.22.100 10.25.22.255 NBNS 92 Interrogazione nome NB VTSCADA<ic> 304 ...10 :47:21.627827 10.25.22.108 10.25.22.255 NBNS 92 Interrogazione nome NB SCADA2<@@>
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 9
 Molti membri del personale operativo conoscono i propri dispositivi con un nome semplice, ad esempio il nome host del dispositivo. "VTSCADA" potrebbe essere l'HMI con cui hanno familiarità. Questi nomi host sono spesso configurati in Windows per HMI/Historians/EWS/ete. e sono spesso rilevabili su NBNS.
 NBNS svolge quindi un ruolo prezioso nell'I.C.S. reti agli indirizzi IP associati (ad esempio, 10.25.22.100) ai nomi host
(ad esempio, VTSCADA).
 70 © 2021 Robert M. Lee
 a o> @> > ® w OH WO WOeMeeOwD wT wr

>_> = = 2 * ® @ a
 un noi
 Vu Ww wb noi noi noi S&S ww ww) | |] noi ww
 DNS e MDNS
 DNS e mDNS risolvono i nomi host in indirizzi IP
 te: Alcuni I.C.S. l'attrezzatura accetta G66. 10:52:42.478696 FeO: :06d: F402; 7212: FFB2:: fb '282 Risposta alla query standard @xQ008 AMAA Sse. 10:52:42. 7477 192.1881. 148

. 248.0.251 70S S27 stoners wry wow woscee approfitta di questo e di alcuni
>> Frame 66664: 282 byte su wir 32 byte catturati (2256 bit)
 5 Ethernet 11, Sez.: Apple. Sed 75/Setd8:c8), Dst: TPveecast_fb (33:33:00:00:00: fb) protocolli (ad esempio, Profinet può

+ Protocollo Internet versione 6, F402: 721e:e688, Ost: FFE2::f>

«ter Protocollo Datagran, vedere Porta: 5383, Porta Dst: 5353 memorizzare informazioni sulle risorse
 Y Sistema multicast Oosain Mase (risposta)
 Teonctien 1D: 808 utilizzando DNS)

> Plags: @xB4@ Risposta alla query standard, nessun errore Domande: @ Risposta RRS: 4
 RR dell'autorità: @ . . . sind et Utile anche per l'identificazione
+iesers

> Toms-§Phone-4, locale: tipo AMAA, classe IM, cache flush, adde fea: :a6d:f402:721e:6888 j + 7
> Waseca: Spe a lancia anche lei dispositivi transitori a ovest in I.C.S. reti
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 7
 DNS e mDNS sono ottimi protocolli per la risoluzione di nomi di dominio/host in indirizzi IP. A prima vista può sembrare strano che I.C.S. le reti, soprattutto se altamente segmentate, avrebbero record DNS. La realtà è che è molto comunemente usato. Alcuni protocolli, come Profinet, possono persino utilizzare il DNS per archiviare informazioni sulle risorse. Scoprirai spesso che i vari fornitori di DCS sfrutteranno pesantemente anche il DNS per i loro HMI/EWS in modi che aiutano a identificare l'apparecchiatura (ad esempio, un dominio Yokogawa su un dispositivo può aiutare a identificarlo come controller Yokogawa).
 Saranno presenti anche dispositivi transitori in I.C.S. reti collegate da altre reti, dai laptop tecnici agli smartphone occasionali. Questi dispositivi spesso tentano di raggiungere i siti Web visitati di recente e il DNS può essere incredibilmente utile per identificare tali risorse mentre tentano di raggiungere Internet senza successo (si spera senza successo).

© 2021 Robert M. Lee 71 Risoluzione dei nomi multicast link-local

* LLMNR si basa sul protocollo DNS e viene utilizzato per la risoluzione dei nomi per gli host sulla stessa rete locale in modo simile alla funzionalità di NetBIOS
 Ora Origine Destinazione Lunghezza Informazioni 784... 18:54:25.094458 10.25.22.101 224.0.@.252 68 Query standard @x@614 A TOH-WORK 7B4_. 10:54:25.095191 fe80: :91a2:d44d:b7a7.. fet rd que @xoeid A 784. 10:54:25.095278 1@.25.22.200 10,
 Frame 78485: 112 byte su cavo (896 bit), 112 byte catturati (896 bit)
> Ethernet Se, Src: LCRCHeFe_ec:5S:fa (28:d2:44:ec:$5:fa), Dst: VMware _3e:a9:2c (00:0c:29:3e:a9:2c)
> Protocollo Internet versione 6, Src: fe8@::91a2:d4dd:b7a7:1361, Dst: fe8@: :d836:2F26: 308: Fofa
> Protocollo datagramma utente, porta Src: 5355, porta Dst: 51616
 Risoluzione dei nomi multicest link-local (risposta)
 ID transazione: @xe14

>> Flag: @x8000 Risposta alla query standard, nessun errore Domande: 1 RR di risposta: 1 RR di autorità: 6 RR aggiuntivi: @
> Domande
¥ Risposte

> Tom-lavoro: tipo A, classe IN, indirizzo 10,25.22.200
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 72
 Simile nella funzionalità a NetBIOS e talvolta utilizzato per sostituirlo, LLMNR viene sfruttato per le risoluzioni da nome host a IP. Nello screenshot vediamo che TOM-WORK è un telefono registrato a nome di Tom utilizzato in questo I.C.S. la rete sta sfruttando LLMNR per risolvere il nome host nell'indirizzo IP.LLMNR presenta gli stessi casi d'uso di NetBIOS per i nostri scopi, anche se in genere conterrà meno informazioni rispetto alla suite NetBIOS completa, soprattutto quando SMB viene utilizzato in NetBIOS.
 72 © 2021 Robert M. Lee
 vemnqnewmewmnmse@*wne@wnT FF R@WRMWwseWnwnsn wh wo w

— 9 & @ wa
 va
 sì
 ww.
 AY
 occhio noi noi
 Protocollo di configurazione host dinamico

¢ Protocollo per indirizzamenti come gateway, nomi di dominio, name server e time server

«Fonte Destnaten
| 852. 10:55:41. 902529 10.25.22.4 955.255.258.255 BooTe 855. 13.962572 10.25.22.4 255.255.255.255 OOTP 342 Richiesta di avvio da @8:28:45:35: fd: Fc (PHOENIXC
 S Erame, 2 byte su cavo (2736 bit), 342 byte catturati (2736 bit)
> Ethernet ret PHOENIXC 35:Fd: Fc (80:29:45:35:fd:¥c), Ost: Broadcast (FF: FF: FEE: FF:FF) 2 Protocollo Internet Versione 4, Src: 1€.25,22 .4, Dst: 255.255.255.255
> Protocollo datagramma utente, porta Src: 68, porta Ost: 67
~ protocollo di configurazione host dinamico Tipo di messaggio: Richiesta di avvio (2) Tipo Mardware: Ethernet (@x01) Lunghezza indirizzo Nordware: € Hop: @ Transazione 10: exeeee2ece Secondi trascorsi: € Fleg Bootp: @xe00@, Flag di trasmissione (Broadcast) Client Indirizzo IP: Il tuo IP (client) a Indirizzo IP del server successivo: Reloy agent 1P eddress: Indirizzo MAC client: PHOENINC_35:fd: fc (00:20:45:35:Fd:Fe) Riempimento indirizzo hardware client: eeeeeeccvveeeas—o900
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 DHCP può essere un ottimo protocollo per identificare gli indirizzi, ad esempio legando insieme indirizzi MAC, indirizzi IP, gateway, nomi di dominio e server di riferimento temporale. In questa schermata vediamo l'indirizzo MAC del PLC Phoenix Contact con il suo indirizzo IP associato. Un numero significativo di I.C.S. le reti utilizzano DHCP proprio come le reti IT aziendali per l'allocazione automatica dello spazio IP.

© 2021 Robert M. Lee
 73
 B
 Protocollo di rilevamento del livello di collegamento e SNMP

> Frame 95: 187 byte in linea (1896 bit), 187 byte catturati (1496 bit)
> Ethernet IT, Src: RSAutoma_@0:76:fc (@8:0f:73:00:76:fc), Ost: LLOP_Multicast (01:82:c2:00:00:0e)
¥ Protocollo di rilevamento del livello di collegamento
> Sottotipo telaio = Assegnato localmente, ID: chi-00123-e5
> Sottotipo porta = Assegnato localmente, ID: port-022
> Tempo di vita = 20 sec
> Nome sistema = CHL-00123-ES
> Descrizione sistema = Hewlett-Packard HP Compaq nc6320 (RNS37AMBABA), F.0D, CNU7Z1EYH
> Indirizzo Gestione Capacità PROFEBUS Nutzerorganisation e.V, - Stato del porto PROPTEUS Nutzerorganisation e.V. ~ Telaio AAC
> Teee 802.3 - Configurazione/Stato MAC/PHY

* LLDP è un protocollo di livello 2 che pubblicizza le informazioni del dispositivo ai peer connessi direttamente

¢ Contiene informazioni come chassis, ID porta, descrizione della porta, nome e descrizione del sistema, IP/MAC e altro

* Spesso interrogato con SNMP, spesso utilizzato per la gestione dei dispositivi
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 LLDP è molto comunemente utilizzato sui dispositivi e può essere particolarmente utile per i sistemi dual-homed per identificare quali sistemi sono dual-homed attraverso l'analisi del traffico di rete. LLDP memorizzerà le informazioni e le trasmetterà ai suoi peer. Le reti Profinet in genere utilizzano molto LLDP per i loro sistemi. Tuttavia, LLDP sarà presente solo sulle reti locali e non lascerà tali reti locali poiché in genere non viene instradato all'esterno della rete locale.
 Inoltre, LLDP può aiutare a identificare i nomi VLAN, le funzionalità del sistema (ad esempio, lo switching) e qualsiasi nome e descrizione del sistema archiviato.
 Le informazioni LLDP vengono archiviate nel Management Information Base (MIB) del dispositivo che è essenzialmente un database per la gestione delle entità collegate in rete.
 I fornitori possono anche disporre di protocolli proprietari del livello di collegamento per acquisire informazioni simili. Ad esempio, Cisco ha il suo Cisco Discovery Protocol (CDP), che rivelerà un'ampia varietà di informazioni sulle apparecchiature Cisco, come la versione del sistema operativo e l'indirizzo IP.
 Il protocollo SNMP (Simple Network Management Protocol) sfrutterà le informazioni MIB per interrogare un dispositivo e viene spesso utilizzato per la gestione dei dispositivi di rete. La raccolta di informazioni SNMP può essere un modo rapido per identificare tutte le informazioni che
 esce da LLDP o è archiviato nei MIB.
 SNMP conterrà spesso anche OID, che corrispondono a linee di prodotti di diversi fornitori. Devono essere decodificati, ma rappresentano un'ottima fonte di identificazione delle risorse quando presenti.
 74 © 2021 Robert M. Lee
 UN @
 re e@fe
 1) noi S&S YS Se YS YS noi noi noi YS noi noi noi SS SS Ww Ww
 UN)
 HTTP/HTT
 Molti controller e; apparecchiature collegate in rete, ~ ee eee

. Siig asent wnat oie oe ge Sep psc PNG AN
 come i firewall, hanno | 93546. 209619 192.168.1.2 192.168.1.266 aa serieh Hele, Cored ehenee') Server' Maa Duo eda cia peas PEG ie ney aie oimenloge
 pagine web che possono essere aiieriilt regent chad Deseo aod nae
 268 12:03:46.$99914 192. 168.1.200 192.168.1-1 6@ 1083 = 443 [ACK] SeqnI96 Ack=1510 Wine6S535 Le:
 accessibile tramite HTTP o ———————— ESS
 versione: v2 (2) HTTPs sertalruber: exeessefoatra7sadoie
> sigoature (shoanithasAtneryption)
~ edsequance degli emittenti (@)
~ rdnsequence: 7 tteas (pics-9-at-enalAddressenguardfinnoninate.con,ki-xt-commonianeniich2eSe6ib7E7a0835 piede teer nemico
 Analisi delle pagine web; raters aunctiestekic) e Aves (id-at-organizaticianesInnominate Security Technologies Ad)
 rivelerà il prodotto Y'neloedvebiseingutsheauee Aten (id-at-orgentzatlowtanesTonontnate Security Techoologies A6) dr 2-5-4184 at-rgentzationtone)
 OfeectorySeeingsuTeastring (3)
 informazioni Fes Hs SLi AS ee ee

> RONSequenza ites: 1 ites (1d-at-orgentzationalunitane=niuard)
> Articoli RowSequence: 1 elemento (id-at-comonkament2cb2c566ib707sa035/F0OF FOO FORE Oe)
> BoSequence ites: 1 ites (pkcs-S-at-enailAdéress=nguardginnosinate.con)
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Quando i tecnici/operatori navigano tra le varie pagine web del controller o accedono a HMI e simili attraverso la rete, le informazioni sono spesso in H'I'l'P e possono essere analizzate per estrarre informazioni sul sistema e sulle apparecchiature. Inoltre, molti dispositivi di sicurezza, come i firewall, dispongono di tali pagine, sebbene di solito siano su HTTP. Sebbene la sessione HTTP sarà crittografata TLS, anche le intestazioni e l'associazione delle chiavi possono rivelare informazioni. In questo esempio è visibile un firewall mGuard della Innominate Security Technologies. L'mGuard è un firewall industriale comune negli ambienti produttivi, soprattutto in Europa.

© 2021 Robert M. Lee 75
 15
 Telnet e FTP
 I banner su Telnet e FTP riveleranno informazioni quali nomi di prodotti, marche, modello, firmware e numeri di serie
 Informazioni sulla lunghezza
| 400, 06:09224,060367 192.168,08.49 121 Rispostat 228 AXIS 266 Rete Comera 4.40
:14.989177 192.168.88. 88 Risposta: 221 Arrivederci. 480 06:09:14. 995427 192.168.88.25 138 Risposta: 220 socket FIP ​​v7.18 (Revisione +
 Frame 480663: 121 byte su cavo (986 bit), 121 byte accettati (968 bit) Ethernet II, Src: AxisComm_7F:0b:be (00:40:8c:7F:Ab:bc), Ost: Westermo 12:61: 83 (08:07:7c:1a:61:83)
> Protezione Internet versione 4, Src: 192.168.58.49, Dst: 192.168.2.64
¥ Teansaission Control Protocol, Porta Src: 21, Porta Ost: 51623, Seq: 1, Ack: 1, Len: 55 File Transfer Protocol (FTP) Y 220 AXIS 206 Network C 4.48 (28 giugno 2086) pronto.\r\n Codice di risposta: servizio pronto per il nuovo utente (228)
 S3833 + 23 [Ax] Seq. Acl
 Segui flusso TCP (flusso TCP eq 25572)
 secavei FO. (23
 Switch per dispositivi Ether MOXA £ 05-50HA

| Tipo terminale console (12 onsifvttee, 2+ vt52) ¢ 1

$08n.(4;19eeme ; .[4;39Hetanaged Redundant switch 04759.[5:2MLocatLon : .[5;3ewItch Locacion.[7519MPirmare Version : .[7:29HVI.0 butld 21871826. [8;19HSertal
[9139N392.168-88.60.[30;290AC Indirizzo: .[10;39H0@-9@-E8-26-40-23.[@}39404759. [225 20H6-~ ceceesensenenannnte[43}20H) (13550) (145208) (24) 508]
 SU. (13520H

{UaBaaWAconto + -(14;22HPaseword ¢ (19539, (145334
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Sia Telnet che FTP sono molto comuni in I.C.S. ambienti, in particolare su controller come PLC e RTU. Quando ingegneri/operatori accedono all'apparecchiatura tramite questo protocollo, è possibile utilizzare un'acquisizione di pacchetti per analizzare i banner ed estrarre informazioni significative. Ad esempio, lo switch Moxa a cui si accede tramite Telnet in questa schermata mostra marca, modello, versione firmware, numero di serie e indirizzo MAC del dispositivo.
 Fonte Pcap: 4I.C.S.-GeekLounge
 76

© 2021 Robert M. Lee
 76
 nnnnnewnkewenewwnewnmewmeé®we*@ewTwnewn#ewewws#seesen @
 ome @ 56» vee Ye we ueuewke Fb weweeteweihikb & b&w
 Oh &
 Laboratorio 2.2 I.C.S. Analisi del traffico
 Raffineria di Calistoga |
 I.C.S.S15 | I.C.S. Visibilità, rilevamento e risposta 7
 

© 2021 Robert M. Lee
 Obiettivi dello scenario del corso (2)

* Raffineria Calistoga e Quali sono i nomi e gli IP delle postazioni Operatore (HMI/EWS/Historian)
 10.10.10.10 — VIEW-DESIGNER (Visualizza Designer)
 10.10.10.20 — FACTORY-TALK-VI (Vista Factory Talk)
 10.10.10.30 —- ENG_WORKSTATION (Studio 5000 Logix Designer) 10.10.10.40 — FACTORY-TALK-HI (Factory Talk Historian)
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

"
 78 © 2021 Robert M. Lee ee noi & Vwe noi noi eewewwevwewseweeeeww#e ww wow w
 Ve
 ve
 Obiettivi dello scenario del corso (3)

¢ Raffineria di Calistoga Un minerale
 Qual è la marca e il modello del 10.10.20.10? Qual è l’indirizzo IP e il dominio dell’avversario? Qual è il nome del file di progetto dannoso? Cosa ha fatto l'avversario al PLC di sicurezza?
* Qual è la routine dannosa nella logica e cosa fa?
* Qual è la causa principale dell'attacco?
+ L’incidente è collegato all’incidente di C3PO?
¢C3PO:
* Creare una topologia della rete di controllo.
* Qual è l'azione dannosa sull'HMI?
* Quale registro è stato manipolato con quale valore?
* Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.SI5 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 79 Caso di studio: ransomware e
 Prevenzione dell'atrofia
 I.C.S.SIS | I.C.S. Visibilità, rilevamento e risposta n. 0
 
 80 © 2021 Roberto M.Lee

("2
 DDD DRRODR DR O& Bm MR MMMM mEm a a
 noi §& |e §& Sw Sw ww noi noi Ye noi VE noi noi ww

_->-—ormdmdmULwWDrU
 Il ransomware e la sua evoluzione
 Ransomware tradizionale Ransomware operato dall'uomo
 Accelerato nel 2016+
 Mirato (gli esseri umani violano il dominio . company e poi lo distribuiscono)

¢
 Utilizzo della criptovaluta e
-pagamenti multimilionari
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Il ransomware esiste da decenni in varie forme. Per molti anni è stato considerato un fastidio. Gli utenti riceverebbero e-mail di phishing, farebbero clic su di esse, il malware entrerebbe nel sistema e crittograferebbe i file, quindi dovresti chiamare un numero per contattare l'avversario per ottenere istruzioni di pagamento e una chiave di crittografia.
 I riscatti variavano solitamente da poche centinaia di dollari a poche migliaia, arrivando infine alla fascia di $ 20-50.000 USD. C'era pressione sull'avversario (fondi tracciabili, tabulati telefonici, e-mail, ecc. per le forze dell'ordine) e non molta sulla vittima (alcuni file casuali venivano crittografati, a volte preziosi, a volte per niente).
 Ciò che è iniziato ad accadere tra il 2010 e il 2016 è stato che gli avversari hanno iniziato a utilizzare di più criptovalute come Bitcoin, il che ha portato a una minore pressione su di loro e ha fornito loro un meccanismo per avere più anonimato nei loro pagamenti. L’aumento dell’utilizzo della criptovaluta ha fatto sì che più vittime potessero pagare in criptovaluta. Ancora più importante, però, gli avversari hanno iniziato a rendersi conto, soprattutto nel periodo 2016-2020, che avrebbero potuto irrompere nelle aziende stesse prima di distribuire il ransomware. In questo modo, potevano prendere di mira i sistemi e i file giusti che significavano di più per l’azienda, aumentando così il tasso di estorsione che potevano richiedere. I pagamenti hanno iniziato a variare da $ 50.000 a milioni di dollari. L’aumento della forza lavoro connessa durante la pandemia di COVID19 ha significato ancora più obiettivi. L’aumento dei pagamenti ha fatto sì che ancora più criminali si unissero agli sforzi e, alla fine, il ransomware è diventato, e rimane, una preoccupazione significativa per molte organizzazioni.

© 2021 Robert M. Lee 81
 Ransomware in I.C.S.

¢ Esiste da decenni ma, a causa del ransomware operato dagli esseri umani, i worm ransomware hanno avuto un impatto incredibile a partire dal 2017

*Il 2018-2020 ha visto un aumento del 500%.

° Le aziende manifatturiere rappresentano 1/3 degli attacchi informatici di Merck
 di tutti gli attacchi conosciuti 1,3 miliardi di dollari Domanda: è stato un atto di guerra? Io Ly 1 re
 D
 e Gli avversari hanno appreso che prendevano di mira I.C.S. le operazioni hanno portato a pagamenti più elevati e più rapidi
 I.C.S.S15 | I.C.S. Visibilità, rilevamento e risposta
 Si sono verificati casi di ransomware in I.C.S. da quando esiste il ransomware, compresi casi estremamente gravi di perdita di produzione e guasti agli impianti. Tuttavia, è nel 2017 che tutto inizia ad accelerare davvero per l’I.C.S. comunità con i worm WannaCry e NotPetya che hanno annientato aziende di alto profilo come Merck, Maersk e FedEx nelle loro reti operative industriali. Ma molti più casi non sono stati segnalati, rappresentando dozzine se non centinaia di casi di ransomware in I.C.S. in vari settori, soprattutto manifatturiero.
 Secondo una ricerca di Dragos e IBM, gli attacchi ransomware contro entità industriali nel periodo 2018-2020 sono cresciuti di oltre il 500%. Un terzo di questi casi riguardavano aziende manifatturiere.
 I gruppi di ransomware hanno iniziato a rendersene conto, prendendo di mira il sistema I.C.S. reti di queste società, che le società pagherebbero più prontamente e pagherebbero pagamenti più elevati a causa dell’impatto sul business.
 Riferimento:
 Ransomware in I.C.S. Ambienti - Dragos 2020.pdf https://www.bloomberg.com/news/features/2019-12-03/merck-cyberattack-s- | -3-miliardi-di-domanda-era-un-atto-di-guerra
 82 © 2021 Robert M. Lee
 92
 ni @ ® © ® HH OH OW DW WH OH OH OH OO DH w
 su FM

"
 mm ©” ” S&S S S&S SY |S &Y ww noi & &w ww Ww WwW

»v ww w ww
 I.C.S. Ransomware personalizzato
 pritpengine.exe Correlato a Proficy
¢ EKANS è stato il primo I.C.S. |resevaree Biatcy Secure Gateway ransomware su misura era prlicensemgr.exe Proficy License Server Manager scoperto a gennaio 2020 imadensemecid aa
° Sesto I.C.S. malware su misura pohcypublshenenice minerale Profiey correlati | famiglia mai proficyserver.exe Proficy Server Proficysts.exe se correlato a Proficy
* Elimina I.C.S. relativo sistema = [Pr"""** roto Ras
. prproficymgr.exe Proficy Piant Applicazioni servizi/processo: es prrds.exe Proficy Remote Data Service prreader.exe Proficy Historian Servizio di calcolo dei dati
* Targeting indicato verso |*“** —
° . prschedulemgr.exe Proficy correlato I.C.S. tra i criminali —— “Tamera psummarymer.exe Proficy Related
 Il 2020 ha visto il primo I.C.S. famiglie di ransomware personalizzate. Tutto è iniziato con EKANS, responsabile di numerosi casi di ransomware nella comunità, tra cui la chiusura forzata di alcune fabbriche della Honda e del Gruppo Enel, e numerose compromissioni non divulgate.
 EKANS è una famiglia di ransomware scritta nella lingua Goland, con una serie di processi di sistema che si blocca in caso di infezione. Si va dalla routine, come gli antivirus, ai processi e servizi specifici del settore industriale.Secondo un rapporto dell'intelligence di Dragos, l'I.C.S. i processi correlati interessano un'ampia gamma di componenti industriali tra cui ThingWorx, GE Fanuc, Honeywell HMIWeb, un numero significativo di servizi Proficy e processi SQL comuni relativi agli storici di uso comune.
 Riferimento: TR-2020-41_Analysis_of EKANS_Ransomware.pdf

© 2021 Robert M. Lee 83 Prevenzione dell'atrofia

* Gli impatti dei ransomware gestiti da esseri umani spesso riguardano meno le e-mail di phishing e molto più le vulnerabilità esposte, la mancanza di controlli preventivi implementati/mantenuti in modo uniforme e una scarsa pianificazione
 Parti significative di tutti gli standard/regolamenti sono incentrate sulla prevenzione
* NERC CIP: 70% di prevenzione e 30% suddiviso tra rilevamento/risposta/recupero
*NIST 800-53: prevenzione del 95%.
* TEC-62443: prevenzione del 75-100% (standard multipli)
 Senza visibilità, la prevenzione viene applicata in modo non uniforme o non mantenuta
 Una così scarsa attenzione al rilevamento, alla risposta e al ripristino comporta un pregiudizio preventivo che, quando fallisce, lascia le organizzazioni molto vulnerabili
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 4
 L’atrofia della prevenzione si verifica quando i controlli preventivi non sono ben mantenuti nel tempo. Le organizzazioni spesso si concentrano fortemente sui controlli preventivi (soprattutto perché i vari standard/regolamenti industriali hanno spinto le persone in quella direzione) con pochissima attenzione o investimenti nei controlli di rilevamento, risposta e ripristino. Ma senza visibilità e rilevamento, è molto difficile determinare se i controlli preventivi vengono applicati in tutto l’ambiente e se vengono mantenuti. È estremamente comune nei casi di risposta agli incidenti scoprire che i controlli preventivi
 a ® DH fF TF TFT OO BH O&
 le organizzazioni che si sentivano fiduciose stanno restituendo molto meno valore nel tempo, a causa dell’atrofia che poi porta a casi di ransomware o peggio.
 Riferimento: https://www.dragos.com/blog/correcting-prevention-bias-in-your-ot-cyber-incident-response/
 84

© 2021 Robert M. Lee
 oo ov ® WW WB BW W
 eo@
 ef @

»
 w WV WS VS SS SS Ww Ww Ww Ww WS WwW Ww WwW WwW W Ww Ww
 Visibilità

[ T
; TYP del Prati 1 F —

— == così
 Aree di interesse |
 Sistemi
 I.C.S.S15 | I.C.S. Visibilità, rilevamento e risposta
 La visibilità può aiutarti a prevenire l'atrofia aiutandoti a ottenere un inventario e una topologia più completi (come le cose si collegano). Dovresti cercare di assicurarti di avere l'architettura che pensi di avere (ad esempio, nessuna comunicazione Internet diretta). Dovresti anche assicurarti di rilevare non solo le minacce e i relativi TTP, ma, per prevenire l’atrofia, di rilevare i sistemi di protezione degli endpoint, i dispositivi di sicurezza, ecc. attraverso il loro traffico di rete. Spesso puoi scoprire quando gli endpoint non ricevono aggiornamenti tramite ricerche di domini e perdita di connettività. Potresti scoprire che un sistema antivirus Symantec emette segnali quando non viene aggiornato regolarmente ai domini Symantec, indipendentemente dal fatto che possano connettersi o meno. Inoltre, dovresti identificare i dispositivi chiave che sono i tuoi "dispositivi periferici" come firewall, punti di accesso remoto e Historian che fungono da accesso alle reti I.C.S./OT, comprendere le vulnerabilità presenti e risolverle rapidamente attraverso patch o controlli di compensazione .
 La tua active directory/controller di dominio è spesso una "autostrada per l'inferno" dall'IT all'OT e in molti incidenti l'infrastruttura AD condivisa porta a un impatto significativamente maggiore sulle operazioni.

© 2021 Robert M. Lee 85
 COME
 I.C.S. Protocolli
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta _ come
 
 86 © 2021 Robert M. Lee
 Carichi utili del protocollo

¢ Valore:
¢ Identificare le risorse affrontate negli strati superiori del modello OSI
* Identificare i payload contenuti all'interno di protocolli come DNP3 e ​​Modbus TCP
* Fonte:
* I dissettori Wireshark contengono breakout di protocollo per molti comuni I.C.S. protocolli; molti dei payload dei protocolli contengono I.C.S. informazioni sull'indirizzo

¢ Metodologia:
* Escludere i protocolli IT
* Identificare l'I.C.S. protocollo in uso (Utilizza gerarchia protocolli per una visualizzazione rapida)
* Mappa il protocollo utilizzando informazioni open source, Wireshark o la documentazione del fornitore
* Registra risorse senza indirizzo IP sul diagramma di rete
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 47
 La maggior parte delle risorse IT tradizionali può essere identificata quasi interamente ottenendo l'indirizzo MAC, l'indirizzo IP e le porte aperte. [I.C.S. collegato a P le risorse spesso hanno risorse aggiuntive a cui sono collegate che fanno affidamento su di esse. Ad esempio, un controllore di processo avrà I/O che potrebbero essere apparecchiature operative, come turbine o sensori di pressione. Inoltre, I.C.S. le risorse potrebbero utilizzare più protocolli l'uno all'interno dell'altro. Questi payload del protocollo sono utili per identificare il tipo di comunicazione in corso e se sono presenti I/O identificabili.
 Wireshark può essere utilizzato per visualizzare questi payload del protocollo, ma solo se è già stato scritto un dissettore. Ripensa a quando abbiamo discusso dei livelli di protocollo IP e TCP in Modbus TCP.L'unico modo in cui Wireshark può analizzare il traffico per determinare se un protocollo è IP è avere un dissettore scritto per il protocollo IP. Il dissettore IP è scritto in modo da sapere che ci sarà un protocollo UDP o TCP (seguendo il modello OSI) trasportato dal protocollo IP. Il dissettore IP esamina il pacchetto IP e si reca nella posizione corretta nel pacchetto per vedere quale flag è impostato; in IP il flag 0x06 viene impostato quando TCP è il carico utile. Pertanto, quando Wireshark analizza il pacchetto, vede il flag 0x06 e quindi utilizza il dissettore TCP per analizzare il livello successivo. Questo stesso processo si applica a I.C.S. protocolli, ma spesso ci sono più livelli in un sistema I.C.S. protocollo. Possono esserci interi set di protocolli incorporati nel carico utile di altri protocolli. Ciò significa che se identifichi un I.C.S. protocollo utilizzato per il trasporto (come EtherNet/IP), è necessario cercare protocolli aggiuntivi al suo interno. Ad esempio, il Common Industrial Protocol (CIP) viene trasportato tramite EtherNet/IP e contiene un frame di intestazione e un frame di carico utile. L'intestazione contiene informazioni sulla richiesta e sulla risposta, mentre il payload contiene i dati effettivi. Dal punto di vista dell'identificazione delle risorse, è utile sapere che il sistema utilizza CIP e quale tipo di informazioni di intestazione fa parte della baseline. I dati del carico utile possono essere utilizzati anche come riferimento, ma poiché è più probabile che siano proprietari e cambino nel tempo, possono richiedere troppo tempo senza il supporto di fornitori o tecnici.
 È importante notare che alcuni dissettori in Wireshark e altri strumenti guardano principalmente al numero di porta della rete
 determinare cos'è un protocollo. Ad esempio, un dissettore scritto male esaminerebbe il traffico e determinerebbe che se viene inviato alla porta 502, sarà Modbus TCP. Il dissettore non elaborerà i dati correttamente e potrebbero verificarsi degli errori.

© 2021 Robert M. Lee 87
 Metodologia
 I dissettore del protocollo Wireshark per le risorse IT sono ben documentati e affidabili. Inoltre con l'indirizzo MAC e IP nonché il numero di porta per le risorse IT è possibile tracciare un buon diagramma di rete. Comprendere i vari servizi in esecuzione su queste risorse è importante, ma per i diagrammi di rete sono sufficienti le informazioni sugli indirizzi e sulle porte. Per l'I.C.S. asset, tuttavia, i dissettori di protocollo possono essere meno affidabili. Il personale di difesa attivo dovrebbe utilizzare Wireshark per identificare l'I.C.S. protocolli ed esaminarli per garantire che il dissettore abbia identificato completamente tutto il traffico o per determinare se è necessario un altro dissettore. Un modo rapido per farlo è utilizzare Wireshark e andare in Statistiche dove si trovavano le opzioni Endpoint e Conversazioni. Invece, fai clic su Gerarchia protocolli. Da lì individuare l'I.C.S. protocollo che desideri esaminare ulteriormente (o eventuali protocolli non identificati) e fare clic con il pulsante destro del mouse sul nome del protocollo. Quindi seleziona l'opzione Applica come filtro e scegli Selezionato. Ciò ripristina la visualizzazione dei pacchetti di Wireshark filtrando però ogni altro protocollo. Quindi il pacchetto può essere visualizzato per intero per determinare se sono già disponibili informazioni di I/O e di indirizzi non IP o se sono presenti protocolli aggiuntivi che non vengono analizzati. Se sono presenti protocolli aggiuntivi non riconosciuti, utilizza le tue conoscenze di rete, persone che hanno familiarità con i sistemi o il fornitore per documentare il protocollo e scrivere un dissettore Wireshark interno e personalizzato. Se è disponibile un indirizzamento non IP, registrare tali risorse nel diagramma di rete.
 Wireshark dispone di buoni dissettori per EtherNet/IP, DNP3, Modbus TCP, PROFINET, ISO-TSAP e pochi altri. Tuttavia, i carichi utili all’interno di questi protocolli hanno meno probabilità di avere dissettori.
 88 © 2021 Robert M. Lee
 7”,
 7, 7T eR RR RR DRDR RDB MMH HM H HH ww
. 7 e.e. eee
 ww ss w
 Breakout Modbus TCP

© Ethernet II, Src: Hewlett-e0:02:5e (78:e7:d1:e0:02:5e), pst: ETau_02:58:b7 (00:04:17:02:58:07) F Protocollo Internet versione 4, Src: 141.81.0.10 (141.81.0.10), Ost: 141.81.0.86 (141, 81. 0.86)
© Protocollo di controllo della trasmissione, Porta Src: 57184 (57184), Porta Ost: asa-app]-proto (502), Seq: 1, Ack: 1, Len: 12
© Identificatore della transazione Modbus/TCP: 0
 Identificatore di protocollo: 0 Lunghezza: 6 Identificatore di unità: 255
© Codice funzione Modbus: Lettura registri di ingresso (4) Numero di riferimento: Conteggio 2258 parole: 2
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta a2
 Modbus TCP ci fornisce un buon esempio di come esaminare I.C.S. protocolli. È un protocollo di facile comprensione e definito in modo aperto. In questo esempio, puoi vedere che Modbus TCP ha un identificatore di transazione, un identificatore di protocollo, una lunghezza e un identificatore di unità. Quindi, contiene dati aggiuntivi identificati come carico utile. Il livello successivo è denominato Modbus e mostra il codice funzione, il numero di riferimento e il conteggio delle parole. L'esame di questo singolo pacchetto può aiutarci a comprendere l'I.C.S. risorsa. Nella maggior parte dei casi, Modbus TCP viene utilizzato per comunicare con un controller connesso a I[P.L'indirizzo IP è solitamente l'ultimo bit di indirizzamento di cui dovresti preoccuparti e in questo esempio vediamo l'identificatore unitario impostato su 255, che è lo standard. Questo ID unità 255 ci consente di sapere che non ci sono altri dispositivi seriali collegati a questo dispositivo connesso tramite IP. Tuttavia, se l'identificatore dell'unità non fosse 255 o 0, vorremmo determinare se erano presenti dispositivi seriali collegati al client. Non è comune vedere dispositivi seriali collegati in questo modo, ma può succedere e mostra un esempio di come possa essere utile ispezionare e comprendere i protocolli sulla rete. Dopo aver determinato che un identificatore di unità non è 255 o 0, il modo migliore per procedere sarebbe utilizzare altre informazioni disponibili sull'architettura di rete e quindi eseguire un'ispezione fisica per verificare che siano presenti risorse seriali collegate. In questo caso, per convalidare la scoperta verrebbe utilizzata l’ispezione fisica, poiché non si tratterebbe di un evento comune. Tuttavia, se sai già attraverso buone mappe dell'architettura di rete che un dispositivo seriale dovrebbe essere collegato qui, potresti eliminare la necessità di eseguire l'ispezione fisica e avere la certezza che l'analisi del traffico ha convalidato la mappa dell'architettura di rete.

© 2021 Robert M. Lee 89 I.C.S. Protocolli
 ea)
@
- &@@ °, Identifica e Qualche dozzina di f the

“maggiore” I.C.S. protocolli di protocollo e
 250+ I.C.S. e protocolli

"normale"
 Utilizzano numeri di porta. La maggior parte sono univoci e utilizzati nella maggior parte dei settori e proprietari dei settori e sono sistemi per determinare sistemi specifici dei principali attori del protocollo e quindi stabilire una base per il suo utilizzo
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Esistono centinaia di I.C.S. protocolli del settore, ma la maggior parte sono proprietari e distinti per sistemi o clienti specifici. Esistono alcune dozzine di protocolli “principali” che puoi aspettarti di incontrare, come BACnet, DNP3, Modbus TCP, EtherNet/IP, OPC e ISO-TSAP. Questi verranno trattati nelle prossime diapositive. Non è necessario conoscere ogni protocollo. In molti casi, anche conoscere lo stack del protocollo non aiuta poiché le implementazioni del protocollo possono variare in base al fornitore e alla risorsa. Tuttavia, è utile essere in grado di identificare questi protocolli quando possibile e determinare cosa significa "normale" per quell'I.C.S..
 Spesso è molto fattibile determinare il protocollo capendo in quale settore operi (come quello elettrico).
 generazione rispetto a gasdotti), i tipi di sistemi utilizzati (ad esempio un ambiente SIMATIC rispetto a un DCS Honeywell) e identificare i numeri di porta utilizzati.
 90 © 2021 Robert M. Lee
 Q ® ® DW DW DP OP GH ww
 eo

® @®@ @ @ Df DD DMD ®

?,
 77 ? Frame 164: 103 byte in linea (624 bit), 103 byte catturati (824 bit)
@) Ethernet II, Src: Rockwell_a4:01:96 (00:1d:9c:a4:01:96), Ost: CadmusCo_2a:21:33 (08:00:27:2a:21:33)
#4} Protocollo Internet versione 4, Sr 172.16.1.30 (472.16.1.30), Dst: 172.16.1.10 (172.16.1.10) 4] Protocollo di controllo della trasmissione, porta sre: dnp (20000), porta Dst: 49315 (49315), Seq: 18, Ack: 34, Len: 49
©) Protocollo di rete distribuito] 3.0
© Data Link Layer, Len: > Da: 1, A: 3, PRM, Dati utente non confermati Byte di avvio: 0x0564 Lunghezza: 38 f@ Controllo: Ox44 (PRM, Dati utente non confermati) Destinazione: 3 Origine: 1 crc: 0xi4c8 [ corretto]
® Strato di trasporto: Oxc3 (FIR, FIN, sequenza 3)
/ Livello applicazione: (FIR, FIN, sequenza 2, risposta) Controllo f: Oxc2 (FIR, FIN, sequenza 2) Codice funzione: risposta (0x81)
@ Indicazioni interne: (0x0000)
| RISPOSTA Oggetti dati
® Oggetto/i: input binario a bit singolo (Obj:01, var:01) (0x0101), 16 punti
® Oggetto/i: stato uscita binaria (Obj:10, var:02) (0x0a02), 16 punti
 Spesso sulla porta TCP 20000
 Utilizzato principalmente nell'industria elettrica, a volte nell'acqua e raramente anche negli ambienti SCADA dei gasdotti Stack di protocolli abbastanza comune con più riferimenti online per quanto riguarda i codici funzione utilizzati
 Protocollo a livello di dispositivo (configura dispositivi, scambia dati, comunica dalla supervisione al PLC)
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 9!
 Il DNP3 si trova più comunemente nei servizi elettrici e idrici. Funziona in una configurazione master/slave e originariamente era un protocollo seriale. È stato portato su IP su TCP o UDP (comunemente visto su TCP). Di solito all'interno di DNP3 sono presenti dati specifici del fornitore che dovrai collaborare con il fornitore per comprendere, ma puoi identificare il livello di collegamento dati, il livello di trasporto e il livello di applicazione come mostrato nella diapositiva. Il livello dell'applicazione contiene informazioni come il codice funzione.
 I codici funzione identificheranno ciò che sta accadendo, ad esempio: Leggi: 1
 Scrivi: 2
 Avviare l'applicazione: 11
 Interrompere l'applicazione: 12
 Configurazione slave: 13
 Risposta non richiesta: 81

© 2021 Robert M. Lee 91
 IEC 60870-5-104 (IEC-104)
 Frame 24: 70 byte su cavo (560 bit), 70 byte catturati (560 bit) Ethernet Ir, src: Asustekc_56:0b:54 (00:22:15:56:0b:54), Ost: ZatAS_00:09:05 (00:16:01:00:09:05) Protocollo Internet versione 4, origine: 10.20. (10.20.102.1), Ost: 10.20.100.108 (10.20.100.108) protocollo di controllo varauission, Src Port: 46413 (46413), Ost Port: 1ec-106 (2404), Seq: 79, Ack: 1525, Len: 16
 EC 60B70-5-104-Apci: <- I (3,36) rad 0 = Tipo: T (0x00)
 asdu: ASDUSLO C_SC_NALU Act TOAS3 “comando singolo” 0 = causeTx: act (63

. = Negativo: Falso
= Prova: falso
 2 1030 fF 40 30 77 00 00 68 Oe 0040 0a 00 Od 00 00 OL
 Spesso sulla porta TCP 2404 (può anche essere sulla 2405 se due master sono sulla stessa rete)
 Ampiamente utilizzato nel settore SCADA dell'energia elettrica per informazioni, monitoraggio e controllo dell'energia
 L'Application Protocol Data Unit (APDU) è suddivisa in Application Protocol Control Information (APCT) e Application Service Data Unit (ASDU) dove l'ASDU contiene l'Information Object Address (IOA)
 I.C.S.515 | |Visibilità, rilevamento e risposta CS
 Lo standard IEC 60870-5-104 fa parte della più ampia raccolta di protocolli IEC 60870. Nello specifico si tratta della versione TCP/IP del protocollo seriale 60870-5-101. I dati del livello di applicazione in ciascuno sono gli stessi. L'unica differenza sta nel trasporto dei dati. Questo protocollo si trova comunemente nel settore dell'energia elettrica, soprattutto negli ambienti SCADA. Viene utilizzato per raccogliere informazioni, come monitorare la potenza e apportare modifiche al controllo attraverso la rete. Il protocollo può supportare una varietà di richieste come il riavvio remoto di un dispositivo, la modifica della configurazione, la modifica dei setpoint e, in generale, la lettura di dati e informazioni dai sistemi.
 92 © 2021 Robert M. Lee
 eo @ @ @ @® @® ®7 Wf ff @ WwW fF MW OW WO HW OH PW
 7®
 mm @ ® ww w Ww
 w
 Classe OPC
 i Frame 13579: 214 byte sul cavo (1712 bit), 214 byte catturati (1712 bit) sull'interfaccia 0
@ Ethernet II, origine: Vmware_97:df:86 (00:0c:29:97:df:86), Dst: Vmware_ec:4a:41 (00:0c:29:ec:4a:41)
@ Protocollo Internet versione 4, Src: 10.25.22.103 (10.25.22.103), Dst: 10.25.22.100 (10.25.22.100) f Protocollo di controllo della trasmissione, Porta Src: danf-ak2 (1041), Porta Dst: rsf-1 (1195 ), Seq: 82321, Riconoscimento:
(@ Ambiente di calcolo distribuito/Chiamata di procedura remota (DCE/RPC) Risposta, frammento: Singolo, versione Fr: 5 ‘ versione (minore): 0 Tipo di pacchetto: Risposta (2) Flag di pacchetto mH: Ox03
) Rappresentazione dei dati: 10000000 Lunghezza frammentazione: 160 Lunghezza autenticazione: 0 Ip chiamata: 2868 Suggerimento alloc: 136 Ip contesto: 4 Conteggio annullamenti: 0
*® [Nessuna informazione di collegamento per questa interfaccia ID contesto - l'acquisizione inizia troppo tardi?] dati stub (136 byte)

¢ Spesso richiede numerose porte aperte per essere utilizzate appieno
¢ Utilizzato nella maggior parte dei settori e si trova comunemente collegato agli storici dei dati sulla rete
* OPC Classic si basa su DCE/RPC e quindi l'identificazione può aiutare a identificare le comunicazioni OPC
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 3
 OPC classic, come abbiamo già discusso in classe, è un traduttore universale nell'ambiente operativo per sistemi di diversi fornitori che non sono stati progettati per funzionare insieme. L'OPC verrà implementato in vari modi, a seconda del sito e di come è progettato, rendendo così più difficile comprendere veramente l'OPC in classe rispetto a come viene implementato nel proprio sito. Tuttavia, ci sono alcune intese e considerazioni comuni che possono essere esplorate e dovrebbero essere comprese.
 OPC è pensato per posizionarsi tra il "data sink" e la "data source". La sorgente dati sarebbe qualcosa come un PLC, mentre il dissipatore dati sarebbe qualcosa come un HMI. OPC garantisce che i dati possano essere scambiati tra questi due (Data Sink e Data Source) senza che sia necessario che comprendano il protocollo proprietario che ciascuno potrebbe utilizzare.
 Talvolta l'OPC viene configurato sulla porta TCP 135 ma, come mostra la figura nella slide, non è sempre così. Ciò che è comune è l'uso dell'ambiente informatico distribuito/chiamata di procedura remota (DCE/RPC). Identificarlo nell'ambiente può aiutare a identificare le comunicazioni OPC. Non sarà sempre OPC, ma è una buona indicazione, soprattutto se non utilizzi questi protocolli nel tuo I.C.S. normalmente.
 Buone guide iniziali:
 https://www.moxa.com/en/support/product-support/software-and-documentation https://www.automation.com/pdf_articles/Guide_to_OPC.pdf

© 2021 Robert M. Lee 93 ISO-TSAP
 i Telaio 47617; 62 byte su cavo (496 bit), 62 byte catturati (496 bit) jp Ethernet IZ, Src; 42:73:63:61:64:61 (42:73:63:61:64:61), Dst: Siemensn_10:94:41 (00:1¢:06:10:94:41) i® Protocollo Internet versione 4, Src: 172.16.4.10 (172.16.4.10), Dst: 172.16.4.30 (172.16.4, 30)
» Protocollo di controllo della trasmissione, Porta src: 51485 (51485), Porta Dst; iso-tsap (102), Seq: 60628, Ack: 234057, Len: 7 jo TPKT, Versione: 3, Lunghezza: 7
| versione: 3 Riservato: 0 Lunghezza: 7 3) IS0_8073/x. 224 COTP Protocollo di trasporto orientato alla connessione Lunghezza: 2 PDU Tipo: DT Data (Ox0f)
[Riferimento destinazione: 0x18c0000}
-000 0000 = Numero TPOU: 0x00 O... seve = Ultima unità dati: nessun dato del segmento COTP (0 byte)

¢ Configurato per la porta TCP 102
* Serve come protocollo portante per ICCP (generazione elettrica) o S7 (protocollo Siemens)
* Il "blob di dati" è la comunicazione ICCP o S7 ed è altamente proprietario
 1CS515| I.C.S.Visibilità, rilevamento e risposta 94
 ISO-TSAP è un protocollo interessante e viene utilizzato in un paio di luoghi: principalmente come protocollo che supporta il protocollo $ 7 di Siemens e ICCP. Sia ICCP che $7 vengono visualizzati sulla porta 102 perché utilizzano ISO-TSAP. All'interno di ISO-TSAP, il blocco dati deve essere suddiviso per determinare (esclusivamente dal pacchetto e senza contesto ambientale) se il protocollo è $7 o ICCP. L'inversione di questi protocolli va oltre lo scopo di questa lezione e dovrebbe essere eseguita con il supporto del fornitore. Tuttavia, è importante essere in grado di comprendere e identificare ISO-TSAP.
 ISO-TSAP è la combinazione di TPKT e COTP (Connection-Oriented Transport Protocol). TPKT è un modo per prendere COTP e inserirlo all'interno di TCP.
 COTP è un protocollo basato su ISO (la maggior parte dei documenti e degli standard ISO devono essere acquistati). COTP è basato su ISO 8073 ed è pensato per essere simile a TCP. La differenza tra questo e TCP è che TCP è pensato per essere un flusso continuo di dati mentre COTP è pensato per essere "pacchetti" di dati, ma comunque basati sulla connessione a differenza di UDP. Tuttavia, posizionare COTP all'interno di TPKT, che viene eseguito su TCP, sembra un po' controintuitivo. La parte TSAP del protocollo è il blob di dati stesso (TSAP sta per Transport Service Access Point). Quel blob di dati lo farà spesso
 essere S7 o ICCP in I.C.S. ambienti.
 Allora perché ISO-TSAP viene messo su TCP se l'intenzione era quella di sostituire TCP? Senza conoscere l'intenzione originale degli sviluppatori, sembra evidente che la funzionalità di flussi continui di dati fosse desiderata da TCP, ma TCP non supporta il tipo di indirizzamento possibile in TSAP. È stato un tentativo di sfruttare la funzionalità di entrambi
 I.C.S. ambienti. Riferimento:
 https://wiki.wireshark.org/TPKT https://wiki.wireshark.org/COTP
 94 © 2021 Robert M. Lee
 rT DP ® DP DPD DM OH ww
 oro@® @®@ & H BD®
 oo fo ff @ &@ @ ® ea

«Sii un.»
 ww BS &S Bw Bw BS Ww |W WwW WS WO WS WwW Ww Ww
 S7COMM
 Tne Sorgente Destinazione 33 96:00:03.952501 192.168.1.10 197.268.1.48 192.268.1.49 192.168.1.18 192.268.1.40 192.168.1.48 192.168.1.10
 Protocollo di controllo della trasmissione, porta Sre: 4185, porta Ost:
"TPKT, versione: 3, lunghezza: 31 150 8073/X.224 Protocollo di trasporto orientato alla connessione COTP
[2 segmenti COTP (2 byte): #33(@), #36(24)] Intestazione Y comunicazione S7: (Userdate) Protocol Ed: x32 ROSCTR: Userdata (7) Identificazione ridondanza (riservata): @x0008 Unità dati protocollo Riferimento: 2626 Lunghezza parametro: 6 Lunghezza dati: 6 Y Parametro: (Richiesta) ->(Funzioni nere) ->{Elenco blocchi di tipo) Intestazione parametro: ox000112 Lunghezza parametro: 4 Metodo (Richiesta/Risposta): Req (@x11 ) 100 .... = Tipo: Richiesta (4) ss+e 0811 # Gruppo funzioni: Funzioni blocco (3} Sottofunzione: Elenco blocchi di tipo (2) Numero progressivo: © Dati Y: (08) Codice di ritorno: Successo ( Oxff) Dimensioni di trasporto: OCTET STRING (8x09) Lunghezza: 2 Tipo di blocco: @8 (08)
 Sequenza:
 Info lunghezza 61 DT TPOU (@) [frammento COTP, @ byte) 85 ROSCTR: [Dati utente] Funzione:(Richiesta] -> [Funzioni blocco] -> [Elenca blocchi di tipo] Tipo:[08] 91 ROSCTR:[Dati utente ] Funzione: [Risposta] -> [Funzioni di blocco] -> [Elenca blocchi di tipo] 61 OT TPOU (@) [COTP fragnente, @ byte] 91 ROSCTR:[Dati utente] Funzione:[Richiesta] -> [Funzioni di blocco] -> (Ottieni informazioni sul blocco} -> Slock:(08 1) 87 ROSCTR: [Dati utente] Funzione: [Risposta] -> [Funzioni del blocco) -> [Ottieni informazioni sul blocco] -> Codice errore:(@x4209]
 359, Ack: 758, Len: 31
 S7 è un protocollo proprietario Siemens che sfrutta
 ISO-TSAP
 Protocollo a livello di dispositivo per connettere le workstation ai PLC
* Da master/client (PC) a campo/server (PLC)
 Scopo: Programmazione di PLC, Scambio di dati
 tra PLC e Accesso ai dati PLC da
 Sistemi di supervisione
 Utilizzato principalmente con la famiglia di PLC Siemens $ 7-300/400
 I.C.S.S15 | I.C.S. Visibilità, rilevamento e risposta
 S7, o S7COMM, è un protocollo proprietario Siemens che sfrutta ISO-TSAP/COTP per la comunicazione. È progettato per facilitare l'interazione tra i sistemi di supervisione e i controllori, sebbene possa essere utilizzato anche per le comunicazioni da controllore a controllore. Viene utilizzato principalmente per l'interrogazione e l'interazione dei dati, nonché per la programmazione dei PLC. Lo troverete sui PLC Siemens serie S7-300 e 400.
 L'analisi del protocollo è utile per comprendere i comandi e i valori letti/scritti sui controller.

© 2021 Robert M. Lee 95
 95
 PROFINET
 Frame 12: 64 byte su cavo (512 bit), 64 byte catturati (512 bit) jm ethernet IZ, src: Phoenixc_cO:70:24 (00:a0:45:c0:70:24), Ost: Phoenixc_37:52: 2c (00:a0:45:37:52:2c)
sono 802.LAN virtuale 1Q, PRI: 6, CFI: 0, ID: 0
[= PROFINET ciclico Real-Time, RTC1(legacy), ID:0xcO10, Len: 40, Ciclo: 3040 (valid, Primary ,ok,Run) Eramerlo: OxcO10 COxCOQO-Oxe7FF: Real-Time(class=1 unicast): ciclico) contacicli: 3040
 DataStatus: 0x35 (Frame: valido e primario, Provider: ok ed esegui) Transferstatus: 0x00 (OK)
| PROFINET Io Cyclic Service Unità dati: 40 byte
| Dati utente (inclusi GAP e aTCPadding): 40 byte

(0000 00 a0 45 37 52 2c 00 ad co 70 24 81 00 cO 00 0010 88 92 Hgmeey sO 80 80 80 80 80 80 00 00 00 00 0020 80 80 0a 00 00 00 00 00 0 80 00 06 00 06 00 00
{0030 00 00 80 00 80 00 00 00 00 00 00 Ob e0 35 00

* Utilizza Ethernet ma non TCP/IP a meno che non utilizzi un'applicazione per la configurazione e la diagnostica

* Utilizza l'IEEE EtherType 0x8892 univoco per ignorare lo stack TCP/IP

* Le apparecchiature collegate in rete PROFINET devono avere un "controller" e i "dispositivi" hanno ciascuno un IP e un nome
¢ Protocollo a livello di bus di campo
 I.C.S.S15 | % di visibilità, rilevamento e risposta I.C.S.
 Il protocollo PROFINET (Process Field Net) si trova spesso negli impianti di processo e di produzione. Può trasmettere dati in tre diversi livelli di protocollo (dallo standard):

¢ TCP/IP per dati non critici con tempi di reazione nell'ordine di 100 ms
* RT (tempo reale) per applicazioni PROFINET IO e ha tempi di ciclo fino a Ims (più comunemente utilizzati)
* IRT (Jsochronous Real Time) per applicazioni con tempi di ciclo inferiori a Ims
 PROFINET ha una configurazione master/slave e utilizza Ethernet per comunicare. Ha un controller, un dispositivo
(dispositivo di campo monitorato dal controllore) e un supervisore (il software su PC per interagire con i sistemi).
 PROFINET dispone comunemente di "profili" che sono configurazioni predefinite per diverse applicazioni, come la gestione del consumo energetico in un impianto. Questi profili sono spesso disponibili tramite il gruppo di lavoro PROFINET e consentono l'interoperabilità. Se identifichi una struttura che utilizza PROFINET, identificando il tipo di sistemi, potresti essere in grado di identificare il profilo utilizzato per comprendere meglio il processo.
 Inoltre, PROFINET utilizza Discovery and Configuration Protocol (DCP) che è un modo per utilizzare uno schema di denominazione. Ogni dispositivo PROFINET dovrebbe avere un indirizzo IP e un nome. Questi nomi possono anche essere memorizzati in un server DNS; ad esempio, cerca un server DNS e recupera i nomi se stai tentando di identificare i dispositivi. Tuttavia, questa non è una configurazione obbligatoria; è solo un'opzione usata a volte.
 Notare nello screenshot qui sopra che non c'è comunicazione IP e TCP. La comunicazione PROFINET è stata invece copiata su una LAN virtuale per la raccolta. Non è possibile accedere a una porta specifica, ma possiamo identificare che si tratta di PROFINET dagli ID frame. In questo caso vediamo anche l'ID del frame 0xc010, che è la classificazione di
 RT.
 Un fantastico webinar che spiega PROFINET può essere trovato qui: https://us.profinet.com/webinar/an-introduction-to-profinet/
 96 © 2021 Robert M. Lee
 eH®
 rT DP DP ®D WD WM
 7 ® ® @® @® ® MW DM WM DW WM OW DW DW ®D ey es we ww
 va
 w w |) ww ww ww w Ww Ww Ww ww w
 w

+ Spesso sulla porta UDP

€4 Dispositivo readProperty[ 20] Confirmwed-REQ, revisione firewall 86001 47808 72 Dispositivo Complex-ACk _readProperty[ 28], revisione firmware s6001 © Src e Dst AB. 64 Confermato: RFO___ceadPronertul 21)_dewice.£6001_annlication-saftwa . Tah Frese 29: 75 byte sul cavo (600 bit) : : ¢ Trovato nell'edificio

> Ethernet IT, Src: IceQube_03:00:61 (08: 00:61), Ost: Dell_bf:1d:@8 (00:21:70:b#:1d:08) sistemi di automazione
> Protocollo Internet versione 4, Src: 172.16.96,1, Dst: 172.16.36.1
[> utente protocollo oatagran, porta Src: 47808, porta Ost: 47808 e data center

> Controllo collegamento virtuale BACnet Automazione e controllo degli edifici. Rete NPDU * Spesso Internet
 Versione: @x@l (ASHRAE 135-1995)
> Controllo: @x@a, identificatore di origine collegato
 Indirizzo rete di origine: 8601 60 Confermato-REQ readProperty[ dispositivo,4194303 identificatore oggetto Origine indirizzo livello MAC Lunghezza: 2 65 Complex-ACK readproperty[ dispositivo,1337 identificatore oggetto dispositivo,1337 aalelieg F aiton e spia di rete di controllo «00 CONFirmed- REQ: dispositivo readProperty[, identificatore fornitore 4194303
‘ 63 Complex-Ack readrroperty[ dispositivo, 1337 identificatore fornitore
: 60 Confermato-REQ _readProperty[ dispositivo, 4194303 nome fornitore Invoke 1D: 19 73 Complex-ACK readProperty[ dispositivo, 1337 nome fornitore Scelta servizio: readProperty (12) 60 Confermato-REQ = readProperty[ dispositivo, 4194303 levice revisione firmware ;, 20081 68 Comp]ex-ACK readproperty[ dispositivo,1337 revisione firmware
+ model-nose (70) 60 Confermato-REQ readProperty[ dispositivo,4194303 versione-software-applicativo 65 Complex-ACK readProperty[ dispositivo,1337 versione-software-applicativo 60 Confermato-REQ readProperty[ dispositivo,4194303 nome-oggetto 70 Complex- ACK readproperty[ dispositivo,1337 nome-oggetto 60 Confermato-REQ readProperty[ dispositivo,4194303 nome-modello 76 Com Tex-Ack readproperty[ dispositivo,1337 nome-modello 60 Confermato-REQ readProperty[ dispositivo,4194303 descrizione
 I.C.S.515 | I.C.S.Visibilità, rilevamento e risposta 97
 BACnet è un protocollo presente soprattutto nel settore della building automation. Sopra è mostrata la versione IP del protocollo. Da questo punto di vista, possiamo vedere che BACnet ha una discreta quantità di dettagli visualizzati. Le informazioni BACnet spesso contengono il tipo di dispositivi che comunicano; può includere anche la loro posizione. Wireshark può estrarre molti di questi dati in modo nativo, poiché ha un dissettore per il protocollo integrato.
 Proprietà BACnet
 In Wireshark, le proprietà BACnet spiegano con quali dispositivi viene comunicata. Inoltre, sono tutti disponibili diversi comandi, come nome oggetto, nome modello, revisione firmware, nome fornitore e descrizione. È importante conoscere i tag all'interno del protocollo per identificare l'esatta informazione contenuta per questi campi dichiarati. Lavorare con i fornitori e identificare la loro documentazione può aiutare a estrarre queste informazioni granulari e fornire molto contesto a ciò che è presente sulla rete. Ad esempio, sapere esattamente cosa rappresenta ciascun campo e valore in BACnet potrebbe essere utilizzato per migliorare il dissettore per estrarre e visualizzare in modo nativo tali informazioni.

© 2021 Robert M. Lee 97 therNet/IP e CIP
 i Frame 6: 117 byte in linea (936 bit), 117 byte catturati (936 bit)
@ Ethernet IZ, Src: Rockwel1_a4:01:80 (00:1d:9c:a4:01:80), Dst: 00:73:63:61:64:61 (00:73:63:61:64:61 ) se Protocollo Internet versione 4, Src: 172.16.1.30 (172.16.1.30), Dst: 172.16.1.10 (472.16.1.10)
 Protocollo di controllo della trasmissione, porta Sr¢: etherne' (44818), porta Dst: 49321 (49321), Seq: 1, Ack: 74, Len: 63 2 Ethernet /ie (protocollo industriale), sessione: OxABDD86F6, dati unità di invio
© Intestazione dell'incapsulamento | comando: Invia dati unità (0x0070) | Durata: 39 sessioni Handle: Oxabdd86f6é Stato: Successo (0x00000000) contesto mittente: 0200000000000000 Opzioni: 0x00000000
@ Dati specifici del comando
= Protocollo industriale comune)
@service: Servizio sconosciuto (Ox4b) (Risposta)
@ Stato: successo
[Dimensione percorso richiesta: 2 (parole)]
@ [Percorso richiesta: Classe: 0x67, Istanza: 0x01]
©) Classe IP Generica
_PSpecifico del comando..pata. si 7 - — - Configurato sulla porta TCP 448 18 per la messaggistica esplicita e sulla porta UDP 2222 per la messaggistica implicita Di solito presente negli ambienti di produzione e basati su Rockwell Lo stack di protocolli è per lo più aperto ma può cambiare in base all'implementazione
 Utile per la configurazione ma contiene molti problemi di sicurezza nel CIP poiché il CIP è instradabile ovunque
 I.C.S.5IS | I.C.S. Visibilità, rilevamento e risposta
 EtherNet/IP è comune nelle reti di produzione grazie al suo ampio utilizzo da parte di Rockwell Automation. È uno dei protocolli che utilizza il Common Industrial Protocol (CIP). EtherNet/IP dispone della messaggistica basata su implicito (UDP) e della messaggistica esplicita (TCP). Nella forma implicita, è normale che il protocollo trasferisca dati I/O. Nella messaggistica esplicita, è normale che parametri, setpoint, ecc. vengano caricati e scaricati. Pertanto, quando si cerca la modifica delle informazioni è necessario cercare TCP, mentre quando si tenta di farlo è necessario cercare UDP
 identificare i dati I/O.
 EtherNet/IP può essere una comunicazione uno a uno, uno a molti e uno a tutti: unicast, multicast o broadcast. Di solito viene visto sulla porta 44818 per TCP e 2222 per UDP. Esplicito (44818) viene utilizzato per trasferire parametri, setpoint, programmi, ecc. Implicito (2222) viene utilizzato per trasferire dati I/O.
 EtherNet/IP stesso è un protocollo a livello di applicazione, anche se contiene due sezioni distinte. La prima sezione è l'intestazione di incapsulamento. La seconda sezione sono i dati specifici del comando, ovvero il protocollo CIP al suo interno che contiene il blob di dati effettivo. Il CIP utilizza gli oggetti per impostare attributi quali l'ID del fornitore, il numero di serie del dispositivo e i dati di identità. Ci sono anche oggetti applicativi all'interno del CIP, che sono definiti dal tipo di dispositivo e dalla sua funzione (collabora con i tuoi architetti/ingegneri per determinare cosa significano questi valori). Questi oggetti applicativi contengono informazioni che descrivono aspetti dell'I/O o del controller come frequenze, corrente nominale e altro. Gli oggetti specifici del fornitore possono anche essere contenuti nel CIP, per cui dovrai collaborare con il tuo fornitore
 esattamente cosa significano i dati.
 Quando si cercano EtherNet/IP e CIP, è utile identificare le anomalie nell'indirizzamento e nei comandi dell'intestazione di incapsulamento EtherNet/IP (come "Invia dati unità") per determinare se c'è qualcosa di strano. Comprendere i livelli più profondi di EtherNet/IP e CIP può essere utile per il monitoraggio della configurazione di rete, ma ha un ritorno sull'investimento inferiore per l'analisi della sicurezza.
 Riferimento: http://www.rtaautomation.com/technologies/ethernetip/ https://literature.rockwellautomation.com/ide/; groups/literature/documents/wp/enet-wp001_-en-p.pdf
 98 © 2021 Robert M. Lee
 sì) sì
 oa ao ® 8 @®8 HH OH OH H OH ww
 UN @ @
 oo Oo @ Oo ® @® @ ow a wa wy a wy 7 oe ~~ ww
 vw wo wow noi noi noi ww
 noi w w wo w
 726955 984 806136 oS A681 Successo 984.806802 192.168.1.175 . io. Servizio sconosciuto (@x4b) 726964 984.816321 192.168.1.51 -168.1.cIP 118 Successo 726967 984.822935 192.168.1.175 -168.1. cIP 112 Servizio sconosciuto (@x4b) 726976 984.836134 192.168.1.51 -168.1. cIP 134 Successo 726978 984.836983 192.168.1.175 -168.1. cIP 121 Unknown Service (@x4b) Come esempio nel commento Ethernet/IP _sveem
 CIP è possibile utilizzare il protocollo per eseguire query che forniranno informazioni sulle risorse
 Qui vediamo un riferimento ad un'alzavola “ 5 Vee o. .
 MuxL..F.we. .J.#1763-LEC
 dispositivo come un 1763, combinato con ~ la comprensione che si tratta di un dispositivo Rockwell possiamo dedurre che si tratta di un Micrologix 1100 Allen Bradley 1763
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta A volte vedrai query e informazioni native nel protocollo utilizzate in condizioni operative normali. Essere in grado di esaminare e analizzare passivamente queste informazioni è fondamentale per identificare diverse risorse
 informazione. Inoltre, a volte vedrai anche i tag nella rete che ti aiuteranno a capire a cosa sono correlati i vari registri e valori di processo nell'ambiente fisico.

© 2021 Robert M. Lee 99 Esempio: Multilin di GE Grid Solutions
 Sistemi aziendali = [oe”. Multilin D4oo di GE è un dispositivo gateway per sottostazioni per la raccolta di dati di misurazione, stato, eventi e rapporti di guasto
 ata Storico
 Daca de Comme “wuinesee Per interagire nella sottostazione,
 deve supportare un'ampia varietà di possibili protocolli HM locali
 Linea singola

"Geir [oan ||... Stwtotenbe «Il grafico a sinistra aiuta

* eceusociet illustra dove potresti vedere
> : Sono stati utilizzati diversi protocolli
 Cs = | ee2 | noi in una sottostazione automatizzata
 ambiente
 Interruttori di protezione del vano, abilitazione PRP Controller non PRP 61850 Relè Misuratori Dispositivo Dispositivo
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 100
 Lo scopo di includere Multilin di GE qui è notare come il produttore pensa ai protocolli e dove li troverai. È importante sottolineare che mostra anche come alcuni protocolli possano essere intercambiabili. Ad esempio, probabilmente non utilizzeresti DNP3, ModbusTCP e IEC-104 per comunicare da un determinato HMI/DMS/Historian al gateway. È più probabile che ne utilizzerai uno e sarai in grado di interrogare i dati necessari dal gateway.
 Il gateway stesso può quindi comunicare con i vari dispositivi, sfruttando i loro protocolli nativi come DNP3, 61850, Modbus, SEL o IEC104. Inoltre, è disponibile il supporto per i vari protocolli seriali a qualsiasi livello.
 Comprendere l'I.C.S. I protocolli sono utili, ma è importante anche comprenderne il ruolo e per cosa vengono utilizzati in un dato momento. Ciò aiuterà a orientare il valore che estrai dai protocolli stessi e ciò che possono
 fornire.
 Riferimento: https://www.gegridsolutions.com/multilin/energy/catalog/d400.htm
 100 © 2021 Robert M. Lee

(Con ('®>

@®

> PDP DB PD OP OH Hh OH WP OS HP wy a
 eo noi & ww
 wo © Ww wo Ww |] ww Ww ww Ww Ww Ww Ww noi w
 dobbiamo
 ty per i comandi RTU di analisi della causa principale

¢ La società di trasmissione ha iniziato a notare variazioni di tensione nelle loro sottostazioni
¢ Impossibile determinare cosa stava succedendo alle RTU

¢ Il team era a conoscenza del fatto che in Ucraina nel 2015 i comandi venivano inviati dal sistema SCADA alle RTU senza interazione da parte dell'operatore
«Non erano disponibili dati forensi come la sequenza degli eventi

« La risposta all'incidente ha avuto luogo e ha dispiegato un sistema I.C.S. soluzione di visibilità

« Fortunatamente, la questione è continuata ed è stata risolta

« C'era un bug nel sistema SCADA che inviava comandi di ripristino alle RTU
« Analizzando l'I.C.S. Il protocollo era il meccanismo per determinare questo problema
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 101
 Presso una compagnia elettrica anonima si è verificato uno spostamento di tensione nel sistema di trasmissione e sono state colpite le RTU di più sottostazioni. L’azienda non riusciva a capire cosa stesse succedendo. Sapevano che un evento simile si era verificato in un incidente reale basato su un avversario e quindi giustamente prendevano precauzioni. Dopo aver dichiarato l'evento e aver chiamato una squadra di risposta agli incidenti, l'azienda ha determinato il problema. La squadra di risposta agli incidenti ha implementato un sistema I.C.S. prodotto di visibilità in rete che permette di analizzare l'I.C.S. protocolli e ha stabilito che il sistema SCADA presentava un bug che inviava inaspettatamente comandi di ripristino alle RTU. Ciò ha consentito loro di intraprendere le azioni giuste, poiché ora avevano compreso la causa principale e non si è verificato alcun impatto maggiore.

© 2021 Robert M. Lee 101 Lab 2.3 I.C.S. Analisi del protocollo
 Raffineria di Calistoga |)
 I.C.S.S5I5 | [Visibilità, rilevamento e risposta del CS — 107
 
 102 © 2021 Robert M. Lee

(@) es
 rTP WP WP OD OO OO WD OD DW DW DW Ow
 7 ® @® @® @® @ ® ® ww w WW @ & BS Bw ww www wo wo we Ww wo BS BS BS w
 Obiettivi dello scenario del corso (4)

* Raffineria di Calistoga
*Qual è la marca e il modello del 10.10.20.10?
 Rockwell Automation/Allen-Bradley
 1756-L55/A e 1756-M12/A LOGIX5555
 I.C.S.5I5 | |\CSVisibilità, rilevamento e risposta 103
 

© 2021 Roberto M.Obiettivi dello scenario del corso Lee 103 (5)

* Raffineria di Calistoga

*C3PO:
 Qual è l’indirizzo IP e il dominio dell’avversario?
 Qual è il nome del file di progetto dannoso?
 Cosa ha fatto l'avversario al PLC di sicurezza?
 Qual è la routine dannosa nella logica e cosa fa? Qual è la causa principale dell'attacco?
 L’incidente è collegato all’incidente di C3PO?

* Creare una topologia della rete di controllo.

* Qual è l'azione dannosa sull'HMI?

* Quale registro è stato manipolato con quale valore?

* Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 104
 
 104

© 2021 Robert M. Lee
 PT RP DP OP OD DP H
 eo@®
 oo nnnn tm? @®&7&DP®®
 eS
 ww noi w ww noi WwW Ww w
 ew w w&
 Caso di studio: DRAGONFLY e HAVEX
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 10:
 

© 2021 Robert M. Lee 105
- Gruppo di minaccia attivo almeno dal 2011
 Inizialmente mirati ai settori della difesa e dell'aviazione

- Nel 2013 è stato deciso di prendere di mira le società di infrastrutture industriali

« Le tattiche comuni includono la compromissione di siti Web e l'uso di trojan su programmi di installazione di software legittimi per ottenere l'accesso e quindi eseguire una ricognizione interna

* Ha sfruttato il malware HAVEX, l'unico I.C.S. su misura
 famiglia di malware
 e
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S
 Dragonfly è un gruppo di minacce identificato da Symantec attivo almeno dal 2011. Inizialmente prendeva di mira i settori della difesa e dell'aviazione in Europa, conferendogli un classico obiettivo di spionaggio degli avversari statali. Intorno al 2013 il gruppo ha iniziato a prendere di mira i settori industriali, comprese le società elettriche. Symantec ha valutato che gli attacchi erano concentrati soprattutto sul settore energetico, tuttavia un'ulteriore analisi delle vittime ha evidenziato che ad essere prese di mira non erano solo le società elettriche.
 La cosa interessante di Dragonfly per l'I.C.S. community è l'uso di HAVEX, che è stato il secondo I.C.S. scoperto malware su misura.
 Riferimento: Rapporto Symantecs Dragonfly
 106 © 2021 Robert M. Lee
 Cos'è la DRAGONFLY?
 106
 mmm DW ® WW @® © ® ® OH DH OP WH Ow
 ef, ® @ @
 7
 mm, noi Ww J ww
 Cos'è Havex?

¢ Havex è un trojan di accesso remoto (RAT):
* Su un sistema, esegue la scansione delle risorse e dei sistemi connessi per mappare le topologie di rete e raccogliere dati

*Il malware modulare consente vari plugin/moduli:
* Un modulo ha cercato specificatamente I.C.S. presenti sulla rete utilizzando OPC

* Un modulo sfrutta il sistema I.C.S. porti per raccogliere informazioni su ciò che era presente
* Dopo aver infettato un sistema, si riconnette a uno delle centinaia di Command
 e server di controllo (C2):

* Utile come backdoor per consentire l'accesso remoto a un utente malintenzionato

* Può essere utilizzato per installare altro malware o eseguire file eseguibili

* Può ricevere comandi o caricare dati rubati
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 107
 Havex è un RAT utilizzato nelle campagne di spionaggio che precedono qualsiasi attività correlata a I.C.S.. Tuttavia, quando è stata trovata una variante aggiornata di Havex contenente I.C.S. moduli, ha colto il mondo alla sprovvista. È stato il secondo malware in assoluto ad avere porzioni/carichi utili specifici di I.C.S.. Sebbene altri malware abbiano avuto un impatto su I.C.S. prima, questa minaccia veniva lanciata da un team ben finanziato, forse uno stato-nazione, che capiva le ragioni dell’I.C.S. reti e voleva raccogliere informazioni da loro. È il tipo di funzionalità che verrebbe implementata durante il tentativo di raccogliere informazioni sufficienti per creare un malware distruttivo come abbiamo visto con Stuxnet. Non c’è motivo di essere allarmisti, ma questa non è una minaccia da prendere alla leggera.

© 2021 Robert M. Lee 107 DRAGONELY I.C.S. Cronologia delle operazioni
 Giugno 2023 «Luglio 2023 Azienda A Comprom e software trejanizzato
 Maggio iB -dor St Attacco Watering-hole Siti wab legati all'energia multiote
 iG 1é Maid apeid Mayid junds Auge 1 agosto 2026
 20 gennaio 2044 «20 gennaio 2018 oomoany 8 compromesso e software trojanizzato 250 download unici:
 I.C.S.515 | [Visibilità, rilevamento e risposta CS _ica
 Per tutto il 2013, Dragonfly ha compromesso i fornitori come compromesso nella catena di fornitura per prendere di mira I.C.S. aziende. Le operazioni hanno preso di mira alcune grandi aziende, come eWon e MBConnect, che avevano apparecchi VPN realizzati su misura
 all'I.C.S. reti.
 Riferimento: Symantecs Dragonfly Report.pdf
 108 © 2021 Robert M. Lee
 Onqnnennmmmmmmmmm®menemnen ® ® ® O ®H ®&
 mw Come viene consegnato?
 E-mail di phishing Waterhole Attack incorporato negli installatori
 p> Incorporato dannoso -~ I.C.S.
 C] i i A
_ File .| Versione di siti Web compromessi

[_] Aperto per infettare i sistemi [7] Visitatori reindirizzati | Siti web vulnerabili

| Versioni precedenti (] Copia/Incolla Metasploit _", programmi di installazione con trojan

_. Kit di exploit attivato _. Diretto nell'ambiente

__| Havex ha consegnato
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Havex è stato consegnato in numerosi modi, tra cui:

* Sono state inviate e-mail di phishing a target con file dannosi che hanno consentito al malware di infettare i sistemi dei target.° Attacco alla pozza d'acqua:

* Le vittime che visitavano un sito Web compromesso venivano reindirizzate a un sito Web che ospitava un kit di exploit; questo kit di exploit scaricava quindi il malware Havex sulle macchine infette.

* Gli exploit kit erano tutti exploit ben noti e disponibili al pubblico. Niente di questi exploit era avanzato o costoso per l'avversario. In alcuni casi, erano moduli Metasploit letterali.

* Incorporato nei programmi di installazione o nel firmware sui siti Web dei fornitori:

*L'I.C.S. La versione più recente di questo malware è stata in gran parte fornita da siti Web di fornitori compromessi. L’avversario sapeva su quali fornitori scendere a compromessi per infettare gli obiettivi desiderati, il che dimostra un altro livello di sofisticazione.

* I siti Web dei fornitori utilizzavano versioni vulnerabili e senza patch di applicazioni Web che consentivano di compromettere i siti Web con exploit noti e disponibili pubblicamente.
 Havex non era avanzato di per sé. Era avanzato a causa della logistica e della pianificazione che ne sono state coinvolte. Non è facile gestire una campagna che prende di mira migliaia di strutture in tutto il mondo ed è anche particolarmente costoso. Inoltre, il tipo di dati raccolti non valeva molto dal punto di vista finanziario. Valeva molto per la pianificazione e lo spionaggio di uno stato-nazione. Questi fattori e altri si combinano per dare uno sguardo a un uso molto intelligente del malware che ha costituito una minaccia avanzata.

© 2021 Robert M. Lee 109
 pure
 Dove atterrerebbe?
 Livello 5 — Risorse Internet/Cloud ae a

= Livello 3 — Impianto/Sito oy

= Livello 2 – Controllo di supervisione a
 me «Livello 1 — Dispositivi di controllo Livello 0 — Processo/Sensori/Attuatori
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta — 10
 Ecco un modello Purdue semplificato che esamina i sei livelli di una rete ben strutturata con I.C.S.. Dove atterrerebbe Havex in queste aree, in base ai vettori di intrusione?
 Nelle e-mail di spearphishing, sarebbe probabilmente arrivato al livello 4 e forse al livello 5. Nel vettore di intrusione nelle pozze d'acqua, potrebbe essere arrivato al livello 5, al livello 4 e potenzialmente al livello 3 se le persone stavano navigando in Internet. Ma con le patch trojanizzate, sarebbe riuscito a raggiungere l'area di livello 2. Nel corso del tempo, gli sforzi dell’avversario
(che lo volessero o no) li ha guidati più in profondità nell'I.C.S..
 Di solito non siamo in grado di determinare l'intento dal codice di un avversario o dalle intrusioni, ma è utile notare cosa stanno facendo e cosa potrebbe significare per la tua organizzazione.
 110 © 2021 Robert M. Lee

" & ©

@

~— ™— mm Om OO mM ® Sd
 aee ew
 vwww | WwW Sw WwW
 Chi l'ha fatto
 Ottenere?
 Havex ha infettato più di 2.800 vittime. Ha utilizzato più di 50 versioni diverse del malware
 Due originali I.C.S. le vittime sono state eWON e MB Connect Line:
* Agire come OEM per varie forniture di PLC come Siemens, Rockwell Automation, Mitsubishi Electric e altri
 Vari individui e aziende hanno rivendicato settori target specifici come quello farmaceutico ed energetico
* In realtà, vari ricercatori/aziende di malware hanno accesso a set di dati e campioni limitati, quindi disponiamo di analisi incomplete
 I.C.S.SIS5 | I.C.S. Visibilità, rilevamento e risposta
 Digital Bond ha identificato due delle vittime originali come eWON e MB Connect Line. Queste aziende si occupano di produzione, sistemi di infrastrutture energetiche, turbine eoliche e altro ancora come fornitori OEM. Symantec ha identificato cinque società di sistemi di controllo energetico e sei società energetiche che reindirizzavano i visitatori a un sito compromesso. Joel Langill ha identificato diverse aziende farmaceutiche come obiettivi. Capire quali aziende sono state prese di mira non solo aiuta a identificare altre vittime, ma aiuta anche a comprendere le motivazioni degli aggressori. Ciò che è interessante è la vastità della campagna. Pensa al tipo di logistica che sarebbe necessaria per utilizzare le informazioni provenienti da migliaia di strutture. Tutte queste strutture potrebbero non essere state l’obiettivo. Tuttavia, per avere una campagna di così vasta portata, l’obiettivo previsto dovrebbe essere almeno una parte significativa di questo set di dati (avrebbero potuto esserlo tutti, ma non possiamo presumere l’intento di un avversario). Il denaro e le risorse destinati alla formazione e al personale incaricato di analizzare le informazioni raccolte sono costosi. Parla della raffinatezza dell'avversario.
 Ovviamente, c’era un grande interesse per I.C.S., ma ci sono molte analisi/prove concorrenti su quale verticale fosse esattamente l’obiettivo primario. È più importante, però, sottolineare come i dati disponibili fossero limitati e che molti I.C.S. le aziende non hanno condiviso i dati sulle minacce, quindi forse non lo sapremo mai.

"Non rappresentare un parametro nella diapositiva dell'aggressore di malware."
 Riferimento: http://www.digitalbond.com/blog/2014/07/02/havex-hype-unhelpful-mystery/

© 2021 Robert M. Lee 111
 u.t
 Dispositivi eWON in I.C.S. Reti
 1CS515| I.C.S. Visibilità, rilevamento e risposta 112
 Qui vediamo un riferimento a come apparirebbe il dispositivo VPN eFive di eWon in un sistema I.C.S. rete. In sostanza dava accesso diretto ai dispositivi L2 e inferiori nell'I.C.S..La figura a destra mostra quale tipo di fornitori eWon ha affermato di supportare e comprendere i loro protocolli. eWon sotto molti aspetti era un fornitore perfetto a cui rivolgersi per raggiungere un compromesso
 serie significative di vittime.
 Riferimento immagine: ewon.biz
 Riferimento: Libro bianco Belden Dragonfly.pdf
 112 © 2021 Robert M. Lee

@
 PO OH OO HH HH HF HH OH HH
 m@ @ @ @ @ B
 ww w WwW Ww OT OBO BW WwW WB WY Sii noi
 Se Sw Ww

)
 ww ww 5
 Comunicazioni HAVEX

. Il software legittimo HAVEX era incorporato in: programmi di installazione legittimi e server C2 con codifica fissa; pene fnome
 swissitaly.com ("}
 egrabitsetup.exe

* Tenterei di contattare
 ogni ~24 minuti
 Sw. ssrangerSetupl. 0,14. 706.exe _Nessuno osservato
 Numero pacchetto |Nome host [Tipo contenuto [dimensione [Nome file
 37 sinfulcelebs freesexycomics.com text/html 150 byte tmp.php?id=62992 131148615 180900090FD80-c8a7af4196405 978 rapidecharge.gigfa.com text/html 244 kB bp~-settings~sre._php?id =629921311486151 80900090FD80-c8a,
© 2085 rapidecharge.gigfa.com text/html 359 kB bp~settings~src.p! prid=6299 13; locanda orerepcerpepne
 op | 3042 rapidecharge.gigfa.com testo/html! 236 kB impostazioni bp—sre. Se ickisatiai Tass sibacbiooeseocae 3661 sinfulcelebs.freesexycomics.com text/html 150 byte tmp.php?id=629921 31148615 180900090FD80-c8a7af4196405
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 113
 HAVEX tenterà di contattare i suoi server C2 all'incirca ogni 24 minuti. Utilizzava domini codificati, alcuni dei quali avrebbero dovuto risaltare in qualsiasi analisi del traffico in questi ambienti. Ancora più importante, è utile notare che le sessioni VPN compromesse significano che i registri raccolti non sarebbero solo traffico di rete e DNS, ma la VPN stessa registra per identificare queste comunicazioni.
 Riferimento: Libro bianco Belden Dragonfly.pdf

© 2021 Robert M. Lee 113 Il modulo OPC
 jr
(S) .rdata:10030CD0 Il programma è stato avviato alle %02i:%02i:%02i\n rdata:10030020 alle
-tdati:10030D28 OZOi:202i. 160i:
'-date:10030D58 sernentwetineannnntaaent
-fdati:L0030DFO a. Inizia il finting degli host LAN. stdata:h0030E30 La ricerca è stata un errore. Errore imprevisto\n srdata:}0030E7C Sono stati trovati %i host nella LAN:\n
's) .dateLOO30EB4 Host non trovato.\n
[S) .rdata:100306D¢ AA\E\E\ENE902i) [%s]\n
"| .rdata:10030F00 Avvia finging dei server OPC...\n ardata:10030F44 Trovato %i, \n
-rdata:10030F80 unic... \tt%i) [%s\\%s]\n\t\NtCLSID: %s\n
|] .rdata:10030FD8 unic... \tht\tUserType: Ses\nit\titVerindProgID: — %s\n
-rdata:0031048 unic.. \t\t\tSupporto versione OPC: %s\n
(3) .rdate-t0031080 unic.. Server OPC non trovati. Programma terminato\n

¢ Il modulo può identificare i server OPC tramite WNet

* I dati scoperti vengono quindi compressi e crittografati

¢ Viene inserito in una cartella temporanea o inviato a un server C2
¢ L'avversario ha poi raccolto e analizzato i dati
 sRRAARRRRA visto REREREREEEERRREE ERE TEER RE An
 I.C.S.SI5 | I.C.S. Visibilità, rilevamento e risposta
 OPC sta per Object linking and embedding for Process Control. A volte viene definito protocollo Open Platform Communications. È un protocollo estremamente comune e può interfacciarsi su numerosi verticali in I.C.S.. Il modulo utilizza la funzionalità Windows Networking (WNet) per mappare la rete. Questa è una mossa fantastica da parte dell'avversario perché utilizza comandi nativi; è un peccato per la vittima perché è più difficile per i sistemi anti-malware identificare i comandi nativi utilizzati nel modo in cui sono stati progettati.
 In breve, Windows fornisce un'API per enumerare le risorse di rete utilizzando il comando WNetOpenEnum e WNetEnumResources. Molti sistemi Windows in I.C.S. con OPC hanno anche OPCEnum, che consente il
 rilevamento di server specifici OPC collegati.
 È interessante notare che in alcuni casi i dati sembravano essere archiviati sul sistema perfetto, ma non caricati su un server C2. Ciò significa che l'aggressore desiderava accedere da remoto e raccogliere i dati da solo, oppure era presente una sorta di protezione integrata nel malware in modo che non caricasse dati in condizioni sospette.
 Per il grafico sopra, F-Secure ha eseguito un campione di Havex sui suoi sistemi. Osservando il programma sono emersi riferimenti ai server OPC nel codice. Ciò ha aiutato gli analisti, che non erano formati nell’I.C.S. o ingegneria, per identificare il
 I.C.S. connessione anticipata.
 114 © 2021 Robert M. Lee
 da

@)
 rT signor PO OO OO HH HO HO WH WP #H wo

™ ® ® o
 o ww we Ww Ww WO WO WO WO GF OO GF DP GF FF SF Se BS w
 noi noi w YS &
 OLE per il controllo di processo (OPC)
 Progettato per raccogliere dati rilevanti da sistemi importanti in modo neutrale rispetto al fornitore. Fornisce una visione consolidata o convergente dei dati
 altri dati: OPC ci consente di raccogliere dati e generare visualizzazioni per z pre. business ~ HMI, server di allarme, 'Aiceealbdacuisnae
 Controllo] Rete

[
 Storici
 io .
| io
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 OLE è una tecnologia sviluppata da Microsoft e sta per Object Linking and Embedding. Viene utilizzato per incorporare e collegare documenti e altri oggetti all'interno di un'applicazione.OPC è stato progettato per raccogliere dati rilevanti da sistemi importanti e fornirne una visione consolidata o convergente con i dati provenienti da un altro sistema disparato. In precedenza, il fornitore del sistema di controllo A avrebbe dovuto scrivere interfacce e codici personalizzati per visualizzare i dati del sistema di controllo B, oppure gli esseri umani avrebbero dovuto inserire i dati manualmente. Man mano che si sviluppavano sistemi di business intelligence e gli utenti esterni all'ambiente del sistema di controllo desideravano vedere i dati sulle prestazioni operative, i programmi di produzione, i lavori di manutenzione, ecc., c'era una crescente necessità di ottenere dati in un unico sistema per consentirne la visualizzazione e l'accesso. Utilizzando le entità OPC, siamo in grado di raccogliere dati e generare le visualizzazioni necessarie per il business. http://www.opcfoundation.org
 Spesso descritto come lo "standard di interoperabilità" per l'automazione industriale, OPC originariamente stava per Object Linking and Embedding for Process Control. OPC è stato sviluppato attraverso la collaborazione del settore alla fine degli anni '90 ed è stato specificato dalla comunità come sinonimo di "comunicazioni su piattaforma aperta". Lo standard ha continuato a crescere ed evolversi poiché ha integrato nuove tecnologie. Funziona come un bridge comune, consentendo di fornire ai client OPC le comunicazioni che arrivano al server OPC. Sulla base di OLE, COM e DCOM di Microsoft, le vulnerabilità correlate a DCOM hanno portato i sistemi vulnerabili a utilizzare OPC. DCOM/RPC è molto complesso e ciò provoca bug difficili da anticipare e scoprire. Le vulnerabilità basate su DCOM, come MS-086, dovevano essere affrontate dagli utenti finali del sistema di controllo. Inoltre, alcuni considerano OPC un protocollo molto ostile ai firewall che presta particolare attenzione alla segmentazione corretta.
 I server OPC possono fungere da ponte per un utente malintenzionato da un sistema all'altro. Consultare l'avviso I.C.S.-CERT: https://www.us-cert.gov/ics/alerts/I.C.S.-ALERT- 1 1-285-01

© 2021 Robert M. Lee 115
 115
 ampia implementazione OPC
 Pe
 Hardware PLC} (Server OPC Client OPC;
: Software =;
 dolce
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Questa immagine è stata presa da un blog di FireEye sul modulo OPC in Havex. Questa immagine mostra una normale implementazione OPC, che dovrebbe aiutare anche chi non ha familiarità con il protocollo OPC a comprendere meglio il modulo. Essenzialmente, OPC funge da livello di traduzione, soprattutto quando si dispone di un sistema I.C.S. altamente eterogeneo. con diversi fornitori, attrezzature e metodi di comunicazione.
 Riferimento: HAVEX è giù con OPC.pdf
 116 © 2021 Robert M. Lee

@, @® @ @, @, @ we ey a, @) oe (e) ao

@,

@

@ w w Ww Ww Ww
 Perchè l'OPC?

¢ L'OPC è presente in numerosi sistemi I.C.S. strutture:
* L'OPC è spesso diffuso e indipendente dal fornitore

¢ Buono per l'impresa -> I.C.S. transizione di rete:
* OSIsoft e altre società utilizzano OPC come "traduttore universale" per gli storici dei dati e
 sistemi aziendali

¢ Teorie: Prova di concetto: l'aggressore potrebbe aver provato un nuovo plugin ed essere stato scoperto Dati specifici: l'ampia distribuzione del malware potrebbe rappresentare in modo impreciso l'intento dell'operazione Creazione di database: il semplice numero e il tipo di dati potrebbero indicare che l'aggressore era costruire un database di reti/obiettivi
 I.C.S.SIS | I.C.S. Visibilità, rilevamento e risposta
 Come accennato in precedenza, l'OPC è un ottimo obiettivo perché si trova in molti diversi sistemi I.C.S. strutture. È anche un'interfaccia utile per tradurre i dati della rete 1CS in dati utili per le reti aziendali, come i sistemi di fatturazione. OPC è anche esattamente il tipo di interfaccia che vorresti prendere di mira se stessi raccogliendo informazioni sugli obiettivi. La sua capacità di scansionare e documentare le risorse sulla rete lo rende il bersaglio per la raccolta di importanti dati di rete. Poiché questa interfaccia consente a diversi tipi di protocolli e connessioni di comunicare tra loro, questo potrebbe essere stato un vettore di attacco su cui basarsi l'I.C.S. ambiente all’interno dell’impresa. (Anche se I.C.S. probabilmente rappresentava un obiettivo più redditizio.) Inoltre, potremmo potenzialmente assistere al primo tentativo di una minaccia contro I.C.S. malware: potrebbe fungere da prova di concetto, rubando tutti i dati possibili per comprendere meglio I.C.S.. L'attacco avrebbe anche potuto essere molto mirato ed efficace. Solo perché ci sono state migliaia di vittime non significa che migliaia di strutture fossero l’obiettivo. Quelle altre vittime potrebbero essere state accidentali o una tattica diversiva dai veri obiettivi.

© 2021 Robert M. Lee 117
 417
 Chi lo ha usato?

° 50% vittime del sistema di controllo energetico
* Firmware identificato con trojan
 vittime degli appaltatori
 Attribuita la campagna alla Federazione Russa

| ¢ Osservate 2.800 vittime in tutto il mondo e modulo OPC eae, ¢ Ha detto che non era la Russia
| Yeti

|
|
|
}
 I.C.S.515 | |Visibilità, rilevamento e risposta del CS
 Le tre principali aziende che hanno rivendicato l'attribuzione di questa campagna sono Symantec, CrowdStrike e Kaspersky. Symantec non ha fatto alcuna affermazione audace sull'attribuzione, sebbene abbia identificato l'attacco come Dragonfly e abbia notato che Havex era fornito nel pacchetto software per gli aggiornamenti del firmware. Hanno anche notato che la campagna è iniziata l'11 settembre.13 e c'è stata un'altra campagna nel marzo 2014-giugno 2014, CrowdStrike è uscito più audacemente nel suo rapporto per affermare che questa attività faceva parte di un gruppo che stava monitorando da alcuni anni; il gruppo, a suo avviso, era sicuramente originario della Federazione Russa. Poco dopo il rapporto CrowdStrike, Kaspersky Labs ha pubblicato il suo rapporto affermando che sicuramente non si trattava di un russo (ma non sa chi fosse). La sua analisi includeva anche un modulo in Havex che da allora nessun altro ha più visto o segnalato. Tuttavia, c'erano molti moduli in Havex ed era facile scambiarli con altri.
 118 © 2021 Robert M. Lee
 a ge ff &® ® Hh B® DH HD HH @&
 a oo ® re ee a ee
 ww ww w w wy ww ww w w w ww
 Perché il "chi" è meno importante
 La vera attribuzione non significa nulla per la sicurezza tattica:
* Non fare affari in Cina o in Russia a seguito di una loro campagna di spionaggio può essere una decisione presa nella sala del consiglio L'attribuzione a un gruppo o a una campagna ha valore
* Comprendere TTP, obiettivi, ecc. aiuta a guidare le pratiche di sicurezza
 Havex ha persistito per diversi anni contro oltre 2.800 vittime:
¢ Ogni vittima identificata avrebbe potuto allertare i propri utenti o altri
* Ogni vittima che l'ha trovata aveva importanti dati sulle minacce da condividere
 Non è necessario essere una grande organizzazione per essere un bersaglio:
* Non puoi decidere se sei un buon bersaglio
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Spesso nella più ampia comunità di sicurezza, l'attribuzione a una campagna malware diventa il punto saliente di qualsiasi segnalazione. “La Russia attacca ancora” o “La Cina sonda le infrastrutture americane” catturano rapidamente i titoli dei giornali. E in realtà, questo tipo di dati è importante (se è accurato) per il processo decisionale informato sul rischio e lo sviluppo di strategie successive all’azione, ad esempio dove un’azienda dovrebbe e non dovrebbe fare affari. Ma la vera attribuzione non significa nulla per la sicurezza. L'attribuzione di una minaccia per decidere quale tipo di minaccia (come stato-nazione, banda di criminali informatici, minaccia solitaria e così via) è importante per comprenderne le motivazioni, ma l'attribuzione, come nel nome della persona o nella nazionalità, non è importante. prezioso. Ai sistemi di difesa, alle firme e alle configurazioni di rete che utilizzi non importa se l’aggressore è russo o cinese. Si preoccupano che tu comprenda la tua infrastruttura e la minaccia che affronti. È importante identificare i TTP, il malware che fa parte di una campagna più ampia e le motivazioni degli aggressori; tuttavia, preoccuparsi eccessivamente dell'attribuzione è una perdita di tempo e fatica. In breve, si possono ottenere grandi vantaggi in termini di sicurezza essendo in grado di comprendere le motivazioni dell’avversario in base al tipo di minaccia che rappresenta e potendo raggruppare l’avversario e i relativi TTP in un gruppo identificabile. Preoccuparsi e cercare di capire quale specifico gruppo di criminalità informatica, quale nazione specifica o qual è il nome del singolo attore e l'immagine del profilo Facebook presenta molto meno valore ed è uno spreco se si considera il ritorno sull'investimento.
 Riferimento: http://ics-isac.org/robert-lee-crouching-yeti-dragonfly-energetic-bear-S-takeaways-ics-community/

© 2021 Robert M. Lee 119
 119
 Havex riesaminato
 Architettura: Difesa passiva:
*Quanti o giorni? * Oltre 146 server C2
° 0 * Traffico e chiamate facilmente bloccabili
« Moduli Metasploit riutilizzati per difese passive configurate
* Infrastruttura nota dei server Web vulnerabili L'applicazione di patch avrebbe eliminato * Le whitelist avrebbero eliminato questo sito Web/vettore di attacco Watering Hole vettore di attacco
 Difesa attiva:
* Havex ha eseguito scansioni OPC (Open Platform Communication) insolite: Limiti: Ambiente sensibile richiede difese non tradizionali NSM: Traffico/modelli insoliti o server C2 facilmente identificabili Risposta all'incidente: Identificazione della backdoor/infezione iniziale Manipolazione: Modifiche all'architettura disponibili per le richieste del server C2 sinkhole Minaccia Consumo di Intel: IOC disponibili per essere utilizzati da altri per garantire < 2.800 vittime
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 20
 Allora, che mi dici di Havex? È il malware specifico per I.C.S., il secondo in assoluto, di successo. Come si articola il ciclo di difesa informatica attiva? Una corretta architettura dei siti infetti originali avrebbe eliminato la parte della campagna di maggior successo e di più lunga durata (i siti Web Watering Hole). Non sono stati utilizzati 0 giorni; erano tutti moduli Metasploit riutilizzati, quasi alla lettera, disponibili pubblicamente con patch ben note. Il vettore dell’infezione sarebbe stato inutile. Tuttavia, se le vittime che sono state infettate da questi siti Web iniziali comprendevano il loro traffico di rete abbastanza da ottimizzare e mantenere le difese passive (indipendentemente dal fatto che fossero intensive come una whitelist o semplicemente abbastanza basilari da capire che il loro normale traffico di rete non includeva ricerche DNS nella Repubblica Ceca), avrebbero identificato precocemente l'infezione e avremmo molte più informazioni su una campagna non altrettanto efficace.
 La difesa attiva avrebbe funzionato eccezionalmente bene contro Havex. Le scansioni OPC e le chiamate di sistema erano sicuramente insolite.I server C2 connessi dalle reti OT a Internet attivo erano (o almeno avrebbero dovuto essere) insoliti. La difesa attiva avrebbe potuto affondare quei domini per raccogliere informazioni sui server C2, neutralizzando al contempo la capacità di Havex di rubare dati. Il monitoraggio della sicurezza della rete avrebbe identificato il malware. La risposta all’incidente avrebbe identificato e ripulito i punti iniziali dell’infezione. L'intelligence sulle minacce avrebbe potuto essere condivisa in tutta la comunità con Indicatori di compromesso in modo che 2,8 mila vittime in più anni non fossero il numero che stiamo cercando per questa campagna. La difesa non ha fallito. Non siamo riusciti a difendere. Ma è difficile. Non è sempre così facile. Quelle vittime non dovrebbero vergognarsi: sono vittime. L’obiettivo non è mostrare quanto “terribili” fossero queste industrie o siti, ma piuttosto mostrare le lezioni apprese che tutti noi possiamo utilizzare per rendere la difesa fattibile.
 120 © 2021 Robert M. Lee

«®) io, om
 Ce er ee ee ee) ee | eo ae w
 noi 2 e
 wwee &© 8 & © &© © & BS YB © GY WwW
 Me
 Se
 Havex nell'I.C.S. Catena di uccisione informatica

“FASE I - Passaggi osservabili dell'intrusione

— 235] Puntamento ¢ oer

—poe
 Consegna | Zappe della rete eterna
(Buenas o Rete delle piante)
 FASE 2 – I.C.S. attacco
 Sviluppare
 Test
 Eseguire I.C.S. attacco
 Attaccare con impatto
 I.C.S.S5I5 | I.C.S. Visibilità, rilevamento e risposta
 Il malware Havex, utilizzato in una campagna contro I.C.S. per raccogliere dati sensibili e informazioni sull'architettura di rete da migliaia di siti in tutto il mondo, era un trojan di accesso remoto originariamente utilizzato per lo spionaggio generale e evoluto in un set di strumenti criminali. È stato anche adattato per prendere di mira l'I.C.S. inserendo nuovo codice e moduli specifici per I.C.S. ambienti. Dalle informazioni disponibili al pubblico è stato stabilito che la campagna si è svolta nel corso di almeno tre anni. Gli autori di Havex hanno utilizzato diversi metodi per introdurre il malware Havex nelle reti dei difensori. Tre dei più comuni erano i seguenti:

* Invio di email di spearphishing con un file dannoso allegato

° Infettare I.C.S. siti Web di fornitori contenenti malware e compromettenti I.C.S. difensori quando visitavano quei siti web
(nota come tecnica del wateringhole)

* Fornire una versione trojanizzata di I.C.S. programmi di installazione di software che hanno infettato il sistema host quando il personale ha eseguito il programma di installazione
 Questi molteplici metodi di compromesso evidenziano che gli avversari rimangono flessibili e non sono vincolati da un’unica tecnica di consegna e intrusione durante la conduzione di una campagna. Le tecniche osservate indicano che gli aggressori sono riusciti nella loro fase di pianificazione a identificare i punti deboli da sfruttare, come la natura generale di fiducia degli ingegneri e la fiducia intrinseca e la dipendenza dall'I.C.S. catena di fornitura. Inoltre, offre tre intrusioni da mappare contro I.C.S. Catena di uccisione informatica. Nella prima intrusione, l'e-mail di spearphishing, l'avversario avrebbe prima effettuato una ricognizione per determinare i buoni obiettivi e personalizzare le e-mail di phishing. Successivamente, gli autori hanno effettuato un'arma combinando un file con un exploit e allegandolo all'e-mail di spearphishing. È stato effettuato un targeting specifico per scegliere quali persone avrebbero ricevuto l'e-mail. L'e-mail stessa era il meccanismo di consegna e, quando l'utente apriva il file allegato all'e-mail, sfruttava il sistema per installare il malware Havex. Quindi, il malware Havex ha tentato di comunicare con uno delle centinaia di server C2. Havex ha quindi scansionato l'ambiente per scoprire I.C.S. componenti, raccolgono le informazioni e le esfiltrano sul server C2 affinché l'avversario possa raccoglierle. L’intrusione di phishing basata su e-mail ha colpito soprattutto la rete esterna. Questo metodo aveva meno probabilità di fornire informazioni specifiche sull'I.C.S., tranne nei casi in cui le organizzazioni conservavano file di ingegneria nella rete aziendale. La seconda intrusione, i siti Web infetti, ha seguito da vicino la prima intrusione, ma ha utilizzato altri metodi per eseguire la Fase 1. Da notare, l'intrusione contro I.C.S. i siti web dei fornitori avevano la propria kill chain e quella dell’avversario.
 Le intrusioni HAVEX hanno raggiunto la Fase 2 con accesso all'I.C.S. reti nel momento in cui l’I.C.S. erano in corso la scansione delle porte e la scansione OPC. Ciò si qualificherebbe per la fase di sviluppo della Fase 2.

© 2021 Robert M. Lee 124
 IO
 GONF (Possibile) Riemersione

* Nel 2017 Symantec ha segnalato una ricomparsa del soprannominato Dragonfly
 Caratteristica Dragonfly (2013-2014) Dragonfly 2.0 (2015-2017) Forza del collegamento
 Backdoor.Oldrea Sì No Nessuno Dragonfly 2.0
 Trojan.Heriplor (Oldrea fase ll} Sì Sì Forte

* Il gruppo è compromesso
 numerose aziende elettriche a 'Trojan.Karagany Sì Sì (Trojan.karagany.B) Medio-Forte il livello di controllo ed esfiltrazione | pojsnussiccarogany stage) Sì ves Mediumisirong, screenshot dell'HMI e altre informazioni interne “Il settore energetico occidentale preso di mira Sì Sì Medium
 Compromissioni strategiche del sito web Sì Sì Debole

* La valutazione era per sabotaggio ed era fortemente collegata a {phishing emai Sì Sì Weak Dragonfly 2.0 è stato discusso
 Applicazioni trojanizzate. Sì Sì Debole
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Nel 2017 Symantec ha identificato il gruppo Dragonfly 2.0 e ha notato che aveva compromesso diverse società elettriche statunitensi sul lato della rete OT. L’analisi era accurata riguardo alle compromissioni ed è stata supportata da Dragos che ha identificato il gruppo pericoloso come DYMALLOY e ha identificato numerose vittime nella comunità elettrica statunitense. Tuttavia, Symantec e Dragos non erano d'accordo sul collegamento a DRAGONFLY. Symantec ha posizionato il grafico a destra come prova della connessione, ma le connessioni erano molto deboli rispetto a quanto presentato pubblicamente. Inoltre, Symantec ha sottolineato come ciò significasse che il gruppo era pronto a “cambiare posizione” sulla capacità di generazione di energia degli Stati Uniti. Anche Dragos ha smentito questo, sottolineando che lo spionaggio che il gruppo stava svolgendo, ad esempio rubando screenshot dell'HMI e documenti tecnici, era preoccupante, ma era un'ulteriore prova dell'incapacità del gruppo di essere dirompente in quel momento. L'argomentazione era essenzialmente che il furto di tali informazioni dimostrava che il gruppo era ancora in una modalità di apprendimento e spionaggio. È il tipo di informazioni che ruberesti per eventualmente distruggere gli obiettivi, ma non essere in grado di farlo immediatamente.
 Tuttavia, nonostante il dibattito, il gruppo ha dimostrato che l’I.C.S. da gruppi di minacce e una crescente sofisticazione nel prendere di mira direttamente le reti I.C.S./OT.
 Riferimento: Dragonfly 2 Symantec.pdf
 122 © 2021 Robert M. Lee
 422
 io)

@)
 a®® &
 afhh®
-» ww ww w@ wow ww wow wow ww ww ww w&w ww wow ww wb ww Ww wT Ww ww w
 I.C.S. Architetture e topologie
 I.C.S.S15 | I.C.S. Visibilità, rilevamento e risposta 123
 

© 2021 Robert M. Lee
 123 Varie architetture di sistemi di controllo

* Molti ambienti operativi sono diversi e contengono un'ampia varietà di apparecchiature e architetture dei fornitori

* Tuttavia, molti degli ambienti di automazione più complessi fanno molto affidamento sui fornitori DCS e SCADA già avviati
 architetture
+ Queste architetture vengono adattate e cambiano rapidamente rispetto al design originale
* È comunque utile averli come comprensione concettuale
» È possibile trovare indirizzamenti logici simili da impianto a impianto dello stesso tipo di DCS

» Esempio: gli schemi IP di Emerson Ovation possono essere coerenti tra i siti
 I.C.S.515 | Visibilità, rilevamento e risposta dell'I.C.S. 14
 Sarebbe un errore presumere che esistano solo poche architetture o poche configurazioni di sistemi di controllo che possono essere memorizzate. Tuttavia, alcuni dei principali fornitori offriranno una configurazione DCS o SCADA completa per i clienti o una configurazione specifica per elementi come un sistema di gestione del bruciatore. Molti clienti ne approfittano e hanno un copia/incolla della tipica architettura di riferimento. Detto questo, molti clienti dispongono anche di ambienti estremamente diversificati e integrati costituiti da più fornitori e non esiste un’architettura standard.
 È utile conoscere alcune architetture e come funzionano per capire come I.C.S. le reti possono essere architettate.
 124 © 2021 Robert M. Lee
 Ciao @&
 7 ® & HH OO OH HH H Ww
 ao @® @
 na nannnaaeaa ao wy
 oOo 8 © WO OB Oo WO BH ee SP YS wb
 wo WO oO Ww Ww
 wo
 Esempio: impianto di etilene
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Nelle prossime diapositive mostreremo la vista di un impianto di etilene da un ambiente Siemens per mostrare come può apparire una topologia dal livello di impianto all'indirizzamento di rete. Ad alto livello, un impianto di etilene fornisce materia prima per la creazione di un'ampia varietà di prodotti in tutta l'industria petrolchimica. Un prodotto comune è l'etilene di grado polimerico. In un impianto di questo tipo, uno dei processi industriali interessati è un forno di cracking, talvolta noto come steam cracker o carbon cracker. Il cracking è un processo in cui le molecole organiche, come gli idrocarburi a catena lunga, vengono scomposte in molecole più semplici.
 Riferimento: digitaltwin-etilene.pdf

© 2021 Robert M. Lee 125
 125
 1CS515| Visibilità, rilevamento e risposta I.C.S. 126
 Mentre ci concentriamo sul cracker di carbonio nell'impianto, sul lato sinistro possiamo vedere una vista schematica di un cracker di carbonio. Sul lato destro, un cracker simile ma mostrato con una migliore comprensione della fisica in atto. Ci sono molti punti in questo processo per il rilevamento e la misurazione, oltre a garantire che il sistema e il processo siano sotto controllo. Viene utilizzata molta strumentazione e deve essere monitorata attentamente. Ciò avverrebbe nel sistema di controllo come un DCS.
 Riferimento: digitaltwin-etilene.pdf
 126 © 2021 Robert M. Lee

"®
 voeowommn he OW O® WH WH
 rnremm a

®

"> m ® ® Oo Ww Ww we Hw Pe DP ey wD wD ee Ow
 wo wo Ow Ww Ww w
 wo ws Ww
 Noi
 I.C.S.SI5 | I.C.S. Visibilità, rilevamento e risposta
 Qui vediamo un esempio di HMI di quel cracker di carbonio da un sistema Siemens SIMATIC PCS7. Questo DCS visualizza un diagramma delle tubazioni e della strumentazione del processo.Vediamo le varie misurazioni che vengono rilevate in un dato momento e la vista schematica che offre all'operatore una visione del processo fisico e quali sistemi sono operativi, come valvole specifiche e i loro stati (aperto/chiuso).
 Riferimento: digitaltwin-etilene.pdf

© 2021 Robert M. Lee 127
 427
 Architettura del sistema di controllo
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Dal punto di vista dell'architettura del sistema di controllo, possiamo vedere il sistema Siemens strutturato ad alto livello, compresi gli switch industriali SCALANCE X, le opzioni di rete per Profibus (seriale) o Profinet (IP) e i diversi controller come Siemens SIMATIC ET 200. Il Siemens SIMATIC ET 200 è un I/O modulare spesso utilizzato con controllori come il SIMATIC S7-300.
 Questa architettura ci aiuterebbe a comprendere i tipi di dispositivi che dovremmo vedere sulla rete e quali dispositivi non sarebbero visibili in rete ma sono comunque presenti.
 Riferimento: digitaltwin-etilene.pdf
 128 © 2021 Robert M. Lee
 428
 oeoe@neo mm © M7 DOD HD HD DH DH DH MO wH Oo
 oh @
 no fF © ® eS © 6 @ BY Oo WO WY FP OS OS DS DS DS ww
 w noi wo Fw Ww Ww &
 sì
 Informazioni sulla rete
 ee è SERIO ena ale
 Assegna il nome al dispositivo
 Nome del dispositivo: [eT200Mnct x] Oe

™ Mostra solo i dispositivi dello stesso tipo I~ Visualizza solo i dispositivi senza nome
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S. 129
 Il DCS stesso consente il collegamento in rete e il controllo di apparecchi come ad es. ET 200M. Qui vediamo che gli operatori possono assegnare ai dispositivi informazioni e nomi sull'indirizzo di rete. IP, MAC, Tipo di dispositivo e Nome dispositivo sono tutti ottimi elementi da acquisire per l'inventario e, cosa ancora più importante per il concetto di topologia, sono utili per aiutare a decifrare ciò che vediamo sulla rete e convalidarlo con la vista delle operazioni. Queste informazioni possono essere raccolte passivamente sulla rete attraverso l'analisi del traffico, ma questa è una buona opportunità per convalidare la configurazione con ciò che vediamo attraverso l'analisi del traffico.
 Riferimento: PCS7Engineering.pdf

© 2021 Robert M. Lee 129 Westinghouse Erson Ovation I&C Syst
 Host di sicurezza del tegumento (antivirus).
 Piattaforma di sistemi Controtier(s) 1&C
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S. 20
 Westinghouse è un nome ben noto nel settore dell'energia nucleare. Dispongono di componenti personalizzati e sfruttano anche i sistemi di controllo Emerson Ovation e DCS. In questo esempio possiamo comprendere la topologia dell'I.C.S. rete per cominciare. Ovviamente non disponiamo dell'indirizzamento e non tutte le risorse verranno visualizzate qui, ma è un buon punto di partenza. Comprendere il contesto e il ruolo dei sistemi che troveremo sulla rete, come Advant Ovation Interface Gateway e come riceve comunicazioni unidirezionali dal sistema di sicurezza) è un contesto incredibilmente utile da avere. Questo è un tipo di distribuzione standard.
 Riferimento: NA-0093 Informazioni e controllo.pdf
 130 © 2021 Robert M. Lee

"" tf con &
 fo@me@nonmnmm? 7 @® DMD DH HD DH HN
 07:00 @& @
 a wow wD ewe ob be De w
 wow wW
 w
 Emerson Ovation per l'energia solare concentrata
 Aziendale

¢ Architettura di Emerson Ovation per un impianto di energia solare a concentrazione
 Si noti che l’architettura non è specifica per l’energia solare fino alla strumentazione e al controllo dei componenti del campo
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 È interessante notare che, se consideriamo Emerson Ovation e ci concentriamo su altre due diapositive, vedremo che la configurazione di Ovation è abbastanza simile per impostazione predefinita per cominciare, indipendentemente dal settore in cui viene utilizzata. Qui si associano a un modello simile a Purdue e fornire una visione dell'architettura di come apparirà la rete dal punto di vista dell'operatore Windows HMI/EWS, nonché dei controller Ovation e di cosa c'è dietro. Vediamo anche che dovrebbero esserci gateway Smart Wireless sulla rete e dispositivi wireless in basso.
 Concentratevi però sulla parte inferiore che comunica attraverso le diverse interazioni con lo strato fisico e altri I/O remoti situati presso l'impianto di energia solare concentrata.
 Riferimento: Ovation DCS e SCADA per CRPs.pdf

© 2021 Robert M. Lee 131

$ 31
 Emerson Ovation per la centrale idroelettrica
 Ovation) Architettura SCADA per Grandi Impianti Idroelettrici

« Ad esempio, l'architettura dell'impianto idroelettrico è identica all'architettura solare
 Le architetture OEM per diverse linee di prodotti integrati spesso rimangono simili
 Le reti, le specifiche, la personalizzazione, ecc. diventano tutte molto diverse
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Confronta ciò che vediamo qui con l'impianto di energia solare concentrata nella diapositiva precedente. È la stessa identica configurazione con lo Smart Wireless Gateway spostato dal lato destro dello schermo a sinistra. Questo non è un marketing intelligente, è solo che dal punto di vista di Emerson, come di altri OEM, i sistemi di automazione che costruiscono e i controller sono pensati per essere riproposti e utilizzati in una varietà di ambienti diversi.Quindi la topologia cambierà quando entreremo nella rete e vedremo le diverse configurazioni e interazioni, ma molti dei componenti e alcune architetture di livello superiore potrebbero essere molto simili, non solo da sito a sito ma da settore a settore. Avere familiarità con questo accelererà le nostre valutazioni e l’identificazione delle risorse e delle loro comunicazioni.
 Riferimento: https://studylib.net/doc/183 15893/ovation-dces-and-scada-solution-for-idroelettrico-power-pl...
 132 © 2021 Robert M. Lee
 432

“- @&
 om@?me@oeen® © ® WHHH HH WH NH
 Qo @D@® &® &®
 UN
 oo sì, che cavolo &
 w
 w
 vy Fe wo WO ww Ww
 ee YS 6 S&S SC EB GF BY YG
 w
 Caso di studio: Centro Controllo Rete Elettrica
 Centro di controllo primario

*Quali sono le funzioni critiche?
* Raccogliere e valutare dalle primarie
* Valuta rapidamente il backup per garantirne la funzionalità
*Come effettueresti la raccolta dei dati?

* Ambiente basato su Windows
* Focus sui sistemi core e su quelli con sistemi ridondanti
*Cosa sarebbe interessante?
* Il posizionamento dell'avversario viene prima nei sistemi di backup?
* È l'avversario in qualsiasi formazione fonminaiiiddnamene
 sistemi? r connessi tramite percorsi di comunicazione SCADA aziendali, in affitto o dedicati
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Considera questo esempio di architettura di un centro di controllo della rete elettrica. Abbiamo il Centro di controllo primario (PCC) e il Centro di controllo di backup (BCC). I due sono probabilmente collegati in diversi modi, ma non senza passare attraverso sistemi di sicurezza come i firewall. Il centro di controllo utilizza un sistema di gestione della distribuzione (DMS) che viene utilizzato per ridurre i tempi di fermo, l'efficienza, programmare il lavoro, mantenere la consapevolezza su interruzioni e riparazioni e, infine, fungere da controllo di supervisione per la distribuzione dell'elettricità. Il sistema di gestione dell'energia
(EMS) qui è solo un ambiente di test. Un EMS è solitamente focalizzato sull’aumento dell’efficienza e sul mantenimento dell’equilibrio per la generazione e la trasmissione di elettricità.
 In questo ambiente, dovremmo sapere prima dell’incidente quali fossero le funzioni critiche. Un'infezione di qualsiasi tipo sia nel PCC che nel BCC sarebbe motivo di grande preoccupazione, mentre un'infezione in uno solo sarebbe allarmante ma non così grave poiché il backup viene mantenuto. Probabilmente la raccolta dei dati dovrebbe essere coordinata, soprattutto se ci fosse una separazione fisica per questi siti. Tuttavia, anche nello stesso centro di controllo, vorremmo concentrarci sulla raccolta di dati da sistemi come server di controllo, stazioni operatore e stazioni di ingegneria prima di tentare di valutare server di file e stampa, server di backup office, sistemi di supporto, ecc. Dovremmo analizzare l'intero ambiente, ma è importante concentrarsi sulla raccolta dei dati dai sistemi principali e da quelli con sistemi ridondanti. Ad esempio, potrebbero esserci cinque diversi HMI e potrebbe essere necessario che siano solo uno o due in funzione alla volta.
 Anche ciò che l’avversario sta facendo nell’ambiente potrebbe essere molto significativo per noi. Si posizionano prima nell'ambiente di backup e poi tentano di accedere al PCC? Questo potrebbe essere un tentativo da parte di un avversario intelligente di paralizzare il centro di controllo. Sono nell'ambiente di test EMS e stanno estraendo dati? Potrebbero probabilmente trovarsi nelle fasi iniziali dell’I.C.S. Cyber ​​Kill Chain e non avere una buona familiarità con l'ambiente. ~

© 2021 Robert M. Lee 133
 133
 Sistema SCADA Honeywell Experion HS

* Molti componenti di qualsiasi DCS/SCADA/ecc. il tipo di architettura sarà simile, inclusi server dati, storici, EWS, HMI, PLC, IED, ecc.
 I progetti cambiano per diversi tipi di processi come un sistema di gestione del bruciatore
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 Le architetture tra i diversi fornitori seguiranno più o meno la stessa struttura prevedendo server e storici dei dati, stazioni operatore come HMI ed EWS e controller come i PLC. L'architettura di livello superiore tende a conformarsi all'approccio del settore. I componenti stessi, i loro collegamenti di comunicazione e il modo in cui si integrano con altri componenti saranno diversi. Comprendere questo può semplificare l'approccio per cercare di comprendere rapidamente i diversi sistemi I.C.S. posizioni. Questo è specificamente il confronto dei fornitori. Quando osserviamo tipi di processi completamente diversi (batch vs. discreti vs. continui come esempio) o settori, spesso troviamo differenze significative.
 Riferimento: HoneywellProcess.com
 134 © 2021 Robert M. Lee

')
 nn nnenm} wh ® ww
 ao
 2
 onan om@
 su wy

»o » @&
 vy YY YY ww» wD wD Ww
 wo © oS & G&S YB YS YY wow wy
 SS
 Sistema di controllo dell'impianto Rockwell Automation
 Ethernet convergente a livello di impianto
. . . Modello di rete industriale Diversi settori a Comoate Ote
 i tempi avranno diverse applicazioni TH xsi ace Hf,
: | ~~ ont | a Internetworking, architetture e [| | Server dati,
 back-office Mainframe e_/ Fai, 1 Dipendenze Storage Server (ERP, MES, ecc.) Lf
 Questo Rockwell si concentrò & t i} a
 Controllore
 pianta evidenzia il || Superiore | sft conte | necessità dell'ERP e - | =<
 Sicurezza uomo-macchina 7 1 8 Uomo

£'. a Interfaccia (HMI | | po fPoofiid Machi MES in questo ambiente "=" && tors ives) 0 Lecbeobent BB ics ISOS at (HM)

| |
 Ri io | Altro H
 cbs FS ‘op er npulOutpu Industrial Network
 EtherNeviP>>
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 135
 Nell'esempio sopra, vediamo un'architettura Rockwell per un modello di rete industriale convergente a livello di impianto. Noterai che ci sono connessioni con l'azienda per la condivisione e l'elaborazione dei dati, nonché connessioni con i sistemi di "back-office" da cui dipende l'impianto, come il sistema ERP (Enterprise Resources Planning). Il sistema ERP gestisce i processi aziendali come l'evasione degli ordini, le attività e le informazioni sulla spedizione. Il Manufacturing Execution System (MES) è una parte importante della maggior parte dei processi produttivi in ​​cui viene effettuato il monitoraggio completo e la documentazione delle materie prime fino ai prodotti finiti. Sebbene possano sembrare sistemi IT, sono sicuramente sistemi OT; se si interrompono, il processo di produzione ne risentirà o dovrà essere interrotto completamente.
 I principi base alla base di tutti i sistemi I.C.S. si applicano ancora a HMI, attuatori, controller, EWS, ecc., ma i tipi di sistemi che ti aspetteresti di trovare e l'architettura di livello superiore dell'impianto di produzione potrebbero essere completamente diversi da quelli
 cosa ti aspetteresti di trovare in un carbon cracker.
 Riferimento: Rockwellplantwide.pdf

© 2021 Robert M. Lee 135 OSlsoft Pi Storico

* Oltre al tradizionale I.C.S. componenti di rete, Avion è incredibilmente importante comprenderli
 architettura degli storici
 e diversi sforzi per
 ottimizzare l'impianto o sfruttare le iniziative di trasformazione digitale |
 Questi possono spesso rivelare dipendenze o connettività cloud
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 136
 Per quanto sia importante comprendere l’I.C.S., è anche incredibilmente importante comprendere l’architettura dei dati. Gli storici sono un ottimo esempio di sistema in I.C.S. reti che non sono lì solo per aiutare a risolvere i problemi e comprendere i guasti, ma anche per offrire opportunità per ottimizzare il sistema I.C.S. con processi produttivi più efficienti. Inoltre, le informazioni storiche possono essere utili per la fatturazione e il monitoraggio di ciò che viene fatto nello stabilimento. Ad esempio, potresti utilizzare un Pi Historian per capire quanta elettricità viene utilizzata da un cliente industriale per fatturarlo in modo appropriato.
 L’architettura Pi Historian in questo caso non si relazionerà direttamente alla topologia della rete, ma ad alto livello possiamo capire rapidamente quali tipi di connessioni dovremmo vedere. Potremmo trovare una connessione Pi Vision alla rete aziendale, ma potremmo anche trovare connessioni dirette a un server cloud AWS. Anche le comunicazioni OPC interne tra i controllori allo storico dell'impianto sarebbero comunicazioni importanti da essere pronti a trovare.
 Riferimento:
 https://www.automationworld.com/analytics/article/2117381 2/data-analysis-helps-glassmaker-see-through-its-processs
 136 © 2021 Robert M. Lee
 roeow@eeon@ewnnn»#wnnmnnm wm @

@ @ @ im ® dD @@
 ft 2D wwe ew wv» wm Dy vw wo wD w
 w w w
 w

>
 2
 sì sì sì come
 COME
 Mappe topologiche

¢ Valore:
* Crea disegni di rete, flussi di dati e diagrammi di interazione delle applicazioni per capire come appare la rete e cosa può essere considerata un'attività normale
* Avere punti di riferimento facilmente disponibili per gli incidenti
* Fonte:
* Sono disponibili strumenti open source e a pagamento
* Documentare i risultati su mappe digitali o fisiche
* Metodologia:
* Utilizza l'analisi del traffico, i file di configurazione e le informazioni disponibili per comprendere la rete
* Documenta i tuoi risultati lungo il percorso, anche se temporaneamente disegnati a mano
* Costruisci un quadro completo della rete con la data delle informazioni
* Archiviare sempre in modo sicuro e protetto i diagrammi di rete
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Identificare e convalidare risorse e reti è in definitiva inutile se non si documentano i risultati. Dovrebbero essere create mappe topologiche per la rete e le risorse, nonché per i flussi di dati e le interazioni delle applicazioni. La mappa più importante da creare è la mappa della rete e delle risorse. Dopo aver eseguito correttamente questa operazione, è importante passare al flusso di dati, che sarebbe il tipo e il volume di dati normali, anziché solo le connessioni tra i dispositivi. Infine, è importante documentare le applicazioni e i servizi presenti in rete e il modo in cui interagiscono. I team addetti all'architettura di rete dovrebbero fornire la maggior parte, se non tutte, queste informazioni al personale di difesa attivo. Nel mondo reale, tuttavia, è normale che il personale di difesa attivo debba identificarlo da solo. Le mappe di architettura sono generalmente obsolete o mal costruite. Quando avrai queste mappe, assicurati di condividerle con il personale dell'architettura.Documenta tutto ciò che hai trovato attraverso la scansione, l'analisi del traffico, l'ispezione fisica e l'analisi dei file di configurazione. Combina la tua documentazione con qualsiasi informazione nota o di supporto. Queste informazioni possono provenire sotto forma di aiuto da parte di operatori e ingegneri o da ordini di acquisto. (Segui i soldi!) È meglio usare mappe disegnate a mano mentre prendi appunti iniziali su ciò che è presente sulla rete. Tuttavia, le mappe disegnate a mano non sono una soluzione permanente. Alla fine, vorrai creare una mappa completa (o una per la rete e le sue risorse, i flussi di dati e l'interazione con le applicazioni) su cui lavorare e condividere. Comprendere il panorama delle minacce ed eseguire il monitoraggio della sicurezza della rete sarà difficile senza questa mappa aggiornata regolarmente. Un modo gratuito per creare tali mappe è utilizzare lo strumento OpenDraw, che fa parte della più ampia suite gratuita OpenOffice. È essenzialmente una versione open source di Visio. Contiene icone che possono essere utilizzate per rappresentare risorse e dispositivi di rete, nonché le connessioni tra loro. Tuttavia, come con la maggior parte degli strumenti gratuiti, richiede più tempo rispetto all’acquisto di qualcosa come Visio o all’utilizzo di uno strumento più robusto.

© 2021 Robert M. Lee 137
 Caso di studio: esempio di sistema di controllo della zavorra per piattaforma petrolifera

*Piattaforma petrolifera offshore
* Sistema di controllo della zavorra e sistema di sicurezza per ciascuna gamba
* Rete prevalentemente piatta
* Due segmenti di rete
* I livelli di perseguimento sono concettuali
* Punti di raccolta multipli
* Firewall mGuard per la comunicazione in ingresso e in uscita
* Switch di rete (lato I.C.S.) per le comunicazioni della rete di controllo interno
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 138
 Per comprendere come i protocolli possono funzionare insieme in un I.C.S., si consideri il sistema di controllo della zavorra di una piattaforma petrolifera offshore. Il sistema è importante per l'attrezzatura per assicurarsi che rimanga a galla correttamente senza sbilanciarsi o ribaltarsi. Ogni “gamba” dell'attrezzatura ha il proprio sistema di controllo della zavorra e, in questa configurazione, ha anche un sistema di sicurezza. Il sistema di controllo del ballast in questo caso funziona su una rete dotata di mGuard Firewall (un tipo di firewall I.C.S. di Phoenix Contact che esegue un'ispezione approfondita dei pacchetti sui protocolli I.C.S.. In molti casi, questi sono anche in grado di supportare il mirroring delle porte). L'impianto è quindi accessibile da remoto attraverso il VSAT e attraverso vari punti di accesso remoti per il fornitore e l'integratore del sistema di controllo. L'impianto dispone di una server farm come una normale rete informatica e ha numerose comunicazioni in corso. All’interno della rete di controllo, è tutto un processo abbastanza statico. La prossima slide entrerà più in dettaglio sull'I.C.S. rete stessa.
 138 © 2021 Robert M. Lee

@
 ror 8 OO DO who oO
 oo @ @ @ @ @

@®
 wow ww» Pw Pp ww YD wD w
 noi OW WwW Ww Ww Ww Ww
 Ww
 Caso di studio: petrolio
 Protocollo
© Frame c Soa PINES eV Aa! iim ieee

©Ethernet

© Protocollo Intermet Versione 4

© Protocollo Controllo Trasmissione! Sistema di controllo della zavorra Sistema di sicurezza della zavorra

| EtherNet/lP (protocollo industriale) B mee [a] eee
® Protocollo industriale comune = Lettura/Scrittura =
 cioè
© TPKT - ISO su TCP - RFC1006
 Protocollo di trasporto orientato alla connessione COTP ISO 8073/X.224
© Modbus/TCP Voce di testo
{Servizio di sessione NetBIOS
\F Protocollo datagramma utente

--an-n-n-=====-Richiesta seriale BPCS per SI&—-----——-----|
 Protocollo di risoluzione degli indirizzi Protocollo di rilevamento del livello di collegamento

* Modbus TCP ed EtherNet/IP per il PLC Rockwell che gestisce il sistema di controllo del reattore
* SZ su ISO-TSAP per il sistema di sicurezza basato su Siemens (LLDP emesso anche dal PLC Siemens)
* NetBIOS specifico per l'HMI Windows basato su Microsoft con richieste prevedibili
 I.C.S.5IS | I.C.S. Visibilità, rilevamento e risposta —_139
 Se analizziamo la rete degli autobus del terminal per il sistema di controllo della zavorra su questa piattaforma petrolifera, scopriremo che ogni tratta (quattro sulla piattaforma) ha un sistema di controllo della zavorra e un sistema di sicurezza. Lo screenshot mostra il disegno di una delle gambe. Gli HMI sono sistemi basati su Windows e, in questo caso specifico, funzionano da una macchina virtuale sebbene non sia visibile nell'immagine (utilizzando NetBIOS che può essere cercato in Wireshark utilizzando il filtro "nbns". Controllo del NetBIOS in una rete può aiutare a rivelare nomi di sistemi e potenziali infezioni poiché i sistemi richiamano richieste imprevedibili (le richieste prevedibili sarebbero cose come "Adobe" sui sistemi che dispongono di Adobe Reader). Un HMI è dedicato al PLC Rockwell e utilizza Modbus TCP e CIP su EtherNet/IP per il monitoraggio e il controllo. Il sistema di sicurezza dispone di una comunicazione seriale (PROFIBUS in questo caso) che lo collega al PLC in modo che possa assumere il controllo in caso di situazione non sicura. Il sistema di sicurezza è un PLC Siemens ed è collegato a un altro HMI e comunica tramite S7 tramite il protocollo ISO-TSAP. Anche il sistema Siemens utilizza LLDP per trasmettere le proprie informazioni.

© 2021 Robert M. Lee 139 Ai on
 Topologie create manualmente
 Conversazioni di Tshark

* Sfrutta strumenti open source per identificare i record di comunicazione
 Filtro conversazioni IIPva:<Nessun filtro>
 om®
 192.168.1. 192.168.1. 192.168.1. 192.168.1. 192.168.1. 192.168.1. 192.168.1.

¢ IP Sre/Dst, Porta Sre/Dst, Protocollo 192.168.1.
 192.168.1.

* Cattura in forma testuale il disegno manuale 2.1681.
 1292.168.1.
 come il diagramma di Visio 192.168.1.
 VVVV UNV
 192.168.1. 192.168.1. 192.168.1. 192.168.1. Ethemet: 19 @ IPva: 9) IPv6: 3. A uP » Sip] ]192. 168.1. 192.168.1. 239.255.255.258
*| Indirizzo Porta 8 Porta B a 239.255.255.250
 Conversazioni di Wireshark
 10.0.6.204 192.168.1.1 192, 168.1.193 192.168.1.253 A9638 992 168:1.57 EtherNet-iP-2° 224.0.0.22 -> 192.168.1.253 49690 192.168.1.20 asa-appl-proto I224.0.0.22 192.168.1 . 49689 192.168.1509 EtherNet-IP-2 224.0.0.252 -> 192.168.1. 1 1 1 1
 oo®
 192.168.1215 49717 192.168.1.30 iso-tsap 192.168.1.255 192.168.1. 192.166.1175 49869 192.168.1.51 EtherNet-tP-2 192.168.1.255 -> 192.168.1. 192.168.1.5 49689 192.168.1.51 EtherNet-tP-2 192.168.1.255 192.168.1. 192.168.15 49690 192.168.1.50 EtherNet-tP-2 224.0,.0.252 192.168.1.
 mn@®
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 140
 Sebbene gli strumenti professionali siano utili, è del tutto fattibile creare topologie manualmente utilizzando strumenti open source. Ad esempio, sfruttare Wireshark come abbiamo fatto nei laboratori, o Tshark dalla riga di comando, per identificare e acquisire conversazioni è perfettamente ragionevole. Il problema è che questa topologia è un punto nel tempo e non viene aggiornata continuamente come ci si aspetterebbe da uno strumento professionale. Tuttavia, questo è un ottimo punto di partenza, soprattutto quando si effettua una valutazione di una rete per cercare di identificare le connessioni e mapparle rispetto all'I.C.S. architetture che già conosci.
 mm®
 È importante acquisire almeno le informazioni sulle cinque tuple (IP Src/Dst, porta Sre/Dst e protocollo).
 nm @
 140 © 2021 Robert M. Lee

= Y
 fp oe noi wZ
 noi ww wh
 ww WwW wW
 Se Fee eeEewey w@B ww wy w
 con&
 Strumenti professionali: ' Open Source: Piattaforma Dragos Industrial Defender GRASSMARLIN Tenable/Indegy Forescout/SecurityMatters
 Nozomi
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 141
 Wireshark, TCPdump e Tshark saranno sempre buone opzioni, ma gli strumenti professionali creati per I.C.S. le reti hanno spesso funzionalità utili a un sistema I.C.S. rete, come comprendere il sistema I.C.S. protocolli, utilizzando I.C.S. protocolli per identificare in modo sicuro le risorse o utilizzare metodi puramente passivi per identificare i sistemi. Questi strumenti di solito hanno anche funzionalità di visualizzazione per creare mappe topologiche.
 GRASSMARLIN è stato sviluppato dalla direzione per la garanzia delle informazioni della NSA e rilasciato al pubblico qui: https://github.com/nsacyber/GRASSMARLIN.
 Ora è anche disponibile per interfacciarsi con lo strumento DHS CSET.
 Ferrett è specificamente uno strumento Rockwell per trovare dispositivi Rockwell sulla tua rete. Interagisce con i sistemi per determinare lo stato della configurazione. Dovresti rivolgerti ai tuoi fornitori per determinare se hanno strumenti simili.
 Gli strumenti professionali includono la piattaforma Dragos di Dragos, Tenable.OT/Indegy, Industrial Defender, Forescout/SecurityMatters e Nozomi. Esiste anche uno strumento focalizzato sulla formazione fornito gratuitamente in classe chiamato CyberLens, anch'esso prodotto da Dragos nel 2013 come uno dei primi strumenti di valutazione delle risorse di identificazione della comunità. Non condivide alcun codice o somiglianze con la piattaforma Dragos, ma è qualcosa che il team ha mantenuto in modo che possa essere utilizzato nelle classi SANS per scopi didattici.

© 2021 Robert M. Lee 144 Case study sullo strumento educativo: CyberLens

° Valore: acquisisce il traffico di rete in tempo reale fuori dalla rete o analizza le acquisizioni effettuate da infrastrutture preesistenti offline. Esegue un'ispezione approfondita dei pacchetti per identificare IT e I.C.S. protocolli Fornisce dati ricchi e granulari sul flusso di rete per visualizzare la rete, i servizi richiesti e dati sulla sequenza temporale utili per l'analisi e la risposta agli incidenti
 Esegue l'analisi dei metadati per proteggere i dati sulla privacy e archiviarli all'1% del peap

¢ Fonte:
« Strumento di valutazione solo per scopi didattici
*CyberLens *NON* è la piattaforma Dragos, che è un sistema I.C.S. piattaforma con funzionalità di identificazione delle risorse, informazioni e risposta

° Metodologia:

* Utilizzare per acquisire e analizzare il traffico in tempo reale o acquisire acquisizioni di pacchetti
* Utilizza le sue funzionalità di analisi automatizzata per fornire topologie di rete e ispezione approfondita dei pacchetti di base
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S
 CyberLens è stato creato appositamente per il sistema I.C.S. Comunità. Esegue un'ispezione approfondita dei pacchetti sui protocolli per identificare I/O e comandi di protocollo della comunicazione basata su IP. Inoltre, dispone di una serie di funzionalità per report automatizzati, linee di base e analisi della sequenza temporale. Utile da comprendere per questa sezione è la capacità di CyberLens di identificare le risorse e visualizzare la rete. Ciò evidenzia la potenza della scansione passiva e la sua capacità di vedere il flusso naturale e reale della rete senza manipolare i dati con la scansione attiva.Lo strumento è commerciale, ma l'azienda sta rilasciando una versione gratuita per uso domestico per consentire agli analisti di familiarizzare con il valore di questo tipo di strumenti e per aiutare a comprendere e proteggere le reti domestiche.

**Disclaimer: l'autore del corso è uno degli sviluppatori di CyberLens. Questo non è inteso come presentazione del prodotto o per indicare che CyberLens è migliore di qualsiasi altro prodotto. Lo scopo di questa diapositiva è semplicemente quello di visualizzare il tipo di funzionalità offerte dalla scansione passiva e l'importanza di comprendere i vari livelli attraverso la Deep Packet Inspection. Inoltre, lo strumento è completamente gratuito. Non è lo strumento di Dragos: è solo uno strumento gratuito per aiutare le persone a iniziare.
 Il motivo per cui abbiamo evidenziato questo caso di studio è quello di identificare alcune caratteristiche fondamentali che qualsiasi strumento patrimoniale professionale dovrebbe avere. Le prossime diapositive mostreranno alcune di queste funzionalità.
 Riferimento: https://dragos.com/
 142 © 2021 Robert M. Lee

@

@

>om. a] om
 o.

=

?=

=

> noi ww ww 'es
 Fw we Vw VY VV Ve VP Ve Vey wy WP Ww Ww Ww wh
 w
 In RELI.C.S. avvieremo l'applicazione CyberLens e andremo alla console del server per avviare il server o assicurarci che sia in esecuzione
 EULA®
 Registrazione
 Porta del server (predefinita 133718

, —
 I.C.S.SIS5 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 143
 143
 CyberLens Caricamento Pcap
 Dopo aver avviato il server navigheremo nella pagina del sensore, selezioneremo un file per caricare il peap
(in questo caso la linea di base di Calistoga Water Utility) e quindi fare clic su Carica
 
 144
 opzioni di interfaccia
 eno
 Dimensione finestra @
 Baisancics. Ba desktop | 1cssi5, fata Jarge_bas
 Nome
 Utilizzato costantemente smaill_baselinegcop fy sansics dal sistema di file GB desktop ee Passaggio 2: Ed ropay nick Doubla cick Carica PCAP: set 3
 Fare clic su "carica" ​​dopo che il file è stato caricato
 Abies lebbroso di Sosa potrebbe portare Pome a processare il giorno
 I.C.S.SIS | I.C.S. Visibilità, rilevamento e risposta

© 2021 Robert M. Lee
 144

"Di @&
 owen © © ® OD OH DH OH &
 o7"
 eh

.®s we wo wo w
 Vv vw eyyvrvsve ve VveerVewVevVvevyvevw YB Www ww
 La dimensione della finestra si riferisce alla granularità dei cambiamenti che osserviamo nella sequenza temporale; non stiamo esaminando piccoli cambiamenti tramite una sequenza temporale, quindi 2 minuti vanno bene qui.
 CyberLens elabora il Pcap
 Suep'3: Cambia ta?
 Avvia l'elaborazione e ti avviserà al termine.
 Ferma 2 minuti soletti
 Passaggio 4:

—o Fare clic su Avvia
 Tempo trascorso: 0¢.00:0m
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 14s
 

© 2021 Robert M. Lee 145 CyberLens Visualizzazione della mappa
 Una volta elaborato il pcap, sceglieremo Mappa interattiva, fare clic sul pulsante Avvia per rivedere le opzioni dell'interfaccia per l'acquisizione offline, quindi scegliere un layout ad albero per migliorare l'aspetto della mappa
 Carica acquisizione live/offline

, Archivi ID sensore
 1 Istantanee
 Confronta la mappa corrente
 192.168.1.20
(00:20:45:06:08:46 Fenice
 1CS515| Visibilità, rilevamento e risposta I.C.S. — 146
 
 146 © 2021 Robert M. Lee

» > >» >» > Hh ® ®
 w.m
 M)
 ao f. @&&esimo HF
 a @ ww ww noi w
 Li
 e.a
 4
 Ww noi
 vu vv Vv Ve Ve ve ve Vee wVPeVywyw wy
 CyberLens Revisione Ma
 A questo punto puoi rivedere la mappa come preferisci e strutturarla in zone che hanno senso per te
 Inoltre, er h : i . 168, facile selezione dei dispositivi 00:10:9¢:a0:a9:50 | (Sì, noi Bar ti mostreremo le informazioni Rockwell su di loro, come i protocolli che hanno
 stato visto usare “ ol sso po |
 I.C.S.S515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 147 Zona di controllo
 aweuseag ered (2) Livello operativo
 eaieaede
 192.108,1,2% oreea.90: 0-07 (2) Prono
 uaz ine.3.05 Fatto 7 S08 tee Raastome
 set:9NCO DIO: DOI: Tab TRIRT ASAIO carriere Veore
 192. 20m2.258 s80.9000:0000;0800 IAZR:4A IOI AE henkarsetO4 3636
 I.C.S.SI5 | I.C.S. Visibilità, rilevamento e risposta 148
 CyberLens è un esempio di uno strumento di scansione di rete passiva che esegue l'ispezione approfondita dei pacchetti per I.C.S. comunicazioni. Ci sono due cose da notare in particolare su questa mappa. Innanzitutto, poiché la rete non è stata scansionata attivamente, il "flusso di rete" rappresentato dalle varie linee tra i dispositivi è il flusso naturale. Se questa mappa fosse generata da una scansione attiva, ci sarebbero linee aggiuntive tra il dispositivo che ha scansionato la rete e tutti gli altri dispositivi con cui ha comunicato. La seconda cosa da notare è l'icona sulla mappa su cui puntano le frecce rosse, che verrà ingrandita nella diapositiva successiva.
 Dovresti essere in grado di visualizzare e navigare semplicemente (ad esempio utilizzando la barra della sequenza temporale in basso) nel traffico di rete. Gli strumenti professionali dovrebbero aiutare a risparmiare tempo agli analisti rendendo l'esperienza interattiva, semplice e visiva.
 148 © 2021 Robert M. Lee
 mmm noi
 PP?) mH®
 ronrmnr © ® ® © OO © ® ®
 oa noi ee ee wh
 we Ve vevevsese eee ye Vv wy wwwwiww
 Laboratorio 2.4 I.C.S. Mappatura della rete
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 149
 © 2021 Robert M. Lee 449 Obiettivi dello scenario del corso (6)

°C3PO:
+ Creare una topologia della rete di controllo.
 ine_Hs,
 00:0¢:29:45R4 86 ti Vonweave’ 2.168.0.10 Tesh2c7:05
. KoyoEiec 192.168,
 168,08 00:00:29:7b:ad:74
«Vmware.»
 I.C.S.S15 | I.C.S. Visibilità, rilevamento e risposta
 
 150 © 2021 Robert M. Lee
 150
 nO H OH © H ©
 oo®?® @®©® @ @®o 9 MO HMO WH ®
 ao m® iw
 ww
 Obiettivi dello scenario del corso (7)

* Raffineria di Calistoga
 Qual è l’indirizzo IP e il dominio dell’avversario?
 Qual è il nome del file di progetto dannoso?
 Cosa ha fatto l'avversario al PLC di sicurezza?
 Qual è la routine dannosa nella logica e cosa fa? Qual è la causa principale dell'attacco?
 L’incidente è collegato all’incidente di C3PO?

*C3PO:

* Qual è l'azione dannosa sull'HMI?
* Quale registro è stato manipolato con quale valore?
* Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.S5I5 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 4151