88 8 Oo HEHHHSEHHHKEHeHKeKeKHeHeKeHSHeULSHDD YH
 I.C.S.515 | I.C.S. VISIBILITÀ, RILEVAMENTO E RISPOSTA GIAC Response and Industrial Defence (GRID)
 515.3
 I.C.S. Rilevamento delle minacce
 GIAC
 CERTIFICAZIONI
 NANS
 LA FONTE PIÙ AFFIDABILE PER LA FORMAZIONE, LA CERTIFICAZIONE E LA RICERCA SULLA SICUREZZA DELLE INFORMAZIONI | sans.org

© 2021 Robert M. Lee. Tutti i diritti riservati a Robert M. Lee e/o al SANS Institute.
 SI PREGA DI LEGGERE I TERMINI E LE CONDIZIONI DEL PRESENTE CONTRATTO DI LICENZA DEL CORSO
("CLA") ATTENTAMENTE PRIMA DI UTILIZZARE QUALSIASI CORSO ASSOCIATO AL CORSO SANS. QUESTO È UN CONTRATTO LEGALE ED ESECUTIVO TRA TE (L'UTENTE") E SANS INSTITUTE PER IL COURSEWARE. ACCETTI CHE QUESTO ACCORDO È EFFICACE COME QUALSIASI ACCORDO NEGOZIATO SCRITTA FIRMATO DA TE.
 Con il presente CLA, SANS Institute concede all'Utente una licenza personale e non esclusiva per l'utilizzo del Courseware
materiali didattici, compresi i libri di testo
 soggetto ai termini del presente accordo. Il Courseware include tutti i manuali di stampa e di laboratorio, nonché qualsiasi supporto digitale o di altro tipo, macchina virtuale e/o set di dati distribuiti da SANS Institute all'Utente per l'utilizzo nella classe SANS associata al Courseware. L'utente accetta che il CLA costituisce la dichiarazione completa ed esclusiva dell'accordo tra SANS Institute e l'utente e che questo CLA sostituisce qualsiasi proposta, accordo o altra comunicazione orale o scritta relativa all'argomento
 questione di questo CLA.
 ACCETTANDO QUESTO CORSO, L'UTENTE ACCETTA DI ESSERE VINCOLATO AI TERMINI DEL PRESENTE CLA. ACCETTANDO QUESTO SOFTWARE, L'UTENTE ACCETTA CHE QUALSIASI VIOLAZIONE DEI TERMINI DEL PRESENTE CLA PUÒ CAUSARE DANNI IRREPARABILI E LESIONI SIGNIFICATIVE A SANS INSTITUTE E CHE IL SANS INSTITUTE PUÒ APPLICARE QUESTE DISPOSIZIONI MEDIANTE INGIUNZIONE (SENZA NECESSITÀ DI POSTARE CAUZIONE) PRESTAZIONI SPECIFICHE O ALTRO RILIEVO EQUO.
 Se l'Utente non è d'accordo, può restituire il Courseware al SANS Institute per un rimborso completo, se applicabile.
 L'utente non può copiare, riprodurre, ripubblicare, distribuire, visualizzare, modificare o creare opere derivate basate su tutto o parte del Courseware, su qualsiasi supporto sia stampato, elettronico o altro, per qualsiasi scopo, senza il previo consenso scritto dell'Istituto SANS. Inoltre, l'Utente non può vendere, affittare, noleggiare, scambiare o trasferire in altro modo il Courseware in alcun modo, forma o formato senza l'espresso consenso scritto
 consenso del SANS Institute. .
 Se una qualsiasi disposizione del presente CLA viene dichiarata inapplicabile in qualsiasi giurisdizione, tale disposizione sarà considerata separabile dal presente CLA e non pregiudicherà il resto dello stesso. Un emendamento o
 un'addendum al presente CLA potrebbe accompagnare il presente Materiale didattico.
 e tutti i software e/o strumenti, grafica, immagini, tabelle, diagrammi o grafici
 SANS riconosce che qualsiasi marchio/registrato/copyright
 presentati in questo Courseware sono di proprietà esclusiva dei rispettivi proprietari, tra cui:
 AirDrop, AirPort, AirPort Time Capsule, Apple, Apple Remote Desktop, Apple TV, App Nap, Torna al mio Mac, Boot Camp, Cocoa, FaceTime, FileVault, Finder, FireWire, logo FireWire, iCal, iChat, iLife, iMac, iMessage , iPad, iPad Air, iPad Mini, iPhone, iPhoto, iPod, iPod classic, iPod shuffle, iPod nano, iPod touch, iTunes, logo iTunes, iWork, portachiavi, Keynote, Mac, logo Mac, MacBook, MacBook Air, MacBook Pro , Pro, Numbers, OS X, Pages, Passbook, Retina, Safari, Siri, Spaces, Spotlight,
 Macintosh, Mac OS, Mac Esiste un'app per questo, Time Capsule, Time Machine, Touch ID, Xcode, Xserve, App Store e iCloud sono
 marchi registrati di Apple Inc.
 PMP® e PMBOK® sono marchi registrati di PMI.
 SOF-ELK@ è un marchio registrato di Lewes Technology Consulting, LLC. Utilizzato con permesso.
 SIFT@ è un marchio registrato di Harbingers, LLC. Utilizzato con permesso.
 Legge applicabile: il presente Contratto sarà regolato dalle leggi dello Stato del Maryland, USA.
 I.C.S.$515_3_G01_07

= om, ahi, ahi,
 ce ee a a
 oh
 siamo noi
 I.C.S.515.3 I.C.S. Visibilità, rilevamento e risposta
 SANS | I.C.S. Rilevamento delle minacce

|

© 2021 Robert M. Lee | Tutti i diritti riservati | Versione GO!_07
 Il SANS I.C.S.515 —I.C.S. Il corso Visibilità, rilevamento e risposta è stato sviluppato da Robert M. Lee con il contributo di un gruppo di esperti, le cui diverse esperienze lavorative, conoscenze e competenze si sono realmente fuse per coprire le aree di contenuto specifiche di questo corso. L'autore desidera ringraziarli per il loro sostegno e contributo. Si prega di consultare la pagina seguente.
 Robert M. Lee
 Robert M. Lee è CEO e fondatore della società di sicurezza informatica industriale (I.C.S./OT/IloT) Dragos, Inc. È un istruttore senior SANS e autore del corso SANS I.C.S.515 —“I.C.S. Visibilità, rilevamento e risposta” e autore principale di SANS FOR5S78 – “Cyber ​​Threat Intelligence”. Attualmente è anche un impiegato del servizio speciale del Dipartimento dell'Energia nel comitato consultivo per l'elettricità in qualità di vicepresidente del comitato per la sicurezza nazionale sulla resilienza della rete.
 Robert ha iniziato la sua carriera nel campo della sicurezza informatica negli Stati UnitiAir Force, dove ha prestato servizio come ufficiale delle operazioni di guerra informatica presso la National Security Agency. Ha svolto missioni di difesa, intelligence e attacco in varie organizzazioni governative, inclusa l'istituzione di una missione di scoperta delle minacce I.C.S./SCADA unica nel suo genere che unisce insieme risposta agli incidenti, caccia alle minacce e intelligence sulle minacce. Infine, Robert è autore del libro SCADA and Me, Threat Intelligence and Me, Santa and Me e del settimanale web-
 fumetto http://www.LittleBobbyComic.com
 Robert può essere trovato su Twitter @RobertMLee o contattato via e-mail all'indirizzo: RLee@Dragos.com

© 2021 Robert M. Lee 1 Contributi di:
 Tim Conway
 Tim Conway è attualmente il responsabile del curriculum dell'I.C.S. La sicurezza al SANS. È stato responsabile dello sviluppo, della revisione e dell'implementazione dei componenti tecnici del SANS I.C.S. e offerte di prodotti SCADA ed è l'autore del corso I.C.S.456 — NERC CIP Essentials. In precedenza è stato direttore della conformità CIP e della tecnologia operativa presso la Northern Indiana Public Service Company (NIPSCO). È stato responsabile della tecnologia operativa, della conformità CIP NERC e degli ambienti di formazione NERC per i dipartimenti operativi all'interno di NIPSCO Electric. Nel corso della sua carriera, Tim ha lavorato per otto anni come ingegnere dei sistemi informatici EMS presso NIPSCO, con responsabilità sui server del sistema di controllo e sull'infrastruttura di rete di supporto. Tim è stato in precedenza presidente dell'RFC CIPC, è l'attuale presidente del NERC CIP Interpretation Drafting Team, attuale membro del comitato consultivo NESCO, attuale presidente del NERC CIPC GridEx 2013 Working Group e attuale presidente dell'NBISE Pannello di sicurezza informatica Smart Grid.
 Michele Assante
 Michael Assante è stato fondamentale nella creazione di questo corso ed è stata la sua visione che mi ha spinto a crearlo. Questa lezione è dedicata alla sua memoria. Per quelli di voi che non conoscevano Mike, è quasi garantito che la carriera che vi ha portato all'I.C.S. la comunità è stata influenzata da lui ad un certo punto. Ho scritto questo blog su ciò che Mike significava per me e sul motivo per cui non sarei stato dove | sono oggi senza di lui. Spero che queste parole aiutino a mantenere vivo il suo ricordo in questa classe: http://www.robertmlee.org/goodbye-mike-assante-thank-you-for-literally-everything/
 Jeff Shearer e Jason Dely sono entrambi membri del team SANS “SROC” che aiuta a creare e testare componenti tecnici per i laboratori. È grazie al loro lavoro e alla dedizione con Tim che sono stati possibili i kit in classe e le interazioni con loro. Sono stati le menti dietro gran parte del lavoro pratico sui kit e hanno aiutato immensamente.
 Anche i membri del team Dragos hanno contribuito in modo significativo al corso attraverso le proprie ricerche e innumerevoli
 conversazioni. Inoltre, Austin Scott, Grant Freter, Jackson Evans-Davies e altri hanno gestito il poligono e hanno eseguito la squadra rossa dell'I.C.S. raggio d'azione del quartier generale Dragos utilizzato nello scenario del corso.
 2 © 2021 Robert M. Lee
 wo noi noi ee ee Sì noi &
 e’ vs bw SF we ww www ww
 Caso di studio: attacco alle acciaierie tedesche
 I.C.S. Minaccia
 Laboratorio 3.1: Rilevamento delle intrusioni di Fase 1
 Caso di studio: SANDWORM - BlackEnergy 2 e BlackEnergy 3
 I.C.S. Monitoraggio della sicurezza della rete
 Lab 3.2: Indagine sulle intrusioni di fase 2 Lab 3.3: Analisi del traffico della manipolazione del controllo
 e conseguenze fisiche Lab 3.4: Convalida delle modifiche logiche del sistema Lab 3.5: Verifica del punto di campo I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Come vedrai, lo schema di questa sezione si concentra principalmente sul commercio di intelligence. Troppo spesso le persone si pubblicizzano come “analisti delle minacce” o “esperti di intelligence” senza avere una conoscenza fondamentale del mestiere dell’intelligence. Esaminiamo alcune delle minacce presenti nella comunità (come HAVEX) e i luoghi in cui è possibile utilizzare buone pratiche di intelligence per comprendere e difendersi in modo più accurato da tali minacce. Considera questa la sezione "Come è fatto" di questo corso in cui guardiamo dietro le quinte nel mondo dell'intelligence per vedere come vengono realizzati quegli accattivanti rapporti di intelligence sulle minacce.

© 2021 Robert M. Lee 3 Sezione 3 Obiettivi
 Pianifica e acquisisci il potere di cacciare in I.C.S. reti Comprendere le diverse strategie di rilevamento
 Acquisire familiarità con strumenti e approcci comuni
 Identificare i compromessi della Fase 2 in I.C.S. reti
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 La sezione 3 riguarda il rilevamento delle minacce. Inizieremo con la comprensione della caccia alle minacce, ovvero il processo guidato dall'uomo di ricerca proattiva delle minacce nella tua organizzazione. Successivamente passeremo alla comprensione delle diverse strategie di rilevamento e dei tipi di rilevamenti che è possibile utilizzare con vari casi d'uso. Lungo il percorso sarai esposto a diversi strumenti e approcci comuni con l'analisi pratica di un compromesso in un sistema I.C.S. rete. Essere in grado di identificare quando una compromissione è solo un'infezione rispetto a qualcosa che si concentra sull'I.C.S.
(Fase 2 della I.C.S. Cyber ​​Kill Chain) ti aiuterà a stabilire le priorità e a classificarle in modo appropriato.
 4 © 2021 Roberto M.Lee
 Dp

©’ ©) } © WY TY YF © w TF FF FF FF ae Pe Oe ST TG GS G Go oe © &© &© &§ © ©&© @& BW © 6 BW © OB GB GS YS YH GBS |Y | Bw
 w
 vedere Ciclo
(FASE 3)
 o
 P@iewee®
 Wn
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 Gli attacchi informatici mirati sono in aumento e rappresentano un serio rischio per I.C.S. ambienti. La ricerca e la decostruzione degli incidenti stanno iniziando a mostrare che gli aggressori stanno sviluppando strumenti compatibili con I.C.S. e si sono dotati di conoscenze di base su I.C.S. tecnologie e architetture per avere successo. Il successo di questi attacchi dipende dalle capacità esistenti dell'I.C.S. vulnerabilità e l’incapacità delle strategie difensive esistenti di far fronte a campagne di attacco prolungate. Molti I.C.S. le difese sono state ottimizzate per proteggere da attacchi informatici non strutturati e non diretti/mirati. La maggior parte delle strategie si basa su una forte difesa perimetrale con una certa protezione basata su host e una buona igiene della sicurezza. Queste difese sono efficaci contro alcune minacce, ma non riescono a bloccare o individuare i tentativi di intrusione più avanzati. Molte difese, se violate, forniscono poca o nessuna conoscenza di dove sia stato l’avversario e di cosa stia accadendo all’interno della rete di controllo. Dobbiamo evolvere oltre la difesa statica focalizzata sul perimetro e costruire nuovi modelli per integrare le strategie di difesa.
 Benefici
 Questo passaggio del ciclo ti consentirà di aiutare i team di architettura e difesa a rimanere consapevoli dell'aspetto della topologia di rete. Basandosi su questa conoscenza della rete, puoi identificare le stranezze della rete e associarle ad avvisi ed eventi sulla rete per identificare il tipo di avversari che le difese tradizionali non troveranno. Puoi aiutare a prendere decisioni sulla necessità o meno di una risposta agli incidenti e fornire il contesto al team. Puoi anche identificare le parti critiche della rete su cui il team dovrebbe concentrarsi. La fase di identificazione delle risorse e NSM è il punto fermo che tiene insieme il ciclo di difesa attiva. In termini più chiari, le persone che operano in questa fase dovrebbero pensare di avere quattro obiettivi principali:

* Identificare le risorse di rete e le connessioni che i team di architettura e difesa hanno mancato e trasmetterli a tali team affinché li conoscano e li utilizzino.

* Fornire raccomandazioni ai team di architettura e difesa in merito alla segmentazione della rete, ai punti di strozzatura e ai sensori aggiuntivi che potrebbero avvantaggiare NSM.

* Identificare le minacce nella rete oltre ciò che le difese tradizionali troverebbero e fornire raccomandazioni al team di difesa per la messa a punto dei sensori e delle risorse di difesa.

* Identificare se una minaccia è sufficientemente grave da avviare una risposta all'incidente e fornire raccomandazioni al management in merito offrendo al contempo il contesto agli eventi.

© 2021 Robert M. Lee 5 obiettivi dello scenario del corso (1)
 Perfeziona
 Qual è l’indirizzo IP e il dominio dell’avversario?
 Qual è il nome del file di progetto dannoso?
 Cosa ha fatto l'avversario al PLC di sicurezza?
 Qual è la routine dannosa nella logica e cosa fa? Qual è la causa principale dell'attacco?
 L’incidente è collegato all’incidente di C3PO?

*C3PO:

+ Qual è l'azione dannosa sull'HMI?
* Quale registro è stato manipolato con quale valore?
«Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta

«

© 2021 Robert M. Lee Reporting di BSI sull'attacco alle acciaierie

* Il 18 dicembre 2014, il BSI del governo tedesco ha pubblicato un rapporto annuale che evidenzia le indagini svolte nel corso dell'anno, comprese le infezioni Havex e BlackEnergy?2 nei sistemi I.C.S. reti

* Non correlato a Havex e BlackEnergy2 era un rapporto di un attacco informatico che ha causato "danni ingenti" in un impianto di acciaieria Questo è stato solo il secondo caso pubblicamente noto di un attacco informatico che ha provocato la distruzione fisica dei sistemi di controllo
 Questa è stata la prima volta che un governo si è fatto avanti per parlare di distruzione fisica di una struttura senza che fossero trapelate prove/informazioni o senza aver subito pressioni pubbliche
 Rif: Siemens
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Il 18 dicembre 2014, il Bundesamt fiir Sicherheit in der Informationstechnik (BSI, tradotto come Ufficio federale per la sicurezza informatica) tedesco ha riferito i suoi risultati annuali. In un caso è stato riscontrato che un malintenzionato si è infiltrato nella rete aziendale di un'acciaieria. L'aggressore ha utilizzato un'e-mail di spear phishing per accedere alla rete aziendale e poi passare alla rete dello stabilimento. Lì, l'avversario ha mostrato una certa sofisticazione e I.C.S. conoscenza e ha proceduto a causare il guasto di più componenti del sistema. Ciò ha causato la mancanza di regolamentazione di un altoforno, provocando ingenti danni fisici. L’unico altro caso in cui si è verificata la distruzione fisica dei sistemi di controllo (noti al pubblico) è stato Stuxnet.Questa storia emozionante e preoccupante è stata per lo più sepolta nelle notizie (in parte a causa della violazione di Sony, avvenuta esattamente nello stesso momento).
 Riferimenti:
 BS tedesco] Rapporto annuale: https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/Lageberichte/Lagebericht2014.pdf?__ blob
=File di pubblicazione
 Analisi Dragos Security e traduzione in inglese: http://dragossecurity.com/blog/
 L’analisi del Wall Street Journal: http://blogs.wsj.com/cio/2014/12/1 8/cyberattack-on-german-iron-plant-causes- diffuse-damage- report/?utm_content=buffer59558&utm_medium=social&utm_source= twitter.com&utm_campaign=buffer
 8 - © 2021 Robert M. Lee
 D

@@® @®
 TW@®
 TTT®
 eT VT TT TT TT T PT HT OP HP
 oe 8 § &@ 8 Bw 8& © &8 6 & & & & & & SS BS BS BY HY Bw
 Ww
 Concentrarsi sul fatto che è stato valutato che l'avversario disponeva di IT e I.C.S. conoscenza. La distruzione fisica non è un
 3.3 Incidenti della gestione federale
 A differenza della direzione federale, le aziende non hanno l’obbligo di segnalare al BS gli incidenti gravi di sicurezza 1T). Da ormai molti anni UP KRITIS consente agli operatori delle infrastrutture critiche partecipanti di scambiarsi informazioni sugli incidenti. La stronzata! dispone anche dell'Alleanza per la sicurezza informatica, una piattaforma che può essere utilizzata per segnalare (in modo anonimo) incidenti che potrebbero essere potenzialmente rilevanti per altre località o che necessitano di valutazione o per i quali è necessario aiuto.

“L’obiettivo di questa alleanza è acquisire conoscenze sulle nuove tecniche di attacco o sugli incidenti aerei con grandi impatti. La stronzata! analizza i rapporti e rende disponibili le valutazioni in forma anonima ad un'ampia cerchia di destinatari. Questo metodo è utile per fornire informazioni tempestive sui nuovi attacchi e sui possibili metodi di prevenzione.

“Finora hanno contattato la piattaforma soprattutto le piccole e medie imprese. 3.3.1 Attacco APT contro siti industriali in Germania Fatto: attacco mirato a un impianto siderurgico in Germania
 Metodo: Attraverso la pesca subacquea e l'ingegnosa ingegneria sociale, gli aggressori hanno ottenuto il primo accesso alla rete degli uffici dello stabilimento Iron, da lì. Essi

|successivamente si sono fatti strada nelle reti di produzione.
 Effetto dannoso: si è verificato un accumulo di guasti di singoli componenti del sistema di controllo o di interi impianti. I guasti al sistema hanno provocato un incidente in cui non è stato possibile spegnere regolarmente un forno e il forno si trovava in una condizione indefinita, con conseguenti danni ingenti all'intero sistema. Destinatari: Operatori di impianti industriali.

“Abilità tecniche: le abilità tecniche degli altackers possono essere descritte come molto avanzate. Sono stati compromessi numerosi sistemi interni e componenti industriali. Gli aggressori disponevano di un know-how avanzato non solo della sicurezza convenzionale, ma anche di una conoscenza tecnica dettagliata dei sistemi di controllo industriale e dei processi di produzione utilizzati nello stabilimento
 minaccia basata su malware dopo il vettore di attacco iniziale (per quanto ne sappiamo).
 Riferimento:
 Analisi Dragos Security e traduzione in inglese: http://dragossecurity.com/blog/

© 2021 Robert M. Lee
 Esempio di altoforno a ciclo chiuso

@ Diagnosi
@ Controllo della terapia a circuito chiuso
@Spiegazione |

| Tasso di coca cola

| Basicità del carico Iniezione di carburante

| Aggiunta di vapore

| Aggiunta di ossigeno
 Regolazione fine
| della distribuzione degli oneri
 Stufe Hat HMI
 Rif: Siemens I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Un altoforno è un'ottima tecnologia ma non è esattamente l'attrezzatura più sicura. Per renderli sicuri è necessaria molta buona ingegneria, ma dal punto di vista di ciò che può andare storto, questi sistemi sono ancora qualcosa da tenere d'occhio. (= Ad esempio, ogni volta che aggiungiamo insieme cose come carburante e ossigeno, dobbiamo pensare alla sicurezza
 implicazioni. Un avversario inesperto potrebbe anche facilmente cliccare sull'HMI, che mostra abbastanza per poter aggiungere più carburante e ossigeno. Allora cosa lo impedisce? Buona ingegneria della sicurezza. Le misure e i sistemi di sicurezza {= collegati qui aiutano a mantenere le cose in condizioni di sicurezza. Sfortunatamente, se un avversario dovesse rovinare quella sicurezza
 sistemi, o anche solo i sensori che li alimentano, potrebbero causare ulteriore caos.
 Riferimento: Siemens

/
 4

)
 ma ww W
 10 © 2021 Robert M. Lee -
 iw
 w
 Svs OE EH Hwee © wb © noi noi © ww ww
 vu Js
 Crollo dell'Atta che conosce
 Sappiamo che il vettore dell'attacco iniziale era un'e-mail di phishing e che la rete aziendale era il punto di accesso all'I.C.S.. Sappiamo anche che con il tempo i singoli componenti si sono rotti e hanno causato danni fisici. Sappiamo anche che non ci sono altre informazioni riportate come la motivazione dell'attacco.

© 2021 Roberto M.Lee 11 Scomposizione dell'attacco: Gli sconosciuti
 È probabile che la rete aziendale fosse direttamente connessa alla rete dell'impianto o contenesse un accesso attendibile
 Le strutture siderurgiche spesso subiscono un danno

| probabilmente non vede Peatong| | Fatto
_ componenti intenzionalmente di cui si sa e Gadar avrebbe potuto essere un movimento di spionaggio di Cee Eon'
 Sembra che non sia stato coinvolto alcun malware oltre al vettore di attacco iniziale;
 il resto sembra dirigere
 interazione
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Ciò che non sappiamo, ma possiamo fare un'ipotesi plausibile, è che la rete aziendale era probabilmente direttamente collegata alla rete dell'impianto attraverso zone attendibili, o peggio. E sebbene l’impianto siderurgico probabilmente avesse componenti preesistenti, avrebbero dovuto esserci sistemi di sicurezza e sistemi di sicurezza per l’altoforno che avrebbero potuto indicare che l’attacco era mirato. In tal caso, potrebbe essere stato manipolato tramite l'HMI.
 12

© 2021 Robert M. Lee
 a) ) ) it) ee)
 oq qm
 w vw 8 FS Minimo e FF Tariffa ee ee
 vos wv vv vw
 Acciaierie tedesche I.C.S. Catena di uccisione informatica

“FASE 2 – Intrusione
 Consegna
 Installa | Modità

¢:

“Passi osservabili”.
 FASE 2 -I.C.S. Attacco Sviluppo Test Consegna Installa/Modifica
 Esegui l'attacco C3
 Forno
 Attaccare con impatto
 Tenaya ae Network, Ahcations, Serees)
 Gli aggressori hanno effettuato un attacco ad impatto e hanno dimostrato di avere informazioni dettagliate sull'I.C.S. conoscenza. Non era la prima volta che si trovavano in un I.C.S., e il fatto che intendessero o meno provocare l'attacco non ha alcuna influenza sul suo impatto.
 osservazione del difensore.

© 2021 Robert M. Lee 13 lezioni apprese
 Il monitoraggio del sistema di controllo e delle reti di processo ne aumenta l'affidabilità

« Nel corso del tempo si sono verificati più guasti nei componenti del sistema di controllo
 I dispositivi interconnessi e le zone di fiducia verranno sfruttati in modo improprio

+ Gli avversari apprezzano il fatto di prendere di mira le infrastrutture aziendali (terreno familiare); presenta una varietà di metodi per ruotare nel sistema di controllo
 La risposta agli incidenti è importante, anche per chi non si trova in un'infrastruttura critica

+ Sebbene i sistemi dell'impianto fossero fondamentali per i suoi proprietari, era improbabile che potesse essere considerato un'infrastruttura critica a livello nazionale
 La condivisione delle minacce è importante e la minaccia non è sempre rappresentata da malware

* Casi di studio come questo consentono di apprendere lezioni
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 Da questo caso di studio possiamo estrarre alcune importanti lezioni apprese che si applicano direttamente all'ACDC. In primo luogo, il monitoraggio del sistema di controllo e delle reti di processo ne aumenta assolutamente l'affidabilità e la sicurezza. NSM avrebbe identificato comandi strani, traffico di rete e movimenti avversari sulla rete, ma potrebbe anche aver contribuito a identificare il problema molto prima che l’altoforno subisse un guasto. Nel processo di NSM, gli analisti potrebbero anche essere stati in grado di identificare architettura e risorse probabilmente non documentate o sconosciute, comprese connessioni sconosciute all'ambiente aziendale. Se esistessero connessioni note, avrebbero potuto e dovuto essere collocate in configurazioni di tipo chokepoint per l'analisi. I clienti aziendali non hanno mai motivo di potersi interfacciare direttamente con HMI o altri sistemi di controllo.
 Dopo che il personale NSM ha identificato una minaccia, il personale IR avrebbe potuto adottare le misure appropriate per contribuire a mantenere attive le operazioni o, più probabilmente in questo scenario, identificare che le operazioni dovevano essere interrotte prima che si verificasse la distruzione fisica. Probabilmente la struttura non si considerava critica e pertanto potrebbe non aver avuto personale di risposta agli incidenti. Abbiamo anche visto in prima persona che questo caso di studio era importante da condividere con la comunità. È utile in questo corso ed è utile per aiutare gli altri a imparare dalle minacce e a creare le migliori pratiche per la difesa.
 Tutto ciò è più facile a dirsi che a farsi, ma è fattibile. E se vogliamo vincere, dobbiamo adottare una risposta matura agli avversari: tale risposta matura include anche la sicurezza.
 Il vettore di attacco iniziale per l'attacco all'acciaieria era un'e-mail di phishing che probabilmente conteneva una sorta di "carico utile"
(identificato anche come "dropper") per ottenere l'accesso.
 Al di là della rete aziendale, tuttavia, non sembra che fosse coinvolto alcun malware, tuttavia le azioni dell'avversario rappresentavano ovviamente una minaccia per la struttura (intento + opportunità + capacità). Comprendere le azioni della minaccia nella rete dell'impianto richiedeva qualcosa di più della semplice analisi del malware; comprendere una minaccia richiede processi mentali ed esami. Il corso di questa sezione sarà fortemente incentrato sull'analisi del malware perché questa è la maggior parte delle minacce affrontate. Tuttavia, l’interazione diretta di una minaccia senza malware deve essere considerata rilevante e pericolosa, ma anche qualcosa che può essere esaminato, compreso e contrastato.
 14 © 2021 Robert M. Lee
 YF TY F VT WT W

)

®Y @
 ironico? ww © WF ww Ww w@ oe 8 SF Fee ee Fe Hw He KH He He KHeKHKeKeeOHermdrHLDh wh
 I.C.S. Caccia alla minaccia
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 © 2021 Robert M. Lee
 Caccia alla minaccia
 La caccia alla minaccia è una caccia alla minaccia che richiede un focus mirato e iterativo sulle persone
 approccio alla ricerca, ra
 identificare e ; fo, Il tuo lavoro si concentra sugli avversari umani, sulla comprensione degli avversari 4° ma potresti non incontrare avversari
 fonde quello del difensore; È necessaria l'apertura mentale di una persona nuova, ma la caccia non è per persone nuove Valore significativo: ; 5 I venditori di prodotti cercheranno un valore significativo: i 7x ase ma non si tratta del prodotto
 Andare oltre ' y: impronta dell'automazione wy ​​Devi fare affidamento sull'automazione, aggiungendo aes o 4 ma non puoi automatizzare completamente
 eee. ae eee caccia: la caccia è un passo avanti nell'automazione ) ay eA A oltre l'automazione Trovare le lacune nella raccolta i Prepararsi per l'IR
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 La caccia alle minacce è un approccio mirato e iterativo per cercare, identificare e comprendere gli avversari interni alle reti del difensore. Si tratta di una tipologia di difesa attiva (la difesa attiva comprende anche aspetti come la risposta agli incidenti, che non è una componente della caccia alle minacce). Il concetto della caccia alle minacce è che aiuta a garantire che la tua organizzazione identifichi le minacce “sconosciute” che le tue normali pratiche di sicurezza non riescono a rilevare. Si tratta in gran parte di un team specializzato di persone che hanno l’esperienza per dare la caccia alle minacce veramente avanzate.
 Qui presentati sono cinque concetti; ciascuno sostiene il primo, ovvero che la caccia alle minacce richiede che l’attenzione si concentri sulle persone. Questo però non riguarda solo i difensori, ma anche l’avversario. La caccia è l’emblema di un duplice rapporto tra l’avversario e il difensore. Sebbene tutti speriamo di tenere gli avversari fuori dai sistemi, non vi è alcuno scopo nella caccia alle minacce se non esiste alcun avversario. Altri tipi di sicurezza possono contribuire al monitoraggio, all'affidabilità della rete e persino agli aumenti di efficienza operativa osservati attraverso l'interazione della rete e del sistema. Ma
 la caccia è focalizzata esclusivamente sull'elemento umano.
 Il valore della caccia alle minacce non sta solo andando oltre l’attuale impronta di automazione (strumenti, rilevamenti, ecc.), ma anche nel portare avanti tale impronta di automazione. Quando esegui una ricerca, dovrebbe sempre esserci un output, ad esempio la creazione di rilevamenti a partire da ciò che hai cercato per spostare tale sforzo in modo più automatizzato. Inoltre, uno dei vantaggi principali della caccia alle minacce è la rivelazione di lacune nella raccolta e problemi relativi ai dati. In sostanza, la caccia alle minacce lo è
 risposta all'incidente senza l'incidente e può aiutarti a prepararti in modo più completo.
 16 © 2021 Robert M. Lee
 ve TF TF TF FT SF
 w
 ahi @w@ @W
 oo ww ww
 wo wo
 aw a nn a) 2
 CO
 58888S8
 Quando minacciare la caccia
 Verso la fine del tuo viaggio verso la sicurezza

+ Sviluppare e implementare una strategia di rilevamento
 Passare al continuo | Operazioni di sicurezza |

«+ Threat Hunt regolarmente (ad esempio, da trimestrale a annuale) per andare oltre e quindi estendere l'automazione
 All'inizio della tua sicurezza
 Viaggio

« Sviluppa scenari che ti preoccupano

« Pianifica un esercizio da tavolo e un piano IR

¢ Threat Hunt per mettere in pratica quell'incidente e identificare le lacune
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Non è appropriato essere costantemente a caccia di minacce. Ciò che la maggior parte delle organizzazioni chiama caccia continua alle minacce sono semplicemente normali operazioni di sicurezza. La valutazione degli avvisi e la ricerca degli avversari in base ai segnali che ricevi fanno parte della tua impronta di automazione e, in definitiva, sono reattivi (identifica un rilevamento e quindi valutalo). La caccia alle minacce, se eseguita correttamente, è più intensa e fornisce più valore per andare oltre l’impronta dell’automazione. Ci sono due momenti nel tuo percorso verso la sicurezza in cui la caccia alle minacce entra naturalmente in gioco e fornisce il massimo valore.
 Il primo è nei primi giorni del tuo viaggio verso la sicurezza. Mentre cerchi di capire le priorità e cosa farai (ad esempio, la tua roadmap di sicurezza) è molto utile identificare gli scenari di minaccia che ti interessano di più, sulla base di punti di vista basati sull’intelligence e sulle conseguenze. Da lì, è opportuno sviluppare un piano di risposta agli incidenti rispetto a questi tipi di scenari, solitamente dando priorità a 3-5 scenari. Tali scenari dovrebbero trasformarsi in esercizi pratici orchestrati tra IT e OT e spesso con la consapevolezza della leadership esecutiva e altri approfondimenti del team (ad esempio, risorse umane e legale). Tuttavia, un problema comune con gli esercizi da tavolo (TTX) è che si basano su ciò che pensi di sapere sull'ambiente. La caccia alle minacce può rappresentare un enorme valore aggiunto in questo caso essenzialmente testando il TTX. Una caccia alle minacce eseguita in questo modo è in definitiva una risposta all’incidente senza l’incidente. Dovresti prendere il TTX/scenario e creare una caccia nella rete appropriata per cercare la minaccia che ti preoccupa nello scenario. Ciò fornirà un feedback se disponi dei dati che ritieni di avere, come otterresti le immagini forensi di cui avresti bisogno nell'incidente, ecc. L'output idealmente non sarà l'individuazione delle minacce, ma la preparazione ad affrontarle.Inoltre, più avanti nel tuo percorso verso la sicurezza per l'area o i siti di interesse, idealmente avrai inserito un po' di impronta di automazione. L’impronta dell’automazione includerà alcune difese passive che forniscono prevenzione, come i firewall, ma anche difese passive come l’analisi della rete e i prodotti di rilevamento. Chiedi ai tuoi analisti di adottare un approccio di difesa attiva per sfruttare e identificare problemi e minacce. Ti sarai essenzialmente spostato verso operazioni di sicurezza continue. A quel punto, la caccia alle minacce dovrebbe essere effettuata regolarmente, almeno trimestralmente, ma almeno annualmente. Questi possono essere sforzi di dimensioni diverse vincolati dal focus e dal tempo (ad esempio, non limitarti a cacciare a tempo indeterminato perché perderai molto tempo). Qui stai cercando quelle minacce che stanno aggirando la tua impronta di automazione e, così facendo, crei risultati finali come nuovi rilevamenti o posizionamenti di sensori per aumentare la copertura della tua impronta di automazione esistente.

© 2021 Robert M. Lee 17 Un modello pratico per la caccia alle minacce

- Nessun modo per cacciare le minacce

* La priorità dovrebbe essere quella di avere un progetto guidato da esseri umani,
 processo guidato da ipotesi

« Il modello pratico per la caccia alle minacce fornisce un ottimo modello di esempio da sfruttare
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 Non esiste un unico modo per eseguire una caccia alle minacce. Spesso si tratta di un approccio molto personale che dipende sia dall'analista che dall'intento della caccia alla minaccia. Tuttavia, quando la caccia alle minacce è più efficace, è guidata dall’uomo (non essendo eccessivamente dipendente dall’automazione) ed è guidata da ipotesi. Un’ipotesi deve essere qualcosa di facilmente enunciabile e deve essere verificabile. Questi componenti fondamentali delle ipotesi le rendono adatte ad aiutare gli analisti a cercare nelle loro organizzazioni guidando e definendo l’ambito di tale sforzo e garantendo un certo livello di successo come risultato.
 Tuttavia, Dan Gunter e Marc Seitz hanno sviluppato un modello molto utile, qui identificato come il modello pratico per la caccia alle minacce, che si basa su un bel po’ di lavoro svolto nella comunità militare statunitense e su altri modelli, come il modello Diamond. Fornisce un approccio ripetibile alla caccia alle minacce strutturate. È il modello che verrà esplorato qui in classe ed è generalmente raccomandato come modello concettuale.
 Riferimento: Caccia-con-rigore.pdf
 18 © 2021 Robert M. Lee
 rr GP GT THT GH EES OH
 Sono @
 oo a7 09 02 4 @
 om ss os 8 wwe FS ewe we weweeewe ww we
 oso JS J
 Noi

}
 w
 Perché stiamo cacciando? Cosa speriamo di ottenere?
 Pensa ai potenziali risultati e a cosa apporterebbe il massimo valore all’organizzazione.
 Esempio:
 DRAGONFLY ha preso di mira numerose aziende elettriche, minerarie e petrolchimiche del settore I.C.S. reti. Dobbiamo capire se al momento siamo compromessi. Il risultato sarebbe un rilevamento migliore delle capacità di DRAGONFLY.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Nella fase Scopo stai cercando di catturare esattamente il motivo per cui stai cacciando, cosa speri di ottenere dalla caccia e i potenziali risultati che genereranno valore. In sostanza, questo sta definendo il requisito. Senza buoni requisiti, l’ambito della caccia diventerà spesso troppo ampio o non verificabile, con il risultato di cacce prolungate e di minor valore.
 È ideale, ma non obbligatorio, avvalersi di altre persone per fare un brainstorming sui requisiti. Ad esempio, comprendere le preoccupazioni del personale operativo o quelle dei leader aziendali aiuterà a personalizzare il tuo approccio. Puoi anche sfruttare gli eventi emergenti (un nuovo incidente nel tuo settore) e il tuo modello di minaccia (quali tipi di minacce ti interessano di più) per iniziare a soddisfare tali requisiti.
 In questo esempio, potremmo segnalare che DRAGONFLY ha preso di mira numerose aziende e che la nostra azienda lo ha fatto
 sia nel settore elettrico che in quello petrolchimico. Pertanto, vogliamo capire se DRAGONFLY è già nel nostro ambiente o meno, e ottenere rilevamenti migliori come risultato per loro e per i loro TTP.

© 2021 Robert M. Lee 19
* Qual è lo scopo della caccia?

* Dove andremo a caccia e per quanto tempo?

* La creazione di un'ipotesi da verificare e l'ambito strettamente focalizzato garantiranno una caccia di maggior successo.
 Esempio:
 Ipotesi: DRAGONELY ha sfruttato applicazioni trojanizzate nel sistema I.C.S. per distribuire il malware HAVEX.
 Dove: Classe A I.C.S. reti focalizzate sul Livello 2.
 Durata: 5 giorni di analisi.
 Nella fase Ambito è importante mantenere un ambito ragionevole per il tipo di caccia e quante risorse hai. Quando cerchi cose sconosciute, cioè non sai se sei compromesso o meno e stai cercando, ciò può portare a una quantità significativa di dispendio di risorse senza capire quando dovresti smettere di cercare. Pertanto, l'ambito è fondamentale per assicurarsi di terminare la caccia in un periodo di tempo ragionevole: gli analisti amano analizzare e continueranno a cercare se non si preparano al successo fin dall'inizio.
 Per creare un buon ambito, considera non solo la durata della ricerca ma anche i siti e le fonti di dati più rilevanti che potrebbero essere importanti per te.Puoi convincerti di come qualsiasi cosa sia potenzialmente rilevante, ma limitati a ciò che è più direttamente rilevante per ciò che stai cercando. Ad esempio, DRAGONFLY potrebbe trovarsi ovunque nella nostra organizzazione, ma concentrandosi sul sistema I.C.S. di Classe A (alta priorità). reti è la più rilevante per noi, osservando in particolare ciò che sta accadendo al livello di supervisione della rete di tipo HMt/Historian/EWS. Finiremo per preoccuparci davvero dei nativi I.C.S. protocolli come OPC e scansione interna alla rete. In questo caso diciamo che estenderemo lo sforzo a 5 giorni.
 La parte più importante di una caccia è l'ipotesi. Ottenere questo corretto ci aiuterà naturalmente a definire lo sforzo. Una componente chiave delle ipotesi è che sono verificabili. Non formulare ipotesi aperte. In questo caso l'ipotesi è che DRAGONFLY abbia sfruttato applicazioni trojanizzate native dell'I.C.S. rete per distribuire il malware HAVEX. Se disponiamo già di capacità di rilevamento e stiamo verificando gli indicatori di HAVEX, è possibile rimuovere la parte HAVEX dall'ipotesi per notare che le sue applicazioni trojanizzate con nuovo malware sfruttano gli stessi TTP. La caccia non è un controllo e una definizione degli indicatori. Questo è uno sforzo importante, molto più facile da realizzare e non vale il tempo dedicato alla caccia. Ciò che abbiamo fatto, però, è stato formulare un’ipotesi semplice e verificabile.
 20 © 2021 Robert M. Lee
 th)
 su ao a 28 8 @ F&F WwW Be TF BW WM BDH DW PV

>
 o- re FF FF OF FF TF FH SF FF FF FF SF SS ee ww
 ceduto
 Ipotesi sui generi
 Competenza nel dominio

. Intelligence amichevole o minacciosa
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Esistono tre tipi di generazione di ipotesi. Puoi farlo in base alla tua esperienza (competenza nel dominio), alla comprensione dell'ambiente e dell'organizzazione (consapevolezza situazionale) o all'intelligence amichevole o alle minacce. Comprendere il tipo di ipotesi che stai generando e il modo in cui ti vengono le idee influenzerà il modo in cui raccogli i dati e rilevi le minacce nel tuo ambiente.
 La competenza nel dominio è la tua comprensione del problema. Ad un certo punto probabilmente sei stato influenzato dalle informazioni o dalla consapevolezza situazionale lungo il percorso, e ora è radicato in te. Ad esempio, potrei capire che gli aggiornamenti all'I.C.S. al di fuori di un periodo di inattività o di mantenimento sono rari. | non ho bisogno che niente e nessuno me lo dica, dato che è l’esperienza e la mia comprensione del problema.
 Guidato dall'intelligence (amichevole o minaccioso) significa prendere spunto da qualcuno o qualcos'altro, con la comprensione di ciò che stanno facendo i nostri difensori (amichevole) o di ciò che stanno facendo gli avversari (minaccia). Non cerca indicatori, poiché ciò non fa parte della caccia alle minacce, ma è invece consapevole dei TTP, della vittimologia e dei tipi di infrastruttura che un avversario sfrutta. Anche comprendere le motivazioni può aiutarmi a capire dove cacciamo.
 La consapevolezza situazionale riguarda il mondo che ci circonda, il che significa che potrebbe essere correlata a eventi non legati alla sicurezza, come il conflitto geopolitico tra stati che potrebbe essere un evento scatenante per determinate minacce. Potrebbe basarsi su cose come l’acquisizione di un’altra società e generare l’ipotesi che siano già compromesse, oppure su cose come comprendere il nostro sistema I.C.S. abbastanza profondamente da comprendere le conseguenze di ciò che può accadere e come, indipendentemente dalle minacce che li colpiscono. L’analisi delle conseguenze è una delle forme più potenti di ipotesi basate sulla consapevolezza situazionale.
 Riferimento: Ipotesi-di-caccia.pdf

© 2021 Robert M. Lee 21 Esempio I.C.S. Ipotesi di minaccia
 Maligno Un avversario
 Aggiornamenti obsoleti e inthe —

| le patch aoe verranno inviate in rete
 ee si verificano dai dati storici del ciclo di processo di estrazione
 Il malware lo farà
 Gruppi di minacce mirati ruberanno i documenti dei sonetti degli HMI
 Gli avversari graviteranno verso
 Consideriamo alcune ipotesi di esempio e come potrebbero influenzare il modo in cui eseguiamo il monitoraggio della sicurezza della rete in un I.C.S..
 Ad esempio, se prevediamo che il malware avvii controlli Internet (come raggiungere Bing.com), valuteremo come raccogliere tali dati. Potremmo catturare pcap dall'I.C.S. segmenti che ci interessano, potremmo cercare eventuali log proxy o log DNS di cui disponiamo e potremmo potenzialmente cercare sull'host stesso le query recenti effettuate.
 In un altro esempio, se prevediamo che aggiornamenti o patch dannosi per la rete si verifichino probabilmente fuori ciclo, potremmo disporre di firme distribuite per cercare questo tipo di attività durante i periodi di non manutenzione e di aggiornamento.
 Se ci aspettiamo che un gruppo target raggiunga uno Stage 2 I.C.S. attacco informatico al nostro ambiente, a un certo punto avrebbero bisogno di comprendere il processo. Ciò potrebbe essere fatto mediante l'interazione con l'HMI e lo storico, ma probabilmente richiederebbe anche loro di comprendere e accedere ai documenti tecnici. Il luogo in cui vengono archiviati questi documenti tecnici (ad esempio al di fuori dell'archivio I.C.S.sulla rete aziendale o nella rete di un appaltatore) potrebbe guidare il modo in cui raccogliamo e analizziamo tale attività.
 Questo processo di generazione di ipotesi richiede l'utilizzo di intelligenza, competenza nel settore e consapevolezza situazionale per comprendere appieno l'ambiente e identificare le anomalie. Comprendere le ipotesi in anticipo consente di identificare dove è necessario raccogliere e rilevare le informazioni sull'avversario. Alla fine, dovresti tentare di aumentare la tua capacità di raccolta automatizzando le "cacce" precedenti. Se conosci già l'aspetto dannoso, assicurati di sviluppare un processo analitico o automatizzato per affrontarlo in modo da poterti concentrare sulle "nuove minacce" in futuro. I cacciatori dovrebbero essere squadre specializzate, non normali processi di sicurezza "acchiappa la talpa".
 Ricorda: nessuno usa Bing.com.
 22 © 2021 Robert M. Lee

@

! wr noi PF wow noi ew WF FP BP ee oe ee ee ee ee
 w

\ |
 wo 2

*Quali sono le fonti dati che utilizzeremo?

*Che intuizione abbiamo per l'ipotesi?

* Quali persone e strumenti sfrutteremo?
 Esempio: origini dati: sfruttare il CMF di Calistoga.
 Approfondimenti: analisi di Intel dei TTP di DRAGONFLY e delle capacità di HAVEX.
 Persone/Strumenti: I.C.S.515 Studenti che sfruttano strumenti open source come Wireshark per l'analisi di rete.
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 Con una buona comprensione del motivo per cui stiamo cacciando e di cosa speriamo di ottenere, rispetto a quali ipotesi e con quale scopo, siamo quindi pronti per entrare nella fase di equipaggiamento. Nella fase Equipaggiamento si tratta di determinare il lato persone/processo/tecnologia della caccia. Quali strumenti sfrutteremo, quale personale coinvolgeremo nella caccia e quali fonti di dati saremo in grado di sfruttare? È qui che avere un CMF diventa incredibilmente utile: comprendere la combinazione dell'ipotesi e della raccolta è una combinazione perfetta per accelerare i nostri sforzi e renderli più efficaci. Invece di cercare di entrare nell’ambiente e quindi determinare le fonti dei dati e quindi determinare quali persone e strumenti sono necessari, possiamo farlo in anticipo.
 Possiamo anche dotarci di approfondimenti a seconda delle ipotesi. Perché l’ipotesi di questo esempio lo è
 concentrandoci su DRAGONFLY vorremmo capire i loro TTP e le loro capacità. Quindi appoggiarsi al team dell’intelligence o semplicemente raccogliere noi stessi queste informazioni sarebbe un’ottima cosa di cui dotarsi.

© 2021 Robert M. Lee 23 Revisione del piano
+ Il nostro piano soddisfa lo Scopo?

« Dobbiamo modificare le fonti dei dati, le persone, gli strumenti o addirittura ridefinire l'ambito a causa delle lacune?
 Esempio:
 HAVEX sfrutta l'OPC, ma non ci sono comunicazioni OPC nella rete di Calistoga. DRAGONELY utilizzava OPC per mappare l'infrastruttura, quindi vorremo concentrarci sulle origini dati che aiutano a identificare le risorse.
 Il personale dello stabilimento non è disponibile a causa dell'alta stagione di produzione; non includeremo i disegni tecnici. Ciò non influirà sul risultato.
 1CS515| Visibilità, rilevamento e risposta I.C.S
 Combinare ciò che stiamo cercando come sovrapposizione al CMF ci aiuterà a determinare rapidamente se avremo successo o meno. Ad esempio, se pensiamo di dover sfruttare le comunicazioni OPC, ma non ci sono comunicazioni OPC nella rete di Calistoga, allora è inutile istruirci sull’argomento o cercare tali abusi. Invece, potremmo determinare che DRAGONFLY dovrebbe utilizzare I.C.S. scansione delle porte e comunicazioni native diverse da OPC. Esaminarlo con ciò che è disponibile può mantenerci rapidamente sulla buona strada. Inoltre, se sul sistema non era installata un'applicazione (le applicazioni trojanizzate erano una tattica di DRAGONFLY), allora
 anche la revisione di tutti i possibili log dell'host è inutile. Ci concentreremo sulla comprensione delle nuove installazioni e sull'esecuzione dei processi seguite dalle comunicazioni ai controller.
 Scoprirai che varie fonti di dati e personale sono disponibili e non sono disponibili durante la revisione del piano. Va bene personalizzare rapidamente il piano. Finché raggiungi ancora l'obiettivo originale, puoi continuare.
 24 © 2021 Robert M. Lee
 wo@@ ww@
 Oo@W@W @W@@w

@, aa,
 2 7 @

= ose 'FW wo HvHeHeeeuisbubsewwsws

~~ eo we wT FS Ww WS
 Esempio: DRAGONELY e Calistoga CMF
 TTP DRAGONELY:
* Raccolta automatizzata

*I.C.S. Scansione delle porte su I.C.S. comune Porti

° Enumerazione dei tag tramite OPC
* Applicazioni trojanizzate

° Legittimo I.C.S. installatori (VPN e
 app di connettività)
 Sistema di sicurezza Triconex _| Stazione di lavoro di ingegneria

* Comando e controllo

° Server C2 codificati

* Segnalazione a intervalli prestabiliti (ad esempio, ~24 minuti)
* Accesso VPN diretto
 Apparecchio di rete
 Tipo di dati Eventi host Windows Syslog
 Eventi dell'host Windows
 Analisi del traffico di rete
 Cattura dei pacchetti
 Posizione di archiviazione dei dati SIEM aziendale locale
 SIEM aziendale
 Apparecchio di rete
 Apparecchio di rete
 Data Tempo di conservazione 7 giorni 90 giorni
 90 giorni
 6 mesi
 7 giorni e su richiesta
 Origini dati rilevanti Eventi host Windows Analisi del traffico di rete PCAP
 È necessario aggiungere una raccolta:
- Registri VPN
 I.C.S.515 | I.C.S.Visibilità, rilevamento e risposta
 Dalla nostra comprensione di DRAGONFLY e del nostro CMF, possiamo identificare rapidamente le fonti di dati più rilevanti, dove si trovano e per quanto tempo le disponiamo. Disponiamo di 6 mesi di analisi del traffico, 90 giorni di registri eventi di Windows e 7 giorni di acquisizione di pacchetti su richiesta. Sfrutteremo l’acquisizione dei pacchetti, ma è una finestra mobile di soli 7 giorni, il che significa che se venissimo presi di mira prima di quella finestra, probabilmente non sarebbe molto utile. Possiamo arrivare a una buona risposta in 90-180 giorni guardando indietro all’ambiente. Il periodo di 7 giorni svolgerà probabilmente un ruolo importante nel determinare se una minaccia è ancora attiva e nello sviluppo dei rilevamenti poiché si tratta essenzialmente di una raccolta grezza/completa
 da usare.

© 2021 Robert M. Lee
 25
* Esegui la caccia alle minacce.

* Documentare gli aspetti osservabili durante tutto il processo, soprattutto per quanto riguarda i risultati desiderati.
 Esempio:
« Analizza i PCAP della raffineria di Calistoga
 per l'I.C.S. protocolli utilizzati per profilare più controller.
 Analizza PCAP e registri del firewall alla ricerca di utilizzi anomali della VPN.
 Analizza i log basati su host alla ricerca di nuove applicazioni installate, soprattutto durante i periodi di produzione e non di manutenzione.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Nella fase Esegui si procede con la ricerca e si entra nell'analisi tecnica e nella raccolta dati. Ad esempio, analizzeremo le catture di pacchetti dalla raffineria di Calistoga alla ricerca di I.C.S. utilizzo del protocollo, in particolare sulla profilazione di più controller (ovvero, utilizzo del protocollo anomalo per i sistemi con cui comunicano). Inoltre, esamineremo i registri VPN e firewall alla ricerca di utilizzi anomali e esamineremo i registri host per le applicazioni installate di recente. Quindi analizzeremo quei file per vedere se c'era connettività o altra applicazione
 non dovrebbe essere lì.
 La fase di esecuzione può essere molto più efficiente e mirata se abbiamo seguito il modello fino a questo punto.
 26 © 2021 Robert M. Lee
 o ©
 su eeeeeee
 anmam@w & & ®
 oe os § &§ FC FFF eee ee Uae
 oe ss
 es wo J
 Feedback

¢ Raccogliere feedback sull'intero processo.
* Acquisisci risultati/risultati finali.
 Esempio: HAVEX non è stato trovato nella raffineria di Calistoga. Uno di | la tattica esplorata è stata l'abuso di I.C.S. protocolli per eseguire l'identificazione delle risorse. Siamo stati in grado di sfruttare i sensori
 per realizzare questa analisi. Però li abbiamo solo a Calistoga. La raccomandazione è di implementare sensori in altre reti in cui ci preoccupiamo di DRAGONFLY.
 I rilevamenti sono stati creati per identificare un singolo sistema, sfruttando la profilazione Ethernet/IP di più controller. È stato creato un altro rilevamento per i file archiviati inviati da un dispositivo L2 tramite VPN e diretti a Internet.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Alla fine di ogni caccia c'è un risultato. Semplicemente non trovare minacce non è un buon risultato. Lo scopo della caccia è trovare le minacce che stiamo cercando, ma alcuni dei migliori risultati stanno nel personalizzare la nostra collezione, nel renderci conto che avevamo delle lacune e che non avremmo avuto successo senza estendere la nostra impronta di automazione, ecc. In questo caso non abbiamo trovato HAVEX nella raffineria di Calistoga, ma conosciamo alcune tattiche che possiamo trasformare in rilevamenti nel nostro ambiente. Inoltre, l'analisi pcap veniva raccolta e controllata manualmente e lontana dal monitoraggio continuo; la raccomandazione non solo di implementare i sensori ma anche di dove collocarli esattamente può estendere la nostra impronta di automazione, collocando la nostra organizzazione in una posizione molto migliore e rendendo i futuri sforzi di controllo molto più efficienti.

© 2021 Robert M. Lee 27 Strategie di rilevamento delle minacce
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee

&@® @@ &@ & @
 noi FT &
 oo e

@
 ea®mgqa@man#kag’mss & oF FF KF HFK KF KEK HHH HEE HH
 it it
 Rilevamento delle minacce: l'obiettivo
 Rileva *: Il punto di:
 il rilevamento non è l'avviso; è cosa fai con l'avviso e perché.
 Un esempio di processo di rilevamento e indagine
 Identifica Rileva Rileva il
” » es
 Nell'ambito della sicurezza IT, sono molti i casi in cui l'obiettivo del rilevamento è semplicemente il blocco dell'attività. Anche quando le cose vanno male, spesso non è un grosso problema per gli utenti finali. La sicurezza cerca di essere il più precisa possibile, ma lo scenario peggiore è che qualcosa di dannoso venga eseguito e dia accesso all'avversario. Pertanto, il rilevamento svolge due ruoli: investigazione e blocco.
 Nell'I.C.S. sicurezza, lo stato attuale dell’I.C.S. impone che il punto del rilevamento sia l'indagine e l'azione post-indagine. Un approccio immediato di “blocco perché potrebbe essere dannoso” non funziona in I.C.S.. La cosa peggiore che può accadere è una perdita di sicurezza o affidabilità anche se il malware è stato bloccato; non il malware in esecuzione. Pensa a un caso in cui il malware infetta i processi critici del sistema sul server di allarme. L'eliminazione dell'antivirus compromette l'affidabilità e potenzialmente la sicurezza di quel sistema.La sicurezza ha uno scopo diverso in questi ambienti.
 L'obiettivo del rilevamento delle minacce in I.C.S. la sicurezza non è il rilevamento in sé, ma l'indagine e le azioni postate.
 Pertanto, esistono modi “migliori” e non semplici risposte “scegli il tuo approccio preferito” al rilevamento delle minacce in I.C.S. sicurezza.

© 2021 Robert M. Lee 29 I quattro tipi di rilevamento delle minacce
 Modellazione dei comportamenti di minaccia
 Indicatori di analisi della configurazione
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Esistono quattro tipi di rilevamento delle minacce suddivisi in due categorie. I quattro tipi sono analisi della configurazione, modellazione, indicatori e analisi del comportamento delle minacce. Le categorie sono ambiente e minaccia.
 L'analisi della configurazione è un approccio basato sull'ambiente per identificare il sistema o la rete sufficientemente bene da individuare i cambiamenti. Stai letteralmente cercando la “novità”. Cosa c'è di nuovo nell'ambiente dalla configurazione? Questo è un approccio in stile whitelist. Tecnicamente, può catturare tutto perché un avversario alla fine deve fare qualcosa di nuovo per fare qualcosa di dannoso. Ma questo ha il più alto tasso di falsi positivi perché tecnicamente rileva... tutto.
 La modellazione è l'evoluzione della configurazione in cui viene applicato un modello, spesso un modello matematico come una tecnica di apprendimento automatico, al set di dati per sviluppare un profilo per l'ambiente. Ad esempio, un modello di apprendimento automatico potrebbe imporre che la configurazione si evolva in un determinato periodo di tempo e presenti modifiche accettabili. Forse il codice funzione 121 non viene utilizzato spesso, ma va bene purché non venga utilizzato più di 5 volte in un periodo di 24 ore. La modellazione è ottima per identificare “anomalie” nell’ambiente e quindi può catturare tecniche davvero nuove. Tuttavia, i due grandi svantaggi del rilevamento delle anomalie sono che sono necessarie cure e alimentazione costanti (non è previsto un periodo di preparazione di 30 giorni e poi il gioco è fatto: è necessario addestrare costantemente il modello) e, soprattutto, nessun approccio di rilevamento basato sull’ambiente può fornire un contesto sulla minaccia. Quindi agli analisti vengono lasciati avvisi senza contesto. L'intero costo di proprietà dell'indagine e quali anomalie contano, perché e
 cosa fare al riguardo spetta al difensore.
 Gli indicatori cercano dettagli sull'attività dell'avversario, come l'hash digitale del malware. Tecnicamente contengono la maggior parte del contesto se utilizzati correttamente, ma spesso vengono utilizzati in modo errato poiché vengono espansi in ciò che cercano fino a diventare inutili (non forniscono contesto e rilevamento inadeguato). Gli elementi atomici delle intrusioni e del malware cambiano così rapidamente che un approccio basato su indicatori richiederebbe un flusso quasi costante di indicatori in continua evoluzione riversati nell’ambiente.
 I comportamenti di minaccia sono l’evoluzione degli indicatori. Invece di cercare attributi specifici di un avversario o dei suoi
 capacità, l’analitico cerca l’abilità commerciale. Si tratta di TTP avversari letteralmente codificati. In questo modo, l'analisi del comportamento delle minacce fornisce comunque il contesto su ciò che un difensore sta guardando quando avviene un rilevamento
 30 © 2021 Robert M. Lee

@w Pp

‘V7 vv PF FBP PW @ @®
 A ® @
 wo
 ee & ® www wwe ©» ww &
 wo
 noi &© &© & &S Jw Ww Ww Ww
 ar
 generati, ma non sono vincolati a specifiche. Invece di preoccuparsi di un aspetto specifico, come l'indirizzo IP della VPN e l'hash MDS del file e i comandi inviati alla RTU, un'analisi del comportamento delle minacce avviserebbe ogni volta che qualcuno utilizza una VPN per accedere a un HMI, rilasciare un nuovo file, e quindi inviare comandi alla RTU. Si concentra sulle tecniche commerciali, non sulle specifiche, e quindi può adattarsi non solo a diversi attacchi, ma anche a gruppi di attività completamente diversi. L’“esfiltrazione DNS da un HMI” può richiedere un numero infinito di indicatori, ma un’analisi del comportamento delle minacce per qualsiasi avversario.
 Riferimento: The_Four_Types-of_Threat_Detection.pdf

© 2021 Robert M. Lee 31 Analisi della configurazione

* L'analisi della configurazione cerca modifiche nella configurazione corrente come:

° Novità Asset, Connessioni, Protocolli, Valori Protocolli, ecc. mai osservati prima
" I cambiamenti
* Modifica dell'orologio GPS
+ Caricamento/download di file di progetto
* Si riavvia
° Tasto di accensione/spegnimento
 Avviso aggiornamento firmware al PLC udp any any -> any 161 (msg:"Comando di aggiornamento firmware per Phoenix Contact PLC tramite SNMP rilevato"; contenuto:"|a3|"; contenuto:"|0e 2b 06 01 04 01 a1 7a Ob Ob Ob 02 04 01 00|"; distanza:0; contenuto:"|02 01 02|"; distanza:0; entro:3; priorità:1; sid:9000305; rev:1; soglia:tipo limite,traccia per_src, conta 10,secondi 86400;)
 Avviso aggiornamento logica al PLC tcp qualsiasi qualsiasi -> qualsiasi 48898 (msg: "Nuova logica applicata al PLC tramite Beckhoff ADS"; contenuto: "beckhoff"; contenuto: "MainTask Instance Mappings.xml"; sid:9003470; priorità:1; giro:1;)
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 L'analisi della configurazione nella sua forma più elementare cerca la “novità”, ovvero la prima volta che qualcosa accade per la prima volta. Ciò implica contro tutto il tempo. Questo non deve essere confuso con un evento di base che si verifica in un determinato periodo di tempo.Se vuoi sapere se viene rilevato un nuovo valore di protocollo rispetto alle ultime 24 ore, si tratterebbe di un rilevamento basato su modelli. Ma se stai cercando una notifica relativa al primo rilevamento di un valore di protocollo nel tuo ambiente, si tratterebbe di una modifica della configurazione. Sembra pedante, ma definire gli ambienti di riferimento non è necessariamente la stessa cosa che identificare la novità. Il modo più semplice per mantenerlo coerente è confrontare una configurazione con un insieme di tempi e cercare deviazioni, in realtà si tratta di modellazione: il componente chiave è il tempo
 confronto.
 Al di là delle novità, però, l'analisi della configurazione può essere estremamente utile per notificare agli analisti eventuali modifiche alla configurazione. Ad esempio, un PLC con il tasto in modalità RUN che poi passa alla modalità PRGRM rappresenta una modifica nella configurazione del PLC. Quando torna a RUN si tratta anche di una modifica nella configurazione. Essere consapevoli dei vari cambiamenti di configurazione nell'ambiente, come i cambiamenti logici, può rappresentare un'ottima fonte forense. Non vorrai valutare questi rilevamenti ma avere le notifiche disponibili per rivedere le modifiche nell'ambiente dopo aver già ricevuto un'altra notifica o evento a cui stai valutando e a cui stai tentando di aggiungere contesto.
 Negli esempi sopra vediamo due rilevamenti di Suricata. Questi sono stati sviluppati dal team di ricerca e sviluppo/Intel di Dragos, così come gli altri esempi di Suricata nelle prossime diapositive. Nella prima si cerca un aggiornamento firmware per il PLC, in questo caso nello specifico Phoenix Contact, e si nota che il protocollo SNMP viene utilizzato sul PLC per modificarne la configurazione. La seconda ricerca un aggiornamento della logica applicata ad un PLC Beckhoff ADS. Sarebbe utile conoscere entrambi questi eventi, ma ancora una volta non è qualcosa che valga la pena valutare senza un altro contesto.
 L'analisi della configurazione non contiene il contesto di come o perché qualcosa è dannoso o potrebbe essere dannoso. L'aggiunta del contesto di minaccia sposterebbe il rilevamento su un comportamento di minaccia. Tecnicamente un rilevamento basato sull'analisi della configurazione e un rilevamento basato sul comportamento delle minacce potrebbero cercare esattamente la stessa cosa. La separazione è il contesto, ma questi sarebbero comportamenti di minaccia orribili. C'è un'aspettativa di valutazione di quelli e di questi invece
 sarebbe meglio il triaging atomico. Per ora hanno valore forense.
 32
 eventi IC che vengono poi inseriti con altri eventi e contesto per rendere più efficace il rilevamento

© 2021 Robert M. Lee
 civile)

@ @ @ @ @ @

@ ww W@W
 eo omoaqaqeeqgg@wme@eseqwv @W wo wow © F&F © Oo © ​​© © & OS w&
 vy
 Modellazione

* La modellazione cerca deviazioni rispetto al modello
* Configurazione + Soglia + Tempo

* Creato manualmente o automaticamente
¢ Soglia manuale: “non avvisare finché non si verifica 5 volte”
* Automaticamente: “machine learning per identificare le anomalie”

*Le linee di base possono essere una forma di modellazione
 Se il rilevamento su qualche aspetto del tempo
* “Questa linea di base nel tempo”
+ Se si tratta solo del rilevamento su "Novità", si tratta di Analisi di configurazione

* Esempio:
"Riavvio a caldo DNP3" + 5 occorrenze > entro 60 minuti
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 I rilevamenti di modellazione cercano deviazioni da una configurazione nel tempo. Questo può essere creato manualmente o utilizzando metodi automatici come l'apprendimento automatico. Quando senti parlare di prodotti o approcci che necessitano di "integrarsi" o "sintonizzarsi" sull'ambiente per essere rilevati, c'è qualche elemento di modellazione in atto.
 Il vantaggio ovviamente con la modellazione è che non è necessario sapere cosa si sta cercando e, a seconda della gravità della deviazione o del contesto ambientale, è possibile scegliere di valutare alcuni di questi rilevamenti. Tuttavia, senza contesto su come o perché qualcosa è dannoso, può trattarsi di uno sforzo molto dispendioso in termini di tempo. Invece, la modellazione viene utilizzata al meglio in modo proattivo quando si cercano in modo proattivo elementi errati nel proprio ambiente anziché quando si valuta un avviso.
 Ad esempio, potrei essere preoccupato per gli avversari che sperimentano le mie RTU in una sottostazione di trasmissione e potrei cercare attività anomale. Potrei farlo tramite l'apprendimento automatico, oppure potrei sapere che alcuni avvisi di configurazione sono importanti per me, come i riavvii a caldo DNP3, e quindi impostare una soglia per cercarne più di 5 che si verificano entro un periodo di 60 minuti.

© 2021 Robert M. Lee 33 Elementi tecnici che descrivono le capacità e le infrastrutture di un avversario che non sono native dell'ambiente
 Esempi di funzionalità: rilevamento del modulo CIP Metasploit

* Malware/hash i .
. Avviso percorsi file tep qualsiasi qualsiasi -> qualsiasi qualsiasi (msg: Metasploit CIP CRASHCPU - possibile DoS"; flusso: stabilito,to_server; contenuto:"|6f00|"; profondità:2;

+ Contenuto modifiche sistema: |000000000200020000000000b2001200|"; offset:8; 46: 1 ", Esempi infrastruttura: profondità:16; contenuto: |52022006240103f00c000a0220022401| ;
.[P indirizzi distanza:0; entro:16; contenuto: |£4£00909880401000100|";
« Distanza Doiains:0; entro:10; soglia: limite tipo, traccia per_sre, conteggio 1, secondi
+ E-mail 86400; priorità:1; sid:9000172; giro:1;)
 Indicatore: PowerShell Empire Non indicatore: PowerShell
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 capacità rapida di rilevare minacce e definire l'ambito del tuo
 Gli indicatori sono spesso abbastanza facili da creare e implementare, dando un vantaggio a un avversario
 ambiente per le minacce note. La componente chiave di un indicatore è che si concentrano sulla rilevazione; struttura. Ciò non significa solo indirizzi IP e malware. Ad esempio, se un avversario lo è
 funzionalità o infrastrutture del percorso del file che non è nativo del tuo
 creando un percorso file univoco sul tuo sistema per installare la loro capacità dannosa, il sistema è un ottimo indicatore.
 La chiave è che non è nativo. Ad esempio, un avversario potrebbe sfruttare PowerShell per scopi dannosi, ma non per la configurazione di quel sistema. Alla ricerca di un uso dannoso di PowerShell
 è uno strumento nativo di Windows. Fa parte di qualcosa attorno al quale potresti invece creare un comportamento di minaccia. Tuttavia, PowerShell Empire è un file
 Strumento basato su PowerShell che non è nativo dei sistemi Windows, quindi cercarlo sarebbe un indicatore.
 Nell'esempio di rilevamento è presente un modulo CIP nel popolare framework Metasploit di pentesting. Quel CIP. Il modulo CRASHSCPU è qualcosa che può essere cercato e il contenuto in tutta la rete (i byte che siamo
 cercando) sono un ottimo indicatore. Gli indicatori possono essere falsi o veri positivi perché affermano che il rilevamento sta rilevando accuratamente una cosa specifica. Quella specificità e la valutazione “questo è vero” è ciò che porta ad avere positivi Vero e Falso (cioè, il
 il rilevamento è corretto o sbagliato).
 34 © 2021 Robert M. Lee
 ag'. @& @& &
 nnnmneeaaef®
 ab wey wy wy wy &
 wow §& &6 & &@ Bw ww Ww ww ww w ww Ww
 Comportamenti di minaccia

* Eventi che non sono specifici delle capacità e dell'infrastruttura dell'avversario
* Spesso include funzionalità/capacità native nell'ambiente
 Combinazione di eventi in un periodo di tempo con contesto su come possono essere utilizzati in modo dannoso o come lo sono stati in passato
*Gli indicatori possono essere Veri o Falsi Positivi in ​​quanto fanno affermazioni:
* "Questo indirizzo IP è dannoso e associato a X Threat"
* I comportamenti di minaccia non hanno Veri o Falsi Positivi
° “Questo comportamento esiste, e in passato se ne è abusato in questi modi”
 Può facoltativamente includere avvisi di analisi della configurazione o di modellazione
+ Evento 1+ Avviso di configurazione + Avviso di modellazione + Contesto = Comportamento della minaccia
* Evento 1+ Evento 2 + Evento 3 entro 30 minuti + Contesto = Comportamento di minaccia
 Non può includere indicatori
* Evento 1+ Avviso di configurazione + Indicatore + Contesto = Indicatore
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 I comportamenti di minaccia sono rilevamenti che cercano tattiche e tecniche dell'avversario. Non cercano capacità e infrastrutture specifiche dell’avversario, altrimenti sarebbero indicatori. La logica di rilevamento cerca spesso una combinazione di eventi che possono verificarsi in modo nativo nell'ambiente, ad esempio rilevamenti basati sulla configurazione o sulla modellazione. Ciò non significa che si tratti solo di rilevamenti di configurazione e modellazione con contesto di minaccia. Un comportamento di minaccia è un'analisi, una ricerca tra i dati per qualcosa di specifico, mentre i rilevamenti di configurazione e modellazione spesso non cercano qualcosa di specifico ma avvisano quando si verificano tali cambiamenti. Un'analisi delle minacce per sua stessa natura è alla ricerca di qualcosa di specifico e contiene il contesto del motivo per cui ti interessa. Ciò lo rende una forma potente di rilevamento trasponibile che dovrebbe assolutamente essere valutata dagli analisti.
 Ad esempio, se un avversario installa un nuovo file su un sistema, si connette a un indirizzo IP e quindi avvia la scansione dei sistemi per le comunicazioni OPC. Tutta quella serie di eventi potrebbe costituire un comportamento minaccioso. Non stai cercando quale sia il file specifico o quale sia l'indirizzo IP specifico: stai cercando una combinazione di "nuovo file" + "nuovo indirizzo IP esterno" + "Scansione OPC" nel corso di un po' di tempo. Ciò rappresenterebbe il comportamento HA VEX. Ma, cosa ancora più importante, non catturerebbe solo HAVEX: rileverebbe quel malware così come qualsiasi altra famiglia di malware che sfrutta quel TTP.
 I comportamenti di minaccia non possono avere valori Veri o Falsi positivi perché non sta dicendo "questo rilevamento avvisa su HAVEX", ma "questo rilevamento avvisa sui comportamenti sfruttati da HAVEX". Non sta dicendo che tali comportamenti siano sempre dannosi e sicuramente non afferma che siano specifici di un malware o di un avversario. Questi comportamenti potrebbero attivarsi per motivi del tutto legittimi, ma meritano comunque la tua ispezione in quanto sono stati abusati in precedenza per scopi dannosi. Ma la logica dell’allerta è corretta secondo cui tali comportamenti esistono, quindi non vi è alcun elemento positivo falso o vero in essi.

© 2021 Roberto M.Lee 35 Esempio di comportamento minaccioso

+ Il seguente rilevamento cerca modifiche alla logica Triconex che non aggiornano le versioni della logica

+ Questa è un'azione non specifica per le capacità o le infrastrutture di alcun avversario, potrebbe essere sfruttata da più di un avversario, potrebbe anche avvenire in modo non doloso, ma è stata vista sfruttata
 prima maliziosamente
 alert udp any any -> any 1502 (sid:9003281,; rev:2; msg:"Triconex ha scaricato la modifica senza l'aggiornamento della versione del progetto"; content:"|05 00|"; Depth:2; content:"|01|" ; profondità:7; byte_extract:4,24,oldversion; byte_test:4,=,oldversion,32; priorità:2;)

* Può includere anche lo sfruttamento delle vulnerabilità se lo sfruttamento non è specifico dell'avversario
 alert tcp any any -> any [135:139,445] (msg:"MS17-010 Shellcode Heap"; content:"|00 dO ff ff ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 co f0 df ff co fO df ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 00 00 00 00 00|"; soglia :limite tipo, traccia per_src, conteggio 1, secondi 3600; priorità:3; sid:9000036; rev:1;)
 I.C.S.515 | Visibilità, rilevamento e risposta del CS
 In questo esempio il rilevamento cerca modifiche alla logica del sistema di sicurezza Triconex in cui la versione della logica non viene aggiornata. Qualcuno sta modificando la logica del controller ma non aggiornando le informazioni sulla versione. Ciò potrebbe avvenire in modo accidentale da parte dell'operatore o del sistema, oppure potrebbe essere effettuato da un avversario che cerca di modificare furtivamente la logica, come è stato osservato nel malware TRISIS nel 2017.
 Non vengono introdotte nuove capacità o infrastrutture avversarie nell’ambiente che stiamo cercando. Cerchiamo eventi di cui si è abusato in precedenza, o che potrebbero esserlo, e il contesto che li circonda.
 36 © 2021 Robert M. Lee

& &@ & @ &
 ane? OGeee e@
 anaonw an @ @& oo Fe WS Ww WwW Ww ww wo ww noi
 oh ww
 ry

+ L'analisi del comportamento delle minacce è il modo migliore per ottenere un rilevamento scalabile delle minacce con il contesto per informare la difesa e la risposta
+ Il lavoro deve essere svolto prima del rilevamento con intelligenza

+ I dati di configurazione sono la migliore fonte di avvisi per eseguire analisi forensi per capire cosa sta succedendo nell'ambiente

+ Utilizza l'analisi del comportamento delle minacce per restringere il campo dei dati di configurazione da ricercare, ad esempio un periodo di tempo specifico (+/- un'ora dal rilevamento)

+ Gli indicatori di compromissione (10C) sono uno strumento orribile per il rilevamento delle minacce, ma sono fantastici per analizzare un incidente o vedere fino a che punto è arrivata una capacità
+ 10C realizzati per il tuo malware specifico o per l'attività dell'avversario sono l'ideale

+ La modellazione può costituire un'incredibile amplificazione del rilevamento delle minacce, sebbene lo sia

“- Non è un buon metodo per eseguire il rilevamento delle minacce come unica fonte di amplificazione. Le anomalie non hanno il contesto appropriato per aiutare i difensori a fare delle scelte, ma
"Si è verificata anche un'anomalia" può migliorare l'accuratezza dell'analisi del comportamento delle minacce
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 I difensori hanno bisogno del contesto di ciò che stanno guardando e di cosa dovrebbero fare con le informazioni. È possibile ottenere il rilevamento delle minacce utilizzando uno qualsiasi dei quattro approcci, ma ciascuno può essere incredibilmente inefficace e inefficiente se utilizzato in modo errato. Solo perché stai raggiungendo il successo non significa che stai adottando l'approccio giusto per arrivarci e spendendo saggiamente le risorse. L'analisi del comportamento delle minacce è la migliore forma di rilevamento delle minacce, ma richiede molto lavoro iniziale. La modellazione è uno dei modi peggiori per eseguire il rilevamento delle minacce e richiede che tutto il lavoro venga svolto dopo il rilevamento da parte del team investigativo. Se si dispone di un'analitica del comportamento di minaccia che si attiva sulla rete e "si è verificata un'anomalia anche nello storico dei dati", è possibile amplificare l'accuratezza e la pertinenza dell'analitica del comportamento di minaccia senza nemmeno sapere quale fosse l'anomalia.
 Gli indicatori sono ampiamente abusati, ma sono strumenti di analisi fantastici e possono essere utilizzati anche nel processo forense.
 Tuttavia, i migliori dati forensi sono i dati grezzi stessi o i dati di configurazione del periodo di tempo in cui qualcos'altro è stato rilevato come potenzialmente dannoso.

© 2021 Robert M. Lee 37 MITRE I.C.S. ATT&CK
 Modifica stato progr

[Comrant ine teace Eipotalon ot Reva Surveas
 sezison ean API sums amon Serves
 craps ae ere Progen ogee es
 Hom Aimee Remete Fle Cony
 reoran Ogaizabon Uns p20 Reptog Mec Sip Discovery | decalcomanie dell'AED
 Pj ents, izecnange Modalità operativa [Sea Cam

[vedi
 iar Exess
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 I comportamenti di minaccia comprendono tattiche e tecniche. MITRE dispone del framework Enterprise ATT&CK come lessico e insieme di conoscenze sulle tattiche e tecniche pubbliche associate alle minacce Enterprise.Nel 2020 hanno creato I.C.S. ATT&CK per tattiche e tecniche specifiche dell'I.C.S. Molte delle tattiche e delle tecniche sono state fornite da Dragos, Inc., data l'intuizione unica del loro team di intelligence. Ciò significa che molte delle minacce di cui abbiamo già parlato in questo corso (ALLANITE, ELECTRUM, ecc.) sono già presenti in MITRE I.C.S. ATT&CK. Dopo aver completato questo corso, mentre cerchi casi d'uso di rilevamento per assicurarti di avere copertura, questo è un framework molto efficace da utilizzare.
 È importante notare che gli indicatori, la modellazione e i rilevamenti basati sulla configurazione non possono essere mappati su I.C.S. ATT&CK. Si può dire “possiamo rilevare la tattica X”, il che è vero. Una regola “qualsiasi qualsiasi” di Snort potrebbe rilevare la maggior parte degli attacchi. Ma individuare qualcosa significa comprenderlo e il suo contesto, in modo che il difensore abbia il giusto livello di informazioni per agire. Nello specifico nel contesto di ATT&CK deve trattarsi di un rilevamento basato sul comportamento delle minacce; ovvero tattica e tecnica, non qualcosa di specifico per una determinata minaccia o malware.
 MITRE ATT&CK e rilevamenti di minacce
 Nel senso più ampio, è possibile ottenere rilevamenti in un'ampia varietà di modi. È possibile ottenere un rilevamento basato su configurazione/modellazione/indicatore/comportamento di minaccia che coincide con una tattica o tecnica MITRE ATT&CK. Tuttavia, il punto centrale delle tattiche e delle tecniche non è essere specifici per le capacità/infrastruttura di un avversario e avere il contesto per sapere cosa è dannoso e perché. Pertanto, i comportamenti di minaccia lo sono
 il modulo di rilevamento che effettivamente si riferisce a MITRE ATT&CK.
 Quando provi a ottenere rilevamenti per MITRE ATT&CK puoi sfruttare una sovrapposizione di minacce per capire cosa ti interessa nello specifico. L'obiettivo non è avere rilevamenti per tutto, ma concentrarsi su ciò che ti interessa
 maggior parte.
 38 © 2021 Robert M. Lee

& & @® @ © ®
 ee &
 ee F &
 se A a ce
 eooananqeganwamest & @ ® oo 8 § © HW WH ewe weewwTeivewe we wo ww
 vo §& & §& S&S YS VI

* Sovrapposizione di gruppi di attività (ad esempio gruppi di minacce) con MITRE ATT&CK per I.C.S. mostrerà uno scenario da emulare per red teaming/IR/rilevamenti
 ESP pecora squadra att
 Nie beni SB WHNTKD ND tide nado
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Una volta compresi gli scenari che ti interessano di più (guidati dalle conseguenze o guidati dalle informazioni), puoi tracciare la catena di uccisione come vista su MITRE ATT&CK per I.C.S.. In questo esempio, questo è il navigatore Dragos, che è uno strumento pubblico/gratuito . Mostra i diversi gruppi di attività, o gruppi di minacce, monitorati e le tattiche/tecniche osservate che hanno adottato. Puoi allinearlo con i tuoi sforzi di caccia e CMF per vedere se hai la copertura nella raccolta/rilevamento per gli scenari che ti preoccupano maggiormente. Puoi anche usarlo per emulare minacce e pianificare gli impegni dei team rossi, riflettere sui playbook di TTX e di risposta agli incidenti e in generale su vari sforzi di sicurezza in cui è utile comprendere le tattiche e le tecniche delle minacce.
 Riferimento: https://www.dragos.com/mitre-attack-for-ics/

© 2021 Robert M. Lee 39 XENOTIME in profondità - Profondità analitica
 AUMENTO DEI PRIVILEGI
 Scelta di uno scenario specifico, ad esempio la compromissione della sicurezza di XENOTIME
 I sistemi Peelomnn ecuabe possono guidare ciò su cui ci concentriamo.
 Un solo rilevamento di compromissione della workstation di ingegneria non sarebbe sufficiente. Rilevare ciò che è accaduto, ma poi creare diverse variazioni di ciò che è accaduto o sarebbe potuto accadere, ci fornirebbe numerose rilevazioni.
 Rilevazioni multiple per la stessa tecnica costituiscono il concetto di Profondità Analitica.
 La profondità analitica espande la nostra capacità di cogliere la minaccia e altri simili.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Ad esempio, parleremo più avanti nel corso di XENOTIME, che ha condotto l'attacco TRISIS. Questo gruppo viene selezionato nella sovrapposizione e vengono mostrate le tattiche e le tecniche che ha utilizzato per la prima parte della catena di uccisione
 nel grafico sulla diapositiva.
 Ad esempio, il "compromesso della workstation di ingegneria" può essere raggiunto in diversi modi, a seconda del fornitore/implementazione/integrazione della workstation di ingegneria. Pertanto, creare semplicemente un unico rilevamento per il “compromesso della workstation di ingegneria” probabilmente non sarebbe adatto contro i diversi modi in cui gli avversari possono eseguire le loro operazioni. È un ottimo strumento per comunicare e monitorare la tua attenzione, ma un singolo rilevamento non coprirà tutte le diverse varianti di questa tecnica.
 Pertanto, vogliamo esaminare cosa ha fatto specificamente l'avversario nello scenario che ci sta informando (in questo caso XENOTIME) e iniziare da lì con il rilevamento. Dovremmo apportare modifiche ragionevoli ai diversi modi in cui potrebbe essersi verificato e forse alle diverse linee di prodotti, protocolli, ecc. rilevanti. Pertanto otterremo un'ampia varietà di rilevamenti, ma tutti hanno lo stesso focus/contesto per aiutarci a guidarci. Questo è il concetto di Analitico
 Profondità.
 40 © 2021 Roberto M.Lee

"

®@®
 7 © @ @ ®
 Sono &
 ean @ es <p Sw
 ww
 uo we SF OF HB HS HO HO Ww ww
 XENOTIME in profondità - Ampiezza analitica
 COLLEZIONE MOVIMENTO LATERALE
 La creazione di rilevamenti attraverso tutte le diverse tattiche e tecniche sfruttate da un avversario ci offre ampiezza analitica
 Ampiezza = copertura delle tattiche/tecniche utilizzate
 Profondità = variazioni nel modo di rilevare la stessa tattica/tecnica
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 Il raggiungimento dell’ampiezza analitica si trova nell’ottenere copertura delle varie tattiche/tecniche di una minaccia. In sostanza, coprire l’intera catena di uccisione è ampio. Coprire diversi modi in cui la stessa tattica/tecnica può essere rilevata sarebbe Profondità. Ottenere una combinazione di ampiezza analitica e profondità analitica è il modo più efficace per avere copertura contro la minaccia che ti sta a cuore e contro le future minacce sconosciute che sfruttano tattiche/tecniche simili.
 Pochissimi set di rilevamenti validi possono coprire un insieme molto ampio di famiglie di malware e minacce.

© 2021 Robert M. Lee 4 Ottenere copertura e identificare le lacune
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Il tuo obiettivo dovrebbe essere quello di identificare i comportamenti di minaccia (tattiche e tecniche) che puoi rilevare (attraverso i tuoi metodi o combinati con gli acquisti di prodotti) e comprendere le tue lacune. Dovresti cercare costantemente di imparare dalle nuove informazioni e puntare a rilevamenti migliori. Spesso è possibile farlo cercando dove non si hanno rilevamenti attuali e quindi codificando le lezioni apprese in rilevamenti stabili.
 So che questo non è colore nei tuoi libri, ma il punto qui è riuscire a monitorare ad alto livello la copertura che hai. È buona norma considerare i rilevamenti A-B e A-D. A-B è l'ampiezza analitica (copertura tra tattiche e tecniche) e A-D è la profondità analitica (quanti rilevamenti diversi hai per la stessa tattica o tecnica). Dovresti cercare di avere 1 rilevamento per spostare qualcosa in giallo, quindi cercare 3+ rilevamenti prima di considerare qualcosa di verde. Il rosso verrebbe usato per dove non hai nulla, e io userei il blu dove qualcosa non è applicabile a ciò che stai facendo. È importante sottolineare che, dati i diversi ambienti, apparecchiature, fornitori, ecc., dovresti prendere in considerazione la possibilità di mapparli nel tuo framework di gestione della raccolta, poiché è improbabile che tutta la tua infrastruttura abbia lo stesso livello di copertura tra i rilevamenti A-B e A-D.
 Combinata con un framework di gestione delle raccolte, un'adeguata strategia di rilevamento basata sull'intelligence può essere uno strumento potente
 affinché i difensori sappiano dove hanno copertura, dove hanno lavoro da svolgere e come collegare attività come la ricerca, la risposta agli incidenti e gli sforzi di raccolta che aumentano le loro difese.
 42 © 2021 Robert M. Lee

"

|

@
 agecomwm@®@®

.° @ @ &,
 oe Ge*e Ff Ff BSBA SG
 noi ww F&F ww w& Ww w&
 wo
 oe © & F&F §& F&F FEF ES
 vedere San Francisco »
 io}
 Copertura delle minacce (copertura della catena di uccisione)

¢ È necessario comprendere la copertura delle minacce Trosting * Tutti i rilevamenti sono concentrati sulla Fase 1 C2? Consegna * Non è necessario individuare ogni azione dell'avversario, ogni strumento, ecc.; devi solo farlo
|
 Installa/Modifica
 rilevare con precisione una delle loro fasi
¢ Una volta eseguito un rilevamento corretto, il
 inizia l'indagine e puoi identificare la FASE 2- I.C.S. Attacca tutto il resto, incluso quello precedentemente sconosciuto
 Sviluppare
 malware, truffe ed exploit
* L’avversario non deve “fare bene solo una cosa”: deve ottenere tutto
 Prova Consegna Installa/Modifica
 Esegui il simpatico CSAttack
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 È importante capire cosa stanno facendo i tuoi rilevamenti per te. Nello specifico, cosa stanno rilevando? Assicurati di avere il rilevamento nell'intero sistema I.C.S. Catena di uccisione informatica. Molte organizzazioni danno priorità a tutti i loro sforzi sul comando e controllo e sullo Stage | Atti (posso rilevare esfiltrazioni e comunicazioni fuori dalla mia rete). Tuttavia, gli avversari possono creare nuove tecniche, abilità commerciali e capacità per ogni fase della kill chain. È estremamente difficile e statisticamente contro l’avversario sviluppare metodi veramente nuovi per ogni singola fase. Molti avversari utilizzano tecniche commerciali comuni e poi fanno qualcosa di impressionante da qualche parte nella loro catena di uccisione. Tuttavia, se rilevi *qualsiasi* delle loro fasi, puoi ruotare per comprendere appieno l'intera catena di uccisione.
 Usa questo a tuo vantaggio. Spesso sentiamo dire che l'avversario deve fare solo una cosa giusta, mentre i difensori devono farlo
 fare tutto bene. Semplicemente non è vero. I difensori devono rilevare con precisione l'avversario solo una volta in una fase: l'avversario deve non essere rilevato in ogni azione in tutte le fasi per avere successo.

© 2021 Robert M. Lee 43 a ES SS SSS Lab 3.1
 Fase di rilevamento | Intrusioni
 Raffineria di Calistoga j
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 
 44 © 2021 Roberto M.Lee

@ @ @ ®@ @ G G
 wo @
 oO
 un fe ff@®

-

<>

@ es § & & bw Ww Bw Ww WwW weet eee we
 vy
 J
 w
 Obiettivi dello scenario del corso (2)

¢ Raffineria di Calistoga
*Quali sono l'indirizzo IP e il dominio dell'avversario?
 192.41.148.220 e rckwel(punto)ru
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 45 Obiettivi dello scenario del corso (3)

° Calistoga Perfeziona:

«Qual è il nome del file di progetto dannoso?
* Cosa ha fatto l'avversario al PLC di sicurezza?

+ Qual è la routine dannosa nella logica e cosa fa?
* Qual è la causa principale dell'attacco?
 L’incidente è collegato all’incidente di C3PO?
 eCgPO:
* Qual è l'azione dannosa sull'HMI?

+ Quale registro è stato manipolato con quale valore?

* Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 
 46 © 2021 Robert M. Lee
 en ene oe OO & & & &

| 7 eo 8 8 © @ 8 Ww wo ww ww Ww wo wo fidanzato wa Fs fidanzata AA ww ©&
 os w
 Caso di studio: verme della sabbia
 BLACKENERGY?2 e BLACKENERGY3
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee
 47 gruppi dal 2007
 exploit contro il SIMATIC,
 BlackEnergy

* BlackEnergy è un malware utilizzato dal crimine informatico

* BlackEnergy è stato utilizzato anche negli attacchi Denial of Service distribuiti
- Un altro gruppo ha preso BlackEnergy e lo ha aggiornato con nuove funzionalità quindi considerate BlackEnergy2 e BlackEnergy:

* Una delle funzionalità aggiunte era { slackenersy DGS Bat J
 un exploit zero-day che è diventato "sew SE |". reef Lae identificato come sedili SANDWORM [io ouainanayi || mao |
‘ + = — =| SYN 10 Alcune versioni di BlackEnergy2 oe 1 el hanno preso di mira I.C.S. ambienti con SS i tratta fF Torfune Freqy [50
 CIMPLICITY e Advantech |
 dimensione upP: [1000 si - || Dimensione Ter: [1000 SF Ps [0 (1-08 0- OFF)
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 BlackEnergy2 (BE2) e BlackRnergy3 (BE3) rappresentano un caso studio interessante. Si trattava di un tradizionale malware di tipo criminalità informatica utilizzato anche negli attacchi DDoS (Distributed Denial of Service) da parte di questi gruppi. Tuttavia, è stato racchiuso in un set di strumenti che è stato identificato come BlackEnergy2 da una minaccia persistente avanzata (APT). Lì è stato reso più complesso ed è stato sfruttato in campagne di spionaggio contro vari gruppi, tra cui la NATO e gli appaltatori della difesa.
 48

© 2021 Robert M. Lee

"

|

@
 eh
 oo § § JF OF ES SF VE EE FY SE SE FY OY we ww
 eh J
 vedere 8 & § SF
 L'impresa dei vermi delle sabbie
 I partner iSIGHT hanno identificato un nuovo exploit zero-day che prendeva di mira tutte le versioni di Windows da VistaSP2 a Windows 8.1

° Lo zero-day ha approfittato di OLE Ha aiutato l'azienda a identificare una campagna di spionaggio informatico legata ad attori russi
 Il rapporto di iSIGHT ha portato Trend Micro a trovare un file che comunicava con uno dei server Command and Control (C2) identificati

* Config.bak che è un file correlato al server CIMPLICITY che identifica Trend Micro dell'I.C.S. Il file correlato ha portato gli analisti di iSIGHT a cercare ulteriori dati su quell’indicatore

*Gli analisti di iSIGHT hanno poi trovato file che prendevano di mira i sistemi Siemens
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 Il rapporto Sandworm Exploit di iSIGHT Partners (https://www.isightpartners.com/2014/10/cve-2014-4114/) ha portato all'identificazione di più server C2. Gli analisti di Trend Micro si sono allontanati dai server C2 per trovare un file che era stato visto comunicare con uno degli indirizzi IP. Il file è stato identificato come config.bak, che è un tipo di file che viene fornito con il software CIMPLICITY SCADA di GE. Da ciò gli analisti sono stati in grado di identificare altri file relativi al file config.bak, compresi i file scaricati dal server C2. Questi altri file erano tipi aggiuntivi di file dannosi correlati a CIMPLICITY e malware non correlati a CIMPLICITY. Gli altri file sono stati utili per identificare indirizzi e-mail, file successivi, server C2 e destinazioni.
 Il lavoro degli analisti Trend Micro a partire dal rapporto iSIGHT ha consentito agli analisti iSIGHT di rivisitare i dati in un rapporto successivo (http://www.isightpartners.com/2014/10/sandworm-team-targeting-scada-systems /) e identificare file aggiuntivi come CCProjectMgr.exe utilizzati, che sono correlati al software SIMATIC e Siemens WinCC. Ciò ha contribuito a sviluppare nuovi indicatori utili agli analisti per identificare i sistemi infetti.

© 2021 Robert M. Lee 49 Obiettivi diversi Approcci diversi

«Documenti Word
(PPT/Excel/Documento)

| Phishing
‘ +» Exploit dei vermi delle sabbie
 E-mail di phishing con file PNG

+ Nessuna infezione, semplicemente
 notificato letto

«L'I.C.S. Sfruttamenti per gli HMI connessi al Web

+ Legittimo falsificato
 I.C.S. File
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 È anormale nominare una vulnerabilità, un exploit e il gruppo con lo stesso nome, ma questo è quello che è successo con SANDWORM. Ciò può portare ad alcune correlazioni che potrebbero non essere accurate nel tempo, ad esempio tutti coloro che utilizzano questo exploit devono far parte di questo gruppo (non necessariamente vero).Detto questo, le varie campagne organizzate da SANDWORM hanno avuto un impatto molto ampio su molte vittime. È interessante notare che l'approccio dell'avversario era diverso a seconda del tipo di vittime. Ciò potrebbe far sì che siano presenti più team anziché uno generale
 gruppo.
 Quando il gruppo ha perseguito obiettivi militari e della NATO, ha sfruttato in gran parte le e-mail di phishing con documenti word dannosi che sfruttavano una vulnerabilità. Quando il gruppo ha iniziato a prendere di mira obiettivi di infrastrutture critiche, c’era la tendenza a fare più ricognizione inviando e-mail che non infettassero l’utente ma richiamando per far sapere al gruppo che l’e-mail era stata letta. Lo sfruttamento diretto (presente in BlackEnergy2) è stato fatto leva contro I.C.S. reti dove potevano trovare HMI ospitati online, i file rilasciati sul sistema falsificato erano legittimi
 File Advantech, GE e Siemens.
 Sebbene sia utile cercare tutto se si dispone di risorse sufficienti, con risorse limitate è necessario concentrarsi sulle tattiche/tecniche/capacità utilizzate dall'avversario contro la vittima che rappresentava la propria organizzazione. Non c'è motivo di cercare inizialmente le e-mail di phishing, se stai cercando nel sistema I.C.S. reti.
 50 © 2021 Robert M. Lee
 it) |)
 nn@@@
 7?

~~
 eee ee a a | we wv 8§©§ Ob WwW we eee &
 ss fF ww noi
 oso SF FS SF
 Il team noto come Sandworm ha condotto una campagna coordinata per diversi anni, prendendo di mira interessi con sede in Russia come Ucraina, Polonia, NATO e organizzazioni legate all’analisi e alla preparazione delle forze militari. Questa analisi delle vittime mostra che gli obiettivi non erano di interesse per i gruppi basati sulla criminalità informatica, ma erano più allineati con gli interessi nazionali.
 Questo tipo di visione dipende fortemente dalla raccolta e trovare ulteriori fonti di raccolta potrebbe invalidare la forte attenzione al targeting, ma ciò non è stato fatto in questo caso. Da quello che sappiamo, SANDWORM era piuttosto mirato a infrastrutture critiche e obiettivi militari. Nel periodo 2012-2014 c’è stata una forte attenzione agli obiettivi elettrici ed energetici.
 Riferimento immagine: iSight Partners (ora Mandiant)

© 2021 Robert M. Lee 51 BlackEnergy2 e 3 I.C.S. Catena di uccisione informatica
 UN @
 S)
:

+O
| J
 ro)
 Atto ©)
 FASE 2 - I.C.S. Attacco “|
 Sviluppare
 Consegnare )
 Installa/Modifica
 OC Esegui I.C.S. Attacco )

}
 Attaccare con impatto
 Qui vediamo che sia in BE2 che in BE3 non c'è mai stata una capacità di attacco. Era semplicemente un kit di strumenti di spionaggio. Ciò ha portato a molta confusione iniziale sull’attacco informatico in Ucraina. Le notizie hanno indicato che "BlackEnergy ha causato l'interruzione di corrente", il che non è vero. Ha consentito agli aggressori di accedere all'ambiente, ma il malware non ha causato l'interruzione della corrente. L'analisi della catena di uccisione BE2 e BE3 prima dell'incidente avrebbe potuto contribuire ad alleviare la confusione. BlackEnergy2/3 potrebbe tecnicamente essere utilizzato per accedere direttamente all'I.C.S., in particolare al BE2, e rappresentare quindi l'inizio della fase di sviluppo di un I.C.S. attacco. Ma essi stessi non avevano alcuna capacità distruttiva o distruttiva per l’energia elettrica.
 52 © 2021 Robert M. Lee

"
 aonmaeaeegKssks#e#egses#eeee
 f @ ~~ Bi] ao Bi] o a mm,
 ce oso ws FO JF FSF FSF SF SF S&F HF HF WD
 I.C.S. Monitoraggio della sicurezza della rete
 I.C.S.$515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee
 53 Monitoraggio della sicurezza della rete

* Il monitoraggio della sicurezza della rete (NSM) è un processo continuo per raccogliere, rilevare,
 e analizzare le indicazioni di minacce allo scopo di rispondere:
¢ Approccio incentrato sulla minaccia rispetto al tradizionale approccio incentrato sulla vulnerabilità
« Presuppone che ad un certo punto la rete sarà compromessa
¢ Monitoraggio continuo della rete per incidenti di sicurezza
¢ Un approccio alla caccia

¢ Limitazioni:
* Richiede analisti dedicati
¢ Richiede la preparazione anticipata di infrastrutture e strumenti

« Vantaggi:
* Approccio proattivo alla sicurezza e al rilevamento delle minacce
* Consente agli analisti di guidare i team di difesa e architettura
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 NSM è stato in gran parte influenzato dalle forze armate statunitensi e dal desiderio di cercare avvisi e indicazioni tempestivi sull’attività dannosa in corso su una rete. Nella sicurezza IT tradizionale, esiste un approccio alla sicurezza incentrato sulle vulnerabilità: individuare le vulnerabilità, chiuderle e attenderne di nuove. Questo aspetto della limitazione delle vulnerabilità è importante, come abbiamo visto nella sezione precedente. Tuttavia, partendo da ciò, NSM si concentra su una valutazione incentrata sulla minaccia. Con la conoscenza della rete e un panorama delle minacce ridotto, come pattugliare la rete alla ricerca di minacce? Il NSM è un processo continuo che comprende che la prevenzione prima o poi fallirà. In questo processo, devi riconoscere che questa non è la tua pratica di sicurezza delle informazioni di base. Hai bisogno di analisti formati e dedicati che eseguano la NSM. Non è un lavoro part-time e non deve essere assegnato come compito aggiuntivo.Un'altra limitazione di NSM è che è necessario avere la capacità di preparare in anticipo la propria infrastruttura e i propri strumenti. Se non puoi collaborare con il team dell'architettura per stabilire punti da monitorare e ottenere l'approvazione degli strumenti, avrai difficoltà a eseguire NSM.
 I vantaggi della NSM sono numerosi. Il principale di questi vantaggi è che NSM fornisce un approccio proattivo alla sicurezza e al rilevamento delle minacce. Invece di aspettare semplicemente che i tuoi sistemi siano infetti, questo processo consente ai team di sicurezza di identificare attori avanzati e mirati all’interno della rete. l'obiettivo è identificare e mitigare la minaccia prima che il gruppo raggiunga la sua missione. NSM, combinato con l'intelligence sulle minacce, può identificare le minacce che stanno sondando le tue reti prima che possano accedervi. Ciò consente di adottare misure di difesa proattive per impedire l'accesso all'avversario.
 Questo processo riguarda la raccolta dei dati giusti, la loro analisi e il rilevamento delle minacce. Dovrebbe portare a un approccio di risposta agli incidenti quando viene rilevata una minaccia e si determina che è una situazione che richiede elevazione.
 Nessuna discussione sul NSM sarebbe completa senza menzionare alcune delle persone che lo hanno sostenuto nel corso degli anni. Di seguito sono riportati tre grandi libri su questo argomento:
 Il Tao del monitoraggio della sicurezza di rete: oltre il rilevamento delle intrusioni di Richard Bejtlich
 Il Tao del monitoraggio della sicurezza di rete di Richard Bejtlich Monitoraggio applicato della sicurezza di rete di Chris Sanders e Jason Smith
 54 © 2021 Robert M. Lee

@
 oe@GF GW GT SG SC GS
 oe @ @ @ @ @ @ @ @ © @O @ D @P we
 come sì
 e 4
 oh noi
 di Fe ww ww
 ss 8 SF SB
 Processo NSM nella difesa attiva
 Utilizzare la conoscenza della rete per promuovere la raccolta.
 Utilizza l'intelligence sulle minacce per influenzare il rilevamento.
 Falso
(falso positivo o inferiore alla soglia) Minaccia vera os
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 NSM non si occupa solo di trovare intrusioni; si tratta di monitorare la tua rete. Qualunque cosa, dai problemi di configurazione alle violazioni delle policy, possono essere tutti problemi che NSM mette in luce. Quando non è necessario che un evento venga trasformato in un incidente, può comunque essere utilizzato per l'azione quando si lavora con i team o il management della difesa e dell'architettura. Questi eventi aiutano a far crescere le difese della rete e l'abilità degli analisti.
 La visibilità tramite NSM consente di:

¢ Identificare i cambiamenti rispetto a comportamenti normali o previsti.

¢ Applicare il controllo e la politica delle modifiche.

¢ Risolvi rapidamente i problemi di configurazione errata.

* Rilevare tentativi di intrusione e spostamento nei sistemi I.C.S./SCADA.
¢ Illuminare potenziali percorsi di attacco.
 I miglioramenti della produttività derivano dal monitoraggio e dalla definizione di base del comportamento corretto noto del sistema mediante:

¢ Riduzione dei tempi di consegna (convalida più rapida e ritorno al buono stato operativo noto).

¢ Riduzione dei tempi di risoluzione dei problemi del sistema.

* Riduzione dei problemi di modifica e configurazione e individuazione rapida di errori/configurazioni errate prima che possano influire sul processo o sulle operazioni.
 NSM viene utilizzato per ottimizzare il sistema tramite:
* Perfezionamento delle zone di segregazione e di controllo per le reti di controllo.
* Generazione e convalida rapida delle regole del firewall.

* Ridurre (in tal modo rafforzando) porte e servizi non richiesti e caratterizzare i cambiamenti nelle comunicazioni di sistema.

© 2021 Robert M. Lee 55 Tipi di dati NSM
 Contenuto completo
+» Traffico completo (peap)

+ Avvisi a livello di rete e sistema come registri eventi °
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 I dati possono essere pensati come informazioni che non sono state analizzate. Come abbiamo detto nella Sezione 1, i dati analizzati diventano intelligenza. Nella fase di raccolta di NSM, siamo molto interessati a ottenere il maggior numero possibile di dati corretti. Ciò significa che se una persona responsabile della sicurezza è responsabile della rete di supervisione, vorrà raccogliere i dati che circolano tra l'HMI e i PLC. Questa persona probabilmente non si occupa del traffico di rete sulla rete aziendale, a meno che non interagisca direttamente con la rete di supervisione. Più dati possono significare più problemi. La raccolta dei dati giusti consente agli analisti di concentrarsi senza essere sommersi da più dati di quelli che possono elaborare. Se hai pensieri sui Big Data, vai avanti e buttali fuori dalla finestra. Desideri dati mirati di probabile valore.
 Contenuto completo Questo tipo di dati rappresenta l'acquisizione completa del pacchetto di dati di rete. Ad esempio, se si acquisiscono pacchetti completi di
 dati tra controllori di processo, ovvero dati a contenuto completo, siano essi basati su seriale o su base Ethernet.
 Metadati I metadati sono dati sui dati. I metadati possono essere considerati come informazioni come l'accesso modificato creato

(MAC) informazioni sui file. I timestamp, il tipo di sistema operativo e persino il tipo di traffico hardware originato sono metadati.
 Dati di sessione/flusso I dati di sessione e di flusso rappresentano il modo in cui si muove il traffico di rete. Determinare quale dispositivo ha inviato traffico e cosa
 ricevuto dal dispositivo, verranno considerati dati di sessione e di flusso. Tecnicamente si tratta di dati sui dati, ma si tratta di un tipo più specifico di metadati che vale la pena identificare.Dati storici/statistici Una visione di alto livello dei dati di rete può essere utile per comprendere l'utilizzo delle risorse di rete, come
 larghezza di banda e latenza prevista. Deviazioni da questo tipo di dati possono rivelare eventi sulla rete che vale la pena esaminare. Ad esempio, se si dispone di un client Modbus che effettua circa 100 letture all'ora e arriva a 400,
 sarebbe motivo di esaminare il traffico in modo più approfondito.
 56 © 2021 Robert M. Lee

= 7 ® ® © ® ® ® ®@ ® ® ® © &

"?) ™ " ™@)
 oeuwvewbwvwbwe
 UN
 ve vb
 devo s§& &§ &
 Avvisi Gli avvisi sono preziose fonti di dati che identificano un evento sulla rete. Questi eventi potrebbero essere accessi non riusciti, avvisi antivirus o registri di traffico bloccato su un firewall. Anche se la squadra di difesa dovrebbe preoccuparsi di questi
 principalmente eventi, la capacità di correlare gli avvisi attraverso l'intera rete e aggiungere contesto all'ambiente di rete è un ruolo NSM adatto a un analista di difesa attivo.

© 2021 Robert M. Lee 57 NSM applicato a I.C.S.

+ Strategia NSMisa indipendente dalla tipologia di asset (IT versus OT)
* Ambiente ricco di invulnerabilità, NSM eccelle:

+ NSM è particolarmente utile in un sistema I.C.S. ambientale a causa di apparecchiature che non possono essere riparate immediatamente (o mai).

° Non sempre le difese informatiche tradizionali sono adeguate ai sistemi I.C.S. ambienti

¢ I.C.S. le reti hanno molte dipendenze e connessioni:

* Connessioni ai fornitori, monitoraggio governativo, applicazioni aziendali, reti aziendali, VPN di appaltatori e così via

¢ NSM non si assume alcuna garanzia in merito
 connessioni/dipendenze
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 NSM non dipende dalla tecnologia. Non importa se parliamo di I.C.S. o sistemi informatici per il processo di NSM. Tuttavia, il modo in cui viene condotta la NSM dipende dal tipo di sistemi su cui si sta lavorando. Il processo NSM di raccolta, rilevamento e analisi va oltre il tipo di sistemi in uso. Tuttavia, in ogni fase, ci sono considerazioni per I.C.S. e difesa attiva. Ad esempio, la tradizionale fase di analisi NSM condurrebbe l'analisi del malware e l'analisi forense dell'host. Nel ciclo di difesa attiva, questi passaggi vengono spostati nei passaggi Risposta agli incidenti e Valutazione delle minacce. Ciò è dovuto alla sensibilità di alcuni sistemi I.C.S. reti e separare ulteriormente i compiti, in modo che i team di sicurezza della rete possano specializzarsi in modo appropriato per gli aggressori avanzati. In I.C.S., il team NSM dovrebbe raccogliere informazioni, rilevare eventi di sicurezza in tali dati e analizzarli per determinare se esiste una minaccia reale meritevole di risposta all'incidente. Le risorse dedicate per gli analisti di malware non rientrano nell'ambito di questo processo e probabilmente non rientrano nel budget per un I.C.S. squadra di sicurezza.
 Perché non sempre le difese informatiche tradizionali sono adatte in I.C.S. ambientali e poiché ci sono molte risorse che semplicemente non possono essere protette, NSM è una strategia altamente efficace per I.C.S.. NSM è una solida pratica IT, ma eccelle nell'I.C.S. ambiente. Le dipendenze e le connessioni che I.C.S. fa affidamento anche per fornire ampie opportunità per le aree che dovrebbero essere monitorate.
 Una considerazione è che la NSM tradizionale spesso non si occupa dei dati raccolti da sistemi come i controllori di processo. Lo storico dei dati che raccoglie informazioni sul processo dovrebbe essere considerato una risorsa preziosa per determinare se si verificano eventi strani su una rete. Le frequenze, le velocità delle turbine, i livelli di pressione e così via non sono tipi di dati normali per NSM, ma dovrebbero essere monitorati in I.C.S. NSM.
 58 © 2021 Robert M. Lee
 7 7 @ @ GT ® B® GB BD @&
 ehm@@
 eo oe mm &@
 ef ff ©& pecore noi Ww ww Ww ww @

- ao ap as as a we 8 § FF SF US Ww

“
 Preparazione per una difesa attiva
 Progetto :
« Progettazione hardware * ¢ Firma test di integrazione * Configurazione ¢ Test funzionale
* Controllo ¢ Spedizioni ¢ Configurazioni prove di carico ¢ Messa in servizio
 I.C.S.515 | [Visibilità, rilevamento e risposta del CS
 Il ciclo di vita dalla progettazione alla messa in servizio è importante quando si pianifica una difesa attiva perché fornisce informazioni specifiche sui processi e sulle apparecchiature che supportano l'analisi dei rischi e gli schemi di sicurezza, come I.C.S. monitoraggio della rete. Il FAT e il SAT sono finestre dove l'utente finale può richiedere e documentare come l'I.C.S. è configurato e determinare una linea di base per le comunicazioni richieste e previste. È possibile determinare gli sforzi di integrazione e le configurazioni finali (si consiglia quella più restrittiva ma funzionale) e convalidarle prima delle operazioni di sistema. La visualizzazione "come costruito" può aiutarti a definire la tua strategia, ma è necessario determinare "come gestito". (Sappiamo che le cose iniziano a cambiare dopo la messa in servizio.)
 Approvvigionamento
 Gli aggiornamenti delle apparecchiature hanno costi proibitivi; pertanto, il linguaggio degli appalti è importante per la gestione del rischio. Il DHS fornisce indicazioni sulle specifiche di approvvigionamento per mitigare i problemi delle specifiche di sistema di base. Vengono fatti riferimenti a tempistiche specifiche delle informazioni consegnabili.Tutta la lingua viene concordata al momento dell'aggiudicazione pre-contratto; le informazioni proprietarie o sensibili per l'azienda verranno fornite dopo la firma del contratto (aggiudicazione post-contratto).
 Test di accettazione in fabbrica
 Il Factory Acceptance Test (FAT) è necessario per verificare che le funzionalità di sicurezza funzionino correttamente e forniscano i livelli di funzionalità attesi. Ogni argomento include attività FAT specifiche per quell'argomento. In generale, prima dell'avvio di ogni FAT, il fornitore dovrà installare tutti i sistemi operativi e le patch delle applicazioni, i service pack o altri aggiornamenti certificati per l'uso con il sistema fornito al momento del test, nonché la documentazione della configurazione di base. Il FAT è un processo, non un evento, e potrebbe estendersi per diverse settimane o mesi. Assicurarsi che in questa fase esistano controlli di sicurezza adeguati, poiché può essere comune che i controlli vengano aggirati nel tentativo di "far funzionare il sistema". Confermare che esistano controlli di sicurezza a livello di file per i dati introdotti o rimossi dal sistema e assicurarsi che la connettività Internet/rete esterna sia ben compresa e controllata. Assicurarsi inoltre che vengano seguite le pratiche appropriate di controllo delle modifiche e della configurazione.
 Test di accettazione del sito
 Il Site Acceptance Test (SAT) dell'acquirente della risorsa ripete in genere un sottoinsieme di un FAT dopo l'installazione del sistema con funzioni integrate aggiuntive. In genere, il SAT viene eseguito prima del cutover o della messa in servizio per verificare che l'installazione in loco sia equivalente al sistema testato in fabbrica. Come il FAT, il SAT può estendersi per diverse settimane o mesi e può verificarsi in più località.

© 2021 Robert M. Lee 59 Preparazione dell'infrastruttura

° Valore:
+ Innanzitutto, preparare l'infrastruttura e identificare le fonti di dati
* Consente l'accesso completo ai dati giusti
° Fonti:
« Tap di rete posizionato in linea per duplicare e catturare il traffico
+ Abilita la porta SPAN/Mirror su uno switch di rete e il flusso dei dati
* Firewall/registri eventi
* Storico dei dati per i dati di processo
° Metodologia:
* Determinare le aree più critiche seguite da quelle più vulnerabili; ritira lì prima
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S
 Preparare le infrastrutture sembra un po’ fuori luogo per un difensore attivo. Idealmente, il tuo team di architettura dovrebbe essere più che capace di farlo. Tuttavia, se non comunichi le tue esigenze al personale dell'architettura, probabilmente non saprà dove o perché desideri che i punti di accesso alla rete raccolgano i dati.
 Per preparare l'infrastruttura è necessario identificare il tipo di dati che si desidera raccogliere. Se stai cercando dati con contenuto completo, dovrai inserire una porta SPAN/mirrored su uno switch gestito e raccogliere il traffico da esso utilizzando strumenti come TCPdump o Wireshark. Se desideri i dati degli avvisi, devi avere accesso ai firewall e ai registri eventi. Tutto sulla rete dovrebbe essere valutato per determinare se contiene dati utili per le tue esigenze, in modo da poter determinare il modo migliore per ottenere tali dati.
 Consigli veloci:

* Su uno switch di rete, ricordare che solo gli switch gestiti possono essere impostati per avere una porta SPAN/mirror. Inoltre, fai attenzione alla quantità di throughput che la tua porta può gestire rispetto alla quantità di traffico di rete che hai. Se disponi di una porta da 1 GB e stai eseguendo il mirroring di 2 GB di traffico su di essa, perderai metà della raccolta dati. Puoi avere più di una porta con mirroring.

* Uno dei migliori strumenti per raccogliere il traffico di rete è TCPdump perché consuma meno risorse di Wireshark; ne discuteremo più tardi.

* Gli switch di rete spesso dispongono di dati di flusso di valore come lo standard IPFIX.

° Gli hub ottengono i dati "più puri". Gli switch di rete spesso scartano pacchetti mal formati o eventuali errori. Gli hub acquisiscono tali dati in modo da poter determinare il motivo per cui i pacchetti non sono corretti.
 Cambia porta SPAN/Mirror
 Finora nel corso abbiamo parlato di alcune cose che sfruttano lo SPAN o la porta mirrorata di uno switch di rete. I due termini sono spesso usati in modo intercambiabile. L'uso originale di SPAN era specificamente per gli switch Cisco. La preparazione di una porta con mirroring sugli switch gestiti nella tua infrastruttura ti consentirà di raccogliere il traffico di rete in modo passivo e sicuro senza aumentare la latenza o la larghezza di banda. La porta con mirroring rispecchia semplicemente tutte le altre porte su di essa. Se la porta riceve più dati della sua velocità effettiva, interromperà il traffico senza che le altre porte vengano influenzate.
 60 © 2021 Robert M. Lee
 omm@m@

)
 io
 ae we Oo oo om LD
 ar
 un ATS | oe WV WV ueeuew wewweweeweewe &
 UE &
 Ogni fornitore ha un metodo diverso per abilitare la porta con mirroring, ma generalmente si tratta dello stesso processo. Accedi allo switch gestito tramite un prompt di gestione nell'interfaccia della riga di comando o nella GUI e impartisci il comando o seleziona l'opzione per eseguire il mirroring di una porta.Ad esempio, i comandi di uno switch Cisco 3000 per eseguire il mirroring di una porta dalla CLI sono:

* (Imposta porta sorgente) # monitor sessione 1 interfaccia sorgente gigabitethernet1/1 entrambi
¢ (Imposta porta di destinazione) # monitor sessione 1 interfaccia di destinazione gigabitethernet1/2 incapsulamento replica
* (Verifica) # mostra la sessione del monitor |
 Quando la porta con mirroring è abilitata, può essere utilizzata per inviare il traffico a una posizione designata. Una metodologia consiste nell'utilizzare un dispositivo di archiviazione di rete per raccogliere il traffico. Un altro approccio consiste nell'utilizzare un laptop con TCPdump (discusso in alcune diapositive) per raccogliere il traffico. Un dispositivo di archiviazione di rete è una soluzione migliore quando è possibile e l'archiviazione di più TB è relativamente economica (poche centinaia di dollari per pochi TB). Ha molto spazio per immagazzinare il traffico in un I.C.S. di dimensioni moderate. ambiente. Assicurati di controllare la quantità di traffico di rete che stai catturando e la velocità con cui prevedi di riempire lo spazio di archiviazione.
 Tocca Rete
 Un tap di rete rispecchierà il traffico full-duplex che attraversa il tap e in genere inoltrerà i flussi catturati a un dispositivo di monitoraggio o a un sistema di acquisizione come due diversi flussi half-duplex. Uno è per la trasmissione e l'altro per la ricezione. Ciò richiede che il dispositivo di acquisizione disponga di due schede di interfaccia di rete e della capacità del software di monitoraggio di combinare i due flussi per l'analisi. Esistono dispositivi di tocco che eseguono l'aggregazione del flusso di dati e consentono un dispositivo di monitoraggio con un'unica scheda di interfaccia di rete e capacità di analisi diretta dal punto di vista del software.
 Va notato che gli hub possono essere utilizzati per vedere la comunicazione tra due dispositivi; tuttavia, gli hub possono causare problemi di larghezza di banda e non sono consigliati in un sistema I.C.S. ambiente.
 Rete Tocca Valore
 In molti I.C.S. ambienti, gli switch distribuiti possono o meno consentire lo spanning/mirroring delle porte. Inoltre, anche gli switch gestiti che supportano lo spanning/mirroring possono consentire il monitoraggio solo di un numero limitato di porte in un dato momento. È necessario prendere in considerazione la capacità di throughput del backplane dello switch; abilitando lo spanning/mirroring, è possibile influire sulla capacità di throughput dello switch. L'utilizzo dello spanning/mirroring sta diventando sempre più comune nelle implementazioni di nuovi sistemi; tuttavia, è anche importante notare che gli errori CRC verranno solitamente scartati dal routing, quindi una porta span/mirror non lo vedrà, ma un tocco di rete lo raccoglierà.
 Dati di processo dello storico dei dati
 Gli storici dei dati contengono preziosi dati storici e statistici da raccogliere. Il rilevamento di deviazioni e anomalie può essere utilizzato per comprendere meglio la minaccia e la portata di un'infezione. Se i valori e i setpoint dello storico dei dati sono cambiati di recente dopo un'infezione, è una buona indicazione che i sistemi di controllo del processo potrebbero essere stati influenzati.
 Sebbene gli storici dei dati siano spesso diversi tra loro in vari modi, di solito sono tutti una sorta di database. Come buona metodologia, recuperare i dati del processo per archiviarli in modo sicuro. Questo può essere fatto tramite comandi di esportazione nativi dello strumento o effettuando query selezionate. La sincronizzazione di questa raccolta dati con uno strumento di raccolta come un SIEM (i SIEM verranno discussi più avanti) può fornire una visione più olistica delle operazioni. Inoltre, questo valore può aiutare i team di analisi forense digitale e di risposta agli incidenti.
 Firewall/registri eventi
 Per NSM, la raccolta di firewall e registri eventi può tracciare un quadro migliore di ciò che accade in una rete. Ad esempio, in una raffineria di petrolio, gli utenti hanno scoperto che molti dei loro account venivano bloccati. Non erano in atto sistemi IDS o di sicurezza per fornire ulteriori informazioni e non c'erano accessi prestabiliti alla rete per avere una buona raccolta di dati come il contenuto completo. La raffineria ha chiamato una squadra di sicurezza esterna al

© 2021 Robert M. Lee 61 un prezzo elevato per capire cosa stava succedendo dopo che numerosi controllori di processo si sono bloccati. Il team di sicurezza ha rapidamente identificato che la causa del problema era il worm Conficker. Questa minaccia non mirata ha causato gravi costi finanziari e commerciali alla raffineria. Una serie di misure difensive, come l'applicazione di patch ai sistemi Windows, avrebbero potuto prevenire questa infezione accidentale. Queste misure difensive si concentrano sulla prevenzione. Un team NSM avrebbe potuto identificare rapidamente questo problema esaminando il numero di registri eventi di Windows emessi per accessi non riusciti.
 I registri eventi possono essere prelevati in remoto dai sistemi, ma per NSM è spesso meglio automatizzare questo processo. Successivamente, discuteremo dei sistemi SIEM e degli aggregatori di log che possono aiutare in questo. Per i firewall, tuttavia, i registri saranno incompleti se non viene eseguita la corretta suddivisione in zone e segmentazione della rete. I punti di strozzatura sono efficaci per la raccolta qui perché le varie connessioni esterne nel tuo ambiente devono passare attraverso la rete
 firewall.Inoltre, è possibile eseguire la Deep Packet Inspection (DPI) o l'ispezione completa dei pacchetti per ispezionare il traffico e determinare se si verificano abusi a livello di protocollo. I firewall Tofino sono un ottimo esempio di sistema I.C.S. firewall a livello di dispositivo in grado di ispezionare I.C.S. protocolli per identificare e bloccare il traffico dannoso o non valido. I registri del traffico bloccato (e quando correlato con altri eventi) sulla rete garantiranno una situazione migliore
 consapevolezza del proprio ambiente.
 L'IDS può acquisire dati, ad esempio acquisizioni di pacchetti relativi a un evento; non deve essere legato a una minaccia. Questo è discusso nella prossima sezione.
 Registri eventi di Windows I registri eventi sono specifici dei sistemi Windows e sono un tipo speciale di registro in cui vengono archiviate informazioni rilevanti
 vari eventi su un sistema. Gli eventi dell'applicazione, ad esempio, identificano avvisi, errori e informazioni sui programmi, incluso il momento in cui sono stati avviati e si sono arrestati in modo anomalo. Gli eventi relativi alla sicurezza identificano attività particolarmente interessanti, come accessi non riusciti o riusciti. Gli eventi di installazione sono correlati specificamente ai controller di dominio. Gli eventi di sistema sono simili agli eventi dell'applicazione, ma specifici dei servizi di sistema Windows. Gli eventi inoltrati sono quei registri di eventi
 inoltrato a una posizione centrale.
 I registri eventi possono essere inoltrati da tutti i sistemi Windows dopo Windows XP Service Pack 2. I registri non devono essere archiviati sul singolo sistema a causa delle tecniche antiforensi degli avversari. La spedizione dei registri a una posizione centrale aiuta l'analisi di tali eventi e la loro archiviazione e gestione sicura.
 Riferimenti: https://support.microsoft.com/en-us/hub/43 38813/windows-help?0s=windows- | 0#1TC=finestre-7
 Fonte immagine: http://blogs.technet.com/b/wincat/archive/2008/08/ 1 I/quick-and-dirty-large-scale-eventing-for-windows.aspx
 62 © 2021 Robert M. Lee

@ @) @) QQ r) 0 @) @ ®) i/o
 o di @ ® @ @® DM WD

@

“> sì | 8§& §& §& S&F FSF §F& HF HF HF HF WT YF W
 Processo A Processo B Operatore Ridondante Ufficio Server di Controllo Ridondanti PC Data Storico Ingegneria Server di Controllo
 Stazione di lavoro
 Processo e HMI
 Processo di pressione della macchina
| contrsiter jlodem Controtier "Soncor
 attuatore del sensore
 Computer
 fodem
 Motore | Accesso remoto: solenoide
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Gli aggressori adorano trovare reti piatte. Le reti flat rendono incredibilmente facile per gli aggressori utilizzare le credenziali e le informazioni raccolte da una parte della rete attraverso l'intera rete. Semplici attacchi in stile spoofing ARP diventano incredibilmente potenti per un avversario che trova una rete senza un'adeguata segmentazione della rete. Le reti piatte sono difficili da monitorare anche dal punto di vista della difesa, il che rassicura gli attaccanti che se trovano una rete come questa, probabilmente i difensori non la guarderanno nemmeno.
 Quando si considera una difesa attiva, questo tipo di rete presenta un problema. Le reti che non sono adeguatamente segmentate e non dispongono di un’infrastruttura di rete gestita, come gli switch di rete che possono abilitare una porta con mirroring, offrono poche opportunità ai difensori di raccogliere dati significativi. Una corretta architettura aiuta a migliorare la sicurezza limitando l'efficacia dell'avversario al momento della compromissione iniziale e dando tempo ai difensori per rilevare l'attacco, ma fornisce una base essenziale per i meccanismi di difesa attiva.

© 2021 Robert M. Lee 63 La separazione è la chiave!
 Storico dei dati
 Processo A ridondante
 Control Serv niginsenet ont 3 processo A HMI Engineacing: Workstation
 Processo A
 Macchina
 Prosa: Controller iio
 Sensore
 Motore Solenoide Pressione Motore 9 Valvola can
 Ufficio Operatore
 Ridondante
 Server di controllo tecnico
 Stazione di lavoro

| Pracoss B
| controllore

|

| |

| | J Presmu
 Processo 8 HMI
 Singiq Lone Modem “‘contiotier
 Sada feonsor ectustore
 Confronta
 ciao)

®@ @ @®

@@
 dd od ed Sd |
 La separazione fisica e logica nelle reti rende più difficile per gli avversari spostarsi all'interno della rete, offrendo allo stesso tempo posizioni e punti di passaggio difendibili per monitorare il flusso del traffico di rete. I chokepoint e il monitoraggio della rete verranno discussi più avanti in questa sezione, ma è importante notare la differenza tra questa diapositiva e quella precedente. C'è ordine in questa architettura di rete e, anche dal solo punto di vista della visualizzazione, sembra più facile da difendere e gestire. È anche molto più semplice identificare le risorse sulla rete
 quando la segmentazione e la separazione vengono eseguite correttamente.
 64 © 2021 Robert M. Lee
 7 oO © OW OD DW ®
 tL ee TT]
 aa fe guai wee www ee
 oo vw F&F ww wo Ue YE Ww WwW
 I.C.S. Raccolta dati

* Mappa per la tecnologia:

* Identificare chi gestisce le infrastrutture e le risorse del sistema di controllo
* Mappa dei processi aziendali:

* Cerca processi aziendali che utilizzano sistemi di controllo

* Distribuisci endpoint di monitoraggio sul lato interno di tutti i collegamenti di rete in uscita
 identificare passivamente I.C.S. risorse, minacce e informazioni critiche
 Creare
" Punti di strozzatura
 I.C.S.515 | I.C.S.Visibilità, rilevamento e risposta
 Dopo che l'identificazione delle risorse e della rete è stata eseguita e verificata rispetto ai documenti di architettura esistenti, la rete deve essere monitorata per determinare i problemi. Il monitoraggio della sicurezza della rete è quasi impossibile senza comprenderne l’architettura. Il primo passo del NSM è la raccolta.
 La raccolta dei dati è necessaria per valutarli rispetto a minacce ed eventi relativi alla sicurezza. Firewall, IDS, server OPC e porte SPAN/mirror sono utili come fonti di raccolta. Li esamineremo nelle diapositive seguenti.
 Assicurati di collaborare con il team dell'architettura di rete per creare punti di strozzatura. Un chokepoint è essenzialmente un collo di bottiglia previsto sulla rete che non limita la larghezza di banda né causa latenza. Ad esempio, se più risorse sulla rete richiedono connessioni remote, un chokepoint sarebbe un singolo punto di accesso per le varie connessioni remote. Gli utenti si collegheranno a questo punto di accesso e quindi si collegheranno al dispositivo di cui hanno bisogno. Invece di avere più punti per raccogliere il traffico, ora hai un unico punto di strozzatura. Questo è un altro motivo per cui la segmentazione della rete è così importante. Quando una rete è segmentata correttamente, si formeranno naturalmente numerosi punti di strozzatura. Queste connessioni tra le reti possono essere punti vitali di raccolta dei dati. In questi punti critici è anche utile implementare sistemi che possano essere utilizzati per avvisare delle minacce, come firewall e IDS. Comunicare le esigenze in modo efficace al personale IT, perché spesso è esperto nelle difese tradizionali e nella creazione di tali punti di strozzatura.
 È più importante avere i dati giusti che tutti i dati. Identifica e raccogli da segmenti di rete critici, punti di strozzatura e dati da risorse critiche.
 Hai visto il film 300? Nel film, gli Spartani devono affrontare legioni di combattenti persiani. Tuttavia, ci sono solo 300 Spartani. In campo aperto sarebbero stati rapidamente sconfitti dagli eserciti persiani. Per contrastare questo, Leonida, il re spartano, posizionò i suoi 300 guerrieri in un passaggio tra due montagne. Questo passaggio naturale assicurava che gli Spartani dovessero combattere solo un numero limitato di Persiani alla volta. Hanno creato un punto di strozzatura. I difensori della rete devono essere abili nell’utilizzare la propria infrastruttura per garantire la protezione contro la vasta legione di minacce
(non necessariamente persiani).

© 2021 Robert M. Lee 65 I posti principali per la raccolta includono:
 eInternet

¢ Impresa

* Operazioni affaristiche
¢ Controllo di supervisione
* Gateway

¢ Bus di campo
 Identificazione dell'I.C.S. Hotspot Individuazione dei punti che possono essere considerati hotspot nel sistema I.C.S. sono importanti per determinare quali punti di raccolta
 dovrebbe essere stabilito prima. Gli hotspot possono essere considerati come luoghi in cui si verificano molte operazioni o in cui è probabile che le minacce di rete trovino un modo per penetrare. Esistono due metodologie principali per trovare gli hotspot: mappa per tecnologia o
 mappa dei processi aziendali.
 Mappa per la tecnologia Identificare chi gestisce le infrastrutture e le risorse del sistema di controllo. Probabilmente le persone che gestiscono l'infrastruttura
 hanno capacità remote in tutta la rete, nonché strumenti predisposti per aiutarli. Questi accessi privilegiati alla rete sono buoni hotspot da cui tentare la raccolta.
 Mappa dei Processi Aziendali I processi aziendali che ottengono informazioni dai sistemi di controllo e dall'I.C.S. è probabile che le risorse, come uno storico dei dati, lo facciano
 essere punti dentro e fuori la tua rete. In una rete ben strutturata, i processi aziendali possono accedere ai dati di cui hanno bisogno fuori dall'I.C.S. attraverso una DMZ, che funge da ottimo hotspot.
 I chokepoint si riferiscono ai percorsi di rete stessi, mentre gli hotspot si verificano dove si svolgono molte attività e possono essere introdotte minacce. Gli hotspot possono esistere nei punti di strozzatura, ma potrebbero non esistere lì. Tuttavia, collaborare con il team di architettura per allineare hotspot e punti di strozzatura può rendere la raccolta molto più semplice.
 66 © 2021 Robert M. Lee
 oS
 om © @® D® ® ®@ GD GD
 sono™
 eh.

~e. eo

<>
 ol ee et le il eof el woe ws FF FTF ow we &
 af oe 8 ©8© 8§ 8 FS 8S TF EF TP PF SE we Ww
 Analisi del traffico Nord/Sud vs. Est/Ovest

° L'analisi del traffico Nord/Sud è un punto di partenza facile ma spesso carente
 I.C.S. contesto e approfondimenti
* Caso d'uso: identificare il beaconing delle operazioni e dei domini dannosi
* Caso d'uso: identificare il traffico tra siti

° L'analisi del traffico Est/Ovest è richiesta in I.C.S. reti perché la maggior parte delle comunicazioni tra Supervisione e Controllo
 l'attrezzatura avviene qui
* Caso d'uso: identificazione delle risorse e analisi del protocollo
* Caso d'uso: movimento laterale avversario e manipolazione dei sistemi di controllo
 peer Nord/Sud = Ciò che oltrepassa i confini, ad esempio, dentro e fuori il processo Firewall L3 A —
 Ufficio Operatore Ridondante Ridondante
 Server di controllo: Data Histonan Engineering - Server Conitol
 Processo A HMI " Wuhsimton: Processo 8 HMI
 Machine secure Process 8 8 Controle, “eeSt Sontiotles Modem

‘Sensore Est / mm ‘a Ovest =

. Interno H
 Motore © Temata Reese
; a comunicazioni | = Regolatore del Ren Seneit -
 I.C.S.515 | I.C.S.Visibilità, rilevamento e risposta
 Quando si coordina la raccolta o si distribuiscono strumenti di rilevamento, è molto comune che il personale dell'impianto desideri che le attività di rilevamento si svolgano all'esterno dell'impianto/sottostazione/sito operativo. Ciò significa che si posizionerà all'esterno del firewall o analizzerà semplicemente il traffico davanti o dietro il firewall per le comunicazioni Nord/Sud. C'è valore nelle comunicazioni Nord/Sud, come il controllo degli indicatori, il traffico tra siti e l'identificazione del tipo di connessioni in entrata e in uscita dal sito operativo. Tuttavia, ci sono molte comunicazioni che ti mancheranno, soprattutto la maggior parte delle cose di I.C.S. valore e le VPN/connessioni OEM/integratore saranno probabilmente offuscate.
 L'analisi del traffico est/ovest richiede la creazione di un rapporto di fiducia con il personale operativo. Quando possibile, dovrebbe essere impiegato in una funzione completamente passiva, senza interrompere attivamente le comunicazioni o svolgere alcuna funzione di prevenzione. Nella configurazione Est/Ovest vedrai l'I.C.S. comunicazioni/protocolli ed essere in grado di identificare risorse e vulnerabilità. Ancora più importante, tutte le azioni “interessanti” dell’avversario, come il movimento laterale, i cambiamenti logici, la manipolazione dei controlli, ecc., saranno disponibili per il rilevamento.

© 2021 Robert M. Lee 67 Caso di studio: raccolta dati su stoccaggio/distribuzione del gas
 Doman Convaker

_1B
 Torre del motore © reer
 io io

' F
 io r
' io
‘ io io | Torre Loe
| Metro ower ter | cioè sat spese
| oraens i ees
} !

! :
 io

|
 io
 io !
 id
 IO

':
| IO
 Io io
 IO

'
 IO
 IO

!
 In questa e nelle due diapositive successive, consideriamo un'operazione di distribuzione e stoccaggio del gas. Si tratta di una configurazione di distribuzione e stoccaggio del gas abbastanza moderna, che include l’uso di ambienti virtualizzati (basati su VMWare). Utilizza il software di gestione FactoryTalk e RTU Bristol con switch Cisco.
 Lo scopo di questa diapositiva non è quello di fornire informazioni dettagliate sulle apparecchiature e sulle torri, quindi non perdere tempo strizzando gli occhi per identificare i nomi. Pensa invece al layout generale. Esiste una rete aziendale che si collega al centro di controllo. Questo centro di controllo è separato dalla rete aziendale tramite un firewall. Sono disponibili più switch Cisco gestiti, incluso uno switch interno e lo switch DMZ vicino al firewall.
 Lo switch Cisco internamente sarebbe l'ideale per raccogliere dati da una porta con mirroring sull'attività sulla rete. Poiché esiste un ambiente virtuale, è probabile che esista anche un'opzione per impostare anche una porta con mirroring virtuale e garantire l'acquisizione di tutti i dati possibili.
 Successivamente, sarebbe importante identificare ciò che sta attraversando la DMZ, in modo che una posizione di monitoraggio possa essere impostata lì o direttamente fuori dal firewall. Vedere cosa sta colpendo il firewall esterno nel percorso verso l'azienda potrebbe essere importante, ma è probabile che sia qualcosa che l'IT potrebbe monitorare. OT avrebbe bisogno di approfondimenti se non di monitorare direttamente (identificare le connessioni fallite a volte è importante quanto quelle riuscite).
 Mentre scendiamo, notiamo che ci sono due dispositivi con cui sta comunicando la torre del Sito A. Questi sono i modem con cui la torre comunica di nuovo, attraverso il firewall, e poi di nuovo sulla rete. È un ottimo design (avere la comunicazione dei modem attraverso un firewall e attraverso la DMZ prima di raggiungere la rete). Ciò significa che un punto di monitoraggio nella stessa DMZ non solo raccoglie dal centro di controllo alla rete aziendale, ma raccoglierebbe anche la torre del Sito A nel centro di controllo.
 Il monitoraggio in ogni luogo sarà probabilmente improbabile per un'organizzazione. Di solito non è possibile un meccanismo di raccolta presso ciascuna torre del contatore. Tuttavia, se in tali ambienti sono presenti interruttori con mirroring a
 68 © 2021 Robert M. Lee
 ta

@ @W@
/
 oemOO. OD DD OD HD ® WH BW @W
 a Om@

?
"COME
 2a «aw «45
 è possibile implementare un piccolo dispositivo di raccolta, riassumere i dati di flusso e rinviare i dati di flusso leggeri attraverso il normale percorso di comunicazione al team di sicurezza del centro di controllo. Nel caso molto probabile che non siano presenti switch gestiti/mirrorati, è preferibile disporre di un agente di raccolta sugli host, ad esempio un raccoglitore di registri, o semplicemente inoltrare i registri di Windows o i syslog a un server nel centro di controllo. Nel peggiore dei casi, monitorando ciò che sta attraversando la torre del Sito A nel luogo, possiamo almeno vedere cosa sta entrando e uscendo verso le Torri dei contatori.
 Inoltre, tutte le informazioni trattate nell'immagine della diapositiva potrebbero essere ripetute anche nel Sito B. Si noti, tuttavia, che il Sito B è in scala molto più piccola. Idealmente, la raccolta verrebbe effettuata dallo switch gestito interno all’ambiente e inoltrata a uno strumento di aggregazione di registri e di rete per il team di sicurezza del centro di controllo.
 Mostrati nel grafico della diapositiva, le stazioni e gli strumenti di monitoraggio potrebbero facilmente essere Security Onion e sono stati presenti in più siti della comunità.
 Per tua informazione, dettagli:
* Il sito A ha 12 siti di compressione e il sito B ne ha 1.
* I dati di fatturazione e misura vengono prelevati dai punti di misura una volta al giorno alle ore 10:00.* Se è necessaria la raccolta manuale, ciascun sito di misurazione ha una capacità di 30 giorni (ma la raccolta manuale non è l'ideale).
* Ogni torre ha circa una dozzina di cadute wireless in metri.

© 2021 Robert M. Lee 69 VLAN 109 / 172.16.19.0/24 Client IT (desktop virtuali) GW: 172.16.19.1
 VLAN 200 / 172.16.20.0/24 Servizi di rete (server IT virtuali) fesnztexae GW: 172.16.20.1 —
 VLAN 201 / 172.16.21.0/24 oe mn: gaa eeetttomnes Servizi app (server SCADA virtuali) | Mosuarece GW: 172.16.21.1
 VLAN 202 / 172.16.22.0/24 mia EWS (Virtual Engineering Desktops) a GW: 172.16.22.1 os
 trassans
 Ga: stuoie
 VLAN 203 / 172.16.23.0/24 : —_ - easass0c OWS (desktop operatore virtuale): ane Ore raat
 sresen24i08
 bee VLAN 300 / 172.16.30.0/24 ete Zero Client (Wyse Thin Client oeiee sroasssens
)GW: 172.16.30.1 . Greramaae
 VLAN 301 / 172.16.31.0/24 . Strumentazione Portatili sicuri soane GW: 172.16.31.1 4 uno mangia
 YUAN 404 1 47218.18.028

'A viltion S, VLAN 400 / 172.16.40.0/24 aeitons s fsa cx Gateway {ControiLogix Gateway) | — SweetDt 2172.16. cosa
 Caso di studio: gasdotto L2 e L3
 Analizzando un po’ di più la rete del gasdotto, possiamo vedere l’architettura logica della rete. La casella espansa mostra che l'apparecchiatura è assegnata alle VLAN in base alla sua funzionalità e ha un intervallo IP impostato. Ciò rende l'identificazione delle risorse ottenibile avendo un'architettura facilmente referenziabile. Con le apparecchiature separate da VLAN possiamo inoltre raccogliere il traffico da VLAN specifiche sullo switch gestito per poter creare linee di base per i segmenti più importanti (come server SCADA, desktop operatore e gateway di controllo). Ognuna delle VLAN potrebbe essere una zona che creiamo nel nostro inventario delle risorse per monitorare e comprendere le porte, i flussi di dati e i protocolli sulla rete.
 Questo tipo di configurazione non è facile da ottenere, ma sono stati utilizzati più sistemi I.C.S. sedi della comunità che hanno ottenuto con successo il certificato I.C.S. in questo tipo di configurazione ben pianificata, anche dopo che le operazioni erano già avviate. Tutto questo è un aspetto della fase Architettura della scala mobile della sicurezza informatica. Qui possiamo vedere come una buona architettura renderebbe la difesa passiva e la difesa attiva molto più accessibili e meno costose.
 Nel materiale della Sezione 3, la raccolta dagli host degli ambienti virtuali verrà trattata in modo più approfondito durante la discussione sulla risposta agli incidenti.
 70 © 2021 Robert M. Lee
 eo @D @® QD &
 Oh DB

»> >>» ® ® ®&
 2)
 ce.S

= w VV Vw Ww &
 noi siamo stati
 ed
 COME
 Protocolli seriali

¢ I protocolli seriali sono ancora presenti in molti I.C.S. al Livello 0 e al Livello 1 del Modello Purdue Sosa tat lS I protocolli comuni includono: |@ FOO 1s me | myat1!® Modbus RTU TN ATES 01 10 3300 00 08 ce gh

| OC DNP | Jo0 01 Se bo & Gi OTE “Watt

|

|

|
 Ld 104-02 00 DI £ 9 34 ¥ DF1 * ae
 33 J04 32 0300 essere OE TEC60870-5-101 IEC50870-5-103 Emerson ROC CC-Link Profibus |
 Pesare i pro e i contro dell'analisi qui = ee Stat SR

¢ Raccolta difficile e dispendiosa in termini di tempo | uaaaaataaaanaaes
 minerale Soke
® P0104 1¢0301 00.89 Oce RA
 9 OT
 01 07 00'00'63. 1900:00:03.13 00:00 00:00 00.00 Oce MANE, 6 % 01 10 3300 OTE Lata 190 G0 60 00 00 00.00 00 73.af DCE Wie’ 00 82 02 UG G1 65 db pre "Vini

® P 01.10 330800 01 Bf ocE RPA
 W 01 04 32 00:00 01 32 72 OTE Mee Wee
 at ® P 01 0402 oce 9 fe P Of 04 32 01 06 01 Se bz

& MOLO 02 0008 F934

* Nessun avversario osservato utilizzando il seriale 60 be ue 76
* La convergenza IT/OT sta generando più minacce IT Raccomandazione:
* Avere un meccanismo di riferimento, se disponibile, utilizzando strumenti come Wireshark o NetDecoder
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Molti analisti vogliono essere in grado di analizzare i protocolli seriali. Sembra più “I.C.S.” nella natura e attraente come una sfida. Tuttavia, non ci sono stati avversari che abbiano dimostrato l’intenzione di utilizzare le comunicazioni seriali. Ciò non significa che non dovremmo preoccuparci della sicurezza di questi sistemi, ma significa che in qualsiasi architettura adeguata, l’avversario dovrà utilizzare i sistemi aziendali nei sistemi tecnologici operativi e in tutte le aree in cui possiamo raccogliere e analizzare correttamente molto prima di arrivare al livello seriale.
 Quando si verifica un problema a livello di comunicazione seriale, è anche importante disporre di un tecnico che comprenda il sistema e l'implementazione per agire. Quell'ingegnere, assistito da un analista della sicurezza, può valutare meglio le comunicazioni con un ritorno di valore più elevato in termini di tempo investito rispetto alla formazione del personale di sicurezza per comprendere le comunicazioni seriali. Molto raramente sarà consentita la raccolta seriale.
 Si consiglia tuttavia di effettuare l'acquisizione di base, se possibile. Questo può essere fatto con molti protocolli utilizzando la versione Linux di Wireshark. Inoltre, lo strumento NetDecoder ha circa 20 I.C.S. protocolli che comprende.
 Riferimento immagine: NetDecoder

© 2021 Roberto M.Lee 71 MatrikonOPC Sniffer

° Valore:
* Acquisisci dati OPC tra client e server
* Fonte:
° http://www.matrikonopc.com/products/ope-data-management/ope-sniffer.aspx
‘ Metadalegia: ® Matrikon OPC Ottieni prima l'autorizzazione: Installa lo Sniffer sul server OPC Sniffer Seleziona l'interfaccia appropriata Spe Inizia la raccolta pancia Memorizza i dati raccolti per analisi future
. L’“I.C.S.” Aspetto:
* Spesso ci saranno strumenti disponibili
¢ Questi non sono strumenti di “sicurezza”, ma possono essere utilizzati come tali
* Richiedi informazioni sugli strumenti di diagnostica e configurazione nell'I.C.S.
 server
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 I server OPC forniscono uno standard aperto per consentire l'interazione con diversi controllori di processo dalle applicazioni Windows. MatrikonOPC Sniffer è uno strumento gratuito che può essere utilizzato tra un client OPC e un server OPC per emettere la comunicazione avanti e indietro. È pubblicizzato come uno strumento di interoperabilità di rete per determinare i problemi di configurazione per gli integratori. Tuttavia, può fungere da utile strumento di raccolta per esaminare i dati OPC e garantire che nulla sembri dannoso o fuori dall'ordinario. Questo potrebbe non essere il tipo di dati utilizzati come indicazione iniziale © di una minaccia, ma i dati possono essere utilizzati dopo l'identificazione di una minaccia per verificare l'integrità dei sistemi OPC.
 Lo scopo di mostrare lo strumento è semplicemente quello di notare che sono disponibili strumenti di diagnostica e configurazione nell'I.C.S. che possono essere utilizzati come strumenti di sicurezza. Dipende dall’ICS, dai venditori, dall’industria, ecc. Non limitarti a chiedere
strumenti di "sicurezza": potresti non trovarne nessuno mentre troverai una serie di strumenti di "diagnostica" che puoi utilizzare per la sicurezza.
 Riferimenti: Manuale di installazione e utente: https://www.matrikonope.com/secure-login.aspx?ReturnUrl=%2 fportal%2fdownloads%2fproduct_manuals%2fOPC-
 Manuale-sniffer.pdf https://www.matrikonopc.com/products/opc-data-management/opc-sniffer.aspx
 72 © 2021 Robert M. Lee
 7 TRHAH AMD © ® OP
 UN @
 ne mm
 an nona na na no @® wT wow ww WH wy
 A Sy
 wo 8 © ww
 e~ noi Fe noi Fe FF 2S DB LD «4
 eh
 Syslog

¢ Valore:
* Raccogli i registri da singoli sistemi come eventi e avvisi
* Le classificazioni di gravità assegnate ai registri aiutano a ordinare rapidamente gli eventi
* Fonte:
* La maggior parte dei dispositivi da campo legacy non dispone di syslog; tuttavia, molti PLC/RTU moderni hanno la capacità di generare e inviare eventi syslog

*Il protocollo è definito da RFC 5424
* Metodologia: verificare che i dispositivi sul campo siano in grado di utilizzare syslog Stabilire un server e un database syslog (discusso più avanti) Stabilire avvisi per quando il personale NSM deve essere identificato sui registri Controllare regolarmente tutti i registri, soprattutto se si sospetta un incidente o una minaccia sulla rete ; L’analisi sarà discussa più avanti in questa sezione
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 Vari dispositivi hanno il syslog abilitato, come gli interruttori intelligenti Emerson DeltaV e la serie RTUS00 di ABB. L'elenco è cresciuto negli ultimi anni; abilitare syslog sui dispositivi è qualcosa per cui dovresti contattare il tuo fornitore, poiché è più che probabile che i sistemi non legacy lo dispongano (potrebbe essere disabilitato per impostazione predefinita ma può essere abilitato). Sylog aiuta a identificare gli eventi chiave del sistema sui dispositivi come accessi utente, aggiornamenti firmware o modifiche alla logica. Si tratta di una fonte di dati incredibilmente preziosa, soprattutto quando si parlerà di correlazione dei dati più avanti in questa sezione.
 PRI: Il PRI è costituito dalla Facility e dalla Severity (valore a 8 bit determinato moltiplicando la Facility per 8 e aggiungendo il valore della Severity) Intestazione: L'intestazione contiene il timestamp ISO e il nome host o l'indirizzo IP Messaggio: Informazioni aggiuntive suddivise in TAG e CONTENUTO
 Esempio di messaggio syslog:
<10> 2014-12-12T05:15:05:015Z 172.168.15.10 su—ID15 — BOM'su root' non riuscita per cybati
 Formato del messaggio syslog
 Il formato del messaggio syslog è abbastanza facile da capire dopo aver interagito alcune volte. Aiuta a identificare gli eventi sui sistemi. Se, ad esempio, sai che nessuno dovrebbe aggiornare il firmware su un PLC, puoi ricevere un avviso syslog che qualcuno sta eseguendo quell'azione. Ciò ti farebbe rapidamente sapere che qualcosa non va. Inoltre, eventi apparentemente non correlati e insignificanti, se esaminati in un contesto più ampio all’interno della rete, potrebbero rivelare modelli e attività dannose.
 Esempio di syslog: Struttura | è un messaggio a livello utente. La gravità 2 è critica. Il PRI sarebbe 8*1+2=10. Poi,
 hai il timestamp ISO, l'applicazione "su" è "super utente", l'ID è 15, BOM è il tipo di codifica e "su root" non riuscito per cyabti è il contenuto del messaggio del protocollo syslog.

© 2021 Robert M. Lee 73
¢ Valore:
* NIDS open source, gratuito e ampiamente compreso, facilmente personalizzabile
* Contiene preprocessori per Modbus TCP e DNP3 nonché molti I.C.S. firme

* Fonte:
* Scarica da: https://www.snort.organizzazione/

¢ Metodologia:
* Distribuisci nei punti critici della rete con un tocco di rete (l'inline può causare problemi)
* Ottimizza il set di regole di firma in base alle esigenze del segmento di rete su cui si trova
* Utilizza la conoscenza della rete, l'intelligence sulle minacce e le informazioni open source
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 Snort è un NIDS open source e gratuito. È ampiamente utilizzato e considerato uno dei migliori progetti open source di tutti i tempi. Può essere difficile eseguire la configurazione la prima volta, ma sono disponibili numerosi documenti online che guidano durante il processo. La cosa importante da sapere è che Snort ha preprocessori per Modbus TCP e DNP3 pur avendo numerosi I.C.S. firme integrate per impostazione predefinita. I preprocessori gli consentono di analizzare correttamente Modbus TCP e DNP3 in modo che possa generare firme basate su informazioni come codici funzione non validi. Le regole di Snort di SourceFire possono essere scaricate gratuitamente e ne vengono pubblicate di nuove regolarmente. Inoltre, attorno a Snort esiste una grande comunità in cui le persone sviluppano regole che li aiutano e le condividono in tutta la comunità.
 Se utilizzato, Snort dovrebbe essere distribuito nei punti critici della rete con un tocco o su una porta con mirroring. Fai attenzione a non metterlo in linea a meno che non sia necessario, perché i dispositivi posizionati in linea possono minacciare le operazioni se falliscono.
 Ottimizza il set di regole della tua firma in base al segmento di rete su cui è in esecuzione Snort. Considera quanto segue:

© Le reti OT avranno requisiti e comportamenti diversi rispetto alla DMZ aziendale.
© I sensori più esterni (confini di Internet, impresa e così via) saranno meno specifici.
* I sensori più interni (rete di supervisione, Fieldbus, ecc.) saranno molto più specifici.
 Dovresti utilizzare la tua conoscenza della rete in combinazione con l'intelligence sulle minacce e le informazioni open source per creare e distribuire le firme più personalizzate possibili per il tuo ambiente.
 Formato delle regole di Snort: le regole di Snort dell'intestazione sono estremamente preziose per testare idee su una rete, oltre ad essere un IDS efficace e gratuito.
 Comprendere il formato delle regole consente il loro utilizzo efficace. Le regole sono suddivise in intestazioni e opzioni. Le intestazioni contengono informazioni per identificare visualizzazioni di dati di livello superiore come NetFlow o informazioni su 5 tuple. Cosa dovrebbe fare la norma? Contro quale tipo di protocolli basati su IP? Contro quali indirizzi IP? Su quali porti?
 L'esempio è solo parte di una regola. Si noti che viene fornita anche una direzione.
 74 © 2021 Robert M. Lee
 VAI @ @ @W OM

@W
 oe em nmnrnrnnrannnnmn @® © ® @
~ wy wy wD wp ww ww wy ww wa wy ae a wa
 wp
 pi

)

'Essere
 Le regole di Snort sono strutturate in intestazioni e opzioni:
¢ Le intestazioni identificano cosa dovrebbe cercare la regola nei dati di tipo NetFlow Le intestazioni comuni sono:

¢ Le azioni determinano cosa dovrebbe fare la regola, ad esempio "avviso" "passaggio" o "abbandono"

* I protocolli indicano alla regola su quali tipi di protocollo eseguire l'attivazione (TCP/UCP/ICMP/IP)
* Le variabili designano indirizzi IP e reti singoli o multipli

* Le porte specificano a quali numeri di porta si riferisce la regola
 Esempio: avviso tep $PLANT_NETWORK 502
 Per approfondire Snort, leggi il libro Snort Intrusion Detection and Prevention Toolkit di Brian Caswell, Jay Beale e Andrew Baker.
 Formato regola Snort: Opzioni
 Le opzioni delle regole di snort aiutano ad entrare un po' di più nel pacchetto da analizzare e offrono all'analista opzioni su cosa succede quando si attiva una firma. In questo caso, vediamo la capacità di fornire agli analisti un messaggio (msg) quando la regola viene attivata, dettare il flusso (se la connessione è stata stabilita o meno), quale contenuto esisteva (se il pacchetto conteneva determinate stringhe di dati) e informazioni di accompagnamento. informazioni sotto forma di riferimento (link alle informazioni).
 L'esempio in basso è la seconda metà di una regola di esempio.
 Le opzioni della regola Snort forniscono granularità per il tipo di dati che devono essere cercati per attivare una regola e quali informazioni vengono restituite:

* Le parti all'interno delle parentesi in una regola Snort sono le opzioni. Alcune opzioni Snort sono:

* msg: le informazioni restituite a un analista quando viene attivata la regola

* flusso: indica se è stata stabilita una connessione e ad un server o client
* contenuto: cerca nel pacchetto o nella sessione contenuti specifici su cui inviare avvisi
° riferimento: dati associati alla regola, ad esempio un collegamento a un avviso

¢ sid: Lo "Snort ID" assegna alla regola un numero identificativo
 Esempio: (msg:"Accesso non autorizzato ai dispositivi di campo da un indirizzo IP non inserito nella whitelist"; flow:to_server,established; classtype:unauthorized-access; sid:1000001;)
 Sbuffa su Syslog
 La conversione degli avvisi Snort in syslog consente di centralizzare i dati su un server syslog e analizzarli con altri tipi di avvisi di rete. Ricorda che l'obiettivo di NSM è quello di poter cercare in tutta la rete e analizzare grandi quantità di diversi tipi di avvisi. Gli avvisi di snort sono utili di per sé, ma la capacità di combinarli con altre fonti di dati li rende uno strumento potente.Snort ha capacità native di convertire gli avvisi nel formato syslog, ma spesso è preferibile utilizzare un altro processo come Barnyard per farlo a fini di ottimizzazione. Questo non viene discusso in modo approfondito qui perché l'intero processo è automatizzato nella distribuzione Security Onion, che esamineremo più avanti in questa sezione.
 Riferimenti:
 Barnyard può essere trovato su http://sourceforge.net/projects/barnyard/. Buone fonti per aiutare con Snort all'output syslog includono: http://manual.snort.org/node2 1 .htm1
 https://logrhythm.com/blog/

© 2021 Robert M. Lee 75 alert tep !$DNP3_CLIENT any -> $DNP3_SERVER $DNP3_PORTS (flusso:from_client,stabilito; contenuto:"|05 64|"; profondità:2; pcre:"/[\S\s] { 10} (\x02|\x04|\x05]\x06)\x09/\\x0A|\xOF|\x12)/iAR"; msg:"SCADA_IDS: DNP3 — Richiesta di scrittura non autorizzata su un PLC"; riferimento:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:bad- sconosciuto; sid:1 111207; giro:1; priorità:1;)
 Questa è una regola delle regole IDS di Digital Bond:
¢ Identifica le richieste di scrittura non autorizzate su un PLC utilizzando il protocollo DNP3
 Esempio di regola dello sbuffo
 Questo è un esempio di regola Snort dell'I.C.S. regole. In questo esempio, possiamo vedere che le regole di Snort possono sembrare complesse ma offrire un valore reale. Se capisci il formato e riesci a infrangere la regola pezzo per pezzo, sono molto meno intimidatori. Qui, vediamo che la regola avviserà sul traffico TCP che NON proviene da sistemi $DNP3_CLIENT noti su qualsiasi porta che va nella direzione di sistemi $DNP3_SERVER noti su $DNP3_PORTS noti. Le opzioni indicano che il flusso deve essere stabilito dal client e che il contenuto deve avere il valore HEX x05 e 0x64 ad una profondità di 2 byte nel protocollo analizzato. Quindi, vediamo "pcre" per le espressioni regolari Pearl che consente la ricerca di una stringa regex di valori HEX, che potrebbe essere un tipo di attacco denial-of-service. Il messaggio restituisce quindi l'informazione "SCADA_IDS: DNP3 — Richiesta di scrittura non autorizzata a un PLC" e fornisce il riferimento al sito Web di Digital Bond. Il tipo di classe aiuta l'analista a comprendere meglio la categoria della minaccia, mentre il SID e il Rev indicano il numero ID e la revisione della regola. Infine, la priorità 1 aiuta gli analisti a vagliare gli avvisi per stabilire la priorità dei propri sforzi.
 Riferimento: DigitalBond
 76 © 2021 Robert M. Lee

@
 ree HO OH DH TH DW BW DW DW VD *W WM WP
 i] 7 Oe] o PD
 un 5)
 wow © WS WJ
 wo oOo Y@ WY WV
 Ww Ww
 Caso di studio: Regole QuickDraw

*Il progetto QuickDraw di Digital Bond include firme Snort per:
* Preprocessori SCADA per una più semplice dissezione del protocollo e scrittura delle regole
* Firme IDS DNP3
* Firme IDS EtherNet/IP
* Firme IDS Modbus TCP
* Firme di vulnerabilità

* Scarica i preprocessori e le regole qui: hitps://www.digitalbond.com/tools/quickdraw/download/
 avvisa tcp !$DNP3_CLIENT qualsiasi -> $DNP3_SERVER $DNP3_PORTS
(flusso:da_cliente,stabilito; contenuto:"|05 64|"; profondità:2; pere:"/[\S\s]{10}(\x02|\x04|\x05|\x06|\x09|\ x0A|\xOF|\x12)/iAR"; msg:"SCADA_IDS: DNP3 - Richiesta di scrittura non autorizzata su un PLC"; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:bad-unknown; sid :1111207; rev:1; priorità:1;
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Il team di DigitalBond ha ideato un progetto chiamato QuickDraw, in cui sono stati necessari una serie di I.C.S. vulnerabilità e ha creato firme Snort per esse, oltre ad alcuni preprocessori.
 Ecco un esempio di firma che cerca richieste di scrittura non autorizzate su un PLC:
 Messaggio: DNP3 — Richiesta di scrittura non autorizzata su un PLC alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER $DNP3_PORTS (flow:from_client,established; content:"|05 64|"; Depth:2; pcre:"/[\S\ s] {10} (\x02\\x04|\x05|\x06\\xO9/\xOA|\xOF|\x12)/iAR"; msg:"SCADA_IDS: DNP3 — Richiesta di scrittura non autorizzata su un PLC"; riferimento :url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:bad-unknown; sid: 1111207; rev:1; priorità: 1;
 Nello specifico, si afferma che dovrebbe essere generato un avviso se si vedono dati TCP NON provenienti da client DNP3 noti nella direzione dei server DNP3 noti su porte DNP3. I dati TCP dovrebbero essere stabiliti dal client e c'è una stringa HEX specifica da cercare (05 64). La regola spiega che questa stringa HEX dovrebbe trovarsi a 2 byte nel pacchetto esaminato. PCRE nella regola ci fa sapere che la regola utilizza le espressioni regolari Pearl per la seguente stringa nella regola. Quindi dice "msg", che sta per messaggio ed emette l'avviso dicendo SCADA_IDS: richiesta di scrittura non autorizzata DNP3 su un PLC. Il resto delle informazioni fornisce riferimenti per cercare il contesto di questo avviso.
 Il problema con questo e molti altri prodotti I.C.S. regole, è che sono eccessivamente complesse e non avvisano molto spesso. Sono utili come strumenti forensi, ma non come strumenti di rilevamento. Un rilevamento migliore sarebbe rimuovere le sezioni di contenuto e flusso e cercare invece solo le comunicazioni che NON sono client DNP3 che comunicano con server DNP3 su porte DNP3.
 Riferimento: DigitalBond

© 2021 Roberto M.Lee 77 Per ulteriori informazioni sui preprocessori DNP3 e ​​Modbus TCP, nonché su alcuni Snort I.C.S. progetti, controlla:

* Preprocessori: https://blog.snort.org/2012/01 /snort-292-scada-preprocessors.html
*Progetto Digital Bond QuickDraw: https://dale-peterson.com/digital-bond-archives/
 Puoi definire l'intera rete conosciuta in una variabile come $INTERNAL NET in $NETWORK e ricevere avvisi su qualsiasi altra cosa vista comunicare. Ciò può aiutare a identificare passivamente dispositivi precedentemente sconosciuti e avvisarli
 nuovi client che si uniscono alla rete e rilevano gli avversari che cercano host.
 Riferimento: https://www.sans.org/reading-room/whitepapers/detection/network-ids-ips-deployment-strategies-2143
 78 © 2021 Robert M. Lee

>

? eo nm oo 68 oe o
 n a ff ® ® 8D ® ®@
 id wo ww
 wS = wS

¢ Motore di rilevamento delle minacce open source per il traffico di rete

* Più “moderno” di Snort ma paragonabile in termini di funzionalità e scrittura delle regole; capace di multi-
 elaborazione del traffico gigabit SURICATA

*Il formato delle regole Suricata viene comunemente utilizzato anche nei prodotti professionali
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Suricata è un motore di rilevamento delle minacce open source in grado di eseguire funzionalità di tipo IDS/IPS/NSM nonché l'elaborazione pcap. È uno strumento potente e paragonabile a Snort, anche se spesso è preferito a Snort per le sue prestazioni e caratteristiche di scalabilità. La cosa più importante, però, è che molti prodotti professionali moderni utilizzano direttamente Suricata o accettano il suo linguaggio basato su regole. Molti degli I.C.S. i prodotti là fuori ti permetteranno di scrivere le regole di Suricata e poi loro’! convertirli nei loro motori di rilevamento. Pertanto, imparare Suricata e la sua lingua può essere un modo molto efficace per sfruttare prodotti open source o professionali per cercare minacce in I.C.S. reti.

© 2021 Robert M. Lee 79 Suricata Primer
 Le regole di Suricata seguono una struttura standard:

* Azione * Meta parole chiave
¢ Protocollo ° Riferimento
* IP di origine/destinazione * Tipo di classe
* Porte di origine/destinazione = Sapncknee TD
. ¢ Revisione delle regole

¢ Direzione » Priorità
* Opzioni regola /
 Contenuto

¢ Parole chiave ad es.
 Fluire
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Le regole di Suricata seguono una struttura piuttosto standard con cui avrai familiarità se hai mai scritto le regole di Snort. È necessario dichiarare un'Azione (ad esempio, "avviso"), il Protocollo (ad esempio, TCP o HTTP o UDP o DNS), gli indirizzi IP di origine/destinazione (ad esempio, 8.8.8.8 o $HOME_NET), Porte di origine/destinazione ( ad esempio, QUALSIASI o 443), la direzione delle comunicazioni (una direzione o bidirezionale), le opzioni/contenuto della regola (cosa stai cercando) e quindi qualsiasi meta parola chiave che desideri (ad esempio, riferimenti, ID e quanto grave questo È).
 Ovviamente c'è molta flessibilità e opzioni qui, si consiglia vivamente di leggere la documentazione di Suricata sulla scrittura delle regole poiché forniscono esempi fantastici e spiegano in modo approfondito cosa fanno tutte le parole chiave. Puoi includere qualsiasi cosa, da un semplice IOC all'espressione regolare di contenuti alla ricerca di vari byte nel traffico di rete.
 Riferimenti:
 https://suricata.readthedocs.io/en/latest/rules/intro.html#rule-options
 Tatyana Shishkova ha realizzato un fantastico video introduttivo su Suricata che vale la pena rivedere: https://www.youtube.com/watch?v=tvoqFBVSShA&ab_channel=OISF-Suricata
 80 © 2021 Robert M. Lee
 oO @ &@ & @M
 oem @
 Di @ @ &@

)
 NO
 n@® ® ® wy
 noi noi Ww Ww noi
 oe wow &§ F&F FTF WwW &

&
 Esempio Suricata
 alert icmp qualsiasi qualsiasi -> qualsiasi qualsiasi (msg:"Richiesta query sullo stato di SolarWinds"; itype:8; contenuto:"Query sullo stato di SolarWinds"; profondità:23; soglia: limite tipo, traccia per_src, conteggio 1, secondi 86400; priorità: 0; sid:9003452; rev:1;)
 Azione = Avviso "Eco")
 Protocollo = ICMP componente 5 Cosa stiamo facendo —_ IP di origine/destinazione = Qualsiasi/Qualsiasi carico utile molti anni dalle porte di origine/destinazione di progettazione = Qualsiasi/Qualsiasi Soglia = frequenza di avviso
 Direzione = -> (dall'origine alla destinazione) Priorità = 0 (quanto è grave?)
 Opzioni regola SID=ID _
* Msg = Cosa avvisare Rev = Revisione 1
° Itype = Numero di tipo ICMP specifico (8
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 Questo è un esempio del team Dragos in cui hanno scritto un rilevamento focalizzato su SolarWinds. È una regola semplice per mostrare come si forma la struttura di una regola. È solo un'opzione: esistono molti modi per utilizzare un'ampia gamma di parole chiave e contenuti.
 Qui vediamo che inizia con l’azione di “avviso” che significa ‘! generare un avviso quando le condizioni sono soddisfatte. Quindi richiede il protocollo ICMP con QUALSIASI IP di origine, seguito da QUALSIASI porta di origine che comunica nella direzione della destinazione su QUALSIASI IP di destinazione e QUALSIASI porta di destinazione. Poi vediamo le opzioni. Inizia con il messaggio su cosa includere nell'avviso per l'utente. L'itype è un'opzione per annotare quale numero di tipo ICMP specifico; 8 è per Eco. Quindi il tag content viene utilizzato per designare un contenuto con distinzione tra maiuscole e minuscole (puoi dichiarare che non dovrebbe fare distinzione tra maiuscole e minuscole se lo desideri), in questo caso "SolarWinds Status Query" apparirà da qualche parte nel contenuto dei pacchetti analizzati.La profondità indica quanti byte dopo l'inizio del payload da ispezionare dovrebbero essere trovati i contenuti. La soglia è utile per assicurarsi di non generare troppi avvisi, qui dice limite per fonte in modo che ogni query di origine generi solo | avvisa ogni 86.400 secondi prima di riemettere un avviso. Ha priorità 0
(solo metadati sulla gravità) e ha un ID Suricata e si dichiara Revisione 1.
 Anche se hai molte opzioni nelle regole di Suricata e puoi crearle in una moltitudine di modi diversi, devi avere la prima parte (azione/protocollo/src/dst/ip/ports) e dovrai assegnare un ID.

© 2021 Robert M. Lee 81 Suricata Semplice controllo 1OC
 alert TCP qualsiasi qualsiasi <-> 41.22.24.102 qualsiasi (msg:“Ricerca IP"; sid:9003452; rev:1;)

+ Le regole Suricata sono disponibili in molte forme e possono essere scritte per coprire tutti e quattro i tipi di rilevamento

* I controlli IOC possono essere semplici come cercare un IP, un dominio, un nome file, un'intestazione o un'altra forma di elemento osservabile nel traffico di rete
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Come per tutta la creazione di regole, assicurati di non renderla più complessa delle tue esigenze. Il punto non è la lingua o tutte le opzioni ma soddisfare la domanda che hai. Nell'esempio di questa diapositiva vedi un semplice controllo per un indirizzo IP sospetto. Manca il messaggio/contesto ma la regola funziona bene.
 82 © 2021 Robert M. Lee
 oe mem Oe 7 DW DO OO OW OW GW OO GW MM

™

> noi wwe &
 noi Ww Ww

* Valore:
* Framework di monitoraggio della rete open source e gratuito basato su Unix
*Non solo un NIDS; è un linguaggio di scripting flessibile e adattabile
* Sistema di rilevamento, analizzatore di flusso, preprocessori, funzionalità forensi e altro ancora
° Fonte:
*https://www.zeek.org/
* Richiede una piattaforma Unix
* Metodologia:
*L'utilizzo principale di Zeek è spesso come IDS e quindi è possibile completare l'analisi successiva
 Il framework di intelligence e il framework di firma all'interno di Zeek possono elaborare IOC e avvisare in base al traffico corrispondente
 Poiché Zeek è più un linguaggio di scripting che un IDS standard, è più uno strumento avanzato
 Il sito Web Zeek contiene documentazione ed esercitazioni per iniziare
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Zeek, precedentemente chiamato Bro, è considerato uno degli strumenti centrali per NSM perché può servire a molteplici scopi. Zeek è un framework di monitoraggio della rete con la capacità di raccogliere dati completi sul contenuto (acquisizioni di pacchetti), rilevare minacce utilizzando firme altamente personalizzabili per i suoi IDS e consentire alle persone di analizzare avvisi e dati attraverso un linguaggio adattabile e programmabile. Coloro che praticano l'NSM dovrebbero dedicare del tempo a familiarizzare con Zeek, anche se all'inizio può essere un po' scoraggiante. Sebbene sia più complesso di Snort, è circondato da una vasta comunità con una varietà di manuali utente e tutorial video.
 Zeek può essere installato ed eseguito da qualsiasi piattaforma basata su Unix. Sebbene il suo utilizzo principale sia spesso visto come un IDS, dispone anche di potenti funzionalità di analisi del flusso e sono disponibili framework di intelligence e framework di firma per l'elaborazione e l'utilizzo rapidi degli IOC.
 Nel laboratorio di questo corso, ci concentreremo sull'uso di Snort, perché è uno strumento valido sia per principianti che per esperti, ma se intendi eseguire qualsiasi quantità di NSM nel tuo ambiente per un lungo periodo di tempo, vale la pena controllare fuori Zeek.
 Riferimento: Moduli Modbus: https://docs.zeek.org/en/latest/scripts/base/protocols/modbus/index.html https://tcipg.org/sites/default/files/papers/2012_Q2_IDSforDNP3-1. PDF
 Zeek contro Snort
 Non è possibile trattare Zeek in modo approfondito in questo corso perché è un linguaggio di scripting e richiederebbe di dedicare molto tempo a capire come scrivere nello script nel linguaggio prima di implementarlo. Sono disponibili numerosi corsi di formazione, tutorial e informazioni specifici di Zeek sul sito Web principale di Zeek. La cosa importante da capire per questa lezione è che Snort è uno strumento eccezionale e veloce da utilizzare per impostare firme che corrispondano agli accessi non autorizzati, utilizzare dati di tipo IOC provenienti dall'intelligence sulle minacce o per testare rapidamente le idee che hai sui dati di rete dannosi. Zeek è lo strumento di monitoraggio della sicurezza della rete più potente e vale la pena comprenderlo. È in grado di decodificare un numero di I.C.S. protocolli e analizzarli con un'ispezione approfondita dei pacchetti. Come Snort, Bro può essere configurato per archiviare i propri avvisi in formato syslog o inviarli a una posizione centralizzata.

© 2021 Robert M. Lee 83 Snort è un ottimo strumento per impostare firme di corrispondenza dei byte e avvisare su attività come accessi a sistemi o porte a cui non dovrebbe essere consentito. Il motore di scripting di Zeek gli consente di andare oltre la corrispondenza dei byte e di approfondire le informazioni contestuali e le politiche di sicurezza.Zeek può utilizzare il contesto per evitare molti falsi positivi:

* Snort può avere una regola per rilevare i byte nei dati che corrispondono a una scrittura non autorizzata Modbus TCP
* Zeck può analizzare l'interazione per vedere che il client è effettivamente un client DNP3 e ​​non vulnerabile a una scrittura non autorizzata Modbus TCP
 Sia Snort che Zeek sono preziosi per un'organizzazione:
* Per regole rapide, in particolare quelle che incorporano idee come l'utilizzo del CIO durante la risposta a un incidente
 scenario, Snort può essere molto prezioso
+ Per l'analisi approfondita e la comprensione degli eventi sulla rete, nonché per la decodifica dei pacchetti, Zeek è la soluzione
 strumento NSM più potente Riferimenti:
*https://www.zeek.org
« CRD 84 © 2021 Robert M. Lee
 eo @ @ @ HW BW W PM
 ane oa h® Wh
 mn www a a a
 eo 8 Ww Ww
 ooh ahi e

)
 ww PB DP PP
 rt
 ALCE

* ELK è la combinazione di Elasticsearch, Logstash e Kibana
 Potente repository di log con possibilità di ruotare i dati per identificare anomalie, eventi di sicurezza, ecc.
 Altamente scalabile e utilizzato in numerosi settori IT e OT
 er To significa un
 Open source con pagamento opzionale
 servizi gestiti | a t i a 19988 1964
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 ELK è una combinazione di tre strumenti: Elasticsearch, Logstash e Kibana. I tre strumenti si combinano insieme per creare uno strumento estremamente versatile noto come ELK. ELK è più o meno un fork di Splunk gestito dalla comunità open source. Vale la pena menzionarlo in questo corso, anche se non lo useremo. Security Onion è più spesso utilizzata in I.C.S. ambienti (menzionati nella diapositiva successiva). Tuttavia, se stai configurando un ambiente in cui il personale IT e OT possa lavorare tra IT e I.C.S., è preferibile guardare ELK.
 Riferimento: https://www.elastic.co/products

© 2021 Robert M. Lee 85 Rilevamento di anomalie
 O
 Dati storici
 Linee di base “
 Identificare cambiamenti e stranezze
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Gran parte di ciò che viene cercato, soprattutto con i feed delle minacce, si basa sulle firme. Esistono molte firme eccezionali e sono utili, ancora più utili sono le firme che corrispondono al tuo ambiente. Ad esempio, se OPC non è nel tuo ambiente, è bene affermare che se quella porta viene mai vista in uso, potrebbe rappresentare un problema.
 Tuttavia, un altro modo efficace per rilevare le minacce in un sistema I.C.S. è attraverso anomalie. Data la natura più statica di un I.C.S., ciò può essere estremamente efficace con dati di flusso, dati storici/statistici e linee di base.
 Linee di base
 Uno dei modi migliori per identificare anomalie in un sistema I.C.S. è quello di basare l'ambiente. Qualsiasi aspetto della "lista bianca" sarà sempre migliore nel trovare i problemi rispetto a un approccio di "lista nera". La difficoltà è che le whitelist sono difficili da mantenere. Tuttavia, in un I.C.S. ambiente, è possibile applicare e mantenere una linea di base almeno per le comunicazioni di rete. Ancora più utilizzabile, tuttavia, è una linea di base di natura passiva. Un esempio di linea di base passiva è quella che rileva un problema e ti avvisa ma non accetta un blocco attivo, che potrebbe interrompere le comunicazioni critiche. Ciò conferisce potere al difensore senza ostacolare le operazioni.
 86 © 2021 Robert M. Lee
 ee) (>
 Noi,
 UN
—~

) ww ww ww Ww =

@

° I dati di flusso sono informazioni sulla sessione
° 5 Tupla:

*IP di origine

¢ IP di destinazione

¢ Porta di origine

¢ Porta di destinazione
*Protocollo

* Rileva anomalie nei dati di flusso raccolti utilizzando strumenti per risparmiare tempo agli analisti
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 In precedenza in questa sezione abbiamo discusso i dati di flusso/sessione come un tipo di dati NSM. IPFIX è stato un esempio di questi dati e può essere utile raccoglierli insieme alle informazioni basate su NetFlow. Con questi dati possiamo iniziare a rilevare anomalie. È facile dire che dovremmo essere in grado di rilevare HMI | parlare con l'HMI 1 o con altre anomalie nel tuo ambiente, ma farlo su larga scala e nel tempo può essere difficile. Sono disponibili numerosi strumenti che supportano queste informazioni. Due strumenti open source che possono essere utilizzati (e vengono utilizzati insieme) sono SiLK e FlowBAT, che esamineremo nelle prossime diapositive.

© 2021 Robert M. Lee 87 eane .
 Dati nel tempo
 Picchi di larghezza di banda Utilizzo del protocollo Numero di connessioni Durata della sessione
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Un modo semplice per pensare ai dati storici è pensarli nel contesto dei dati nel tempo. Che tipo di dati, ad alto livello e nel tempo, potresti identificare rapidamente e quali modifiche potresti identificare? Di solito si tratta di cose come i picchi di larghezza di banda, le volte in cui viene utilizzato un protocollo o quanti sistemi utilizzano quel protocollo, il numero di connessioni e la durata delle sessioni. Ciò è utile anche nel contesto di orari e momenti diversi della giornata. Potresti avere più connessioni nell'I.C.S. alle 14:00 di giovedì che alle 3 di domenica. Quanti dispositivi utilizzano Modbus TCP? Se vedi un picco in questo, potrebbe anche essere strano. Questi tipi di set di dati storici sono utili.
 88 © 2021 Roberto M.Lee
 ohm
 Ooh cL
 ao 8 DD @D ®
 n?, nove ananwn nan a
 J

~
 oS ww ww WwW noi Ww Ww Ww
 wwe ww & w&
 Caso di studio: gli interruttori ottengono punti
 La ricercatrice Eireann Leverett ha presentato nel 2014 le vulnerabilità negli switch di rete industriali
 Lui, Colin Cassidy e Matt Erasmus hanno aggiornato la presentazione più tardi quell'anno con più vulnerabilità
 Nel 2015, Eireann e Colin hanno incluso Robert M. Lee nella serie di presentazioni
 per Black Hat e DEF CON
 per mostrare a NSM l'identificazione di queste vulnerabilità di martedì 10 La ricerca sulle vulnerabilità 6-3 è estremamente preziosa ‘ Zn
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Al 315* Chaos Computer Congress di Amburgo, Germania, nel 2014, Eireann Leverett ha presentato l'argomento
"Switches get Stitches" in cui ha valutato gli switch di rete industriali di numerosi fornitori come Siemens Scalance X200 versione 4.3, GE Multilink ML800 versione 4.2, GarrettCom e altri. Ha poi sviluppato questa presentazione per 44CON includendo i ricercatori Colin Cassidy e Matt Erasmo.
 Per Black Hat e DEF CON 2015, Eireann e Colin hanno scoperto nuove vulnerabilità e hanno coinvolto Robert M. Lee nel discorso per parlare dal punto di vista del difensore. La ricerca di Eireann e Colin è stata/è vitale per scoprire le vulnerabilità di questi switch industriali. Si tratta di vulnerabilità avanzate e difficili da scoprire. Molti sono stati scoperti alla ricerca di meccanismi di sicurezza di base che avrebbero dovuto esistere. Lo scopo non era quello di evidenziare un singolo fornitore, ma piuttosto di mostrare ai proprietari e agli operatori degli asset le vulnerabilità di cui molti avversari sarebbero già a conoscenza. Robert è stato coinvolto nel discorso per mostrare ai proprietari e agli operatori delle risorse come eseguire la NSM per identificare quando queste vulnerabilità sono state sfruttate.
 Blackhat Talk: https://www.youtube.com/watch?v=urj KkQaspHQ

© 2021 Robert M..Lee 89 Esempio di grafico I/O da Switches Get Stitches
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Eireann ha apportato una modifica al firmware di uno switch di rete industriale su una rete, in base a una delle vulnerabilità del firmware. Qui, Robert M. Lee ha preso i dati storici della rete su cui era acceso lo switch sotto forma di grafico I/O da Wireshark. Riesci a individuare la stranezza? Si verifica circa 320 secondi in questo campione di acquisizione.
 Alcune delle vulnerabilità mostrate ai difensori nella serie di presentazioni Switches get Stitches evidenziano backdoor non documentate, crittografia debole, chiavi RSA incorporate e metodi per modificare il firmware su uno switch. Tutte queste cose fanno sì che l’avversario possa fare tutto ciò che vuole sulla rete. Per la maggior parte di questi problemi non sono state rilasciate patch e molte vulnerabilità non verranno mai risolte. Pertanto, è importante essere in grado almeno di identificare il problema. Poi potranno aver luogo le pratiche adeguate. Ad esempio, sarebbe necessaria una risposta agli incidenti in caso di modifica del firmware in qualsiasi dispositivo, in particolare negli switch di rete.
 90 © 2021 Robert M. Lee

(p>
 ao fr @f @& & @ @& @& @ © Di @ OW Di @O @ Oo DW OG WH Ww wW et
 2

+

|
 w ww ww ww

= wwfp
 Operazioni di sicurezza consigliate
 Sfrutta l'I.C.S. strumenti specifici per indagare sui rilevamenti (necessità di minaccia e contesto ambientale)
 Aumentato | I.C.S.: cs Specific ee Rilevamento Tariffa Tera
 I.C.S. Operazioni specifiche
 Il livello 2 dovrebbe comprendere l'impatto sulla caccia quando non una migliore valutazione
 7| Livello di rilevamento Mas Tier 3 specifico per TE?
 L'IT segue il normale percorso di triage e flussi di lavoro
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Esistono molti modi per eseguire operazioni di sicurezza e tutti richiedono che tu sia adattato alla missione che stai svolgendo e alle risorse di cui disponi. Tuttavia, in uno stato ideale, ecco una panoramica di come è possibile avere un SOC OT dedicato
(che è semplicemente persone/processi/tecnologia – non significa nemmeno un organigramma separato) con la giusta attenzione prestata a I.C.S. con operazioni integrate con l'IT.
 Dovresti avere i vari avvisi/registri aziendali/IT e I.C.S. avvisi/registri in arrivo nel SIEM aziendale. Dovresti sfruttare I.C.S. prodotti specifici che comprendono I.C.S. comunicazioni, minacce, ecc. per l'I.C.S. pezzo. Nell'Enterprise SIEM la tua normale funzione Tier 1, senza I.C.S. competenze specifiche, esegue il lavoro di triage/escalation.
 Quando gli avvisi vengono inoltrati al "Livello 2", se sono aziendali/IT dovrebbero seguire il normale flusso di lavoro, il che probabilmente equivale al Livello 2 che esegue indagini e al Livello 3 che esegue un lavoro più specializzato di risposta agli incidenti, analisi forense o malware.
 Quando gli avvisi intensificati provengono dall'I.C.S. rete dovrebbe andare a un I.C.S. dedicato e formato. funzione specifica del Tier 2. Quella persona o squadra dovrebbe quindi tornare all’interno dell’I.C.S. strumenti di sicurezza per ottenere un contesto ambientale e trarre vantaggio dalla comprensione specifica dell’I.C.S. fornita da tali strumenti. È particolarmente utile se è lo stesso prodotto a eseguire il rilevamento e ha la capacità di eseguire analisi di log/rete nello strumento.
 Da lì, se l’I.C.S.La funzione di livello 2 valuta che esista un rischio reale, passerebbe a una funzione di livello 3. La funzione di Livello 3 non sarebbe un team di sicurezza specializzato e centralizzato ma piuttosto un sostenitore/sostenitore/collegamento presso lo stabilimento o il lato operativo dell'azienda (ad esempio, qualcuno al Centro di controllo, qualcuno alla Raffineria, qualcuno allo stabilimento di produzione, ecc. .). Quel personale capirà quell'impianto specifico e il potenziale impatto. Possono anche dedurre rapidamente se vale la pena dedicare del tempo a indagare ulteriormente su qualcosa. Non è necessario che siano persone specifiche per il cyber, ma persone che comprendano il linguaggio cyber; ovvero, hanno interagito con I.C.S. gente in anticipo e capire come ridurre l'impatto.
 Il sistema I.C.S. analisti specifici non dovrebbero valutare tanti avvisi quanto quelli specifici dell'IT; I.C.S. la sicurezza è più alta
 impatto, frequenza più bassa. Ciò significa che il personale dovrebbe costruire rapporti con il personale dell'impianto e cacciare quando non è in fase di triaging, il che dovrebbe costituire la maggior parte dei loro sforzi.

© 2021 Robert M. Lee 91 Approcci di rilevamento consigliati

* Identificare gli "parlatori" più alti e più bassi della rete:
« Quali indirizzi IP e porte vengono utilizzati di più e quali meno Identifica i maggiori utenti di larghezza di banda:
* Identifica l'infrastruttura che invia o riceve i file più grandi Identifica le comunicazioni crittografate:
* Il malware utilizza spesso C2 crittografato; identificare e assicurarsi che sia legittimo Identificare le risorse critiche e il traffico normalizzato:

* Identificare PLC sensibili, switch e router principali, HMI, ecc.

* Sull'infrastruttura identificata, capire almeno come appare la normalità. Cercare prima le minacce note e poi le anomalie

« Gli aggiornamenti del firmware dovrebbero avvenire nei periodi di non manutenzione

¢ Ci sono picchi nell'utilizzo della larghezza di banda sulla rete, attraverso RF/Vsat/ecc. Identificare i cambiamenti critici attraverso I.C.S. analisi del protocollo

* Modifiche dell'orologio GPS, caricamento/download della logica, arresti forzati, ecc. Identificazione dell'esfiltrazione

° Esfiltrazione DNS, POST HTTP, comandi FTP PUT, ete.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Alcune analisi utili per iniziare ruotano attorno a cose che non si basano su molta conoscenza della rete. Ad esempio, quali indirizzi IP e porte sono i più attivi sulla rete? Assicurati che siano tutte comunicazioni legittime. Ci sono file di grandi dimensioni che vengono costantemente trasferiti agli indirizzi IP? Esaminateli attentamente. Se sulla rete sono presenti collegamenti crittografati, assicurati che siano crittografati; il malware non invia necessariamente tutto il traffico fuori dalla rete: i siti di rilascio sono comuni (raccolgono l'esfiltrazione in una posizione prima di inviarlo fuori dalla rete). Se disponi di un indirizzo IP che rientra in tutte e tre queste categorie (top talker, larghezza di banda più elevata e crittografato), è probabile che sia dannoso. Controlla e assicurati. Inoltre, impara a conoscere la tua infrastruttura e comprendi quando gli eventi dovrebbero e non dovrebbero verificarsi sulla rete, come aggiornamenti del firmware e patch.
 92 © 2021 Robert M. Lee

>
 oppure @ @ @ @ 8 8B BB @ ® @®
 oo @@
 id
 nmOo

”ul mn w

‘
 ew ww ww w

+ +

~
 w
 sì ap
 ag con&

* Ina Terminal richiama lo strumento con “zeek” e poi —C per ignorare checksum non validi e —r per rileggere un file pcap
* Zeek-cut è un'opzione comune anche sullo strumento per leggere i log ASCII Zeek per colonne/campi di dati specifici
+ Esempio per leggere il conn.log e identificare nomi host/domini tra due indirizzi IP (origine e risponditore): cat conn.log | zeek-cut id.orig_h id.resp_h host
 Una volta letto un pcap in Zeek, creerà automaticamente vari file di registro che potrai quindi analizzare; inoltre, puoi eseguire qualsiasi ricerca in grep per cercare qualcosa di specifico
 conn.log

* Connessioni tra due risorse
* Può scegliere tipi specifici di comunicazione come dns.log solo per le comunicazioni DNS tra risorse
 files.log Tutti i file trasferiti attraverso il traffico di rete
* Può scegliere protocolli specifici come http_files.log o smb_files.log per tutti i file trasferiti tramite SMB
 rdp.log

* Esaminare le comunicazioni RDP attraverso la rete
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Zeek è un potente strumento di scripting di rete che ti consentirà di analizzare rapidamente i pcap e i relativi dati (simile al syslog per il traffico di rete). Ecco alcuni comandi che potrebbero essere utili nei prossimi lab. I laboratori utilizzeranno Zeek solo una volta, ma puoi facoltativamente continuare a utilizzare Zeek durante tutti i laboratori in questa sezione.

© 2021 Robert M. Lee 93 Lab 3.2 Indagine sulle intrusioni di Fase 2
 Raffineria di Calistoga:
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 
 94 © 2021 Robert M. Lee

| | |

@
 on7nnnnnm ® ® ae we wh
 Sistema operativo @© Ww @& WwW w w&
 Ww
 Obiettivi dello scenario del corso (4)

* Raffineria di Calistoga

* Qual è il nome del file di progetto dannoso?
 BurnerManagementInfected.ACD
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Roberto M.Obiettivi dello scenario del corso Lee 95 (5)
 Cosa ha fatto l'avversario al PLC di sicurezza?
 Qual è la routine dannosa nella logica e cosa fa? Qual è la causa principale dell'attacco?
 L’incidente è collegato all’incidente di C3PO?

*C3PO:

* Qual è l'azione dannosa sull'HMI?
* Quale registro è stato manipolato con quale valore?
* Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 
 96 © 2021 Robert M. Lee
 nnn © © © f oF OW GO GH GO GS OC GW MP
 M
 a o rs | oe ww ww FF FE Wwieweweweesewe ww
 aw
 UN
 UN
 I.C.S. Analisi NSM: quando evitare l'IR
 La risposta agli incidenti potrebbe non essere necessaria se:
 Era una rete "Era una violazione della politica di configurazione snespentel maleue | senza IR
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Con i dati raccolti adeguati e la capacità di rilevare una minaccia, spetta alla fase di Analisi determinare se la minaccia è reale e se vale la pena avviare un processo di risposta agli incidenti, o se la minaccia può essere mitigata e difesa rapidamente senza alcun impatto sull’operatività.
 Senza dubbio avrai avvisi sulla tua rete che sembrano dannosi ma non lo sono. Questi vengono identificati come falsi positivi e richiedono la maggior parte del tempo in NSM, soprattutto quando i sensori non sono sintonizzati correttamente. Tuttavia, si verificheranno una serie di violazioni delle policy, problemi di configurazione o anche minacce isolate che è possibile analizzare e determinare che in realtà non è necessario un processo di risposta agli incidenti. Questi problemi possono essere risolti rapidamente senza consumare tempo e risorse preziosi.

© 2021 Robert M. Lee 97 I.C.S. Analisi NSM: cosa non dovresti fare
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 La fase di analisi non è destinata a consentire al personale di prendere decisioni sull'interruzione delle operazioni, sulla messa offline dei sistemi o sull'esecuzione di analisi approfondite sulle minacce. Questi sono tutti passaggi trattati nelle Sezioni 3 e 4. La fase di analisi riguarda la convalida delle minacce rilevate in modo che sia possibile prendere una decisione sul passaggio successivo. Nella fase di rilevamento, agli analisti viene chiesto di avere una visione olistica della rete per rilevare le minacce su più tipi di sistemi e avvisi. In Analisi, il tuo compito è andare oltre i sistemi per determinare se e come la minaccia dovrebbe essere elevata per la gestione.
 98 © 2021 Robert M. Lee
 ce@@@©O&O GO PM
 7 © @ @
 oe®©®
 a @® @® rn rn a!
 ww w ww WD W
 noi Ww &w Ww &w Ww Ww
 wW
 I.C.S. Analisi NSM: cosa può fare
 Modifica raccolta e | Da utilizzare per supportare i creatori di tattiche di rilevamento IR sulla necessità degli sforzi dei team IR o TEM si i Bee | pipì } e
 Le aisa tice Nosdew SOUTER Ravens HaMisuieren a aotar tas See facilis
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 A volte il rilevamento e l'analisi si sovrappongono. Ad esempio, forse vedere un picco di I/O su un segmento critico è sufficiente per dire che qualcuno dovrebbe indagare con la mentalità e la metodologia di risposta agli incidenti. Realisticamente, però, ciò è dovuto al fatto che il rilevamento e l’analisi avvengono contemporaneamente. È importante riflettere attentamente sull'analisi e formulare ipotesi contrastanti prima di avviare la risposta agli incidenti se si desidera evitare falsi positivi. Questo non deve essere un processo lento, ma renderlo una parte integrante del processo.
 L'analisi può aiutare a promuovere tattiche di raccolta e rilevamento migliori. Forse è necessario un nuovo tocco per poter raccogliere traffico in un segmento in cui non hai visibilità attuale. Forse ci sono state delle anomalie in fase di rilevamento
 avrei dovuto vedere anche lui.
 I tipi comuni di analisi di cui parleremo nel resto di questa sezione sono l'analisi dei pacchetti, del traffico, dei file e della sequenza temporale.

© 2021 Robert M. Lee 99 Metodologia comune di Wireshark
 una fase di rilevamento genera un avviso
 Esamina il traffico catturato in Wireshark
 Inizia con il livello alto 5-Tuple Ga. Identifica valori anomali e anomalie
 a B Cercare anomalie nel protocollo*
 I.C.S.S515 | I.C.S. Visibilità, rilevamento e risposta
 La prima volta che guardi il traffico sulla tua rete in Wireshark, avrai un momento di panico. Imparare nuovi protocolli, comprendere le regole di colorazione e acquisire familiarità con il normale traffico basato su TCP come HTTP
 Le richieste GET sono tutti prerequisiti per eseguire l'analisi in Wireshark.
 È comune vedere un singolo dispositivo utilizzato come punto cardine per gli avversari. A volte è difficile "tornare indietro nel tempo". Cioè, non hai la cattura dei pacchetti ma, se venisse fatto qualcosa, è improbabile che un avversario conduca un processo completo di pulizia e antiforense. Il movimento laterale è comune, ma sono comuni anche i server C2 interni, inclusi i punti stadiati in cui il traffico SSL può essere utilizzato per espellere i dati dalla rete.
 Wireshark contiene una serie di funzionalità come Follow TCP Stream e Follow UDP Stream per identificare i pacchetti di tuo interesse e tutti quelli che si trovano nella stessa sessione.Inoltre, è possibile impostare regole di colorazione e opzioni di filtro per filtrare rapidamente ciò che gli analisti del traffico non vogliono vedere o attirare la loro attenzione su modelli o problemi insoliti.
 Come metodologia generale, non utilizzare Wireshark solo per esaminare grandi quantità di dati alla ricerca del male. Lascia che la fase di rilevamento di NSM si occupi di generare un avviso, tramite firme o anomalie. Una volta rilevato qualcosa, utilizza Wireshark sul traffico già acquisito oppure filtra in base all'IP dell'avviso e acquisisci il traffico in tempo reale e inizia con l'esame dei dati di alto livello. Utilizza dati a 5 tuple (IP di origine/destinazione, porta di origine/destinazione e protocollo) per esaminare cose che potrebbero essere fuori posto. Ad esempio, HMI | normalmente parli con l'HMI 2? Il Modbus TCP viene solitamente visto attraversare la rete aziendale? Quali dispositivi utilizzano solitamente l'OPC?
 È anche possibile cercare manipolazioni del protocollo. È possibile realizzare nuovi dissettori Wireshark con il supporto dei fornitori per aiutarli a ricercarli. C'è un asterisco accanto al passaggio "Ricerca anomalie del protocollo" perché finora non c'è mai stato un avversario che abbia eseguito l'I.C.S. manipolazioni del protocollo in un'intrusione nella vita reale. Sono state effettuate ricerche, ma nessun avversario ne ha avuto bisogno. L'utilizzo di comandi, funzioni e accesso alla rete nativi è stato sufficiente. Tuttavia, dobbiamo essere in grado di esaminare i pacchetti per individuare eventuali minacce future e di comprendere, in modo più realistico, i comandi accurati utilizzati in modo inappropriato. Quanti comandi di scrittura dovrebbe eseguire Modbus TCP in un determinato segmento di rete?
 100 © 2021 Robert M. Lee
 ciao

@® ri @ @ > @ @
 Me
 su @®m®

(>
 7h OM OM®®
> Vv Noi WwW Ww Ww wh eH Hy ww wy
 ww w

»

"@R
 UN

)
 NetworkMiner
 Valore:

* Analizza rapidamente i pacchetti acquisiti per rilevare il sistema operativo
 tipi, dati di sessione, file di esportazione e determinazione dei nomi host Fonte:

* http://sourceforge.net/projects/networkmi Tè
 nero/
« Ha una versione gratuita e una a pagamento Metodologia:

* Carica un pacchetto acquisito in NetworkMiner tramite la GUI o la CLI I file che non dovrebbero attraversare la rete devono essere estratti I metadati e il contesto relativo al tipo di file e al suo trasferimento possono essere sufficienti per avviare una procedura di risposta all'incidente Passare i file sospetti a Squadre di triage delle minacce
 IO
[Eset rete adenterintbeit—
| [Parametri (1243) [Parole chiave [Ceare [Anomaie)
| Ospiti (119) | Cornici (15) Carte (60) immagini | Messaggi | Credenziale (6) | Sedute (69) | DNS7)
 Estensione del protocollo D.pot
 TOPS Tor 1115 Ter 113 Ter 1120 Ter 125 TCP 1126 Ter nae TCP 1116 TOP 1128 indice. TeP 1128 legare 9E, TEP 38 ‘ legare 80. Ter 1131 indecht. TeP 1131 cattivo 67. ep 1132 rilegatura 80,
 28 legare 23
 io io
 PULTE ERE 3
 Utilizzo del buffer di registrazione live |
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 NetworkMiner è un modo rapido per elaborare l'acquisizione di pacchetti ed esportare file, dati di sessione e altre informazioni preziose come chiavi e credenziali SSL osservate. Ciò è particolarmente utile dopo aver rilevato una minaccia sulla rete. Molti hacker utilizzano l'autenticazione durante l'esfiltrazione nonché servizi crittografati per inviare dati fuori dalla rete in modo privato e senza motivo di allarme. NetworkMiner può cercare attraverso le acquisizioni dei pacchetti le credenziali che gli avversari potrebbero aver utilizzato. Fai attenzione a rispettare sempre la privacy degli altri sulla rete e a non abusare di altre credenziali che potresti trovare.

© 2021 Robert M. Lee
 101 Determinazione della risposta all'incidente
 È necessario determinare cosa si qualifica come un problema che richiede una risposta all'incidente
 eseguita molto prima che si verifichi un incidente
* La pianificazione è la chiave dell'IR
 NSM alla fine porta alla determinazione se un problema debba essere intensificato, ma non è il personale NSM che dovrebbe dichiarare un incidente:

* Il management probabilmente ti ascolterà se hai stabilito un rapporto di fiducia, ma alla fine è una loro chiamata
 L'analisi abbinata ai ruoli, alle responsabilità e ai piani compresi in un'organizzazione è spesso la differenza tra operazioni di risposta agli incidenti fallite e riuscite
 Dove nell'I.C.S. Cyber ​​Kill Chain è il tuo avversario?
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 e.a
 e.a
 eo 8 ® ® 2 Ym @
 Non è compito di coloro che eseguono il NSM dichiarare un incidente a meno che non venga loro specificatamente conferita tale autorità. Il loro ruolo è invece informare il team più ampio e il management sulle scoperte convalidate e analizzate che dovrebbero essere esaminate con un processo di risposta agli incidenti.
 Per la gestione:

* Consenti al tuo personale la formazione tecnica, la comprensione e l'autorità necessarie per eseguire l'intero ciclo NSM.

* Ascolta i tuoi analisti, ma in definitiva la decisione di impegnarsi nell'IR è una decisione a livello gestionale basata sulle esigenze operative.

* Si verificheranno minacce; comprendere la rete e il panorama delle minacce può aiutare a determinare le soglie di risposta.
 Per gli analisti:
* Essere espliciti riguardo ai bisogni e ai requisiti per completare un ciclo completo di NSM; il credito parziale non conta.

¢ Gli analisti devono fornire analisi basate sull'evidenza e sulla migliore comprensione in quel momento.* Quanto più preparato e informato è il team IR, tanto più sicure saranno le operazioni di rete e le persone.
 102 © 2021 Robert M. Lee
 oOo? @@
 on7noeom ® & Ww Ww Ww WV noi noi ee noi noi
 ww ww fw

®w & Ww ww Ww ww
 e.a
 Dove nell'I.C.S. La Cyber ​​Kill Chain è i tuoi avversari
 FASE I - Passaggi osservabili dell'intrusione
 Ricognizione ¢

+ Analizzando il -?
“punto” dove @® l'avversario Ronee “ sembra essere | aiuta Exploit a determinare le considerazioni sulla risposta agli incidenti e dove monitorare
 Collegamenti di rete esterni
(Bacini o Rete di Impianti)
 Applicazioni DMZ |

“Elementi di controllo di vigilanza”.
(Rete, applicazioni, server) |
 Installa/Modifica

| io
| io
 FASE 2 – I.C.S. Sviluppo dell'attacco
 Era il test della Fase 1
 dati utili per la Fase 2?
 Consegna Installa/Modifica
 1 Sensori e Attuatori
 Eseguire I.C.S. attacco
 LEOOO-DOOOH)
 Mentre esegui NSM, cerca di capire sempre dove si trova il tuo avversario. È qui che entra in gioco l '"analisi" di ciò che hai rilevato da una posizione generale. Ad esempio, il tuo avversario sta semplicemente sfruttando i sistemi in questo momento? Se è così, è improbabile che ci siano azioni nell'ambiente da rilevare. Identificare e mitigare ciò può ridurre tempo e fatica. Tuttavia, se hai già visto C2 collegato con successo all’ambiente esterno, allora è molto probabile che siano in corso altre azioni, anche se non le hai ancora notate.
 Per l'I.C.S. Tuttavia, è importante considerare quale attività della Fase 1 viene svolta. Le VPN sono presenti nell'I.C.S. si accede? L’esfiltrazione di documenti è incentrata sulla proprietà intellettuale, il che potrebbe indicare spionaggio, oppure si tratta di disegni e documenti tecnici, nonché dati di processo che potrebbero essere utili anche per gli impatti della Fase 2?
 Analizzando cosa sta facendo l'avversario, dove si trova nel suo I.C.S. Cyber ​​Kill Chain e cosa significa
 dove monitori e rispondi, è vitale per la difesa del tuo ambiente. Tratta le minacce mirate come minacce invece che come singole intrusioni in stile "colpisci la talpa".

© 2021 Robert M. Lee 103 I.C.S. Fattori di escalation
 Impatto all'indicazione dell'impatto al monitoraggio o alla capacità di sicurezza o al supporto dell'affidabilità su larga scala delle funzioni che influiscono sulle operazioni
 Rilevazione di I.C.S. Uccisione informatica
 catena dei dati critici Fase 1
 azioni di esfiltrazione potrebbero ragionevolmente
 portare alla Fase 2
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 I.C.S. i fattori di escalation dovrebbero essere determinati con largo anticipo rispetto all’incidente e fare affidamento sulle informazioni provenienti dal processo di valutazione del rischio. Idealmente, le valutazioni vengono inizialmente eseguite prima della messa in servizio del sistema e vengono aggiornate per riflettere i cambiamenti nella funzionalità e nell'architettura del sistema attuale. I sistemi dovrebbero avere un profilo di rischio determinato in base alla loro funzione ed esposizione. Per qualsiasi tipo di tecnologia operativa (OT), è importante determinare in che modo i componenti del sistema influiscono sul funzionamento sicuro e affidabile di un processo industriale o in una specifica applicazione di automazione. I.C.S. possono spesso avere un impatto sulla sicurezza del personale in sede ed eventualmente fuori sede, incidere sull’ambiente e causare impatti aziendali significativi perdendo la disponibilità commerciale di un bene o la capacità produttiva. Le conseguenze possono essere difficili da determinare correttamente e richiedono una buona valutazione ingegneristica per determinare se l'uso improprio di un sistema I.C.S. un componente può semplicemente interrompere il processo o può provocare uno scenario di guasto che può aggirare o corrompere il sistema di sicurezza e danneggiare apparecchiature difficili da riparare o sostituire.
 I fattori di escalation possono riguardare il tipo di incidente o violazione delle policy, il possibile rischio associato all'incidente in questione e la capacità di gestire e rispondere all'incidente.
 I fattori di escalation degli incidenti specifici dell'I.C.S. includono:

* In quali livelli o livelli segmentati esistono prove che potrebbero indicare un compromesso?

¢ Esistono percorsi sfruttabili verso reti più affidabili?

* Qual è la funzione dei sistemi a rischio? Si tratta di sicurezza (priorità più alta), controllo (seconda priorità più alta), monitoraggio (visualizzazione e visualizzazione) o ausiliario/supporto?

* Quanti sistemi potrebbero essere colpiti dalla minaccia o dal malware in questione? (Ad esempio, l’aggressore può raggiungere la scalabilità?)

° C'è stata una recente rimozione delle persone che hanno accesso all'I.C.S. componenti?

* Esistono prove del traffico del sistema di controllo o dei dati di produzione che lasciano le vostre reti controllate o protette?
 104 © 2021 Robert M. Lee
 ouUcnmmUm mC OUCOWUCUCOLUCUCOUlLUClCeMllUllU le Ue
 o@
 aonanenhesw a @
 ao 2 wewe

=]
 www w
 COME
 ww
 Lab 3.3 Analisi del traffico della manipolazione del controllo
 

© 2021 Robert M. Lee
 105 obiettivi dello scenario del corso (6)

¢ Raffineria di Calistoga
* Cosa ha fatto l'avversario al PLC di sicurezza?
 L'aggressore è passato da IT a OT, caricando infine un file di progetto infetto manipolando la logica del PLC di sicurezza, ma non si sa cosa abbia fatto in quel momento
 tempo
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 
 106 © 2021 Roberto M.Lee wo
 wwe eT oy ww ww
 w Ww

<U]
 Obiettivi dello scenario del corso (7)

* Qual è la routine dannosa nella logica e cosa fa?
* Qual è la causa principale dell'attacco?
* L’incidente è collegato all’incidente di C3PO?
*«C3PO:
»—_Crea-un'apologia-della rete eontrel.
* Qual è l'azione dannosa sull'HMI?

» Quale Registro è stato manipolato con quale valore?
* Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 107 Analisi degli eventi e conseguenze fisiche
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 
 108 © 2021 Robert M. Lee
 m mW. om, mM, m, m, om, om, m, om, e noi wh ww ww w ww
 ww ww
 w a Ww
 noi &w @&w eB eB Ww Bw ww ah Ww aw
 ww

non è rotto, no
 Interazione con il controllo di processo Many I.C.S. la configurazione o il funzionamento degli ambienti sono un processo l'ambiente è deterministico stabile in genere non è un compito facile, a causa degli ambienti con pochi rischi per le operazioni e i cambiamenti che si verificano le possibili interruzioni necessarie per eseguire il lavoro
 Alcuni settori come quello nucleare, farmaceutico, chimico e dei sistemi di difesa richiedono lunghi percorsi di certificazione/ricertificazione per i cambiamenti
 Quando sono necessarie modifiche, in genere passano attraverso molti livelli di operazioni
 revisione, con il supporto del venditore
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 In molti ambienti di processo i normali cicli di funzionamento e manutenzione portano verso attività di riparazione delle rotture. Gli ingegneri di strumentazione e controllo, gli integratori di sistemi o gli appaltatori in genere arrivano con l'obiettivo di
“riparare” tutto ciò che attualmente non funziona per ripristinare le operazioni il più velocemente possibile, quindi stare lontano dal sistema per evitare qualsiasi rischio di causare un’interruzione forzata.
 Questa modalità operativa considererebbe ogni potenziale cambiamento (patch di sicurezza, modifiche delle prestazioni o della logica di ottimizzazione, rafforzamento della sicurezza, gestione dell'accesso degli utenti, modifiche della rete, modifiche del firewall, ecc.) come un rischio per il processo. Pertanto, ogni modifica passerebbe attraverso un processo di revisione per valutare la priorità della modifica proposta rispetto al rischio per il processo. Per questo motivo, probabilmente vedresti una serie di modifiche in attesa di un'interruzione di manutenzione programmata.

© 2021 Robert M. Lee 109 Rendere obbligatorio il cambiamento
 CIP-010-3 ~ Sicurezza informatica: gestione delle modifiche alla configurazione e valutazioni delle vulnerabilità Alcuni settori, come il Nord
 Introduzione Il settore elettrico americano ha sviluppato Tile: Cyber ​​Security ~ Configuration Change Management and Vulnerabilty requisiti per le valutazioni. ae: G Numero: cIP-010-3 identificazione e applicazione della sicurezza
 Scopo: prevenire e rilevare modifiche non autorizzate ai sistemi informatici BES tramite patch correlate alle risorse operative specificando la gestione delle modifiche alla configurazione e la valutazione della vulnerabilità entro tempi specifici
 requisiti a sostegno della protezione dei sistemi informatici BES da compromissioni che potrebbero portare a malfunzionamenti o instabilità nel sistema elettrico di massa (BES).
 CiP-013-1 ~ Sicurezza informatica - Gestione dei rischi della catena di fornitura
 Inoltre ci sono anche Supply
 Requisiti specifici della catena per Numero: cip-0134 che interagisce con i fornitori e Scopo: mitigare i rischi di sicurezza informatica per il funzionamento affidabile delle patch di convalida in blocco
 Electric Systern (BES) implementando controlli di sicurezza per la gestione del rischio della catena di fornitura dei sistemi informatici BES.
 A. Titolo introduttivo: Cyber ​​Security – Gestione del rischio della supply chain
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 In alcuni settori, come il Bulk Electric System nordamericano, esistono standard che richiedono azioni di rafforzamento del sistema, azioni di gestione degli account, registrazione, monitoraggio, patch di sicurezza, rilevamento di codici dannosi e comunicazioni e l'implementazione di pratiche complete di gestione delle modifiche. Questi standard richiedono maggiori attività di interazione e la frequenza con cui tali attività devono essere eseguite.
 Inoltre, esistono standard della catena di fornitura che forniscono requisiti specifici quando si eseguono azioni come questa lavorando con OEM, fornitori e altre terze parti.
 Al di fuori del settore elettrico nordamericano, non sono presenti molti altri settori in I.C.S. fornendo requisiti per questo livello di interazione o processi della catena di fornitura.
 110 © 2021 Robert M. Lee
 eo DW DW Bh DP
 nnn a om @ ® OD OH WH OH HH DH DWM BD
 an wo © WY YG YY VY VUeEVBPwo Www ewe eee er
 Ww
 Ww
 Interazione elevata con una risorsa operativa
 Relativo alla sicurezza informatica
 Modifiche all'accesso utente Modifiche all'accesso al gruppo
 Modifiche al firewall locale/perimetrale
 Cambiamenti nell'infrastruttura di rete Cambiamenti nel protocollo
 Rafforzamento delle porte e dei servizi degli endpoint
 Cerotti
 Modifiche alla visualizzazione
 Modifiche all'etichetta
 Cambiamenti logici
 L'ambito di applicazione della responsabilità cambia
 Il pacchetto allarmi cambia. Lo storico cambia
 Cambiamenti nelle prestazioni/ottimizzazione del processo
 I.C.S.515 | I.C.S.Visibilità, rilevamento e risposta
 Sebbene in alcuni settori si registrino elevati livelli di cambiamenti legati alla sicurezza informatica, ci sono cambiamenti legati alle operazioni che si verificano in tutti i settori. Questi cambiamenti sono generalmente guidati da sforzi di miglioramento dei processi, modifiche o aggiunte alle apparecchiature, miglioramenti operativi per gli operatori di sistema, cambiamenti identificati come risultato di un evento o potenzialmente cambiamenti nell’azienda o in un settore che richiede nuove capacità operative.

© 2021 Robert M. Lee 111 Produttori di apparecchiature originali
 Negli impianti di produzione di energia, è molto comune trovare connessioni di fornitori e OEM nelle reti OT, poiché l'OEM fornisce analisi delle prestazioni, ottimizzazione e in alcuni casi identifica le esigenze di manutenzione preventiva.
 Anche se queste connessioni con i fornitori possono essere preoccupanti dal punto di vista della sicurezza informatica e dovrebbero assolutamente essere considerate un vettore di attacco, in molti casi dovranno essere gestite e controllate; non rimosso.
 Un obiettivo comune di ottimizzazione e miglioramento delle prestazioni per gli asset di generazione è apportare modifiche operative per migliorare il consumo di calore di un'unità.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Nel settore elettrico si discute da tempo sui collegamenti degli OEM e dei fornitori all’I.C.S. segmenti di rete allo scopo di monitoraggio, analisi, ottimizzazione delle prestazioni e ottimizzazione. Molte entità hanno guardato a queste connessioni con preoccupazione per la sicurezza informatica, i requisiti di conformità e gli obblighi di garanzia. In molti casi queste connessioni sono una realtà della vita che deve essere gestita e molti hanno sviluppato approcci innovativi per ridurre i rischi. Tuttavia, i vantaggi forniti all'azienda potrebbero rendere necessario che l'accesso esista in una forma controllata.
 Con questo accesso gli OEM e altre terze parti possono fornire servizi preziosi all'operatore proprietario dell'asset.
 4112 © 2021 Robert M. Lee
 id
 om OB WO OM ff fF & ® & &
 aoemqqqnwno @ @ www ww noi ww w
 ww wW
 CU)
 U)
 JOC CO
 Variazione della velocità di calore

* Nel laboratorio successivo, l'OEM ha fornito modifiche logiche per migliorare la velocità di riscaldamento dell'unità. La velocità di riscaldamento è l'importo
 di carburante necessario per generare un kWh di energia. L’obiettivo è migliorare l’efficienza riducendo il costo di un MW = consumo di calore dell’unità di generazione x costo del carburante
 Spesso un OEM, un fornitore, un integratore di sistema o un appaltatore si recano sul posto durante una finestra di manutenzione per eseguire una serie di attività per apportare modifiche pianificate. Negli altri casi, la parte 3" può chiedere al personale in loco di farlo
 L'OEM ha apportato modifiche al calcolo nella logica per implementare un controllo più aggressivo della valvola del carburante
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 apportare le modifiche e collaborare con il gruppo 3"4 in remoto. Nel laboratorio successivo, l'OEM ha apportato una modifica minore al calcolo della valvola di controllo del carburante e ha chiesto al proprietario dell'asset di applicare la modifica di runtime per evitare eventuali impatti sul sistema.
 L'azienda sta cercando di rendere l'unità più redditizia diminuendo il costo di generazione dell'elettricità e massimizzando il valore di mercato dell'elettricità venduta nel mercato energetico, comunemente indicato come "scintilla".
 spread”: genera a basso, vendi a alto.

© 2021 Robert M. Lee
 113 Lab 3.4 Convalida delle modifiche logiche del sistema
 1 CS $ 515 | I.C.S. Visibilità, rilevamento e risposta
 
 114 © 2021 Robert M. Lee

*oeoneorr® © MOD OH OD GH GH HF & PM
 a @O @ ® ® ® WO ww www ww
 ww ww ww
 Qw
 YY wweveVv VVyvUVvewveWwyoyW
 La risoluzione dei problemi è difficile
 Inizia con l'elemento fisico locale che sembra non funzionare correttamente
 Osserva la mappatura dei punti I/O da cui viene guidato l'elemento di controllo finale
 Esaminare il segnale o il percorso di comunicazione in cui vengono ricevuti i comandi
 Esaminare l'elenco di tag associato alle aree di traduzione dell'elenco di punti Determinare se i display dell'HMI ricevono dati accurati e li visualizzano nelle aree corrette
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Durante la risoluzione dei problemi, spesso è più utile iniziare dal livello fisico. Anche quando sembra improbabile, è meglio convalidarlo. In un sistema complesso ci sono numerose aree che devono essere riviste per verificarne l'accuratezza e che richiederanno documentazione su quale dovrebbe essere il buono stato previsto del sistema. L'esecuzione di questa convalida e revisione richiederà probabilmente anche una varietà di personale diverso con ruoli e responsabilità diversi all'interno dell'organizzazione.

© 2021 Robert M. Lee 115 Azioni di restauro
 Quando viene identificata un'operazione errata, può essere importante che si tratti di un evento casuale.Nel laboratorio successivo, verificare che il sistema si comporti nel modo i
 Gen Breaker Apri PS Gen Breaker Chiudi PS
'Trans Breaker aperto PG
‘Interruttore Trans Chiudi PB GND
 Spia di guasto del relè di protezione
'Trans Breaker Open Light Gen Breaker Aperto e stretto Spia di stato di interconnessione
 Distribuzione Vaso Residenziale Distribuzione Vaso Industriale
 Grafico a barre della generazione del suolo Misuratore % della produzione industriale

~W Verifica il
 Oh
 oO
 oOoO
 il punto terminale corretto si illumina quando viene attivato il pulsante dell'interruttore Gen corretto
 Comprendere e documentare i cambiamenti che hanno portato ad un impatto negativo sul sistema sarà molto importante nelle attività di analisi e ripristino.
 Analizzando le modifiche agli ioni del sistema avvenute sul campo e verificando lo stato dei controlli manuali sul campo, per terminare la risoluzione dei problemi opel rem sarà rapido! nel trouling non c'è nulla di sbagliato nel funzionamento del campo.

"L'errore deve essere nella logica e nel download dello stesso Je gies,
 la logica dovrebbe riportare il sistema in buono stato.
 1CS515| I.C.S. Visibilità, rilevamento e risposta
 non lo è, sarà necessario caricare la logica sicuramente valida nel sistema.
 116

© 2021 Robert M. Lee
 t eliminare innanzitutto un errore fisico o una connessione difettosa prevista e, se
 a nn mnemnrest et & © PM
 ohm
 mm,
 bt

= wwe wewryeweyse ys we ee wey wewo ww
 sì
 Quando conosciuto bene = non va bene
 Il test e la convalida dei file a scopo di ripristino potrebbero funzionare correttamente negli ambienti di test e quindi comportarsi diversamente in produzione.
 Il file logico sicuramente funzionante è stato ripristinato e la logica è tornata a uno stato attendibile, ma i dati operativi e lo stato del sistema potrebbero essere diversi.
 Potenzialmente verrebbe presa in considerazione una verifica sul campo delle strutture associate, per aiutare a risolvere il problema.
 Mentre è in corso un'indagine operativa, potrebbe anche essere necessario avviare un'attivazione di risposta inidentica a causa del cambiamento della logica di terze parti che sembra aver dato inizio agli eventi sospetti.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Eventi come questo creeranno confusione in tutta l'organizzazione, mettendo in discussione molte cose mentre l'organizzazione tenta di ripristinare le operazioni e incontra ulteriori sfide. I dettagli degli eventi e le capacità di analisi diventeranno molto importanti nello sforzo di comprendere appieno cosa sta accadendo e perché. Inoltre, durante molti eventi operativi è sempre necessario prendere una decisione difficile: si tratta di un dispositivo guasto, di un'errata configurazione, di un errore umano o potenzialmente di qualcosa di dannoso?
 Quando un'organizzazione sa con certezza che si è verificato un incidente? Dovrebbero coinvolgere tempestivamente gli operatori di pronto intervento nel caso in cui un evento sia dovuto ad attività dannose? Nel tentativo di ripristinare un sistema, ci sono molte azioni che il personale operativo sul campo può intraprendere che potrebbero “risolvere” il problema e, parallelamente, nascondere involontariamente la causa. Questo potrebbe essere un passaggio necessario per garantire rapidamente sicurezza e affidabilità, ma coinvolgere tempestivamente il personale addetto alla risposta agli incidenti può consentire la raccolta di informazioni per l'analisi successiva.

© 2021 Robert M. Lee 117 Lo hai chiesto tu
 Sei pronto per ricevere aiuto?
 I team di risposta agli incidenti avranno bisogno di aiuto per aiutare.
 Procedi con il personale appropriato del team:

+ Briefing sulla sicurezza per tutte le strutture che verranno visitate

¢ Panoramica del funzionamento del sistema.

+ Identificare i flussi di comunicazione affidabili da sistema a sistema.

« Revisione delle impronte fisiche.

+ Stampe della rete della struttura.

+ Analisi di file statici che descrivono configurazioni di sistema per regole firewall, switch di rete, protocolli di comunicazione, configurazioni di sistema.

+ Revisione dei file di registro, avvisi ed eventi di sistema, inclusi eventi operativi e dati storici.
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 L'invio del segnale pipistrello e l'avvio di un'attività di risposta all'incidente avvieranno uno sforzo più ampio con un team di soccorritori che avrà bisogno dell'aiuto dei team operativi prima di poter contribuire a qualsiasi attività di risposta. Per gli operatori che rispondono agli incidenti, è importante comprendere l'unicità di ciascun sistema I.C.S. ambiente e le specifiche di come si presentano le normali operazioni, mentre aiuti a cercare di identificare la causa dell'attività sospetta.
 118 © 2021 Robert M. Lee
 e 8
 NO. OD@
 oh
 ann @ @® ©

'LD a
 Laboratorio 3.5 Verifica del punto sul campo
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 119 Obiettivi dello scenario del corso (8)

«C3PO

* Qual è l'azione dannosa sull'HMI?
 Siamo rimasti bloccati fuori dall'HMI e il caricamento della nuova logica non ha aiutato.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 
 120 © 2021 Roberto M.Lee
 qa? a ae a aw <a ” =

<B
 siamo =~

—5
 ehm
 Obiettivi dello scenario del corso (9)

* Calistoga

* Qual è la routine dannosa nella logica e cosa fa?
* Qual è la causa principale dell'attacco?
«L’incidente è collegato all’incidente di C3PO?

«C3PO:

+ Quale registro è stato manipolato con quale valore?
* Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 121