vsv vewvsewsewvwsewwst 8&8 & s&s &
 w
 oS SE DF SE IS SE IH IE DH
 1CS515.4 I.C.S. Visibilità, rilevamento e risposta
 SANS | Risposta all'incidente

© 2021 Robert M. Lee | Tutti i diritti riservati | Versione GO|_07
 Il SANS I.C.S.515 —I.C.S. Il corso Visibilità, rilevamento e risposta è stato sviluppato da Robert M. Lee con il contributo di un gruppo di esperti, le cui diverse esperienze lavorative, conoscenze e competenze si sono realmente fuse per coprire le aree di contenuto specifiche di questo corso. L'autore desidera ringraziarli per il loro sostegno e contributo. Si prega di consultare la pagina seguente.
 Robert M. Lee
 Robert M. Lee è CEO e fondatore della società di sicurezza informatica industriale (I.C.S./OT/IloT) Dragos, Inc. È un istruttore senior SANS e autore del corso SANS I.C.S.515 — “I.C.S. Visibilità, rilevamento e risposta” e autore principale di SANS FOR578 – “Cyber ​​Threat Intelligence”. Attualmente è anche un impiegato del servizio speciale del Dipartimento dell'Energia nel comitato consultivo per l'elettricità in qualità di vicepresidente del comitato per la sicurezza nazionale sulla resilienza della rete.
 Robert ha iniziato la sua carriera nel campo della sicurezza informatica nell'aeronautica americana, dove ha prestato servizio come ufficiale delle operazioni di guerra informatica presso la National Security Agency. Ha svolto missioni di difesa, intelligence e attacco in varie organizzazioni governative, inclusa l'istituzione di una missione di scoperta delle minacce I.C.S./SCADA unica nel suo genere che unisce insieme risposta agli incidenti, caccia alle minacce e intelligence sulle minacce. Infine, Robert è autore del libro SCADA and Me, Threat Intelligence and Me, Santa and Me e del settimanale web-
 fumetto http://www.LittleBobbyComic.com
 Robert può essere trovato su Twitter @RobertMLee o contattato via e-mail all'indirizzo: RLee@Dragos.com

© 2021 Robert M. Lee Contributi di:
 Tim Conway
 Tim Conway è attualmente il responsabile del curriculum dell'I.C.S. La sicurezza al SANS. È stato responsabile dello sviluppo, della revisione e dell'implementazione dei componenti tecnici del SANS I.C.S. e offerte di prodotti SCADA ed è l'autore del corso di [CS456 — NERC CIP Essentials. In precedenza è stato direttore della conformità CIP e della tecnologia operativa presso la Northern Indiana Public Service Company (NIPSCO). È stato responsabile della tecnologia operativa, della conformità CIP NERC e degli ambienti di formazione NERC per i dipartimenti operativi all'interno di NIPSCO Electric. Nel corso della sua carriera, Tim ha lavorato per otto anni come ingegnere dei sistemi informatici EMS presso NIPSCO, con responsabilità sui server del sistema di controllo e sull'infrastruttura di rete di supporto. Tim è stato in precedenza presidente dell'RFC CIPC, è l'attuale presidente del NERC CIP Interpretation Drafting Team, attuale membro del comitato consultivo NESCO, attuale presidente del NERC CIPC GridEx 2013 Working Group e attuale presidente dell'NBISE Pannello di sicurezza informatica Smart Grid.
 Michele Assante
 Michael Assante è stato fondamentale nella creazione di questo corso ed è stata la sua visione che mi ha spinto a crearlo. Questa lezione è dedicata alla sua memoria. Per quelli di voi che non conoscevano Mike, è quasi garantito che la carriera che vi ha portato all'I.C.S. la comunità è stata influenzata da lui ad un certo punto. Ho scritto questo blog su cosa ha significato Mike per me e perché | non sarei dove sono oggi senza di lui. Spero che queste parole aiutino a mantenere vivo il suo ricordo in questa classe: http://www.robertmlee.org/goodbye-mike-assante-thank-you-for-literally-everything/
 Jeff Shearer e Jason Dely sono entrambi membri del team SANS “SROC” che aiuta a creare e testare componenti tecnici per i laboratori. È grazie al loro lavoro e alla dedizione con Tim che sono stati possibili i kit in classe e le interazioni con loro. Sono stati le menti dietro gran parte del lavoro pratico sui kit e hanno aiutato immensamente.
 Anche i membri del team Dragos hanno contribuito in modo significativo al corso attraverso le proprie ricerche e innumerevoli
 conversazioni. Inoltre, Austin Scott, Grant Freter, Jackson Evans-Davies e altri hanno gestito il poligono e hanno eseguito la squadra rossa dell'I.C.S. raggio d'azione del quartier generale Dragos utilizzato nello scenario del corso.
 2 © 2021 Robert M. Lee

@, mm, ww, ww nN a, am, «me, ww mm, mm, cm, ay ae, raggio m-, oe, m@,
 ow, Sue ve ve vueuevewvwbebevbvbkb sewuwwu
 UN"
 Sezione 4 Descrizione
 Caso di studio: SANDWORM - Ucraina 2015
 I.C.S. Panoramica sull'analisi forense digitale e sulla risposta agli incidenti
 Lab 4.1: Acquisizione in ambiente operativo
 Preparazione di un I.C.S. Squadra di risposta agli incidenti
 Laboratorio 4.2: Analisi Logica e Reset a
 Caso di studio: ELECTRUM e CRASHOVERRIDE - Ucraina 2016
 Vettori di compromesso iniziali
 Lab 4.3: Analisi delle email di phishing
 Fonti di dati forensi in I.C.S. Reti
 Lab 4.4: Analisi forense della memoria HMI Lab 4.5: Triage dei processi
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 Come vedrai, l'obiettivo di questa sezione è familiarizzare con i concetti di risposta agli incidenti in I.C.S. con alcuni elementi di digital forensics (come memory forensics e analisi logica). La risposta agli incidenti e l'analisi forense digitale sono due campi separati, ma è necessario comprenderne alcuni per essere efficaci in entrambi.La risposta all'incidente consiste nel riportare la struttura o l'ambiente nel luogo in cui deve trovarsi (ad esempio, nell'ultimo buono stato conosciuto), garantendo al tempo stesso che la missione di quell'ambiente sia soddisfatta (ad esempio, la produzione sia ripristinata) e raccogliendo prove a supporto delle domande che devono essere affrontati (ad esempio, analisi delle cause profonde dei problemi che si sono verificati). L'attività forense consiste nel prendere le prove digitali e immergersi in profondità per rispondere alle domande sui dati per supportare un'ampia varietà di esigenze, inclusi obiettivi aziendali e operativi. Gli addetti alla risposta agli incidenti dovrebbero analizzare le informazioni solo nella misura in cui queste li aiutano a raggiungere più rapidamente lo scopo dello sforzo di risposta all'incidente.
 Naturalmente, i requisiti sono sempre diversi negli incidenti, quindi pochissimi casi di risposta agli incidenti sono simili, ma è importante disporre delle competenze di base per le situazioni comuni. In questa sezione, lo facciamo attraverso una serie di sezioni e laboratori.

© 2021 Robert M. Lee 3
 3
 Ad alto livello, comprendere l'analisi forense digitale
 Comprendere i principali punti focali per la risposta agli incidenti Comprendere le principali fonti di dati forensi Acquisire, verificare e analizzare rapidamente prove digitali
 Sottolineare l’importanza di mantenere operazioni sicure/affidabili
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Benvenuti alla Sezione 4 del corso. Nelle prime due sezioni ci siamo concentrati su come comprendere e utilizzare l'intelligence sulle minacce e su come identificare le risorse e monitorarle per individuare eventuali incidenti di sicurezza. In questa sezione trattiamo la risposta agli incidenti (IR). Risposta agli incidenti in I.C.S. presenta una serie di somiglianze e una serie di differenze rispetto alla risposta agli incidenti negli ambienti IT. Inoltre, una fase dell'Active Cyber ​​Defense Cycle (ACDC) del processo di risposta agli incidenti è probabilmente diversa da quella a cui potresti essere abituato se avessi già praticato la risposta agli incidenti in precedenza. Prendendo spunto dalle lezioni apprese e dall'esperienza sul campo, discuteremo in seguito perché la risposta agli incidenti, presentata qui come parte di ACDC, viene presentata così com'è e perché è incredibilmente importante per I.C.S. ambienti.
 Il primo obiettivo di questa sezione è importante: comprendere ad alto livello l'analisi forense digitale. L'analisi forense digitale è una scienza, come verrà esplorato in seguito, e di solito è racchiusa nel termine "analisi forense digitale e risposta agli incidenti"

(DFIR). Inoltre, negli ultimi dieci anni, ha compreso il reverse engineering e l'interazione con il malware. IL
 l’aspetto della risposta agli incidenti è ovviamente fondamentale.
 Il secondo obiettivo di questa sezione è garantire che i punti focali per la risposta agli incidenti siano compresi, come l'importanza di creare un team di risposta agli incidenti, partecipare alla formazione e incorporare alcune migliori pratiche. Successivamente, i partecipanti dovrebbero, a livello tecnico, comprendere le principali fonti di dati forensi. Non eseguiremo analisi forensi digitali approfondite; questo non è un ruolo dell’ACDC.
 È importante che il personale che acquisirà le prove comprenda quali prove hanno valore e perché. Successivamente, e probabilmente in modo più critico, ci si aspetta che tu acquisisca la capacità di acquisire, verificare e analizzare rapidamente prove digitali.
 L'aspetto più importante di questa sezione è: lo scopo di chi risponde agli incidenti è preservare le operazioni acquisendo prove digitali di qualità forense e valutando la portata dell'incidente (o quanto lontano/velocemente si è diffuso e a quali sistemi). Infine, si prevede che 515 partecipanti comprenderanno i concetti fondamentali per il mantenimento e il ripristino delle operazioni. Per comprendere appieno l'ultimo punto focale, sarebbe necessaria una configurazione fisica completa del Jab, unica per l'organizzazione di ciascun partecipante. Per questo corso, la parte importante è comprenderne gli aspetti.
 4 © 2021 Robert M. Lee
 4
 scrivimi wm & OM OO MT WS WM Cw
 wm che
 wm-™-?
 m™w

- noi ww
 FF GF F&F F&F BOB Bb BF BF HY Bw BE UV Ue Ww wo wo we wo wo WwW
 Inoltre, il personale addetto alla risposta agli incidenti in I.C.S. gli ambienti spesso non ripristinano effettivamente i sistemi. È più probabile che ingegneri e architetti di sistema ripristino le operazioni, ma i loro sforzi sarebbero vani senza personale di risposta agli incidenti ad alte prestazioni.

© 2021 Robert M. Lee 5 obiettivi dello scenario del corso (1)

* Qual è la routine dannosa nella logica e cosa fa?
* Qual è la causa principale dell'attacco?
¢ L’incidente è collegato all’incidente di C3PO?

¢C3PO:

° Quale Registro è stato manipolato con quale valore?
* Quale file dannoso è stato eseguito sull'HMI e quando?
 1C$515 | I.C.S. Visibilità, rilevamento e risposta
 
 6 © 2021 Robert M. Lee
 6

}
 sì
 wy iy, iW WW \) eThibate » » iVes ; url Intelligenza Attiva w § Consumo

(FASE 4)
 Visibilità
 I.C.S.515 | I.C.S.Visibilità, rilevamento e risposta
 Come discusso nella diapositiva degli obiettivi, il punto focale della risposta all'incidente per l'ACDC è informare i decisori sulla portata dell'incidente e acquisire prove di qualità forense per l'analisi da parte del team di manipolazione delle minacce e dell'ambiente e degli analisti forensi digitali dopo l'accaduto. Gli analisti forensi digitali e l'esplorazione approfondita dei dati forensi non sono ruoli di difesa attiva; quel processo è più accuratamente contenuto nella difesa passiva. La difesa attiva dovrebbe avere un livello di impegno e velocità per il mantenimento delle operazioni che generalmente non è adatto al mestiere meticoloso e dispendioso in termini di tempo della tradizionale analisi forense digitale.

© 2021 Robert M. Lee
 7
 Caso di studio: verme della sabbia
 Ucraina 2015 Attacco informatico al sistema elettrico
 di Robert M. Lee e Jeff Haas
 7 cooo tHine W' re meact wouos| | 7 NOTE oe mangia MOM N [7 scegli a
 CREDERE CHE PUÒ INFINITAMENTE MA non può?
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S
 
 8 © 2021 Robert M. Lee
 FY FF TF TF WM © VM WM @ @&
 wowremrwrrrnmrevrwrmne wy ​​& oo © © © © © & S&S DS WwW YH BH ww ww wo wo wo wo HS WwW
 L'incidente '
 Il 23 dicembre 2015, un Oblenergo ucraino ha segnalato interruzioni. Lo scetticismo è stata la risposta iniziale
 L'analisi dell'I.C.S. e di cosa potrebbe causare il problema, nonché un campione di malware scoperto, hanno contribuito a confermare l'attacco
 Gli ucraini hanno attribuito l'attacco ai servizi russi. Anche la squadra Sandworm è coinvolta nell'attacco
 Nel complesso, sono state disconnesse 3 Oblenergo, circa 62 sottostazioni, lasciando circa 225.000 clienti senza elettricità per 3-6 ore
 L’Ucraina è stata operativa manualmente per mesi
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Il 23 dicembre 2015, gli aggressori hanno sfruttato l’accesso di cui avevano avuto nei sei mesi precedenti per eliminare dalla rete tre regioni dell’Ucraina. Complessivamente sono state disconnesse circa 62 sottostazioni e le interruzioni sono durate dalle 3 alle 6 ore, a seconda della regione. La corrente è stata riattivata in tempi relativamente brevi grazie alla capacità degli ucraini di tornare alle operazioni manuali, ma hanno dovuto persistere nelle operazioni manuali per diversi mesi.
 Dal rapporto ufficiale:
 Il 23 dicembre 2015 la Kyivoblenergo ucraina, società regionale di distribuzione elettrica, ha segnalato interruzioni del servizio ai clienti. Le interruzioni sono state dovute all'ingresso illegale di terzi nei sistemi informatici e SCADA dell'azienda: a partire dalle ore 15:35 circa. ora locale, sono state disconnesse per tre ore 7 sottostazioni da 110 kV e 23 da 35 kV. Dichiarazioni successive hanno indicato che l’attacco informatico ha colpito ulteriori porzioni della rete di distribuzione e ha costretto gli operatori a passare alla modalità manuale. L'evento è stato elaborato dai media ucraini, che hanno condotto interviste e hanno stabilito che un aggressore straniero controllava a distanza il sistema di gestione della distribuzione SCADA. Inizialmente si pensava che le interruzioni avessero interessato circa 80.000 clienti, in base all’aggiornamento del Kyivoblenergo ai clienti. Tuttavia, in seguito è stato rivelato che tre diversi oblenergos di distribuzione (un termine usato per descrivere una società energetica) sono stati attaccati, provocando diverse interruzioni che hanno causato la perdita di energia elettrica a circa 225.000 clienti in varie aree. Poco dopo l’attacco, funzionari del governo ucraino hanno affermato che le interruzioni erano state causate da un attacco informatico e che i servizi di sicurezza russi erano responsabili degli incidenti. A seguito di queste affermazioni, gli investigatori in Ucraina, così come società private e il governo degli Stati Uniti, hanno eseguito analisi e offerto assistenza per determinare la causa principale dell’interruzione.

© 2021 Robert M. Lee 9
 9
 Come sono le reti elettriche?
 Generazione: Nessuna eh
 Trasmissione: Nessuna Distribuzione ER: 3 Oblenergos 4

& sotto
 Fonte: Modifica al Piano Settore Energetico DHS 2010
 In Ucraina sono stati colpiti tre Oblenergo. Le Oblenergos sono la versione ucraina delle compagnie energetiche. In una rete elettrica ci sono generalmente tre componenti principali: generazione, trasmissione e distribuzione. Storicamente, abbiamo dato priorità alla sicurezza di generazione e trasmissione, che era ben posizionata. Sfortunatamente, la Distribuzione è il ventre molle; molte aziende tentano di proteggere questi siti, ma molte aziende non lo fanno né esistono regolamenti o requisiti per farlo (non che questo sia comunque il meccanismo migliore). Gli aggressori ucraini hanno preso di mira la Distribuzione.
 10 © 2021 Robert M. Lee
 ww @w

,rPr FF PS TF F YF PW HP FH HW WP wD
 Roma
~~ wr wow noi ow wwe noi wow wow wow wo wm ww

-
 ne Interruzione di corrente I.C.S. Catena di uccisione informatica
 Targeting delle e-mail di phishing
 Consegna
 Energia Nera 3
 6)
 Sfrutta l'installazione/modifica
 VPN e furto di credenziali
 Individuazione di reti e host
 C2
 100

|
 FASE 2 - I.C.S. attacco

| io
|
 Sviluppo di firmware dannoso

©
 Installa/modifica caricamento firmware
 Sii carino iCSAttack KIUDisk sovrascrive
 000
 Interruzione/i di corrente}
 Attaccare con impatto
 Il primo passo nella Fase 1 è la Ricognizione.Non ci sono segnalazioni di ricognizioni osservate prima di prendere di mira le società energetiche. Tuttavia, un’analisi delle tre organizzazioni colpite mostra che erano obiettivi particolarmente interessanti a causa dei livelli di automazione del loro sistema di distribuzione; consentendo l'apertura remota degli interruttori in una serie di sottostazioni. Inoltre, l'individuazione degli obiettivi e il piano d'attacco finale delle società elettriche in generale sono stati altamente coordinati, il che indica che ad un certo punto è avvenuta una ricognizione. Era molto improbabile che si trattasse di un attacco opportunistico. Il secondo passo è l'armamento e/o il targeting. Il targeting verrebbe normalmente effettuato quando non è necessaria alcuna arma; come l'accesso diretto ai dispositivi connessi a Internet. In questo attacco, non sembra che fosse necessario prendere di mira un'infrastruttura specifica per ottenere l'accesso. Invece, gli avversari hanno utilizzato come arma i documenti di Microsoft Office (Excel e Word) incorporando BlackEnergy 3 all'interno dei documenti. Campioni di Excel e altri documenti d'ufficio sono stati recuperati dalla campagna di accesso più ampia che ha preso di mira una moltitudine di organizzazioni in Ucraina; compresi i documenti dell'Ufficio utilizzati nello specifico attentato contro le tre società elettriche. Durante la fase di consegna, sfruttamento e installazione dell'intrusione informatica, i documenti Office dannosi venivano recapitati tramite e-mail a persone nella rete amministrativa o informatica delle società elettriche.
 Quando questi documenti venivano aperti, agli utenti veniva visualizzato un popup per incoraggiarli ad abilitare le macro nel documento. L'attivazione delle macro ha consentito al malware di sfruttare la funzionalità macro di Office per installare BlackEnergy 3 sul sistema vittima e non si è trattato di un exploit di una vulnerabilità tramite codice exploit. Non è stato osservato alcun codice di exploit in questo incidente. Il tema dell’utilizzo delle funzionalità disponibili nel sistema era presente in tutta la catena di uccisione dell’avversario. Durante la fase di installazione, il malware BlackEnergy 3 si collegava agli indirizzi IP di comando e controllo (C2) per consentire la comunicazione dell'avversario con il malware e i sistemi infetti. Questi percorsi hanno consentito all’avversario di raccogliere informazioni dall’ambiente e consentirne l’accesso. Sembra che gli aggressori siano riusciti ad accedere più di sei mesi prima del 23 dicembre 2015, quando si è verificata l'interruzione di corrente. Una delle loro prime azioni è avvenuta quando la rete è stata quella di raccogliere credenziali, aumentare i privilegi e spostarsi lateralmente in tutto l'ambiente (ad esempio, indirizzare l'infrastruttura del servizio di directory per manipolare e controllare direttamente il sistema di autenticazione e autorizzazione). A questo punto, l’avversario ha completato tutte le azioni per stabilire un accesso persistente agli obiettivi.

© 2021 Robert M. Lee 11 Mentre i punti d'appoggio iniziali sono stati utilizzati per raccogliere credenziali legittime per un'acquisizione sistematica e pivotante dei sistemi IT e delle connessioni remote, è probabile che gli aggressori si siano allontanati rapidamente dai loro punti d'appoggio iniziali e dai vulnerabili C2 nel tentativo di fondersi nei sistemi del bersaglio come utenti autorizzati. Con queste informazioni gli aggressori sarebbero in grado di identificare le connessioni VPN e i percorsi dalla rete aziendale all’I.C.S. rete. L'utilizzo di connessioni e comandi nativi consente agli aggressori di scoprire il resto dei sistemi ed estrarre i dati necessari per formulare un piano per la Fase 2.
 Durante l'I.C.S. Nella fase di attacco, gli avversari hanno utilizzato software nativo per distribuirsi nell'ambiente per l'interazione diretta con l'I.C.S. componenti. Hanno raggiunto questo obiettivo utilizzando gli strumenti di amministrazione remota esistenti sulle postazioni di lavoro degli operatori. Gli autori degli attacchi hanno continuato a utilizzare l'accesso VPN anche all'ambiente informatico. Nella preparazione finale all'attacco, gli aggressori hanno completato la fase di installazione/modifica installando nell'ambiente software dannoso identificato come KillDisk modificato o personalizzato. Sebbene sia probabile che gli aggressori si siano poi assicurati che le loro modifiche all'UPS fossero pronte per l'attacco, non erano disponibili prove forensi sufficienti per dimostrarlo. L'ultimo atto di modifica è stato che gli avversari prendessero il controllo delle postazioni di lavoro degli operatori e quindi bloccassero gli operatori fuori dai loro sistemi. Infine, per completare l’I.C.S. Cyber ​​Kill Chain e per eseguire l'I.C.S. Attacco, gli avversari hanno utilizzato gli HMI nell'ambiente SCADA per aprire gli interruttori. Almeno 60 sottostazioni (il numero totale è probabilmente più alto) sono state messe offline nelle tre società energetiche, con un impatto su circa 225.000 clienti. Allo stesso tempo, gli aggressori hanno caricato il firmware dannoso sui dispositivi gateway da seriale a Ethernet.
 Ciò garantiva che, anche se le postazioni di lavoro degli operatori fossero state ripristinate, non sarebbe stato possibile impartire comandi remoti per riportare in linea le sottostazioni (abbiamo caratterizzato gli attacchi firmware contro i dispositivi di comunicazione sul campo come
“far saltare i ponti”).Nello stesso periodo, gli aggressori hanno anche sfruttato un rifiuto di servizio telefonico remoto sul call center della compagnia energetica con migliaia di chiamate per garantire che i clienti interessati non potessero segnalare interruzioni. Inizialmente sembrava che questo attacco servisse a impedire ai clienti di informare gli operatori dell'entità delle interruzioni; tuttavia, esaminando tutte le prove, è più probabile che la negazione del servizio sia stata eseguita per frustrare i clienti poiché non potevano contattare l'assistenza clienti o ottenere chiarezza sull'interruzione.
 12 © 2021 Robert M. Lee

)

*DM WP Ww
 rr ww noi ww HP PW WPM PW PM
 e ww @w @w
 TP
~~ Se noi wow noi noi noi © & & & S&S ww
 od
 Interruzione di corrente in Ucraina
 Attacco integrato
 Altamente coordinato
 Sofisticazione logistica
 Strumenti utilizzati per abilitare
 Oltre 6 mesi nell'ambiente
 Artack con conseguenze fisiche
 Incidente in Ucraina
 Report completo sull'Ucraina: TLP_WHITE_E-ISAC_SANS_Ukraine_DUC_6_Modular_I.C.S._Malware Final.pdf

© 2021 Robert M. Lee 13 Conclusioni sul ciclo di difesa informatica attiva
 cioè Ne — Sonn EE =
'» Regole precedenti BlackEnergy YARA, ) | VPN in I.C.S. frequenza e TTP e server C2 ancora applicati: durata della sessione
* Comprensione strategica della ° Utilizzo della situazione geopolitica del desktop remoto: + Movimento laterale nel
* Condivisione di IOC/TTP tra più grandi
_ Comunità
 Risorsa
 ped 1D/Sicurezza di rete
 Consumo di intelligenza
 Monitoraggio.

_ Analisi dell'attività di minaccia Minaccia e

(interazione umana e sforzi per ~ Incidente ambientale
 io io
:
|

+ Analisi del malware (KillDisk rileva l'infezione
| e BlackEnergy 3) + Raccolta di log/traffico/memoria per _

+ Documentazione di IOC, strumenti, analisi e identificazione di potenziali attività commerciali di impatto, inclusi i server C2 «Raccolta di campioni di BlackEnergy3 codificati nel malware e KillDisk

|
| apprendere DMS e ambiente) Età della manipolazione. * Utilizzo di IOC e TTP
|
|
|
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 14
 Ci sono stati numerosi insegnamenti dallo scenario ucraino lungo la scala mobile della sicurezza informatica: tutto, dalle decisioni sull'architettura come la necessità di limitare l'accesso al desktop remoto e abilitare l'autenticazione a due forme sulle VPN, alle difese passive nel lato IT della casa per rilevare attività anomale e attraversamento dell'I.C.S.. Gli aspetti legati alla difesa attiva sono i più importanti, tuttavia, come con questo stile di minaccia mirata, l'avversario avrebbe lavorato per sconfiggere l'architettura e le difese passive in atto. Questo è il caso di studio perfetto per mostrare cosa avrebbero dovuto fare i difensori attivi contro un avversario attivo.
 Il personale del Threat Intelligence Consumption avrebbe potuto prendere in considerazione la situazione geopolitica più ampia per determinare la necessità di un maggiore livello di sicurezza, soprattutto in relazione al conflitto fisico e al sabotaggio contro apparecchiature e stazioni elettriche in altre parti dell’Ucraina e della Crimea. Avrebbero anche potuto identificare quali attori della minaccia hanno mostrato interesse per la fornitura di energia in precedenza, come il team Sandworm, e raccogliere gli indicatori, le pratiche commerciali e le regole YARA ad essi correlati. Tutto ciò era ancora utile e rilevante nella struttura ucraina.
 Queste informazioni potrebbero essere state trasmesse agli analisti dell'NSM che monitorano l'ambiente. Il monitoraggio dell'I.C.S. in particolare sarebbe stato utile, poiché le modifiche alla frequenza e alla durata della sessione nelle connessioni VPN, nonché l'utilizzo strano del desktop remoto e dell'UPS avrebbero potuto aiutare a identificare attività anomale. Inoltre, sarebbe stato particolarmente utile vedere le modifiche dei registri sui sistemi, come il nuovo software distribuito nell’ICS.
 Gli addetti all'intervento avrebbero potuto essere guidati verso i sistemi colpiti per raccogliere campioni e prove forensi, trasmettendo rapidamente le informazioni agli analisti di manipolazione delle minacce e dell'ambiente per analizzare ed estrarre conoscenze sull'avversario, sul potenziale impatto delle azioni e aiutare a dare raccomandazioni al personale per la pulizia e la messa in sicurezza dell'ambiente. Anche qualcosa di semplice come disabilitare temporaneamente l'assistenza desktop remoto sarebbe stata una raccomandazione fantastica.
 Tutte queste informazioni potrebbero essere trasmesse al personale di Threat Intelligence Consumption per guidare il processo numerose volte di fronte all’avversario e condividere informazioni rilevanti con la comunità più ampia, soprattutto in Ucraina, per aiutare la posizione di sicurezza di tutti a migliorare.
 14 © 2021 Robert M. Lee

> 7 @B b

= I.C.S. Digital Forensics e
 Panoramica della risposta agli incidenti
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 15
 

© 2021 Roberto M.Lee Cos'è l'analisi forense digitale?

*La Digital Forensics è un sottoinsieme della scienza forense:
* La scienza forense è un metodo scientifico per raccogliere ed esaminare informazioni
+ In generale, lo standard per la qualità e i metodi di raccolta delle informazioni è se queste siano ammissibili in tribunale
« Ampiamente praticato e sviluppato nella comunità delle forze dell'ordine con particolare attenzione all'uso dei mezzi digitali per trovare criminali
¢ Il campo veniva chiamato principalmente informatica forense ma si è espanso con la crescita delle fonti di medicina legale, come ad esempio:
¢ Analisi forense sui cellulari
¢ Windows/Mac/Linux/ecc. forense
* Analisi forense della memoria
¢ Analisi forense della rete Analisi forense della posta elettronica e del browser
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 1s
 La scienza forense digitale è un sottoinsieme della scienza forense. La cosa importante da notare qui è che si tratta di una scienza. Non c'è bisogno di inserirvi la parola "cyber" (alcuni hanno iniziato a chiamarla cyber-forense) perché il campo è una scienza riconosciuta e ben praticata. È stato ampiamente influenzato dalle forze dell’ordine come necessità di identificare la fonte e l’impatto dei crimini digitali. La sicurezza e il benessere dei bambini rapiti e di quelli sfruttati per la pornografia infantile sono stati i principali catalizzatori per lo sviluppo di molti strumenti nella comunità forense digitale. La comunità DFIR è una delle più coinvolgenti con cui confrontarsi, in parte per questo motivo, e il campo ha una certa maturità e serietà amante del divertimento che ne conseguono. I.C.S. i professionisti che interagiscono in questa comunità scopriranno che ci sono alcune responsabilità e passioni che risuonano tra le comunità che pochi altri condividono.
 16 © 2021 Robert M. Lee
 wo wow 8S S&S 8S wweeeewweweweweewse &©§ &§ & & &
 SD
 a> va ww
 Forense tradizionale contro I.C.S.

‘ig PE finitura FORENSI.C.S. DOMINIO sccqutinon Repiattons:
 Setadase Configurazione HME

.Z eo ebeur se

«Ti avena ac roano
 FORENSE TRADIZIONALE} Sec° DOMINIO
 Foto
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Questa è un'immagine tratta da una guida alle pratiche raccomandate da I.C.S.-CERT per l'analisi forense digitale in un I.C.S.. Si noti che il nuovo dominio forense in alto si occupa di cose come i sistemi sul campo, gli storici dei dati, le workstation di ingegneria e così via. Tuttavia, questi sistemi spesso funzionano su sistemi operativi Windows e sono collegati tramite protocolli basati su IP. Ciò non significa che non sia unico rispetto alla medicina legale tradizionale. Tuttavia, ciò implica che ci sono molte lezioni apprese dalla medicina legale tradizionale che possono essere applicate in modo intelligente con i test.
 Riferimento: https://ics-cert.us-cert.gov/sites/default/files/recommended_practices/Forensics_RP.pdf

© 2021 Robert M. Lee 17 Esempio storico forense: l'uovo del cuculo

° The Cuckoo’s Egg di Cliff Stoll è spesso considerato una delle prime esplorazioni nel campo della scienza forense digitale
* Libro del 1989 che documenta il suo resoconto dell'interazione con un hacker che ha fallito
 nel Lawrence Berkeley National Laboratory nel 1986: gli fu chiesto di esaminare un errore di $ 0,75 per gli account di utilizzo del computer. L'hacker stava usando una connessione a 1200 baud, quindi collegò delle telescriventi per registrare ciò che faceva l'hacker, e quando l'hacker si connetteva, Cliff ha chiesto all'operatore telefonico di tracciare la linea Cliff ha finito per rintracciare l'hacker attraverso più punti in cui ha scoperto che le basi militari e i centri di ricerca nucleare negli Stati Uniti erano stati compromessi. Alla fine ha portato ad alcune grandi interazioni con il governo della NSA (incluso il leggendario Robert Morris). si interessò dopo le proteste iniziali, ne trovò il significato e scoprì che gli hacker erano in Germania e finanziati dal KGB
 I.C.S.515 | \CSVisibilità, rilevamento e risposta 18
 La storia tende a rivelare casi di studio sorprendentemente simili a quelli con cui abbiamo a che fare regolarmente oggi. Per coloro che sono interessati a comprendere veramente alcune delle radici della comunità forense digitale e desiderano esplorare un resoconto storico accurato, di qualità quasi da romanzo di spionaggio, sul "tracciamento degli hacker", questo libro è assolutamente da leggere. Cliff Stoll ha ispirato innumerevoli persone a dedicarsi all'analisi forense digitale e il suo libro è una buona lettura per I.C.S. personale nel campo della risposta agli incidenti. In effetti, Cliff ha persino trovato un modo utile per analizzare una connessione a 1200 baud, qualcosa che anche l'ingegnere più vecchio stile può rispettare.
 18 © 2021 Robert M. Lee
 ehm Ww
 presso la scientifica può determinare

¢ Chi ha compromesso la mia organizzazione?

¢ Cosa è successo e quale è stato l'impatto?
 I.C.S.515 | (Visibilità, rilevamento e risposta del CS
 La medicina legale è brava a rispondere alle domande "chi, cosa, dove, quando e come". Dal punto di vista forense è importante comprendere veramente il quadro completo di un incidente. Ciò consente alle organizzazioni di comprenderne l'impatto, capire come devono agire apportare modifiche in base a ciò che hanno imparato dal loro ambiente (come una nuova vulnerabilità) e capire come raggruppare insieme le attività.Vale la pena notare che il “chi” a volte non è così importante: è la medicina legale che può aiutare con queste domande, ma non è necessariamente vero che ciascuna di queste domande sia preziosa quanto le altre.

© 2021 Robert M. Lee 19
 19
 Cosa non è la Digital Forensics: Migliora!

*La digital forensics non è magia:

* Molti estranei alla comunità hanno un'immagine degli esami forensi digitali che superano il limite del tecnicamente possibile. Come hai trovato la chiave di crittografia del malware in memoria? Deve essere magico.

* L'analisi forense digitale non riguarda solo il recupero e la criminalità dell'HDD:
+ L'analisi delle intrusioni è un buon esempio in cui la medicina legale eccelle e non è in linea con a
 concezione tradizionale della medicina legale.
+ L’analisi forense digitale non può compensare le cattive pratiche di sicurezza:
° Se il logging è disabilitato, se l'acquisizione delle prove viene rimandata per un po', e così via, non c'è molto che si possa fare.
*Il principio dello scambio di Locard è sempre in gioco
¢ Qualunque cosa tu faccia (o faccia l'avversario) lascia una traccia.
* Comprendi entrambi per poter porre le domande giuste sui tuoi dati.
* Comprendere entrambi per essere in grado di comprendere l'impatto sui sistemi.
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S. 20
 Sembra che ci sia sempre un po’ di mistero attorno alla scienza forense digitale. In parte, è colpa degli spettacoli polizieschi di tipo CSI e del loro desiderio ridicolmente serio di gridare "migliora!" sulle foto digitali (indipendentemente dalle limitazioni dei pixel) per vedere i riflessi sugli occhi delle persone per identificare l'assassino. La medicina legale digitale non è magia. La digital forensics è un metodo approfondito per comprendere i sistemi e interagire con essi per estrarre le informazioni necessarie. Ad esempio, quando i dati sono
"eliminato" su un sistema informatico, ciò che realmente accade (nei dischi fisici tradizionali) è che un flag viene invertito (come un bit | in un bit 0) mostrando che i dati in quella sezione sono disponibili per essere sovrascritti. Ma i dati non vengono cancellati; è disponibile solo per essere sovrascritto se il sistema ha bisogno di spazio. Pertanto, recuperare i dati "eliminati" può essere semplice come avere lo strumento giusto per ignorare il flag 1 o 0 all'inizio delle sezioni del file per recuperare il file "eliminato". Questa è solo una comprensione del sistema. L’analisi forense digitale non è un modo per correggere errori reali. Non è la capacità di rimediare a cattive pratiche di sicurezza. Conoscere i limiti dell’analisi forense digitale è importante quanto comprenderne i punti di forza.
 La scienza dietro di esso
 Uno dei concetti più importanti da comprendere nell'analisi forense digitale, e in particolare nella risposta agli incidenti, è il principio di scambio di Locard, sviluppato dal Dr. Edmond Locard (1877-1966). Locard ha ipotizzato che ogni volta che si entra in contatto con un'altra persona, luogo o cosa, si verifica uno scambio di materiali fisici. Credeva che non importa dove vada o cosa faccia un criminale, entrando in contatto con le cose, un criminale può lasciare ogni sorta di prova, incluso DNA, impronte digitali, impronte, capelli, cellule della pelle, sangue, fluidi corporei, pezzi di abbigliamento, fibre e altro ancora. Allo stesso tempo, il criminale porterà con sé anche qualcosa della scena. Questo vale per la medicina legale digitale.
 Qualsiasi interazione che si verifica tra un analista forense digitale o un addetto alla risposta agli incidenti e le prove lascia tracce di tale interazione. C'è impatto. Va bene finché capisci qual è questo impatto. Quando un soccorritore lancia uno strumento per raccogliere prove digitali su un sistema infetto, chiavi di registro, dati di processo, settori di memoria e simili modifiche. Senza sapere quale impatto hanno gli strumenti e le azioni sulle prove, esiste un'elevata possibilità che le interazioni degli analisti possano essere scambiate per azioni dell'avversario. Ancora più importante, comprendere e attuare questo principio è importante per la professionalità richiesta dal lavoro. Cioè, gli analisti devono conoscere l’impatto delle loro azioni. Se le azioni danneggeranno la scena del crimine è secondario. Gli analisti che non comprendono gli strumenti, soprattutto in un sistema I.C.S. ambientale, finirà per causare più danni che benefici.
 20 © 2021 Robert M. Lee

@ @ &
 wT TT VT TP PW SW HP
 vw © & Ww Ff wv guai wweeweiweejwveowwe & w
 oe 8 § 8S BS noi noi Ww ww
 Che cos'è la risposta agli incidenti?

* La risposta agli incidenti è un approccio organizzato per affrontare e gestire le conseguenze di un incidente:

* Gli incidenti sono definiti dall'organizzazione; tuttavia, generalmente sono associati a violazioni della sicurezza, intrusioni o perdita di vista/controllo in un sistema I.C.S.

¢ Gli incidenti dovrebbero essere dichiarati solo da una persona predefinita con autorità definita Esistono numerose tecniche e guide per aiutare a stabilire la risposta agli incidenti
 pratiche, team e metodologie:

* SP 800-61rev2 del NIST "Guida alla gestione degli incidenti di sicurezza informatica"

¢ La "Guida alle buone pratiche per i CERT nell'area degli I.C.S."

* "Creazione e gestione di team di gestione degli incidenti di sicurezza informatica" di FIRST La maggior parte delle metodologie e delle guide sono di alto livello La maggior parte delle pratiche esistenti si concentra esclusivamente, o principalmente, sull'infrastruttura IT
 I.C.S.$515 | I.C.S. Visibilità, rilevamento e risposta 21
 Con una comprensione dell’analisi forense digitale, viene posta la domanda: cos’è la risposta agli incidenti? La risposta: è un approccio organizzato per affrontare e gestire le conseguenze di un incidente. Non è necessario ripristinare immediatamente la rete allo stato precedente all'incidente. Non è necessario eseguire un'analisi approfondita per raccogliere tutte le informazioni possibili o l'attribuzione. Deve semplicemente trattarsi di un approccio organizzato per soddisfare i requisiti stabiliti in anticipo su come affrontare e quindi gestire un incidente. In I.C.S., ciò è quasi sempre inteso come: mantenere le operazioni in esecuzione in sicurezza.
 Sono disponibili numerose metodologie per la risposta agli incidenti, ma sono per lo più focalizzate sull’IT. L'I.C.S. il campo della risposta agli incidenti è giovane e le poche informazioni disponibili sono spesso consulenze di alto livello o pratiche commerciali strettamente protette. Ma è importante esaminare il ciclo di vita e i passaggi della risposta agli incidenti IT per vedere cosa potrebbe o meno essere applicabile a I.C.S..
 Riferimento: http://www.enisa.europa.eu/activities/cert/support/baseline-capabilities/ics-cerc/good-practice-guide-for-certs-in-the-area-of-industrial-control- sistemi
 http://www. first.org/conference/2008/papers/killcrece-georgia-slides.pdf

© 2021 Robert M. Lee 21 passaggi tradizionali della risposta agli incidenti IT

¢ Preparazione:
* Preparare l'ambiente, il team, gli strumenti e lo scopo Identificazione/Rilevamento:

* Rileva che si è verificato un evento che ha raggiunto una soglia
|
|
| se io

* Analizzare cosa ha causato l'incidente Contenimento:

* Contenere l'eliminazione delle intrusioni e del malware:

* Elimina il ripristino del malware:

* Ripristino dei backup, nuova installazione sui sistemi, ecc. Lezioni apprese Attività post-incidente:

¢ Annotare le lezioni apprese e osservare le reinfezioni Rif: NIST 800-61rev2
 I.C.S.515S | I.C.S. Visibilità, rilevamento e risposta 22
 Tradizionalmente, la risposta agli incidenti consisteva nel preparare, identificare/rilevare, contenere, sradicare, recuperare e quindi eseguire le lezioni apprese in attività post-incidente come scrivere le lezioni apprese, pubblicare informazioni almeno internamente e monitorare la rete per eventuali reinfezioni. Questa è una grande responsabilità per un team di risposta agli incidenti. Mantenere e mantenere personale esperto in tutti questi talenti è costoso e difficile. Questo è esattamente il motivo per cui molte aziende scelgono di esternalizzare le proprie esigenze di risposta agli incidenti principalmente ad aziende esperte. Tuttavia, alcuni di questi compiti sono separati in ACDC. Ad esempio, rilevare ed eseguire il primo livello di analisi di un incidente è compito del personale addetto al monitoraggio della sicurezza della rete. L'identificazione delle modalità per contenere ed eliminare il malware è responsabilità del team di manipolazione delle minacce e dell'ambiente. Il ripristino è in gran parte il ruolo degli ingegneri per garantire che i sistemi rimangano online e tornino online in modo appropriato. Ma ciò non lascia molto spazio a disposizione per la risposta agli incidenti da "fare"; tuttavia, c'è molto lavoro non visualizzato accuratamente da questi passaggi.
 22 © 2021 Robert M. Lee
 Ww
 VT FD HMM WO noi

"rv www www Ww P
 w
 wv 7 © eo ww noi wewewoe ww wo wy
 va
 Sartoria necessaria per I.C.S.
 Conformità Legale Affidabilità Fornitori governativi
 Raccolta di sistemi di sistemi di dati univoci legacy
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 È necessario adattare il modello tradizionale di risposta agli incidenti per I.C.S. e allo stesso modo per il modello ACDC. È improbabile che nella maggior parte delle aziende ci sia un team di risposta agli incidenti a grandezza naturale, per non parlare di I.C.S. organizzazioni. Nell'I.C.S. nello specifico, la regolamentazione, la conformità e i requisiti legali entrano in gioco in un modo che normalmente l'IT non è tenuto a sperimentare. Infine, il proseguimento sicuro delle operazioni è una priorità, mentre nel settore IT è più accettabile disattivare i sistemi nella maggior parte degli scenari. Inoltre, c'è un certo senso di tempestività in un incidente che viene evidenziato molto bene in I.C.S..
 In poche parole, è inefficace copiare e incollare metodologie informatiche su I.C.S. risposta all'incidente. Tuttavia, è altrettanto inefficace ignorare i processi e le metodologie valide dell’IT semplicemente perché sono IT e non OT. È nostro dovere personalizzare la metodologia di risposta agli incidenti per I.C.S..
 I.C.S. Sfide di risposta agli incidenti
 Nel tentativo di raggiungere lo scopo di I.C.S. risposta agli incidenti, è importante notare le sfide. Innanzitutto, ci sono poche pratiche pubbliche effettive utilizzabili da coloro che eseguono la risposta agli incidenti. Ci sono un sacco di brave persone nell'I.C.S. comunità che hanno provato a condividere informazioni, ma in gran parte si è trattato di un livello estremamente elevato e in un campo estremamente giovane. Inoltre, con le normative e le ragioni legali che complicano gli incidenti, non ci sono molti casi di studio da valutare pubblicamente.Un'altra sfida sono i dispositivi legacy e le apparecchiature sul campo: raramente dispongono di registrazione e molti degli script e degli strumenti da utilizzare nella risposta agli incidenti IT non funzionano con i sistemi legacy.
 Un’altra grande sfida è prepararsi in anticipo. Quando i budget sono limitati e la missione sono le operazioni, la sicurezza digitale di solito passa in secondo piano. Da qualche parte nella parte posteriore dell’autobus, molto indietro rispetto alla sicurezza digitale, si trova il luogo in cui si trova la risposta agli incidenti. Tuttavia, la risposta agli incidenti richiede che la maggior parte del lavoro venga svolto in anticipo: la preparazione in anticipo. Le persone sono impegnate, la missione ha la priorità e i budget non supportano il personale che ha tutto ciò che desidera. Spesso è una sfida comprensibile, ma è una sfida.
 Una delle sfide più frustranti è rappresentata dai sistemi operativi e dai protocolli proprietari non documentati/sconosciuti
 utilizzo. L'oscurità non è un metodo adeguato per la sicurezza. Se non riesci a comprendere i tuoi sistemi e le loro comunicazioni,

© 2021 Robert M. Lee 23
 23
 è improbabile che abbia senso per te durante un incidente. Ciò rappresenta una sfida seria e, durante un incidente, uno degli unici modi per rimediare è avere un piano in anticipo per interagire con i vari fornitori dell'I.C.S..
 I requisiti del NERC richiedono che i dati degli eventi vengano archiviati in qualche modo, solitamente allo scopo di ricreare l'evento. I dati potrebbero non essere utili in un'indagine forense, ma dovresti essere consapevole che tali requisiti lo sono
 esistere.
 Riferimento: https://ics-cert.us-cert.gov/sites/default/files/recommended_practices/Forensics_RP.pdf
 24 © 2021 Robert M. Lee Ss & &F& SF &F S&F wevweewe wweeeeoewuwweeeo ww Ww WW
 Scopo dell'I.C.S. Risposta all'incidente
 Mantenere operazioni sicure e affidabili:
 Ciò include portare le informazioni provenienti dalla risposta agli incidenti all’attenzione dei decisori per determinare se e quando le operazioni debbano essere ritardate, se non del tutto
 Acquisire dati forensi significativi:
 Le minacce che si presentano a uno di noi riguardano tutti; è fondamentale raccogliere dati forensi validi in modo che l'analisi possa essere eseguita successivamente per determinare se si tratta di un attacco mirato, come difendersi in futuro, se è veramente
 scomparsi e se condividere tali informazioni con altri
 Eseguire analisi tempestive:
 Il personale addetto alla risposta agli incidenti non è responsabile dell'analisi forense e dell'interazione con la minaccia, ma deve identificare la portata della compromissione e il tipo di minaccia da affrontare per gestirla. Contenere ed sradicare le minacce:
 Contenere e quindi eliminare le minacce in un ambiente fa parte delle principali attività di risposta agli incidenti
 scopo; sebbene, nell'I.C.S. probabilmente ciò avverrà in gran parte grazie all'aiuto di ingegneri e architetti di sistema che reinventano, reinstallano e riconfigurano
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S. 2
 Con tutti questi processi di pensiero sull'IT rispetto a I.C.S. in mente, è tempo di esaminare il vero scopo della risposta agli incidenti in un sistema I.C.S. ambiente. Ciò può cambiare da organizzazione a organizzazione ed è in gran parte determinato dai requisiti stabiliti in anticipo. In generale, le priorità principali sono:
 1. Mantenere operazioni sicure e affidabili. 2. Acquisire dati forensi significativi.
 3. Eseguire un'analisi tempestiva.
 4, contenere ed eliminare le minacce.
 Contenimento ed eliminazione sono in cima alla lista nell'IT ma in basso nell'elenco dell'I.C.S.. Sì, vogliamo che il malware scompaia, ma al sicuro
 e le operazioni affidabili sono il numero 1. La capacità di ottenere dati per determinare se esiste una tendenza è ciò che fa vincere la guerra, non il combattimento, e quindi comprendere accuratamente la portata della minaccia per supportare i punti 1-3 sono la chiave. Il punto 4 è vitale, ma è l'ultimo.

© 2021 Robert M. Lee 25 I.C.S. Passaggi di risposta all'incidente

° Preparazione:
» Uguale all'IT tradizionale ma spesso più approfondito, compreso il contatto con le dipendenze (pari I.C.S., FBI, I.C.S.-CERT, eic.) e il test di strumenti/metodi in un laboratorio.
¢ Rilevamento e identificazione integrati:
* Collaborare con il team NSM per far sì che implementino regole e capacità di rilevamento su misura per la minaccia per identificare tutti i sistemi interessati (NSM rileva che si è verificata una minaccia: IR dovrebbe collaborare con NSM per individuare tutti gli impatti).

* Acquisizione di prove:
*InI.C.S. spesso non c'è abbastanza tempo per fare analisi forensi approfondite; l’attenzione dovrebbe concentrarsi sul mantenimento delle operazioni, acquisendo allo stesso tempo prove sufficienti per eseguire successivamente analisi forensi significative.
¢ Analisi temporale critica:
* L'uso di tecniche rapide e ben testate per determinare rapidamente l'impatto complessivo sulle operazioni, il tipo di minaccia affrontata, ecc., che potrebbe portare a ulteriori rilevamenti o al tipo di agenzie/gruppi esterni che devono essere coinvolti.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Una volta definito lo scopo e comprese le sfide, possiamo esaminare i passaggi effettivamente consigliati. Questo è solo un modo per rispondere agli incidenti, ma è stato ben praticato e utilizzato in I.C.S. Prima.
 Preparazione: è la stessa dell'IT tradizionale ma in modo approfondito per comprendere le dipendenze, i PoC di altri team, test estremamente intensivi degli strumenti prima del loro utilizzo e così via.Rilevamento e identificazione integrati: il personale NSM dovrebbe identificare il momento in cui si verifica un incidente, ma il suo lavoro non finisce qui. Se l’ACDC viene eseguito correttamente e ponendo l’accento sulla precisione e sulla velocità, il personale NSM dovrebbe supportare gli operatori di risposta agli incidenti prendendo informazioni dal team di risposta agli incidenti e applicandole al monitoraggio della rete. Questo aspetto verrà esplorato un po' più in profondità più avanti in questa sezione.
 Acquisizione di prove: l'analisi forense digitale e l'analisi approfondita non sono una priorità per mantenere i sistemi in funzione. Ma senza dati forensi reali, non si impareranno lezioni e la storia si ripeterà. Inoltre, le prove sono necessarie per un’analisi tempestiva.
 Analisi temporale critica: nota anche come "analisi tempestiva", questo è il metodo utilizzato (come l'utilizzo degli IOC).
 analizzare rapidamente le prove acquisite per determinare la portata di un incidente e cosa si può fare per preservare la sicurezza delle operazioni e/o formulare raccomandazioni su come contenere o sradicare la minaccia.
 26 © 2021 Robert M. Lee
 26
 TPM wD HW HM WH WS HW
 ww ww
 ww Ww ww Ww
 Ww © ow
 jw
 iw
 eo ue we wee we ew se es we wwewweWwe eee wv wo & Ww
 Attività supportate da I.C.S. Risposta all'incidente

¢ Condivisione delle informazioni:
* Le prove dovrebbero essere trasmesse al team di manipolazione delle minacce e dell'ambiente (Sezione 4) per avviare un'analisi approfondita e determinare ulteriori informazioni.
* Informazioni che devono essere segnalate all'I.C.S. per motivi di conformità, sicurezza o informazioni utilizzabili. la comunità deve essere condivisa durante la risposta agli incidenti.
* Contenimento:
* Preservazione delle operazioni impegnandosi attivamente con l'infrastruttura attraverso la collaborazione con il team di manipolazione delle minacce e dell'ambiente (Sezione 4) e con gli ingegneri e gli operatori dei sistemi
(combattere attraverso l'attacco).
¢ Eradicazione e Recupero:
* Neutralizzare la minaccia reinventando i sistemi, reinstallando software noto come valido, implementando patch, ecc.
* Il recupero avviene quando tutto torna alla normalità al 100%.
* Lezioni imparate:
* Documentare i risultati per tutti e trasmettere le informazioni al team NSM per vigilare sulla reinfezione.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Queste azioni sono quelle supportate dal personale addetto alla risposta agli incidenti ma spesso non vengono eseguite da sole come le fasi di risposta agli incidenti. La condivisione delle informazioni con altre strutture può essere un'informazione tempestiva di prima analisi, ma realisticamente alla fine si evolverà in lezioni apprese dall'intero processo ACDC e incorporerà lezioni apprese a livello I.C.S. che possono essere utilizzate sia internamente che esternamente.
 Il contenimento è supportato dalla risposta agli incidenti, ma di solito fa molto affidamento sull'analisi e sull'interazione del team con la minaccia. Il contenimento della minaccia, come modifiche dell'architettura o aggiornamenti del sistema, viene eseguito da architetti e ingegneri. Gli operatori che rispondono agli incidenti non dovrebbero apportare modifiche alla rete al volo (nella maggior parte dei casi).
 Anche l’eradicazione e il ripristino rappresentano uno sforzo congiunto e guidato dai team di risposta agli incidenti e dai team di manipolazione delle minacce e dell’ambiente, ma si affidano anche a ingegneri e architetti.
 Le lezioni apprese sono più specifiche della condivisione delle informazioni. La condivisione delle informazioni è tutto ciò che può essere utile alle persone all'interno o all'esterno dell'organizzazione. Le lezioni apprese hanno in realtà lo scopo di evidenziare le migliori pratiche, le cose che non sono andate secondo i piani e così via, che possono essere utilizzate internamente all'organizzazione. Anche questi possono essere condivisi, ma di solito sono molto più specifici della condivisione iniziale delle informazioni.

© 2021 Robert M. Lee 27
 cu
 ersus I.C.S. Esempio di risposta all'incidente: Utilità senza nome

¢ Infiltrazione nella rete del sistema di controllo
¢ Sistemi multipli infetti

+ Acquisizione di immagini digitali eseguita
¢ Raccolta di prove e campioni
¢ Rilevato malware accidentale che non si diffonde
 Aveva un piano relativo all'escalation. Monitoraggio del malware per garantire che non vi fosse alcun impatto
(8 « Ripulito al prossimo tempo di inattività programmato
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 L'utilità rimane senza nome per una serie di ragioni (principalmente la sua privacy), ma esiste un buon caso di studio sulla risposta agli incidenti che può essere condiviso in modo responsabile per evidenziare dove I.C.S. la risposta agli incidenti è diversa dalla risposta agli incidenti IT.
 In questo caso, l'utility ha identificato la presenza di malware nella rete del sistema di controllo. Tuttavia, il malware non ha influenzato il processo. Attraverso una rapida analisi, il personale dell'utility ha capito che il malware, nel peggiore dei casi, stava inviando beacon dalla rete dicendo "Eccomi" all'avversario. Lo hanno monitorato per assicurarsi che l'avversario non tentasse di accedere all'ambiente e di manipolare i sistemi, ma non tentava nemmeno di pulire i sistemi. Hanno adottato una risposta matura e equilibrata caratterizzando la minaccia, individuando le loro esigenze e aspettando fino al successivo periodo di inattività programmato per eliminare il malware dalla rete. Hanno analizzato vari scenari per determinare se fosse arrivato il momento di interrompere le operazioni e cosa sarebbe successo se ciò fosse accaduto, ma erano preparati.Non è stato fatto alcun danno; non c'è stata una perdita. Vinci per l'utilità.
 28 © 2021 Robert M. Lee
 TTT PWM WSP WM WM WW w w
 rww ww
 ww Ww ww Ww
 wom oo wo oF wo HS Uwe wewewweFeweesewoeewwewevweewee#e#e#e we wv & w
 Terminologia

* Immagine digitale:
* Copia digitale delle risorse di un sistema come disco rigido, file di registro, memoria, connessioni di rete e così via
* Raw: copia bit per bit incluso lo spazio non allocato e slack
* Logico: copia solo delle partizioni e dei file attualmente esistenti
¢ Hash:

* Funzione crittografica che funge da "impronta digitale".

« Qualsiasi modifica nel file con hash risulterà in un hash diverso e imprevedibile
* Catena di custodia:

* Documentazione che accompagna la prova che annota quali sono le prove, come sono state ottenute, dove sono state ottenute, chi le ha ottenute e ogni persona che è venuta in contatto con esse o ne ha avuto il possesso in qualsiasi momento

* Uno standard concreto per tutti i casi che portano in tribunale e un buon standard per le pratiche interne in generale
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Ogni campo ha il suo gergo. Nell'analisi forense digitale, tre termini comuni di cui devi essere a conoscenza sono immagine digitale, hash e catena di custodia. Probabilmente li hai già usati, ma vale la pena sottolinearli. Un'immagine digitale può essere un'immagine grezza, cioè una copia bit per bit, oppure può essere un'immagine logica, che è solo una copia delle partizioni attualmente esistenti. Per ottenere la maggior parte delle prove, raccogli un'immagine grezza; ma per ottenere qualche prova in una situazione critica in termini di tempo, usa un'immagine logica. Un hash è un'impronta digitale e deve essere raccolto in varie fasi di raccolta e analisi per documentare le modifiche alle immagini. La Catena di Custodia aiuta a comprendere chi ha avuto accesso alle prove e quali erano le loro condizioni, hashish, ecc. lungo il percorso. La catena di custodia è molto più spesso utilizzata nelle forze dell'ordine, ma è un buon standard a cui attenersi.
 Lo scopo Lo scopo dell'acquisizione di prove digitali come un'immagine del disco rigido, chiavi di registro, memoria, dati di processo e così via, è quello di consentire l'esecuzione dell'analisi forense in un secondo momento:
¢ Come notato in precedenza, nel caso I.C.S., è particolarmente critico e le minacce affrontate sono spesso gravi se prese di mira.
¢ Le prove forensi sono fondamentali per ricostruire esattamente ciò che è accaduto ed estrarre informazioni sulle minacce utili per l'analisi delle intrusioni e l'intelligence sulle minacce.
 La fase di risposta agli incidenti dell'ACDC non approfondisce l'analisi forense, ma verranno eseguite alcune analisi tempestive sulle prove acquisite, come illustrato più avanti in questa sezione.
* È probabile che esistano scenari in cui è preferibile pulire i sistemi e ripristinarli rapidamente piuttosto che preservarli per l'analisi forense; è quindi estremamente importante acquisire immagini digitali.
 Si tratta di un sito utile che fa riferimento a numerosi strumenti forensi digitali e alle funzioni che svolgono, con dettagli sui vantaggi di un approccio rispetto a un altro.
 Riferimento: http://en.wikipedia.org/wiki/List_of_digital_forensics_tools

© 2021 Robert M. Lee 29 Ordine di volatilità

* Quando si esegue l'acquisizione attraverso la raccolta di immagini digitali e traffico di rete, è necessario seguire l'ordine di volatilità L'ordine di volatilità è un modo per descrivere quali prove hanno maggiori probabilità di essere distrutte per prime L'ordine generale di volatilità è: contenuto nella cache e nel registro
 Informazioni di rete (tabelle di routing e cache ARP) Memoria*
 Processi di sistema
 File system temporaneo
 Dati sul disco rigido
 Dati registrati in remoto
 Dati sui supporti d'archivio
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 L'Ordine di Volatilità (OoV) è un approccio suggerito per acquisire prove digitali in base alla velocità con cui determinati tipi di prove decadono e perdono valore. Sii flessibile; la memoria di sistema è più volatile dei dischi rigidi del sistema, ma se un sistema importante sta per essere distrutto, raccogli i suoi dischi rigidi prima della memoria di un altro sistema. La quantità di dati forensi disponibili sui sistemi è enorme e la maggior parte degli analisti non ha idea di dove siano tutte le fonti o di come accedervi: può essere travolgente. Pertanto, la raccolta dei dati può essere uno degli aspetti più importanti in modo che altri possano elaborarli e utilizzarli in seguito. Rispettare l'OoV ti aiuterà a garantire di ottenere tutto.

*La memoria viene spesso posta al di sotto della maggior parte delle altre cose in termini di dati volatili, ma in pratica è sempre la prima cosa da raccogliere perché contiene gran parte delle altre informazioni (come le informazioni di rete) al suo interno.
 Riferimento: https://www.sans.org/blog/best-practices-in-digital-evidence-collection/
 30 © 2021 Robert M. Lee
 30
 om m2 A A ee ee ee
 AA
 Acquisizione locale e remota

(dovrebbe essere) eseguito | __" Certo
 ogniqualvolta _ condizioni possibili | Deve essere raggiunto
 L'acquisizione locale è Jan giustificarla più velocemente a Se :
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 L'acquisizione di prove da un sistema (di solito sotto forma di immagini digitali) è vitale per l'analisi in loco e futura.Negli ambienti normali, è comune scoprire che i sistemi dispongono di software preinstallato per consentire una rapida acquisizione digitale in remoto da un punto centralizzato come un Security Operations Center. In un I.C.S., è raro che sia consentito questo livello di preparazione (ma a volte è fattibile). L'acquisizione locale delle informazioni di sistema può essere eseguita in loco e di persona, in genere tramite CD o USB avviabili pretestati/preapprovati. L'acquisizione remota delle informazioni di sistema viene eseguita attraverso la LAN o la WAN (presso un sito locale o sul campo).

* L'acquisizione locale è più rapida e spesso più semplice; dovrebbe essere eseguito quando possibile
* L'acquisizione remota è lenta e occorre prima soddisfare alcune considerazioni

© 2021 Robert M. Lee 31
 31
 Considerazioni sul sistema remoto
 Questa azione può essere igata? La rete La larghezza di banda remota è supportata? su questo ee operazioni
 Quindi acquisire prove remote: : ( pipì e.
 I.C.S.515 | |Visibilità, rilevamento e risposta del CS 32
 Ci sono alcune considerazioni che devono essere prese in considerazione prima di eseguire l'acquisizione remota. Ad esempio, in un I.C.S. distribuito a livello globale, potresti avere un sito in Europa mentre conduci le indagini negli Stati Uniti: esistono leggi che vietano ai cittadini extracomunitari di raccogliere tali prove. In quella situazione, devi avere qualcuno in Europa che sia un cittadino che raccolga quelle prove, anche se si tratta dei sistemi della tua azienda. Inoltre, il sistema rientra nell’ambito dell’indagine? A causa del tempo, dello sforzo e di qualche piccolo rischio legato alla raccolta di prove del sistema remoto, è necessario giustificarlo. In definitiva, è necessario considerare i tempi di attività, le considerazioni sulla larghezza di banda, i costi associati ai dati recuperati attraverso sistemi come VSAT (Very Small Aperture Terminals) e se il rischio vale la ricompensa. Il rischio è difficile da determinare senza testare in anticipo, il che è un altro buon motivo per prepararsi e fare pratica.
 32 © 2021 Robert M. Lee
 vv ww w
 Tw OOO OT Ow MW wT w
 vw @ @ @& noi Ss noi noi noi ww noi noi wo WH noi WH WY Ww OS BS BS Se BS Se SS noi
 vy
 Preparazione del sistema remoto
 Preposizionare indicare il fornitore: il software con le raccolte approvate è = operativo e testare quando: curato e il software possibile utilizzato correttamente
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 DD e Netcat possono fare molto per l'acquisizione remota, ma questo processo può essere doloroso per molti analisti. Se è possibile posizionare il software in anticipo per effettuare la raccolta, è preferibile, ma assicurati che non ci siano problemi di conformità nel farlo. È anche importante stabilire esattamente cosa è necessario per determinare l’impatto sulle operazioni o sulla rete per ottenere le prove. Nelle prossime diapositive, esamineremo alcuni strumenti di sistema remoto.
 Prima di iniziare l'acquisizione, determinare esattamente cosa è necessario: ad esempio, è necessaria un'immagine dell'HDD o inizialmente solo la memoria? L'acquisizione remota avverrà probabilmente su reti con un sovraccarico di larghezza di banda minimo, quindi è importante acquisire solo ciò che è necessario inizialmente e prenderne di più quando necessario.
 I.C.S. Negli ambienti raramente è installato un software di acquisizione digitale remoto, quindi è preferibile l'utilizzo di strumenti comuni e leggeri: la combinazione di DD e Netcat (discussa in alcune diapositive) è un modo perfetto per raccogliere un'immagine digitale attraverso una WAN o LAN, utilizzando open source e strumenti leggeri. utensili.
 Se possibile, contattare qualcuno presso il sito remoto per monitorare il sistema per garantire che non vi siano impatti negativi o guasti software/hardware.
 Una buona maturità si ha quando si è in grado di preposizionare il software (protetto) per facilitare la raccolta.

© 2021 Robert M. Lee 33
 33
 Metodologia del sistema locale

¢ Quando si raccolgono prove digitali su un sistema locale, assicurarsi che: Gli strumenti da utilizzare siano stati testati su sistemi identici L'acquisizione sia stata coordinata con tutto il personale coinvolto Utilizzare un USB o un LiveCD per acquisire risorse (preferibilmente USB) Raccogliere tutte le prove se il tempo lo consente (Ordine di volatilità in caso contrario)
 Scatta foto del sistema se potrebbe essersi verificata una violazione fisica
 Se sullo schermo è presente qualcosa come prompt dei comandi o file, scatta una foto e non chiuderli a meno che non siano necessari per le operazioni
 Tutti i dati devono essere analizzati in una struttura approvata
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Quando si raccolgono prove digitali su un sistema locale, assicurarsi che gli strumenti da utilizzare siano stati testati su sistemi identici in un ambiente di laboratorio. Coordina l'acquisizione con ingegneri o operatori locali e, quando possibile, chiedi a qualcuno di essere presente come testimone delle tue azioni. Utilizzare un USB o un LiveCD (discusso in alcune diapositive) per acquisire risorse (preferibilmente un USB se accettabile in loco). Poiché si tratta di un sistema locale, se hai motivo di acquisire informazioni dal sistema, raccoglile tutte se il tempo lo consente: ad esempio, ottieni un'immagine digitale dell'intero sistema inclusa memoria, processi e HDD. Inoltre, se potrebbe essere coinvolta una violazione fisica del sistema, scattare foto del sistema e di come è cablato e configurato.Nello specifico, se sullo schermo è presente qualcosa come prompt dei comandi o file, scatta una foto e non chiuderli se non strettamente necessario per il proseguimento delle operazioni: potrebbero essere utili per capire cosa è successo sul sistema. E ricorda, tutti i dati devono essere conservati in loco senza lasciare nulla nell'area o in un'altra struttura approvata: non deve essere effettuata alcuna analisi a domicilio.
 Nelle prossime diapositive discuteremo come raccogliere le prove e nella sezione successiva discuteremo il valore dei diversi tipi di prove. (Questo è in parte necessario per poter avviare il laboratorio, il che può richiedere del tempo.)
 34 © 2021 Robert M. Lee
 34
 ww w&
 TT TT DW WM GW DMD WM WM WD

|
 vv 7 UF vw wo we © & &F & HS &
 eravamo noi
 oD ae “se ae td “s ae o ap o ww wy
 USB e LiveCD

* Poiché è difficile, e talvolta non consentito, preinstallare il software di imaging digitale, si consiglia vivamente di utilizzare USB o LiveCD puliti, approvati e testati

* Le unità USB consentono l'esecuzione del software di imaging digitale direttamente dall'USB:

* Pro: consente al gestore dell'incidente di eseguire il software dall'USB invece di installare il software sul computer della vittima; Il Principio di Scambio di Locard entra in vigore, ma l'eseguibile
 viene eseguito in memoria (perdita di memoria senza impatto sul sistema)
* Contro: è una USB e quindi potrebbe non essere consentita; inoltre, le unità USB su un sistema creano nuovi valori di chiave di registro e possono diffondere infezioni (se si utilizza USB è un dispositivo unico)

* I LiveCD consentono di avviare un nuovo sistema operativo dall'avvio del sistema senza installare il sistema operativo o eseguire software dal CD per l'analisi del sistema live:

* Tieni presente che esistono LiveCD, ma generalmente non sono consigliabili in un I.C.S. ambiente in particolare con l'opzione più potente di raccogliere memoria di sistema
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Le USB non sono sempre consentite in I.C.S. per buone ragioni. Tuttavia, un'unità USB pulita dal punto di vista forense può rappresentare un'ottima risorsa per un'indagine. I LiveCD hanno spesso molti impatti negativi; nella maggior parte dei casi, consumano molta memoria del sistema, il che distrugge una delle prove più preziose.
 Un whitepaper SANS sui pro e contro dell'utilizzo di diversi LiveCD è disponibile all'indirizzo http://www.sans.org/reading-room/whitepapers/incident/pros-cons-linux-windows-live-cds-incident-handling-forensics -1706.

© 2021 Robert M. Lee 35
 38.
 Software di acquisizione digitale
 Redline e Memoryze dd e LiME

* Strumenti da riga di comando per la memoria ¢ Strumenti da riga di comando basati su Linux
¢ Redline non può eseguire un'immagine disco completa ¢ La memoria LiME è e dd è un disco pieno ma raccoglie anche alcune stringhe/dati ¢ Supporta la raccolta locale o remota (su TCP)
 FTK duplicato

* Strumento da riga di comando per la memoria * Strumento basato su GUI
¢ Sviluppato da MoonSols * Estremamente facile da utilizzare
* Costruito sulla versione Windows di dd * FTK può raccogliere l'intero disco o la memoria
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Sebbene la maggior parte dei software di imaging possa anche acquisire memoria di sistema live (come FTK Imager Lite), esistono strumenti di acquisizione della memoria specifici:
 Gli strumenti specificatamente progettati per l'acquisizione della memoria sono i migliori da utilizzare quando è certo che l'unica prova desiderata è la memoria di un sistema. Gli strumenti di raccolta della memoria solitamente non possiedono una GUI e possono essere interagiti solo tramite la riga di comando; ciò garantisce una perdita di memoria minima. La memoria di sistema è una delle forme più ricche di prove digitali con molte informazioni che possono essere raccolte rapidamente; come tale, verrà discusso approfonditamente in questa sezione.
 A causa dei requisiti di test in I.C.S., è spesso consigliabile attenersi a un unico strumento di raccolta (ad esempio, FTK Imager Lite o la suite Redline di Mandiant):
 Negli ambienti IT, utilizzare strumenti per scenari diversi ha senso, ma il sovraccarico aggiuntivo in I.C.S. per testare e comprendere gli impatti, limita la fattibilità.
 Memoria
 Memoryze è un altro ottimo strumento Mandiant gratuito; Il blog SANS di Chad Tilbury è una delle migliori risorse disponibili su come utilizzare Memoryze. In generale, viene eseguito dalla riga di comando e scarica la memoria su un'unità di output (solitamente un USB, ma può essere inviata attraverso la rete con Netcat) per l'acquisizione.
 Riferimento:
 https://www.fireeye.com/services/freeware/memoryze.html
 Blog SANS di Chad Tilbury: https://www.sans.org/blog/digital-forensics-how-to-memory-analysis-with-mandiant-memoryze/
 Dump
 MoonSols ha reso disponibile gratuitamente il suo strumento di acquisizione della memoria, Dumplt, alcuni anni fa, ed è un'ottima risorsa basata sulla versione Windows per dd. Come Memoryze, però, lo strumento funzionerà solo su sistemi Windows.
 36 © 2021 Robert M. Lee
 36
 momo. wh wh DH WwW WM WH WM WW WM HH ww w
 va bene,
 ren = @ es ee ww & & & & ww
 eh
 Video didattico dell'istruttore SANS Lenny Zeltser: http://www.moonsols.com/201 1/07/18/moonsols-dumpit-goes-mainstream/
 Lime
 Gli strumenti presentati finora in questo corso sono fortemente orientati a Windows perché sono gli strumenti che sono stati disponibili e ampiamente testati. Tuttavia, per i sistemi Linux, lo strumento nativo per le immagini logiche dell'unità fisica è dd.Per la memoria in Linux, un'ottima scelta è LiME. Nelle versioni precedenti di Linux, lo strumento dd poteva essere utilizzato contro la memoria a causa di dove era archiviata e di come vi si accedeva. Linux ha ulteriormente bloccato l’accesso allo spazio di protezione, rendendo più difficile l’acquisizione. LiME tenta di aggirare questo problema.
 https://github.com/504ensicsLabs/LiME
 dd Viene fornito di default sulla maggior parte delle distribuzioni Linux (come Ubuntu e Fedora). È estremamente potente; usalo correttamente o potresti cancellare l'unità.
 Di seguito sono riportate informazioni di esempio sui comandi: dove if = file di input, of = file di output, bs = dimensione in byte
 dd if=/dev/sdb1 of=/home/andrew/newimage.dd bs=512 conv=noerror,sync dove if = file di input (o in questo caso unità), of = file di output, bs = dimensione in byte, conv = opzioni di conversione
 Quello che segue è un comando tipico su un sistema Windows per utilizzare una versione eseguibile di dd con Netcat per inviare l'immagine attraverso la rete: dd.exe if=\\.\f: | nc 192.168.154.1 1234
 Sulla macchina di destinazione (ricevente): ne —I —p 1234 | dd <nome LiveCD>-<sistema operativo macchina>_data.img
 FTK Imager Lite
 FTK Imager Lite è probabilmente il software di acquisizione digitale più utilizzato. È gratuito, flessibile e rappresenta solo il minimo indispensabile in termini di dimensione del file, in modo da non avere un impatto negativo eccessivo sulle prove della memoria. È utile per raccogliere un'ampia gamma di prove da una macchina.
 Il software AccessData è costoso, ma FTK Imager Lite è gratuito. Scaricalo come file zip ed estrailo su una USB per l'installazione (il gioco è fatto). La guida per l'utilizzo è disponibile all'indirizzo: https://www.sans.org/blog/forensics-|01-acquiring-an- image-with-ftk-imager/
 Dati di rete Utilizzare gli strumenti e le metodologie della Sezione 2; non vi è alcuna differenza nell'acquisizione per IR e NSM in relazione
 alla raccolta in rete.
 Il personale di monitoraggio della sicurezza della rete dovrebbe già monitorare il traffico di rete, ma il personale di risposta agli incidenti dovrebbe aiutare a guidare le attività di raccolta dei sistemi chiave durante un incidente.
 Wireshark per acquisire e filtrare rapidamente il traffico di rete. TCPdump per l'acquisizione di pacchetti più approfondita e prolungata.

© 2021 Robert M. Lee 37 Avvio dell'imager FTK
 Strumenti applicativi
 Visualizza Gestisci
 Nome
 euEncypeon
 ESD adencrypt_gui
 adfs_globals.dll ADIseDLL.dil
 adshattrdefs.dil boost_date_time-vc100-mt-1_49.dll boost_filesystern-vc100-mt-1_49.dll boost_regex-ve100-mt-1_49.dil boost_system-vc100-mt-1_49.dll

} boost_thread-vcl00-mt-1_49.dll
 cximage.dil da7zip.dil Immagine FTK icudta4.dil icuucd4.dil
 IPC » Disco rimovibile (F:) » Imager_Lite_3.1.1
 Data modificata
 13:00 12:00 B12:00
 12:11:27 211:30 21:26 14:11:36
 1 1 1 11:11:15
 Bfla/2o12
 28/06/2011
 Imager_Lite_3]
 Tipo
 PPC OUUIT EXLEN Se Applicazione
 App
 L'applicazione si estende. L'applicazione si estende. tien extens... Applicazione extens. L'applicazione si estende. L'applicazione estende L'applicazione estende. L'applicazione si estende, Applicazione L'applicazione si estende...
 L'applicazione si estende...
 10, 14.521KB
 921KB
 Dopo che il file zip è stato estratto su una USB, è sufficiente collegare l'USB a un sistema Windows ed eseguire il file evidenziato
 fascicolo di domanda.
 38
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta

© 2021 Robert M. Lee
 38
 ahi w
 veo 7 7 7 7 Ow Ow OW WO DW
 mo @
 ahi
 onmn es wv wow wweewwewe #8 & &© & &
 Esecuzione dell'imager FTK
 Configurazione modifica progetto - Guida in lingua di monitoraggio dei registri di comunicazione
"Progetto corrente C:\users\root\Desktop|CYBATI_Labs\HMI\CybetiWorks-1 Trainer AccessData FTK Imager 3.1.1.8

? e io 53
 Aggiungi elemento di prova... j { te) ee | 2 Aggiungi tutti i dispositivi collegati
 Montaggio immagine...
 Jt DER RL@eaa
 6 Immagine del contenuto personalizzato
 Decrittografa l'immagine AD1... Yerify Drivestm: Cattura memoria. oncceeneneneand
 Ottieni file protetti... _a—iieeen—m—nn™ ee
 gi
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 39
 Si noti che è possibile creare immagini disco (dischi rigidi fisici), acquisire memoria e ottenere file protetti.

© 2021 Robert M. Lee 39 Informazioni sul caso Acquisito utilizzando: A0I3.2.0.0
 Inserito manualmente dall'esaminatore al momento dell'acquisizione
 Immagine FTK Imoger 3.2 del disco Cruzer USS Examiner: 3¥ Note: QUESTA è un'immagine del disco ohysicol
 Informazioni per C:\tnagel
 Prysical Evidertiary Ite= (Fonte) Informazioni
(Informazioni sul dispositivo} Tipo di origine: Phystcal
 teers, Se FTK Imager Metadata
 Tase per Sytinders 255 settori per traccia: 63 E I aycee pat ductors aa2 xample SOG write momuertaks
 Paura dei legami? Crase sersiana: ene eeilis
 Tipo di interfaccia Orive: USS Unità rimovibile: Veri hash crittografici
 Dimensioni della data di origine: 7657 We, calcolata sui dati sul conteggio dei settori 15662599 v disco in fase di imaging

(Hash calcolati] Checksum MOS: 341247 MGoDIDS Ive Te Meteo Vedi I2z SMAI checksum: QlalSeF#l lc@atETSSECTSOATS< "46672 OTROS
 Siege Tnorwertves Hash crittografici calcolati L'acquisizione inizia domenica 20 agosto ©9:52°53 204 sui dati nell'immagine appena creata. Acquisizione completata: domenica 1 agosto@ ©9:54-B8 2034 Verificato significa che l'hash di Elenco segmenti: co\teeged e l'immagine corrisponde all'hash del disco di origine.L'immagine è una copia identica di Image Verification Resules Vain. verificato
 Verifica iniziata: Dom 1 Ago@ ©9:38:09 ze14 Vertfico terminato: Dom 1 Ago@ @9:59:38 2016
 Checksum MOS 341.247 946nd IBS Sac Te So4e36amOe 122
 Checksum SHAL: SlalGef Si 1ceotG7ESbc#SORFS47496R7I74TIS4 © wert tt
 Rif: Sally Vandeven "Immagini forensi che guardano il piacere"; Sala lettura SANS
 I.C.S.515S | Visibilità, rilevamento e risposta I.C.S. 40
 Ecco un rapido esempio del tipo di informazioni che accompagna un'acquisizione digitale eseguita da FTK Imager. I metadati sono utili per verificare e comprendere il contesto delle prove digitali. Si è verificato in troppi casi in cui il personale ha perso traccia di dove e quando sono stati raccolti i dati. File di metadati come questo aiutano in questo.
 40 © 2021 Robert M. Lee
 Se
 eo mn wo ww w
 ww» w
 eo @~@ O68 DO HO Ww WD Ww ww Ww
 Considerazioni cruciali in termini di tempo
 Come evidenziato nel corso della giornata, vi è la necessità in I.C.S. risposta agli incidenti per concentrarsi sull'acquisizione digitale e quindi sull'analisi tempestiva L'analisi tempestiva consente ai decisori di comprendere la portata del problema e prendere decisioni su I.C.S. operazioni e sicurezza
 La sicurezza e le operazioni devono superare la normale mentalità di risposta agli incidenti e, a volte, le migliori pratiche
 L’analisi tempestiva viene utilizzata al meglio incorporando le informazioni della Sezione 1 e della Sezione 2 (intelligence sulle minacce e NSM) e dovrebbe concentrarsi prima sulla comprensione della portata del problema e poi sul tipo di problema
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta
 Lo scopo dell'analisi tempestiva è comprendere la portata dell'incidente e raccogliere tutte le informazioni forensi rilevanti
 dati provenienti dai sistemi infetti identificati. Inoltre, un'analisi rapida può rivelare il tipo di minaccia che si sta affrontando e
 trasmettere prove importanti e dati sulle minacce al team di manipolazione delle minacce e dell'ambiente. La combinazione degli sforzi può fornire ai decisori informazioni importanti sulla possibilità di continuare le operazioni.
 Considera i vantaggi di una risposta tempestiva derivanti dalla prequalificazione dei tuoi team di risposta agli incidenti sulle procedure di sicurezza richieste e sui requisiti di formazione delle varie strutture.
 Utilizzo di Asset Discovery e NSM in IR
 Il personale NSM dovrebbe essere considerato lo scout dei soccorritori in prima linea in caso di incidenti. Man mano che i dati vengono passati avanti e indietro al team, il ciclo ACDC accelera verso iterazioni del ciclo sempre più veloci. Le informazioni diventano più snelle e l'analisi diventa più efficace.
 Una parte significativa del tempo impiegato in qualsiasi indagine sulla risposta agli incidenti è dedicato all'acquisizione di un diagramma di rete accurato e all'identificazione dei sistemi critici.
 La fase Asset Discovery e NSM dell'ACDC dovrebbe avere questi documenti per lo più aggiornati e pronti per l'uso nella risposta agli incidenti.
 Identificare le differenze nel traffico di rete corrente e nei dati di flusso rispetto alle mappe conosciute è un modo semplice per identificare rapidamente le minacce. :
 Man mano che gli sforzi di risposta agli incidenti scoprono maggiori informazioni sulle anomalie e sulle minacce, queste informazioni possono essere trasmesse a coloro che eseguono NSM per stabilire regole IDS e concentrare gli sforzi sull'identificazione di infezioni nuove e ricorrenti:
 Il personale NSM è per molti versi una sorta di scout per gli operatori di prima linea che rispondono agli incidenti.

© 2021 Robert M. Lee 41 Informazioni di base, database e whitelist
 ti 3 F ‘ F Raccogli dati da. Maggiori sono le informazioni di base disponibili, più veloce sarà l'ambiente
 la risposta all'incidente andrà: avanti rispetto a un
+ Le informazioni di base, come risorse e software, ovvero inventario non identificato e dati sul flusso di rete, riducono drasticamente lo sforzo e il tempo necessari per la risposta agli incidenti
* Collaborare con NSM e i team di architettura prima di: z garantire che questa linea di base esista e sia aggiornata Creare ee ood Avere un database accessibile e salvaguardato di informazioni di base di 'ghee hae bee, hash digitali del software "ete. installato nell'ambiente di controllo, è vitale; Sviluppa whitelist basate su processi, file e applicazioni in esecuzione nell'ambiente I.C.S. Lac inne te Whitelist interne > le whitelist esterne non possono essere convalidate
. Le whitelist esterne sono un buon punto di partenza, ma l'obiettivo dovrebbe essere l'internalizzazione del processo
 dovrebbe essere
| ispezionato ulteriormente
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Le informazioni di base estendono i dati di rete passati per includere file, hash, topologie e altro ancora che compongono una rete e i suoi sistemi. Avere accesso a un database protetto può significare una drastica riduzione dello sforzo e del tempo
 necessari a un team di risposta agli incidenti.
 Per molti ambienti *nix, uno strumento interessante da considerare è AIDE. Disponibile su SourceForge, AIDE (Advanced Intrusion Detection Environment) è un controllo dell'integrità di file e directory.
 Le whitelist nella risposta agli incidenti spesso assumono la forma di file o raccolte di hash digitali: consentono agli analisti di ignorare rapidamente file e software noti.
 Pre-incidente: crea e mantieni una whitelist di hash digitali per velocizzare la risposta agli incidenti ed essere in grado di individuare il male.
 Quando si crea una whitelist, soprattutto per un I.C.S. ambiente, cerca di interiorizzarlo il più possibile.
 Sebbene WhiteScope e NSRL (discussi nelle prossime diapositive) possano essere buone risorse per iniziare o integrare l'impegno, tieni presente che non possono rappresentare il 100% del software presente in ogni I.C.S..
 42 © 2021 Robert M. Lee
 UN
 2.) © DT OD Ww ow
 o ese ese ee ee we Ve ee eeweeet wes w&
 ww 4
 aa
 NSM all'IR
 Cosa potrebbe
 Identificare. cosa mi è importato
 è stato trovato dentro
 che attività di rete eoni?
 Scansione in fase di Beaconing? il network? Cerca gli IP o Cerca i domini sull'host dei processi. comunicare in rete.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Quando esamini l'host, inizia con ciò che hai trovato durante NSM. È in corso una scansione dannosa? Quindi c'è un processo su quel sistema che comunica con la rete che può essere trovato. Trova il processo e potrai scoprire cosa lo ha avviato. Cosa ha fatto l'utente, qual era il vettore dell'infezione e così via. Stabilire un punto di partenza e quindi tirare la corda per scoprire attività correlate e attività dannose.
 Una volta identificato un punto di partenza, è importante sviluppare una sequenza temporale delle attività. Cerca lungo la sequenza temporale delle tue attività (tenendo conto del modello di catena di uccisione illustrato nella Sezione 1) cosa avrebbe fatto l'avversario prima o dopo la comparsa di quell'attività anomala. Se si tratta di un processo dannoso, a un certo punto è stato installato qualcosa nel sistema. Se è stato installato, a un certo punto qualcosa ha sfruttato il sistema o ha sfruttato qualcuno tramite ingegneria sociale. Ad un certo punto è stato rilasciato nell'ambiente,

© 2021 Robert M. Lee
 43
 UN
 Utilizzo dell'intelligence sulle minacce nell'IR
 CC7
' ¢ Valuta rapidamente
 sistemi dopo la pulizia
 Da utilizzare per garantire che le minacce scompaiano dopo l'IR
 TTIP per identificare” gli sforzi degli avversari

|

| «Capire dove
| le minacce lo farebbero

| obiettivo e come

_lo farebbero

+ Valutare innanzitutto i sistemi prioritari e convalidarne il maggior numero possibile

+ Passaggio osservato | ospitare dati relativi alla rete per le persone NSM
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 La risposta agli incidenti è il momento in cui vediamo il modello ACDC iniziare a prendere vita. Le informazioni provenienti dal NSM si attivano
 risposta all'incidente e funge da scout durante l'incidente. L'intelligence sulle minacce consente di individuare e cercare rapidamente le minacce nell'ambiente. Porta anche allo sviluppo di regole NSM per assistere la risposta agli incidenti. È un autoalimentarsi
 ciclo per garantire che la minaccia sia completamente identificata e risolta. I IOC rappresentano un ottimo modo per rendere l'intelligence tattica sulle minacce utilizzabile dagli operatori che rispondono agli incidenti. Lo sviluppo del CIO viene effettuato nella Sezione 4, ma la capacità di farlo
 utilizzare gli IOC è sicuramente una funzione di tipo risposta agli incidenti.
 Una buona intelligence sulle minacce dovrebbe includere IOC per uso tattico:
 Spesso utilizzato da NSM nella progettazione e implementazione delle firme IDS Utile per l'analisi a livello di sistema; I COI forniscono l’analisi rapida definitiva
 Il personale che utilizza l'intelligence sulle minacce dovrebbe cercare 1OC dagli addetti alla manipolazione delle minacce interne e dell'ambiente e dalle fonti esterne di intelligence sulle minacce e feed di minacce:
 Lavorare a stretto contatto con coloro che utilizzano l'intelligence sulle minacce per fare in modo che i COI e il contesto rispondano a domande come: "Quanto è grave
 di una minaccia è il CIO se risulta positivo?"
 Gli IOC basati sulla rete, come gli indirizzi IP e i dati di flusso, sono utilizzati al meglio dal personale NSM, mentre gli IOC di sistema, come gli hash digitali di software dannoso, possono essere utilizzati nelle regole e negli strumenti YARA come Redline di Mandiant.
 44 © 2021 Robert M. Lee
 44
 ehm? mamma mia @ OM DO @ &
 oOo @ @® © Dw
 oh mm &
 UN.
 aa
 w ww wwe wwe wwe & noi & &
 vedere wv vw vs vs vw w&
 Esempio di risposta ad un incidente: botnet Mariposa

+ Ottobre 2012 Azienda elettrica infetta
 1 ¢ * Botnet Mariposa sulla rete di controllo delle turbine

‘Risponde ° 10 computer compromessi; Guida inviata dal CERT
 e.a

¢ L'analisi della chiave di registro ha identificato l'USB originale
* L'identificazione dell'USB ha aiutato a individuare l'infezione
¢ Guida in outsourcing a società IT senza I.C.S. esperienza ,

* Tre settimane di inattività per i sistemi infetti
* Avrebbe potuto avere un impatto molto più grave
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Come ultimo caso di studio, la botnet Mariposa fornisce un buon esempio di malware informatico "tradizionale" che finisce in un sistema I.C.S. ambiente. Il team ha adottato un ottimo approccio chiedendo aiuto all'I.C.S.-CERT, ma il problema crea un ritardo di tre settimane nel riavvio dell'impianto. Inoltre, il vettore iniziale dell’infezione era una chiavetta USB utilizzata da un tecnico e avrebbe potuto essere evitato. Quando il malware ha iniziato la scansione alla ricerca di sistemi da compromettere, un team NSM se ne sarebbe accorto e avrebbe indirizzato il personale addetto alla risposta agli incidenti nella giusta direzione per cercare ed eliminare il malware. Se il malware è ben noto e sembra trattarsi di un'infezione accidentale, è del tutto normale non seguire uno scenario completo di risposta all'incidente. La NSM per la bonifica è opportuna ma deve essere decisa in anticipo con i requisiti e le soglie di risposta.

© 2021 Robert M. Lee 45
 45
 SR A NL EI NT AU SE IE OT ETI I
 Laboratorio 4.1 Acquisizione in ambiente operativo
 I.C.S.515 | |Visibilità CS, rilevamento e risposta 46
 
 46 © 2021 Robert M. Lee
 7mm © OM OOM OO OO -

®
 Tee? ®®
 7 ow wvewewe we &
 woo oh ww
 wp4D

“ci sentiamo) «p “ww «“p ws SF PP wp

“ow
 Preparazione di un I.C.S. Squadra di risposta agli incidenti
 Determinazione dei requisiti Determinazione delle dipendenze Sviluppo del team
 Costruire il tuo laboratorio in-house o in outsourcing
 Piattaforme forensi
 Migliori pratiche di risposta agli incidenti
 I.C.S.$515 | I.C.S. Visibilità, rilevamento e risposta
 1CS410 ha trattato la discussione di alto livello sulla risposta agli incidenti, ma ci sono alcuni punti che vale la pena sottolineare. Questa è una sezione relativamente breve ma fornisce alcuni consigli di alto livello che è importante tenere a mente quando si crea e si mantiene un team di risposta agli incidenti.

© 2021 Robert M. Lee
 47
 a7
 Determinazione dei requisiti e delle dipendenze

* Quali sono i tuoi requisiti in termini di uptime, disponibilità di sistemi specifici, ecc.

* Questi determinano come dovrebbe essere il tuo atteggiamento di risposta agli incidenti

* Determinare le dipendenze chiedendo alla direzione e al personale in loco
"cosa succede se" e "chi è responsabile di?", ad esempio:

¢ "Cosa succede se questa struttura crolla completamente?"

* "Chi è responsabile della sicurezza pubblica in caso di incidente?"

* "Cosa succede se il SIS va offline?"

*Le dipendenze possono incidere sia sul sito interessato che sui siti non interessati:

* Determinare le dipendenze dell'infrastruttura in loco, ad esempio l'impatto di un Data Historian sul processo se va offline (anche se la risposta è nessuna, documentarlo)

* Essere buoni vicini determinando i requisiti dell'infrastruttura connessa, indipendentemente dal fatto che sia logicamente o fisicamente influenzata da tempi di inattività o violazioni
 I.C.S.515 | Visibilità, rilevamento e risposta dell'I.C.S. 48
 Dipendenze per un I.C.S. può variare da insignificante a importante a livello nazionale. Qualunque siano le dipendenze per la tua organizzazione, assicurati di identificarle, tenerne conto e far loro sapere che lo hai fatto. Ad esempio, se esiste un'infrastruttura che dipende dalla tua in siti non gestiti dalla tua organizzazione, è importante che loro sappiano cosa ti serve da loro in caso di incidente o cosa farai in modo che anche loro possano pianificare. Le dipendenze possono anche essere legate alla regolamentazione o specifiche del fornitore. I requisiti per il team di risposta agli incidenti determinano come viene sviluppato, di cosa è equipaggiato, come pianifica e forma e, in definitiva, quale responsabilità ha.
 Prestare attenzione alle leggi statali e federali, nonché alle normative relative alla perdita di dati, I.C.S. compromesso e altro ancora: ad esempio, i proprietari di asset del settore energetico hanno requisiti obbligatori di segnalazione degli incidenti ai sensi del NERC CIPv5.
 La risposta agli incidenti è un aspetto importante del business e I.C.S. operazioni: coinvolgere il senior management e determinare le loro esigenze, compresi i tempi di inattività accettabili, se desiderano finanziare un team interno o esternalizzare e cosa ci si aspetta dal personale in loco rispetto ai fornitori, al governo e all'industria privata.
 Il resto della giornata si svolgerà partendo dal presupposto che sia presente un team di risposta agli incidenti in loco per la raccolta e l'analisi iniziale: un team di risposta agli incidenti completo in grado di gestire gli incidenti dall'inizio alla fine è una grande risorsa da avere, ma spesso troppo costosa per la maggior parte delle organizzazioni.
 Entra in contatto con i PoC
 È necessario contattare vari PoC presso le organizzazioni che potrebbero essere contattate durante un incidente. Questi non si limitano alle dipendenze ma potrebbero includere un ISAC per condividere informazioni con l'FBI per indagini che potrebbero essere di origine nazionale o criminale, personale di risposta alle emergenze mediche/dei vigili del fuoco/della polizia e così via. Il personale dei vigili del fuoco/della polizia/medico potrebbe già essere preso in considerazione in un piano generale degli incidenti, indipendentemente dal fatto che l'incidente sia digitale. Pertanto, gestisci queste informazioni da parte del coordinatore generale degli incidenti per la tua organizzazione e assicurati che gli sforzi non vengano raddoppiati inutilmente.
 48 © 2021 Robert M. Lee
 no - @~- ©
 n / a @
 o7m@om?@eo @mm@® @® @®

> @®

@@ @® wow e
 siamo in debito con ww
 soso we we ws '§& 8 © SS ww
 od
 In-House contro esternalizzazione

¢ Ci sono molti vantaggi nell'effettuare una risposta agli incidenti internamente:
* Accesso coerente e fiducia nel personale coinvolto
+ Capacità di personalizzare piani e formazione per soddisfare i requisiti
+ Conoscenza complessa della configurazione/impostazione altamente unica dell'I.C.S.* Ci sono anche vantaggi nell’esternalizzare la risposta agli incidenti:
* Assumere personale competente per la risposta agli incidenti con una vasta esperienza nelle indagini
* Costi temporanei anziché costi di mantenimento del personale e formazione in loco
* Le prospettive esterne aiutano a evitare il pensiero di gruppo e le visioni ristrette sulle indagini
* Suggerimento: creare un team interno di risposta agli incidenti se soddisfa i requisiti, ma avere almeno una persona che agisca come Lead Responder per mantenere le conoscenze e aiutare a guidare gli altri Indipendentemente dal tipo di team interno stabilito, stabilire una soglia di quando, chi e come chiamare un aiuto esterno Avere un piano elaborato per assumere occasionalmente un aiuto di tipo consulente per un esame incrociato
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta «9
 Esistono scenari in cui ha senso un team di risposta agli incidenti tutto interno, e ci sono scenari in cui ha senso avere una sola persona nello staff responsabile della risposta agli incidenti per coordinare un team esterno quando necessario. Il suggerimento generale è che almeno una persona agisca come responsabile della risposta e mantenga la conoscenza dei sistemi. Questa persona sarà fondamentale per guidare il team in outsourcing. Un team interno generalmente ha una migliore conoscenza dei sistemi ed è di maggiore utilità per la risposta agli incidenti, ma i team in outsourcing possono spesso assumere e trattenere personale più formato ed esperto. Cioè, non esiste una risposta giusta; assicurati solo di sapere quale scelta viene fatta e perché.

© 2021 Robert M. Lee 49 Dimensiona correttamente la tua squadra

¢ Ciò che conta di più non sono le dimensioni del tuo team, ma la qualità:
+ 3-4 operatori di pronto intervento ben addestrati possono coprire efficacemente un'ampia area I.C.S.
 1—2 membri del personale fungeranno da Lead Responder e Direttore
 Per avere 3-4 persone sul posto, 2 persone potrebbero essere fuori. Di solito ne sono necessari 8-10
 soccorritori “malati, licenziati o altro”.
 indisponibile quando necessario personale
 disponibile
 La risposta agli incidenti richiede solitamente 12-20 ore al giorno; pertanto si consigliano 2 turni
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Anche solo poche persone possono fare una grande differenza durante un incidente. Da tre a quattro addetti al pronto intervento ben addestrati possono coprire efficacemente un'ampia area I.C.S. e trasmettere le informazioni necessarie al Lead Responder; tuttavia, non avrai sempre quelle persone. Dovrebbe essere sempre presente almeno una persona a tempo pieno dedicata alla risposta agli incidenti, mentre altri potrebbero avere la risposta agli incidenti come compito aggiuntivo. Ciò li incoraggia ad avere esperienza in altri aspetti dell'I.C.S.. Quando si verifica un incidente, devono dedicarsi al 100% alla risposta all'incidente. Non avranno la capacità di contribuire in modo affidabile e sano ad altri gruppi di lavoro. Cioè, ci dovranno essere dei riempimenti su quelle altre squadre per loro. Per contribuire ad alleviare i problemi e far funzionare le cose in modo più efficace, valuta la possibilità di passare a un modello SOC (Security Operations Center) integrato se la tua organizzazione è pronta.
 50 © 2021 Robert M. Lee

> >

>> wm
 PM OO OP OO OO OO ©
 7? ® ® giura wvoweweweetss & &
 eo è FS wy ow
 wo
 SsFS wD
 Catena di comando
 Direttore della risposta agli incidenti

« Si interfaccia con la gestione/PoC del Lead Responder

¢ Risposta per tutti + Focus pre-incidente

. punto degli handler Evidenze e + Guide del personale,
 Il triage dei gestori degli incidenti, la sequenza temporale, il mantenimento della situazione

¢ Acquisire prove, consapevoli
 infezione ambito, analisi tempestiva
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Deve esserci una chiara catena di comando per qualsiasi incidente. In generale, è buona pratica avere un direttore della risposta agli incidenti che prepari principalmente le informazioni per il personale a livello dirigenziale e/o si interfaccia con il pubblico. Il soccorritore principale dovrebbe concentrarsi sull'indagine e sul mantenimento/gestione della squadra. I gestori delle prove o degli incidenti sono gli individui che eseguono il piano.
 Direttore della risposta agli incidenti:
 Interfacce con la direzione e i PoC di altre organizzazioni.
 La maggior parte del lavoro svolto da questa posizione è preliminare alla creazione e al mantenimento del team. Risponditore principale:
 Responsabile di tutti i gestori di prove/incidenti e implementa il piano.
 Guida il personale, le attività di triage, la cronologia degli eventi, mantiene la consapevolezza della situazione e così via. Gestori di prove/incidenti:
 Responsabile dell'attuazione del piano, inclusa l'acquisizione di prove digitali, il contenimento/pulizia
 sistemi autorizzati e infetti, eseguendo analisi tempestive per determinare l’ambito della risposta
 e informare il Lead Responder dei bisogni.
 Usa la catena su e giù
 La catena di comando funziona in entrambe le direzioni; personale che contatta la direzione o la direzione che contatta il personale
(all'interno o all'esterno dell'organizzazione) devono essere corretti e informati del comportamento adeguato alla situazione. In caso contrario si crea confusione e si garantisce la perdita di informazioni critiche. Spesso, gli analisti inesperti ma tecnicamente esperti vorranno comunicare più rapidamente con i decisori esterni al team o semplicemente saranno entusiasti di provare ad aiutare. Ma tutte le comunicazioni devono passare attraverso il Direttore IR.Il personale Sharp ben conosciuto dal management verrà spesso contattato direttamente da persone esterne alle attività IR per informazioni:
 Al di fuori dell’analisi e dell’assistenza tecnica diretta, questo non può funzionare. Assicurarsi che tutti coloro che non partecipano all'attività IR (in sede o fuori sede) seguano il comando di risposta agli incidenti per qualsiasi esigenza e aggiornamento.

© 2021 Robert M. Lee 51
 s1
 Tutto il personale coinvolto nell'attività IR dovrebbe sottoporsi al responsabile della risposta agli incidenti per comunicare anche con la direzione. Ciò include il personale fuori sede che fornisce supporto.
 La catena di comando funziona in entrambi i sensi.
 52 © 2021 Robert M. Lee
 eh
 oo ® @ ® DM ®M WM ® wD ©) wD w ww
 aaogeeeemeeew @® ® vouvweuwvwsev#sewsewvswesteee & & WW
 ov VF HF KF KH KH HH YD
 Trovare personale adeguato

¢ Trovare personale addestrato alla risposta agli incidenti è utile, ma assicurati di includere persone che hanno vari sistemi I.C.S. esperienze
« Ingegneri, operatori, personale dell'infrastruttura IT, ecc.

* Assicurati che il tuo file . a: Abbi pazienza Sono disposto a chiedere al personale: e puoi seguire una richiesta di aiuto quando
 piano/lista di controllo necessari
 Lavora bene
- Avere una squadra forte e una comunicazione ad alto stress
 competenze ambientali
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 53
 È sempre utile avere personale specializzato in risposta agli incidenti. Le persone con un'istruzione formale o un background formativo nel campo delle IR possono essere di grande valore sia per mettere in pratica solide metodologie sia per offrire una buona prospettiva sulle migliori pratiche del settore. Tuttavia, il personale che inizia in un altro campo, come un ingegnere, un integratore o un operatore, generalmente apporta un elevato livello di conoscenza dei sistemi che è estremamente importante per I.C.S. risposta all'incidente. Non esiste un unico stampo "candidato perfetto" tra cui scegliere. Concentratevi invece sulla ricerca di personale paziente, in grado di lavorare bene con un team sotto alta pressione e disposto a dire: "Non lo so". È importante includere nel team persone che abbiano avuto esperienza nell’ambito dell’I.C.S. in alcuni aspetti in modo che comprendano il quadro generale, comprendano alcune stranezze del sistema e abbiano credibilità da poter sfruttare quando necessario durante l'IR. Molti scenari nella risposta agli incidenti si verificano in cui non esiste una risposta chiara: l'ultima cosa necessaria è un "esperto" che agisca in caso di incertezza.
 Il team dovrebbe essere diversificato per evitare il pensiero di gruppo e aree di interesse con visione ristretta (ad esempio, qualcuno che lo è
 esperti con gli storici dei dati probabilmente valuteranno il valore forense di quelli più in alto rispetto a qualcuno che ha lavorato a lungo sugli HMI).

© 2021 Robert M. Lee 53 Necessità del kit di lancio
 Buoni strumenti sono importanti per la risposta agli incidenti; i buoni analisti sono vitali. Un soccorritore ben addestrato può aiutare a guidare e guidare un team completo. Scegli sempre l'allenamento rispetto agli attrezzi, ma assicurati di avere gli attrezzi giusti nel tuo "kit di salto":
 Strumenti di acquisizione/imaging digitale (come USB forensically clean con software di acquisizione) Hub o rubinetto di rete in grado di supportare la velocità effettiva di rete prevista Cavi e convertitori di rete (da USB a seriale)
 Più dischi rigidi da 1-3 TB per archiviare immagini digitali e traffico di rete CD vuoti per quando non sono consentiti gli USB
 Laptop pulito con script e software approvati per un'analisi tempestiva Fotocamera per scattare foto di scene con manomissioni fisiche
 Buste di plastica antistatiche, etichette e un quaderno con le pagine numerate
 Lista di controllo con procedure definite, soglie e elenco dei contatti. Dispositivi di protezione individuale
 Metodi di comunicazione fuori banda come le radio
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S. — 4
 Le necessità di un kit di lancio variano da struttura a struttura in base ai requisiti. Tuttavia, è sempre una buona idea includere supporti di memorizzazione come dischi rigidi e USB, prese di rete, una fotocamera digitale, vari cavi di rete, attrezzature di sicurezza come elmetti di protezione, cavi vari, cacciaviti, prese multiple, torce elettriche e liste di controllo. Le liste di controllo saranno importanti quando inizierà l'incidente; forniscono un modo valido e affidabile per garantire che tutti siano sulla stessa pagina. Considera una revisione trimestrale dell'inventario del tuo Jump Kit; spesso gli articoli possono essere "presi in prestito".
 Riferimento: https://isc.sans.edu/diary/Day+4+-+Preparation%3A++ What+ GoestInto+a+Response+ Kit/5 125
 Formazione sugli strumenti
 Gli strumenti migliorano gli analisti, ma gli strumenti non sostituiscono gli analisti e la formazione. Avere analisti concentrati e dedicati che hanno esperienza con gli strumenti che stanno utilizzando. così come comprendere il motivo per cui utilizzano tali strumenti e cosa fanno esattamente, è fondamentale per la risposta agli incidenti. Inoltre, assicurati di avere una comprensione da parte del legale sulla catena di custodia e sulle prove ammissibili, nonché sulle differenze da stato a stato sui dati delle prove a carico e a discarico (dati favorevoli rispettivamente all'accusa e all'imputato). La formazione può essere formale, come le lezioni SANS, o informale, come esercitazioni interne, che infettano una rete di laboratorio con "malware" a cui le persone possono rispondere, o esercizi di settore come GridEx di NERC.Costruisci il tuo laboratorio
 Il personale addetto alla risposta agli incidenti ha bisogno di un laboratorio per testare i propri strumenti e provare la propria formazione. Proprio come i vigili del fuoco che rispondono alle emergenze spesso seguono corsi in cui affrontano scenari e competono tra loro, un ambiente di laboratorio può essere incredibilmente utile per garantire che i membri del team di risposta agli incidenti siano pronti alla lotta. In questa sezione parleremo della creazione di un laboratorio virtuale sicuro per l'analisi del malware. È perfettamente accettabile utilizzare lo stesso laboratorio per la formazione. Tuttavia, durante un incidente sarà necessario un laboratorio dedicato per il personale addetto alla risposta agli incidenti che non sia in alcun modo influenzato dal malware per la formazione. Il personale deve tornare in un ambiente privo di distrazioni per eseguire l'analisi tempestiva necessaria sulle prove acquisite.
 54 © 2021 Robert M. Lee
 Noi
 oppure vo© ww
 omnmnmnmnenmmn wm © © © ® © ® @
 wm@
 wv se wepoewwwws ww guai & & WwW
 ww ww ww
 2

=)

=)
=)

=]
 È necessario un laboratorio per la risposta agli incidenti in modo che gli strumenti possano essere testati e convalidati per funzionare efficacemente nell'I.C.S. ambiente.
 Il laboratorio dovrebbe, come minimo, includere: Alcune workstation con configurazioni e software identici a quelli dell'I.C.S.. Hardware collegato alla "rete del laboratorio" che imita l'I.C.S.. Computer fuori rete che fungerà da workstation dell'addetto alla risposta all'incidente. Switch gestito per raccogliere e comprendere il normale traffico di rete.
 Le macchine virtuali rappresentano un modo estremamente conveniente per replicare sistemi che altrimenti sarebbero troppo costosi o difficili da implementare in un laboratorio.
 Costruire un laboratorio può fornire un luogo in cui testare le capacità degli operatori di risposta agli incidenti, dimostrando al contempo al management la competenza e un piano comprovato.
 Alcuni computer fuori rete dovrebbero essere preparati per un laboratorio di test. Questi computer verranno utilizzati in caso di incidente per un'analisi tempestiva.

© 2021 Robert M. Lee 55 L'ultimo posto per testare i comandi è l'I.C.S..
 autunno f 9
 wMICc
 REG
 PER FINDSTR TROVA WEVTUTIL
 Scrivi le tue azioni e testale in anticipo quando possibile.
 e.a
 ETS SG Vege
 FRRAgG
 SCHTASKS BITSADMIN DRIVERQUERY, ALBERO
 DIR
 ASSOC
 DOSKEY NETSTAT FTYPE, [=<]
 Sjooy aylvads-anpoyy pve,
 RAV ATIG) PRGVGGR VIGg gy: AG RVVVG) |VRRL Vey PVA ARN VIV UGG TVG AT OPI Vag gay
 QS RS NS/8 RR Teg ee B88) GRP GV ggg e\ a g9)
 AR BRR

* Nota: la versione del sistema operativo richiede l'installazione di un pacchetto di utilità della riga di comando aggiuntivo
 Rif: Nicola Carr
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta s+
 La maggior parte di ciò che viene fatto su un sistema informativo per analisi o acquisizioni tempestive può essere programmato tramite script. Esistono molti sistemi in cui gli script non subiranno alcun impatto, ma tentano di automatizzare il più possibile il processo. L'automazione consente ai passaggi di essere testabili e ripetibili con sicurezza. Garantisce inoltre che gli analisti non trasmettano alcun comando durante un periodo e un ambiente ad alta tensione. Non esistono risposte giuste in termini di quale sia il linguaggio di scripting migliore, ma Perl, Ruby e Python sono stati ampiamente utilizzati nella comunità DFIR.
 L'ultimo posto in cui sviluppare e implementare script (Python, Ruby, ecc.) è la scena durante un'indagine. La maggior parte delle azioni che devono essere intraprese in un I.C.S. l'ambiente utilizza strumenti nativi (come WMIC per enumerare un sistema o netstat per identificare porte e processi aperti) che possono essere programmati e automatizzati: avere script pronti riduce gli errori degli analisti e il "fat fingering" incoraggiando al contempo gli analisti a prepararsi in anticipo e testare le proprie capacità. utensili.
 Tutti gli interventi di risposta agli incidenti presentano stranezze ed eventi non pianificati, ma una parte significativa delle attività intraprese su un sistema di destinazione può essere programmata, automatizzata e praticata in anticipo. La preferenza del linguaggio di scripting viene dopo "politica e religione" per cose che non dovrebbero essere discusse:
 Tuttavia, tieni presente che esiste un gran numero di script Ruby di risposta agli incidenti.
 Nicholas Carr ha pubblicato un ottimo documento di tesi della Naval Postgraduate School sulla risposta agli incidenti nell'I.C.S. ambienti. Ecco una tabella creata da lui che mostra gli strumenti nativi nelle diverse versioni di Windows. Questa è un'ottima risorsa per sviluppare script rapidi con strumenti in un ambiente diversificato. Il punto non è una discussione o una comprensione di tutti gli strumenti disponibili in questa diapositiva: il punto è capire che alcuni dei tuoi script e strumenti preferiti potrebbero non essere disponibili sui sistemi Windows meno recenti. Assicurati di convalidare e comprendere ciò che è disponibile prima di continuare. sito e prima dell'incidente.
 Riferimento: 14Jun_Carr_Nicholas.pdf
 56 © 2021 Robert M. Lee
 oOo mf OM . OM FARE che ww
 rTP Pf OP PP OP Oe Ow ww
 v7Teg’ & ® eww wowwewew WwW
 ap
 wo 8 8

* Proprio come deve esserci un responsabile della risposta agli incidenti, deve esserci una "stanza della guerra" in cui le operazioni sono centralizzate e monitorate: assicurarsi che la stanza della guerra disponga di lavagne, ricezione cellulare, riscaldamento/raffreddamento adeguati a seconda
 in base al periodo dell'anno ed è segmentato:
* Il personale operativo normale non dovrebbe attraversare una sala di guerra
 I.C.S.515 | I.C.S.Visibilità, rilevamento e risposta
 Una War Room è il centro operativo centrale per le attività di risposta agli incidenti. Può diventare rumoroso, può essere teso e ci sono molte persone che spesso sono interessate a sapere cosa sta succedendo. Cacciare le persone che non hanno bisogno di essere lì e non lasciare che gli analisti lavorino nella War Room per analizzare le prove acquisite dai sistemi. Consideralo il sistema SCADA delle attività sul campo di risposta agli incidenti. Qualsiasi analisi forense deve essere eseguita lontano dalla War Room. Può risultare frenetico rispondere alle domande del management, contattare i PoC, aggiornare tempistiche e modelli, tracciare la portata dell'infezione su diagrammi di rete appesi alle pareti, ecc. Non è il luogo in cui eseguire l'analisi tecnica.
 Riferimento immagine: Star Wars

© 2021 Robert M. Lee 57
 s7
 Preparare, preparare, preparare
 La maggior parte del lavoro per la risposta agli incidenti dovrebbe svolgersi nella fase di preparazione. Collaborare con gli esperti di architettura per assicurarsi che la registrazione avvenga ove possibile e che i punti di acquisizione della rete siano disponibili.
 Tieni conto della motivazione e fai in modo che i tuoi genitori siano felici e ricompensati
 di Robert M. Lee e Jeff Haas
 COSA DEVI FARE PER INCIOENT è IL TUO ENVICONMENT
< DURANTE UN INCIDENTE,
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 8
 Le pratiche di risposta agli incidenti cambieranno da I.C.S. a I.C.S., in base a requisiti, sistemi e configurazioni unici e così via. Per questi e altri motivi è fondamentale prepararsi in anticipo. È stato sottolineato in tutta questa sezione, ma non può essere sopravvalutato: prepararsi, prepararsi, prepararsi. La maggior parte degli scenari di risposta agli incidenti che presentano complicazioni possono attribuirli a una mancanza di preparazione. Questa è la parte della risposta all'incidente che non è così "divertente", quindi tende a essere trascurata. Ma è la parte più importante dell'indagine.
 Ad esempio, coloro che eseguono NSM dovrebbero già collaborare con i team di architettura per garantire che la registrazione avvenga. Questi registri sono preziosi durante la risposta agli incidenti. Stabilisci un contatto, assicurati che lo siano e stabilisci un piano per lavorare con loro in caso di incidente. La risposta integrata è quella più efficace.
 Nell'I.C.S. ambienti, avrai anche alcune opportunità uniche per i log, come syslog su vari PLC o RTU. Raccoglierli è spesso l'unica informazione che avrai sull'attrezzatura da campo.
 Motivazione e compensazione
 Ricorda di compensare adeguatamente coloro che lavorano sulla risposta agli incidenti e di intraprendere azioni per mantenere alto il morale. Le pizze e le bevande analcoliche fanno molto bene sia al morale che all'energia. Le bevande analcoliche potrebbero essere una scelta ovvia, ma nel caso in cui non lo fossero, va sottolineato: non bere per caso... mai.
 Sia che il personale sia assegnato a un team di risposta agli incidenti a tempo pieno o come compito aggiuntivo, quando si verifica un incidente, deve essere al 100% di risposta agli incidenti a tempo pieno:
 Ad esempio, pianificare di reintegrare le persone nel team da cui sono state prelevate se la risposta agli incidenti è un compito aggiuntivo per loro.
 Avere un piano per ruotare e compensare i tuoi dipendenti durante il giorno; la risposta agli incidenti richiede normalmente mesi.
 Gli orari prolungati sono normali, gli orari di Panama (12 ore sì/12 ore no per 3 giorni sì, 2 giorni liberi, 2 giorni sì e poi 3 giorni liberi) sono uno standard accettato.
 58 © 2021 Robert M. Lee

> wDow
 wo ww
 ron nnn m7 7 OO OM OD wD w wD
 oh wm
 e wow weweweet ws & &
 wo a
 eo w wwwewowes §&§ & §& SF &
 Stabilire orari limite rigorosi in cui il personale deve tornare a casa e riposare dopo un determinato numero di ore (dopo 12-16 ore di servizio, non c'è nulla che l'individuo possa contribuire).
 Compensare con cibo, spuntini, ferie future, bonus salariali e così via.
 La motivazione può diminuire se la risposta agli incidenti non sembra andare bene; è una battaglia lunga, in salita ed è faticosa:
 Sii attento e creativo riguardo al morale.

© 2021 Robert M. Lee 59 Posizione informatica difendibile durante la risposta agli incidenti
 Disabilita Limita o disabilita le connessioni alle funzionalità remote attualmente inutilizzate
 Protocolli 77™ aggiuntivi per l'accesso a Internet di sicurezza Disconnect per la posizione informatica del personale difendibile
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Ogni organizzazione dovrebbe essere in grado di mettersi in una posizione difendibile durante uno scenario di risposta agli incidenti. A seconda della gravità dell’incidente, del gruppo o della capacità percepita come minaccia e della tolleranza del cambiamento da parte dell’organizzazione, la posizione informatica difendibile varierà notevolmente.Quattro buoni consigli da ottenere sarebbero la possibilità di disconnettere l'accesso a Internet (ovvero anche tramite proxy e forwarder), disabilitare funzionalità attualmente inutilizzate come Assistenza desktop remoto, limitare o disabilitare le connessioni remote (anche per fornitori e personale di manutenzione) e ulteriori protocolli di sicurezza per il personale che includono l'autenticazione in due forme o la modifica delle password anche se tutti utilizzano le stesse password (passare informazioni agli operatori e persino avere password su foglietti adesivi per tutti non è una cattiva idea se l'obiettivo è un avversario remoto).
 Assicurati che tutto questo sia provato, in modo che le tue azioni non facciano più danni dell'avversario.
 Questa posizione informatica difendibile consentirà agli operatori di risposta agli incidenti di identificare più rapidamente l’incidente, individuare le aree interessate e limitare l’impatto sull’organizzazione.
 60 © 2021 Robert M. Lee
 oh oh @
 oh wm
 LY
 om7 © OM@
 TnPD®®
 oaeagwm® wuwewesweweweweew ©

=)
 Qualcosa andrà sempre inaspettatamente.
 Le cose andranno male.
 Gli sforzi di preparazione e formazione possono sembrare inadeguati (forse lo erano), ma c’è sempre una via da seguire.
 Fare "qualcosa" è in genere meglio di niente; niente è lo standard per
 indagini digitali nell’I.C.S. ambienti e questo deve essere cambiato. Garantire la comprensione OT della minaccia. Sii orgoglioso e goditi il ​​viaggio.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 63
 Soprattutto, prendi una pagina dalla Guida galattica per autostoppisti e non farti prendere dal panico. Un piano ben implementato può aiutare, ma le cose andranno sempre storte o inaspettatamente. Va bene. Finché viene mantenuta la professionalità, il personale addetto alla risposta agli incidenti contribuirà a garantire uno stato di sicurezza migliore rispetto a prima del suo arrivo. Andrà tutto bene, anche quando sembra più teso.

© 2021 Robert M. Lee 61 Esempio di risposta ad un incidente: Venezuela Marine Terminal

“« Terminale marittimo in Venezuela nel 2003 eae Adversary ha ottenuto l'accesso alla rete SCADA vee. © I PLC manipolati si collegano alla petroliera

¢ L'avversario ha tentato di riscattare il controllo
* Ha acquisito la logica PLC e cancellato i sistemi

+ Logica PLC già vaultata
_ + Accesso alla rete disconnesso e Logica ricaricata dai backup e riscatto evitato ;
 I.C.S.SI5 | I.C.S. Visibilità, rilevamento e risposta
 Questo è un altro incidente poco noto accaduto in cui è molto probabile che un terminal marittimo venezuelano sia stato colpito da un avversario remoto durante uno sciopero dei lavoratori. L'aggressore è riuscito ad accedere alla rete SCADA e ha essenzialmente cercato di bloccare il personale della struttura, presumibilmente chiedendo un riscatto per "rilasciare il controllo". La risposta del personale venezuelano è stata quella di recarsi ai PLC e ripristinare la logica ricercando nella rete il vettore di attacco ed eliminandolo. L'impatto è stato un ritardo di otto ore, ma difficilmente un lungo caso di risposta all'incidente e difficilmente un impatto grave. Gli scenari di risposta agli incidenti di solito richiedono molto più tempo e questo scenario probabilmente non era opera di un avversario estremamente talentuoso o di una minaccia mirata.
 62 © 2021 Robert M. Lee

®
 nO PO OOO DH DM OH
 o @@® Wm Ww
 oo @ & svvwvwsgeg8seodgseegpvw+evws#b#kewsewwew#cuci#s#wsew wee &©& oe & & &
 Laboratorio 4.2 Analisi Logica e Reset
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee
 63 Obiettivi dello scenario del corso (2)

*C3PO

* Quale registro è stato manipolato con quale valore?
 DS51 con un 1 che consentiva al PLC di operare in remoto e bloccare l'HMI
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 
 64 © 2021 Robert M. Lee
 64
 Oh
 rneomrmnaaonn eon mr 7 TP OM OD OW DM OD OM W
 noi @ @ oo ow ow wo ww FS wow weoeewoeeeoe8&ewe8&w#sww#w#ewwe &@ BH WwW
 COME
 Obiettivi dello scenario del corso (3)

¢ Raffineria di Calistoga AQuello è il nome

* Qual è la routine dannosa nella logica e cosa fa?
* Qual è la causa principale dell'attacco?
* L’incidente è collegato all’incidente di C3PO?

¢C3PO:

-Gresica-opelgyetinecontzel nebvect Whatict lei : neHM

* Quale file dannoso è stato eseguito sull'HMI e quando?
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 65 Mappa dei cavi j2 e J3
 PB aperto di Gen Breaker. Gen Breaker Chiudi PB
 Interruttore trans aperto P3 Interruttore trans chiuso PB
@ND
 Relè di protezione Spia di guasto Spia Trans Breaker Open Spia Gen Breaker Open
 OoOoOO oo00
 Spia di stato dell'interconnessione
 Vaso residenziale di distribuzione
 oh
 Vaso industriale di distribuzione
 BARI
 Terra
 Schermo'
 Grafico a barre di generazione
 Misuratore % della produzione industriale
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Per questo processo fisico, la mappatura dei punti può essere vista qui per il cablaggio al modulo di controllo principale.
 66

© 2021 Roberto M.Lee
 66
 NO @
 TP OO OM OW DM OH WD
 enn@
 rn rn ri
 ouvuvwesesveeewswebsuve
 w9876543274
 Fare clic su Ingresso digitale/Uscita relè CO-O8CDR
 GND
 Guasto relè protezione trans PB
 Relè di protezione trans Cancella errore PB
 Richiusura circuito dist aperto PB
 Richiusura circuito dist Chiudi PB
 Casa 1 Luce
 Casa 2 Luce
 Casa 3 Luce
 Potenza di fabbrica disponibile
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Per questo processo fisico, la mappatura dei punti può essere vista qui per il cablaggio al modulo di ingresso digitale/uscita relè.

© 2021 Robert M. Lee
 67
 67
 Requisiti per sistemi complessi
 Punto dati HMI
 Analisi logica
 Postazione di lavoro dell'operatore
 Rilevamento delle risorse
 Azione dell'operatore
 Osservazione fisica
 re Diverse capacità di risposta
 RTU da campo del sistema di comunicazione front-end
 Elenco tag Mappatura mappa punti Mappa terminale

. Database dei front-end di visualizzazione del sistema
 vale a dire 46 SCADA Network Sze Cémmunications mare
 Azione del dispositivo di campo
 1CS515| I.C.S. Visibilità, rilevamento e risposta: 6 secondi
 Esaminare ciascuna area, iniziando dagli elementi fisici e intervistando un operatore per capire cosa sta vedendo, ed esaminare ciò che sta realmente accadendo sul campo, può aiutare a fornire un contesto su dove concentrarsi successivamente. Mentre procedi per esaminare le varie risorse di sistema, prova a identificare dove potrebbe verificarsi il problema. Osserva ciascuno degli elementi logici per identificare cosa sta creando l'evento sospetto.
 68
 68
© 2021 Robert M. Lee
 sa' wouvudbssvebsbbb & b&b &
 Noi
 Tipi di dati e memoria del PLC

[Te ascrte np pits ace mse Dy me" ymdo

[Mh Disc Outpt pots af sprsortas di De *Y it,

Da -32.768 a 32.767
 2.147.483 da 648 a 2.147.483.647

~3.4028235E+38 al 340282356438
 0000h a FFFFH
(Il tipo di dati HEX richiede la "h" dopo il valore.) Singolo carattere ASCIi
| emma ASCE C008 OO HO FPR soanainmnnincil Codice ASCII da $00 a SFF
(Il tipo di dati Codice ASCII richiede la "S" prima del valore.)
 russa Seton Gone fil gelieliociahideiaiiemall
 nipote
 Ss
 fm ue fais minty to" atin pari t

[ED Reine eps peste te 0" abt coe ising et
 cing fers kama Ya 18 tar
 Cravatta B Dosis
 cioè el ne 5 op Tl esta Spee Be Roce pnomaay spb
 Questi elementi mostrati sono specifici del CLICK PLC, ma altri I.C.S. i dispositivi avranno a disposizione funzionalità simili
 ingegneri che programmano i dispositivi per il loro scopo specifico.

© 2021 Robert M. Lee
 69
 69
 Esercizio 4.2 Lettura

“Sembrava essere un problema dell'HMI
 L'azione che l'ha causato potrebbe essersi verificata per mesi sul campo e dimenticata come potenziale evento contribuente. Il cambiamento o specifiche dinamiche del sistema hanno innescato l'evento nel momento più impattante: inverno, bassa generazione
 I.C.S.515 | |CSVisibilità, rilevamento e risposta 7°
 Questo particolare attacco e altri esaminati nel corso di questo corso possono essere piuttosto difficili da identificare sul campo se non si utilizzano approcci specifici di visibilità, rilevamento e risposta OT. La risoluzione dei problemi solo sul controller utilizzando solo strumenti nativi avrebbe portato a un evento "quasi mancato" che probabilmente non sarebbe mai stato completamente diagnosticato o
 risolto.
 70 © 2021 Robert M. Lee
 es@) es
 wAa
 7 DM DM DM DH w
 7m®®OM®®
 eee
 vu dees ese bv &
 Caso di studio: ELECTRUM e CRASHOVERRIDE
 Ucraina 2016 Attacco informatico al sistema elettrico
 I.C.S.515 | [Visibilità CS, rilevamento e risposta 71
 

© 2021 Robert M. Lee ian Interruzione di corrente
 17 dicembre 2016 4 23:53 Ora locale:
 La sottostazione di Ukrenergo si diseccita Causata interruzione dell'area di servizio Utilità trasferita in modalità manuale Inizio del ripristino dell'alimentazione in 30 minuti
 I.C.S.515 | [Visibilità, rilevamento e risposta del CS 72
 Il 17 dicembre 2016, in Ucraina si è verificato il secondo attacco informatico in assoluto volto a bloccare le operazioni in una rete elettrica. Questa volta è stata colpita solo 1 sottostazione, ma si trattava di una sottostazione a livello di trasmissione che ha provocato una perdita di potenza 3 volte superiore a quella dell'attacco del 2015, anche se sono state colpite meno persone e il ripristino della potenza è iniziato appena 30 minuti dopo l'attacco.
 72 © 2021 Robert M. Lee
 vo DD Oo @
 OP PP Oe OD PP DM PD MD w

?@?@® ®
 el
 o®
 q w
 uw wewewewewiuw
 565 6 QUOTA SI

—]
 L’I.C.S. di ELEC Catena di uccisione informatica
 ELETTRO (Gruppo di attività)

¢ Palcoscenico | L'attività nella rete IT rimane sconosciuta
* La fase “Act” della Fase 1 si è verificata almeno già nell’ottobre 2016.
* Creati account controllati dagli aggressori in
 ambiente per “vivere sulla terra”.
¢ Storico dei dati IT accesso il 12 dicembre.
¢ Lo storico dei dati IT ha fornito l'accesso a OT.

* La fase 2 di "Sviluppo" prevedeva l'uso di comandi SQL, Mimikatz e PowerShell per acquisire informazioni e sviluppare conoscenze. La fase prevedeva anche lo sviluppo di CRASHOVERRIDE.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Il gruppo di attività che ha creato e sfruttato il malware CRASHOVERRIDE nell'attacco in Ucraina del 2016 è stato identificato da Dragos, Inc. come ELECTRUM. L’analista di Dragos Joe Slowik ha pubblicato un documento dettagliato sull’attività di ELECTRUM nel 2018.I dettagli precedentemente non divulgati sull'attacco includevano la fase "Act" di Stage | per identificare che una compromissione dello storico dei dati nella rete IT ha portato all'accesso nella rete OT. Da lì l'utilizzo di strumenti comuni e comandi nativi ha permesso all'avversario di sviluppare la propria conoscenza dell'ambiente, mentre separatamente hanno sviluppato anche CRASHOVERRIDE. Gli aggressori hanno utilizzato un server OPC per enumerare l'ambiente, che ha fornito loro le informazioni di targeting da caricare in CRASHOVERRIDE come file di configurazione.
 Riferimento: https://www.dragos.com/blog/20180607Electrum.html

© 2021 Robert M. Lee 73 CRASHOVERRIDE Quadro

—

«Addizione!» P Fuggi: ESEGUISCE

|
| | JJ |
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 74
 J, COMANDI

=
 Joe, ESEGUITE
 I dettagli dell'attacco del 2016 non erano noti fino a quando non è stato rilasciato un rapporto pubblico da ESET seguito da un rapporto pubblico rilasciato da Dragos, Inc. circa un'ora dopo. ESET ha identificato il malware come Industroyer, valutando che potrebbe colpire qualsiasi numero di settori e non solo la rete elettrica. Dragos non era d'accordo con questa valutazione, e quindi lo chiamò CRASHOVERRIDE invece della scelta a tema "distruttore di industrie" di ESET. Entrambi hanno lavorato prima delle pubblicazioni per analizzare e informare i propri clienti. Dragos ha inoltre assicurato che la comunità statunitense e vari CERT nazionali in tutto il mondo lo sapessero prima che ESET lo diffondesse alla notizia. Allarmi privati ​​sono stati inviati tramite E-ISAC, EEI e DHS alla comunità elettrica statunitense dopo la notifica da parte di Dragos, il che ha dimostrato un grande impegno da parte della comunità.
 Riferimento: CrashOverride-01 .pdf
 74 © 2021 Robert M. Lee
 Fr PD OP OP PP OD PO OP noi

@
 PT® PM T DP®
 oe @ue weweweweww wW
 ap
 os » & SF we wy wv
 COME
 7
 Carichi utili
 MODULI CRASHOVERRIDE e IMPATTO
 1EC-104 1EC-104 1850
 SIPROTECT Negazione del servizio

" Analisi ESET T Altre fonti
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 CRASHOVERRIDE è stato il primo malware in assoluto progettato specificamente per interrompere le reti elettriche. Conteneva una serie di moduli che ESET e Dragos sono stati in grado di identificare e analizzare. Ciascuno dei moduli 1EC104, 1KC61850 e OPC era in grado di provocare l'attacco; tuttavia durante l'attacco è stato utilizzato solo il modulo IEC104. I ricercatori di Dragos hanno valutato che ciò indica che gli aggressori potrebbero aver testato le loro capacità contro gli ucraini, lasciando gli altri moduli disponibili per attacchi futuri. La combinazione dei moduli consente al malware di essere scalabile su qualsiasi rete elettrica che utilizzi questi protocolli (Europa, Medio Oriente e Asia) e richiederebbe solo una leggera personalizzazione per includere DNP3 per consentire al malware di funzionare negli Stati Uniti e nel resto del mondo. mondo. La vulnerabilità SIPROTECT non era necessaria affinché l'attacco funzionasse, ma avrebbe potuto avere ripercussioni fisiche se il dispositivo di protezione, in questo caso un relè digitale, non funzionasse più quando gli operatori elettrici hanno ricollegato l'apparecchiatura. Tuttavia, durante questo attacco non si è verificato alcun danno fisico.
 Riferimento immagine: Dragos, Inc.

© 2021 Robert M. Lee 75
 Esso
 Carichi utili nel contesto
 FIREWALL
 SERVER WORKSTATION ORG DI INGEGNERIA

[- =~] ROUTER DiorraL RELAY
 cioè sono dieci
 1 1€C 104 SCHIAVO IEC 104 SCHIAVO
| RTo Are

; io
; |
 io

«aie dstsdiaiatsall
 io

'
 H
 io

- io
 PLC
 CONTROLLORE.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Ecco un'immagine di una tipica sottostazione elettrica che utilizza i protocolli presi di mira da CRASHOVERRIDE. CRASHOVERRIDE ha effettivamente inviato comandi IEC104 assumendo la posizione di master dopo l'installazione su un HMI. Quindi ha inviato ripetutamente comandi di apertura attraverso il relè digitale alla RTU per forzare l'apertura e mantenere aperti gli interruttori automatici, diseccitando così l'apparecchiatura.
 La capacità è altamente scalabile ma deve comunque essere messa in atto dall’avversario, il che significa che è necessaria una componente umana nell’attacco. Questo è un effetto della Fase 2 nell'I.C.S. Cyber ​​Kill Chain, ma deve comunque esserci un'operazione Stage 1. Questa non è una capacità wormable che funzionerebbe in modo efficace, a causa della segmentazione e della strutturazione delle reti.
 Il gruppo di attività ELECTRUM era responsabile della funzionalità CRASHOVERRIDE ed è stato in grado di passare dagli storici dei dati (server SQL in questo caso dalla rete IT alla rete OT) e mettere in atto CRASHOVERRIDE.
 Riferimento immagine: Dragos, Inc.
 76 © 2021 Robert M. Lee
 7%

@
 v DD w
 rer 7erenwrmenrneeene © © © ® ® @®
 7©
 sv woevuewewsewewwseweuwewe#eesexueuw
 Vettori di compromesso iniziali
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S. 77
 

© 2021 Roberto M.Vettori di attacco iniziale di Lee

* Il punto di partenza per analizzare e comprendere una minaccia è generalmente il suo vettore di attacco iniziale

* I vettori di attacco iniziali includono e-mail di spear phishing, sfruttamento di siti Web esterni, connessioni Internet dirette a sistemi di controllo, reti affidabili abusate e connessioni tra altre reti, come
 fornitori o reti aziendali:

* Analizzando il modo in cui una minaccia ha inizialmente infettato il sistema I.C.S. può fornire raccomandazioni di riparazione e può aiutare a identificare e chiudere la vulnerabilità affrontata dall'organizzazione per ridurre le possibilità di reinfezione

* Uno dei vettori di attacco iniziale più comuni sono le e-mail di phishing:

¢ Le prossime diapositive mostrano alcuni metodi di analisi per le e-mail di phishing che
 potrebbero essere passati al personale TEM
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 8
 I vettori di attacco iniziali possono variare, includendo una varietà di attacchi lato client, ma le e-mail di ingegneria sociale e di phishing sono estremamente comuni perché efficaci. I PLC connessi a Internet sono comuni e vulnerabili, ma le e-mail di phishing spesso danno accesso a sistemi di cui l'avversario ha bisogno per comprendere appieno e ruotare all'interno di una rete. Per questo motivo, esamineremo un po' le e-mail di phishing e alcuni modi per analizzarle per individuare eventuali indicazioni dannose.
 78 © 2021 Robert M. Lee
 oOo @ @& DM . wo wo
 Wm
 Rif @ @
 oem®® ©®®®
 7 milioni di debiti con JF woweeeeteew &
 sì 48
 wo 8 JF JF JF VF WS WS I
 Esempio di vettore di compromesso iniziale: manutenzione e collegamenti ai fornitori
 mi dispiace * Molti OEM e integratori mantengono le connessioni tramite VPN e connessioni permanenti o limitate nel tempo. ae Ad esempio, il software e le apparecchiature di controllo delle turbine richiedono la condivisione della diagnostica.
 Tali connessioni o gli stessi OEM/integratori possono essere compromessi, determinando un accesso che bypassa l'IT aziendale
 I.C.S.5I5 | I.C.S. Visibilità, rilevamento e risposta 79
 La manutenzione e i collegamenti con i fornitori sono un'area che la maggior parte dell'IT aziendale trascura la prima volta che inizia a pensare alla connettività dentro e fuori le reti operative. Esistono numerose connessioni che tradizionalmente aggirano la rete IT aziendale, il che significa che non si vedono le compromissioni che si verificano o l'azione dell'avversario dopo il fatto. È buona norma entrare negli impianti da monitorare (analisi traffico est-ovest) e se si sta facendo pentest provare a pentest fuori dall'I.C.S. invece che nell'I.C.S. dalla rete informatica.
 Ciò è emerso come un grosso problema in SolarWinds, dove numerosi OEM e integratori utilizzavano Solar Winds direttamente attraverso i collegamenti di manutenzione e compromettendo le strutture all'insaputa dei proprietari degli asset, spesso come soluzioni di sicurezza white label o utilizzando direttamente SolarWinds.

© 2021 Robert M. Lee 79 Email di phishing

° Le e-mail di phishing spesso contengono "payload" o un "dropper" che contiene codice dannoso:
« Un esempio potrebbe essere un PDF allegato a un'e-mail che esegue shellcode quando viene aperto
° Lo Shellcode è un tipo specifico di codice utilizzato come carico utile di un tentativo di sfruttamento; di solito avvia una shell di comandi (da cui il nome
 shellcode) per eseguire ed eseguire processi, comandi e impostare un punto di connessione
+ Poiché le e-mail di phishing devono sfruttare alcune vulnerabilità per introdurre malware nell'ambiente o aprire una connessione per un avversario remoto, il malware può essere esaminato dal personale TEM
* Data la natura del malware come vettore di attacco iniziale per l'avversario,
 le informazioni raccolte da esso sono estremamente importanti, spesso rappresentano i server C2 dell'avversario o indicazioni su quanto sia avanzata la minaccia
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta: 80
 La parte e-mail di un'e-mail di phishing di solito non è la funzionalità utilizzata dall'avversario. Molto spesso, è allegato un file che deve essere eseguito affinché il "payload" o il "dropper" (il codice dannoso) venga eseguito sul sistema. Spesso questo include lo shellcode che consente agli avversari di accedere al sistema. Le e-mail di phishing spesso contengono codice dannoso, anche se contenuto in qualcosa come un PDF, e devono essere gestite con cura.
 80 © 2021 Robert M. Lee
 oh @
 7° MO MOMOOD*MPDODOO@D OD OD DM wD wD w
 T
 Se vswewesewewewscucitosnwsewsewewewsw &
 noi PS
 Noi
 oeFFFS
 ff o>». ae Rapporto sul campionamento dell'acqua dell'EPA - Messaggio (HTML) (Read-Onty)

|FIREE, guai a te, orton
 Gy junk Elimina Rispondi Rispondi Inoltra H+ Sposta Traduci 2 Q
 5 Vuuses targetea 52 pF 3) Moth Unread
 3 E-mail del team =O i} Azioni ¥ Follow-up > :
 Elimina Rispondi Passaggi rapidi a Movimento Trotto + teiting

© Questo messaggio è stato prestato con grande importanza da: Ufficio per la sicurezza chimica e la prevenzione dell'inquinamento, EPA <OCS? @epe.gov > Inviato: martedì 76/2010 e 31:00 Oggetto: Rapporto sul campionamento dell'acqua dell'EPA

_d Messaggio “7 water_upaste parti pat (519 KB) “)water_update_part2 pat (618 KB)
 I campioni di acque superficiali EPA raccolti dal 17 al 26 giugno 2010 lungo la costa del Golfo non hanno rivelato livelli elevati di sostanze chimiche presenti nel petrolio
 I risultati delle acque superficiali raccolti dal 21 maggio al 24 giugno 2010 lungo la costa della Louisiana sono stati riferiti a due delle sostanze chimiche associate a disperdenti (2-butossietanolo e alcol 2-ethythexyi)

"Perché l'EPA campiona e monitora l'acqua?"
 Il processo di campionamento dell'acqua dell'EPA comprende la raccolta del campione, le analisi di laboratorio e la verifica dei dati (che garantisce dati di elevata qualità di phishing). "Questi passaggi richiedono circa 7 giorni per essere completati prima che i dati possano essere pubblicati sul sito web dell'EPA". Pertanto, i dati pubblicati dall'EPA "i5" non sono rappresentativi delle condizioni attuali ma sono piuttosto un'istantanea in tempo per una determinata posizione. Continuiamo a raccogliere campioni d'acqua e Email Esempio pubblicherà i dati come 006 non appena saranno disponibili.
 La mia acqua ha un sapore o qualcosa è diverso, cosa dovrebbe | Fare?

“Potete contattare il Centro informativo congiunto, o IC, situato nel cuore degli sforzi di risposta. Il TIC è un centro di coordinamento per le agenzie di risposta federali, statali e locali. Puoi chiamare il JIC al numero 985-902-5231.
 Riferimento: Contagio
 Ecco un'e-mail di phishing trovata come parte di una campagna APT. Contagio è un sito Web che dispone di un'ampia fonte di e-mail di phishing, malware e informazioni utili al personale TEM per ottenere campioni su cui formarsi. In questo caso, un'e-mail di phishing ben personalizzata include PDF contenenti un exploit che consente a un utente malintenzionato di accedere al sistema che lo esegue. Qui vediamo l'acqua presa di mira da un indirizzo email EPA.gov. (L'indirizzo email è stato falsificato.)
 Tutto intorno si tratta di un'e-mail credibile e solo una persona nell'organizzazione deve fare clic su di essa. Ma avere accesso alle e-mail e ai PDF può rivelare informazioni vitali per identificare la minaccia dopo che ha violato l’organizzazione. Finché non perdi qualcosa di valore o l'avversario non ottiene ciò che stava cercando, non c'è "sconfitta" nell'ingresso di questa minaccia. Ma rispondere è vitale.
 Per inciso, un malinteso comune è che le e-mail di phishing contengano parole errate come le e-mail del principe nigeriano perché gli avversari non sono così bravi. La verità è che la ricerca ha dimostrato che le e-mail di Nigerian Prince spesso contengono errori grammaticali e evidenti indicatori di attività dannose perché coloro che conducono la campagna vogliono prendere di mira gli individui ingenui. Il tipo di persone che rispondono a tali e-mail è il tipo che potrebbe fornire i dati della propria carta di credito. Cioè, i principi nigeriani spesso conoscono davvero il loro pubblico target. Gli avversari dell'I.C.S. sono allo stesso modo.

© 2021 Robert M. Lee 81
“EDE-1
%heB1074 ; 81075 ; &#1055 681059 0 oggetto)
 1 Esempio di struttura PDF “ “Tipo Catalogo
“Apri azione <<
 AIS AOR
/$ AavaScript

<</lunghezza 6 ‘Filtro (/ASCI1HexDecede) >>
>>strean 646£63756d6560742077727974652822486Sbcbc6E22293b> endstrean
 0000000000 65535 £
 0080000010 00000n
 6000000120 00000n
 trailer

«<<
 fTaglia 2
 Radice d'avena 10 R
 startxret
 633
 Riferimento: Infosec Institute XAEOF
 I.C.S.515 | [Visibilità, rilevamento e risposta CS n.2
 Allora perché i PDF sono così comuni? I PDF sono incredibilmente popolari e le persone sono abituate ad aprirli. Adobe è anche un'applicazione relativamente facile in cui individuare le vulnerabilità. Ma, come puoi vedere in questo esempio, c'è molto spazio per fare cose in un PDF. Puoi incorporare JavaScript o altri comandi come "oggetti" e incorporare codice dannoso che può essere richiamato ed eseguito. Esistono indizi noti di comportamenti dannosi perché le persone hanno analizzato un numero sufficiente di PDF per rendersi conto di quali aree comuni siano dannose.
 Un file PDF è composto da intestazione, oggetti, tabella di riferimenti incrociati (per individuare gli oggetti) e un trailer.
 Riferimento: http://resources.infosecinstitute.com/analyzing-malicious-pdf/
 82 © 2021 Robert M. Lee
 B®
 onwnownmmnemneemnememmnwon em ww
 eh
 w ses s&s w ws &S vw wb wb usb ue wb wo wb wb & &

@» «ws as ws os
 Aspetti PDF su cui concentrarsi

* L'istruttore SANS Lenny Zeltser consiglia (sul suo sito Web) di concentrarsi su formati di file PDF specifici perché sono stati osservati in vari casi dannosi:

« /OpenAction e /AA (Azione aggiuntiva) specificano lo script o l'azione da eseguire automaticamente
/Names, /AcroForm, /Action possono anche specificare e avviare script o azioni

/JavaScript specifica JavaScript da eseguire

/GoTo* modifica la visualizzazione in una destinazione specificata all'interno del PDF o in un altro file PDF

/Launch avvia un programma o apre un documento

/URI accede a una risorsa tramite il suo URL

/SubmitForm e /GoToR possono inviare dati a un URL

/RichMedia può essere utilizzato per incorporare Flash nel PDF

/ObjStm può nascondere oggetti all'interno di un flusso di oggetti
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Lenny Zeltser apparirà alcune volte in questo corso; è il guru dell'analisi del malware e insegna al SANS. Ha messo insieme un elenco sul suo sito web di alcune aree specifiche di interesse da cercare nei file PDF.Potresti creare un IOC da questo, ma ci sono già strumenti disponibili per farlo.
 Nessuno di questi dovrebbe essere visto come indicatori evidenti di attività dannose e alcuni possono essere abbastanza comuni, ma sono buoni comandi da evidenziare e cercare; in particolare, scopri cosa è normale per il tuo ambiente e cerca
 comandi che non sono normali. Inoltre, un numero elevato di ciascuno di essi può indicare attività dannose.
 Riferimento: http://zeltser.com/reverse-malware/analyzing-malicious-documents.html

© 2021 Robert M. Lee 83
 83
 Un semplice strumento per cercare stringhe nei PDF che potrebbero essere dannose Creato da Didier Stevens nel 2009
 Restituisce il numero di volte in cui un documento PDF contiene le stringhe impostate. Utile per l'analisi rapida di un singolo documento rae, tenendo conto di quali oggetti e stringhe PDF potrebbero essere dannosi:

¢ Ad esempio, combina le tue conoscenze o un elenco
(come quello di Lenny Zeltser) con questo strumento per eseguire una rapida ricerca di stringhe
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 2
 Si tratta di uno strumento semplice ma potente creato da Didier Stevens che scansiona rapidamente un PDF alla ricerca di parole chiave e oggetti chiave che potrebbero essere dannosi. Restituisce un conteggio delle diverse parole chiave trovate.
 Riferimento:
 http://blog.didierstevens.com/2009/03/3 I/pdfid/ L'immagine è tratta dal riferimento sopra
 84 © 2021 Robert M. Lee
 ena 8 @® ® ® ®H w& w&
 eon @ &
 su lui ©
 Ld
 oon @ wowwewwew W
 wweipwe ww w
 w
 w ww
 Vv noi Ww
 vy
 oo Fs FF Ww
 AnalizzaPDF Es.
 Riferimento: Glenn P. Edwards Jr. 85
 AnalizzaPDF è uno script Python che utilizza le regole PDFiD, PDFinfo e YARA per analizzare i PDF: uno dei più recenti strumenti di analisi PDF (2013) creato con l'intento di osservare i noti segnali "cattivi".
 Sviluppato dall'analista di Mandiant Glenn P. Edwards, Jr. come tentativo di basarsi sugli strumenti disponibili e creare qualcosa di più intelligente che possa utilizzare le regole YARA: ha analizzato oltre 13.000 PDF (puliti e dannosi) per determinare modelli comuni che potrebbero indicare attività dannose.
 Ottima risorsa per incorporare le regole YARA con i tradizionali strumenti di scansione PDF (PDFiD e PDFinfo) per avere un'idea migliore se un PDF è dannoso.
 Esempio di analisi PDF
 Si noti che questo strumento fornisce l'hash SHA256, conta alcuni dei comandi interessanti indicati in precedenza, visualizza l'entropia e consente l'uso di YARA direttamente contro i PDF di questo strumento. Questo è un ottimo strumento da poter utilizzare per questi motivi.
 Riferimento: http://hiddenillusion.blogspot.com/2013/12/analyzepdf-bringing-dirt-up-to-surface.html

© 2021 Robert M. Lee 85 Analisi PDF automatizzata

* L'analisi automatizzata del malware verrà discussa più tardi oggi; tuttavia, tieni presente che è possibile inserire un PDF in una piattaforma automatizzata di analisi del malware e lasciare che esegua il codice dannoso:

* Ciò consente all'analista di determinare non solo se il PDF è dannoso, ma anche che tipo di attività svolge il PDF

* È buona norma utilizzare gli strumenti PDF manuali per analizzare i PDF che potrebbero essere dannosi, quindi lasciare che i PDF potenzialmente dannosi vengano eseguiti in un analizzatore automatico invece di perdere tempo

° Le prossime diapositive mostrano un caso di studio sull'analisi automatizzata del malware su un'e-mail di phishing che prendeva di mira i membri della comunità di sicurezza nucleare
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 L'analisi automatizzata del malware è un'ottima risorsa per gli analisti ed è uno dei tipi di metodologie di analisi del malware. Verrà esplorato più avanti in modo approfondito, ma a questo punto tieni presente che è possibile semplicemente inserire un PDF dannoso in una piattaforma automatizzata di analisi del malware ed estrarre informazioni utili.
 86 © 2021 Robert M. Lee
 il 8 ff ff ” oe. ff ff
 nn nnn ak kh fh ouedeg wb ewewwewesewwewewew
 tu sei Ww
 ahi, VY
 Documento di ricerca sulla revisione della postura nucleare del 2010 e l'imminente Surimit sulla sicurezza nucleare - Messaggio...
 SD Seas) Psy se ya
- = Dy Correlati ~ — Biodk aor Cegonce Foon Manas Serato Rule Azioni~ Mittente ~~ * Su~ Non letto “4 Seleziona OneNote een Pic Coton Lind | onebte
 prossimo vertice sulla sicurezza nuda

La Nuclear Postufe Review (NPR) del 2010 delinea l’approccio dell’Amministrazione nel promuovere l’agenda del Presidente per ridurre i pericoli nucleari e perseguire l’obiettivo di un mondo senza armi nucleari, promuovendo allo stesso tempo una più ampia sicurezza degli Stati Uniti.
 interessi.
 Secondo la Casa Bianca, l’obiettivo finale del prossimo vertice sulla sicurezza nucleare del 2010 sarà “un comunicato che impegni gli sforzi per raggiungere i più alti livelli di sicurezza nucleare, che è essenziale per la sicurezza internazionale così come per lo sviluppo e l’espansione dell’energia nucleare pacifica in tutto il mondo. “

"Ad accompagnare questa lettera c'è!!!) Documento di ricerca sulla revisione della postura nucleare del 2010 e sul prossimo vertice sulla sicurezza nucleare."

| Fateci sapere se lo trovate utile e se ci sono ulteriori informazioni che vorreste vedere incluse in futuro
 edizioni. Apprezziamo molto il vostro supporto e assistenza.Caso di studio: e-mail di phishing per la revisione della postura nucleare
 Riferimento: Contagio
 Nelle prossime diapositive, vedrai alcune analisi effettuate su una campagna APT in cui un avversario ha preso di mira membri della comunità nucleare, e in particolare un vertice che si stava svolgendo a Washington, D.C. nel 2010. Dopo l'apertura del PDF , si è eseguito sul sistema e ha iniziato a inviare la comunicazione all'avversario
 server di comando e controllo (C2).

© 2021 Robert M. Lee
 87 giorni
 e
®
€
 Traffico di rete dal sistema di destinazione
 24 554.455242. 172.29, 0.100 172.29.0.114 Risposta alla query sul nome NEMS NB 172.29
 37 900. 653053 172, 29,0,114 https > ansoft-lm-2 [ACK] Seq=l Ack 205 Len: 39 901. 640232 139, 172.29,0.114 https > ansoft-Im-2 [Ack] Segel Ack=48 win =64193 Len=0 40 912,124742 172.29.0,114 Continuazione Dati 42 912, 356588 172.29,0,114 https > ansoft-Im-2 [ACK] Seq=9 Ack=82 win=64159 Len=0 44 912. 574972 139.92. 172.29,0,114 https > ansoft-Im-2 [ACK] Seg=9 Ack=87 win=64154 Len=0 45 913, 777693 139,92. 172.29.0,114 Continuazione Dati 48 917, 395205 139.92. 172.29.0.114 https > ansoft-Im-2 [ACK] Seg=13 Ack=126 win=64115 Len=0 50 918,372746 174.139.92.6 172.29.0.114 fittps > ansoft-Im-2 [ACK] Seg=13 Ack= 206 vincite=64035 Len=0
§1 921.881126 174.139. 92,6 172,29. 0.114 Dati di continuazione
§2 O97 WMS 174 120 07 & 179 20 0-144 bttne \ ancaftolm? Pacv] Can-27 Arh-290 Wwin-64N1 tonico
# Frame 32 (98 byte sul cavo, 98 byte catturati) ri
® Ethernet II, Src: Cisco-Li_éf:ac:09 (00:18:F8:6F:ac:09), Dst: vmware_eO:1f:2e (00:0c:29:e0:1F:2e)
# Protocollo Internet, Src: 68.87.73.246 (68.87.73.246), Dst: 172.29.0.114 (172.29.0,114)
® Protocollo datagramma utente, Porta Src: dominio (53), Porta Dst: 51276 (51276)
% Sistema dei nomi di dominio (risposta)
 w.m
 ovo @&
 000000 0c
 loo10 00 54' :
 10020 00 72 F 0 is as ies 0030 00 OL reese orepiper 0040 08 73 wsexidud e. com... 0050 00 OL ba vede 0060 5c 06 \
 w
 Riferimento: Contagio
 Ww
 Qui vediamo la comunicazione avvenuta sul sistema infetto. L'analista di Contagio ha aperto il PDF e ha avviato Wireshark per acquisire la comunicazione di rete. Vediamo che il server C2 si trova sul sito web sexidude.com. (Sito web reale, in realtà dannoso, non andarci.) Da lì potrebbe essere effettuata una grande quantità di analisi e quali informazioni vengono raccolte da questa acquisizione di rete (come cercare informazioni per il sito web, vedere quali altre campagne malware sono state associati e alla ricerca di collegamenti in altri malware).
 wo
 ogee @ @ @& @
 88 © 2021 Robert M. Lee
 ong m@m devo seweewwe+#ewweb#ewsewwwwe & WW
 ovevsev Vv ee we we Ww
 Analisi delle e-mail di phishing nucleare

¢ L'analisi automatizzata dei ricercatori di Contagio nella sandbox di Anubis ha mostrato che il PDF, una volta aperto, creava il file
%Temp%\AcrRd32.EXE con l'hash MD5 5a67c2a64e17a2e3e5efdoae94db715c L'eseguibile quindi è stato creato e aperto:

° %Temp%\11111111.pdf MD5 6b4162954594a6c6e4287773fced7e5f

° %Temp%\wuweb.exe MD5 8ae20aabfb207f5bb4e3918b043d37!a Attraverso la sola analisi automatizzata, un membro del team TEM avrebbe potuto scrivere una regola YARA sugli hash digitali e sui percorsi dei file/eseguibili, nonché sulle informazioni di rete fornite (l'indirizzo IP per il server C2 ) al personale NSM per creare firme di rete in un IDS:

¢ Ciò avrebbe anche accelerato gli sforzi di risposta agli incidenti per individuare gli infetti
 sistemi
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 L'analisi effettuata dai ricercatori di Contagio ha mostrato che il PDF creava un file iniziale e poi alcuni altri.
“Questo è il tipo di informazioni che il personale TEM potrebbe raccogliere e trasmettere agli addetti alla ricerca di sistemi infetti. I dati della rete potrebbero essere passati al personale NSM per cercare indicatori basati sulla rete.
 Informazioni aggiuntive:
 Ho sfruttato la vulnerabilità CVE-2010-0188 in Adobe Reader. Il vertice si è svolto a Washington, DC nel 2010.
 All’epoca, meno del 13% degli AV colse la minaccia.
 Riferimento: http://contagiodump.blogspot.com/2010/04/apr-10-cve-2010-0188-pdf-research-paper.html

© 2021 Robert M. Lee 89 Esempio di risposta ad un incidente con vettore di intrusione
 L'evento ransomware si è verificato poco prima di un evento fisico
 Ransomware
 Raccolta limitata, ma la visibilità della rete distribuita e i registri dei controller sui controller hanno mostrato errori relativi alla scansione
 Gli operatori che hanno risposto all'incidente hanno trovato dati su una sequenza temporale pluriennale

- ¢ L'autore del ransomware ha catturato l'attore statale
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 In questo caso di risposta all'incidente, l'organizzazione vittima sapeva di essere stata compromessa a causa delle note del ransomware e dei sistemi bloccati. Tuttavia, dopo aver esaminato le analisi forensi disponibili, era ovvio che c'erano più avversari nell'ambiente, due per la precisione. Sembrava che l'attore statale svolgesse attività di spionaggio e ha compromesso l'organizzazione inizialmente tramite un'e-mail di phishing, quindi ha aperto i punti di accesso al firewall dell'azienda.L'accesso aperto è stato sfruttato da un attore di ransomware per distribuire un ransomware che alla fine ha catturato l'attore statale. L’evento fisico accaduto era del tutto estraneo ad entrambi i casi.
 L’analisi della sequenza temporale è stata fondamentale qui.
 90 © 2021 Robert M. Lee
 90.
 eo come
 agg’ @ @ @ @ @ @ @ @ © & OP 2 OD OP OD
 oon giura JF ows ewe HHeewewwswb Ww
 un j
 ost 8 JF wo W
 uo
 Altre parole: dobbiamo guardare di più
 di Robert M. Lee e Jeff Haas
 VI ASSICURIAMO CHE NON VEDREMO MAI ALCUN ATTACCO,
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Trovare e condividere casi di studio aiuterà il nostro settore a crescere. L’applicazione dell’ACDC, in particolare concentrandosi sull’osservazione (NSM), e la raccolta di casi di studio che coinvolgono l’avversario (Incident Response), ci consentirà di farlo.

© 2021 Robert M. Lee 91
 a1
 Lab 4.3 Analisi delle email di phishing
 Raffineria di Calistoga
 I.C.S.5I5 | Visibilità, rilevamento e risposta I.C.S. 2
 
 92 © 2021 Robert M. Lee
 ooh. & &
 Rif
 wm
 oh @
 ahi @ @® @® @&
 M@
 ogg Fs we ee ww wow wes ws GS WF UF Ww ww © | WwWD

~~4
 Fonti di dati forensi in I.C.S. Reti
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta %3
 

© 2021 Robert M. Lee

° Le VPN sono molto utilizzate nella maggior parte dei servizi I.C.S. ambienti per il business -> comunicazione rete di controllo e per il fornitore -> I.C.S. l'accesso attraverso le VPN WAN è stato osservato come percorsi verso I.C.S. che le minacce amano usare:
° I fornitori infetti possono trasmettere malware attraverso la VPN o i sistemi I.C.S. può essere utilizzato nell'Enterprise
» Stuxnet si è diffuso in vari siti non tramite Internet ma tramite VPN La maggior parte dei servizi VPN ha la capacità di visualizzare i registri
¢ I registri VPN non sono necessariamente altamente volatili ma sono spesso trascurati e degradati

* I tentativi di connessione, la durata delle sessioni e le dimensioni del trasferimento dei dati sono tutti componenti chiave da cercare
 2021/9/17 03:34:31.853 2960 2740 G1 — Richiesta di trasferimento file da 66.145.232.15 consentita 2021/9/17 03:34:32.658 2960 2740 G1 — Visualizza la cartella
 2021/9/17 03:34:57.358 2960 2740 G1 — Visualizza la cartella C:\Programmi\SIMATIC\
 2021/9/17 03:35:04.333 2960 2740 G1 — Elaborazione del trasferimento file...
 2021/9/17 03:35:04.333 2960 2740 G1 — Scrivi il file C:\Programs\SIMATIC\projectfiles.exe 2021/9/17 03:35:04.343 2960 2740 G1 — Trasferimento file terminato.
 2021/9/17 03:35:04.348 2960 2740 G1 — Visualizza la cartella C:\Programmi\SIMATIC\
 2021/9/17 03:35:12.153 2960 2588 G1 — Fine di CFileTransferThreadServer...
 2021/9/17 03:35:12.153 2960 2740 G1 — Server di trasferimento file spento.
 2021/9/17 03:35:12.153 2960 2588 G1: CFileTransferThreadServer è terminato.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Le reti private virtuali sono comuni in I.C.S. ambienti. I loro registri sono generalmente piuttosto statici e archiviati bene nel tempo. In un ambiente IT, questi non sarebbero probabilmente considerati dati altamente volatili. Tuttavia, gli avversari sono ben consapevoli delle tracce che lasciano e le VPN tendono ad essere un punto di accesso privilegiato e una strategia di movimento laterale per gli avversari. Pertanto, è più probabile che eliminino o manipolino i registri delle VPN in I.C.S.. È importante raccogliere i registri delle VPN nelle prime fasi di un'indagine.
 94 © 2021 Robert M. Lee
 iy m= = 7 C2 . rt] ?@7? @ > > > - —_ - -

™ giura che noi eesewweseu iw
 wo ww
 ahi
 se wv vw ww ve wee w
 Alveari del registro
 Gli hive del registro sono gruppi di chiavi e sottochiavi del registro. Alcuni hive comuni sono:
*HKEY_CURRENT_USER
*HKEY_CURRENT_CONFIG
°HKEY_LOCAL_MACHINE\SAM
° HKEY_LOCAL_MACHINE\Sicurezza
* HKEY_LOCAL_MACHINE\Sistema
° HKEY_USERS\DEFAULT Le chiavi di registro contengono dati diversi come password, impostazioni e informazioni del browser ed eventuali modifiche al sistema come nuovi USB:
* SYSTEM\CurrentControlSet\Enum\USBSTOR visualizza i dettagli/fornitore delle unità USB
* NTUSER.dat\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2 mostra quale utente ha effettuato l'accesso quando è stata inserita un'unità USB. Alcuni malware utilizzano gli hive del registro per l'accesso permanente
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Gli hive del registro e le relative chiavi di registro rivelano molte informazioni su un sistema. Tutto, da chi ha effettuato l'accesso, a quando si sono verificati determinati eventi, a quale USB è stata collegata per ultima al sistema. È importante acquisire queste informazioni. L'analisi forense delle chiavi di registro può rappresentare un intero sottocampo dell'analisi forense per quanto dettagliata e importante possa essere. Concentrati sulla raccolta dei dati e osserva le aree chiave (come l'elenco USB) senza concentrarti troppo sull'analisi dei dati. La possibilità di averlo a disposizione per le attività forensi digitali in un secondo momento si rivelerà preziosa.
 Regedit è un comando nativo di Windows per aprire e visualizzare il registro.
 Dopo aver estratto le chiavi di registro da un altro sistema, queste possono essere caricate e visualizzate in Regedit su una workstation pulita dal punto di vista forense.
 L'analisi dipende dalla conoscenza del Registro e della sua struttura.
 Un'altra opzione utilizzando Regripper:
 https://code.google.com/p/regripper/wiki/RegRipper
 In grado di estrarre e analizzare informazioni dal registro
 In un I.C.S.ambiente, non è consigliabile scaricare gli strumenti nel sistema di destinazione, ma utilizzare invece strumenti come Regripper come un'altra opzione per visualizzarli dopo la raccolta.
 Lo strumento da riga di comando è scritto in Perl.
 Lettura di alveari: http://msdn.microsoft.com/en-us/| libreria/windows/desktop/ms724877(v=vs.85).aspx
 Visita il sito per una buona presentazione ad una conferenza SANS di Harlan Carvey: https://nanopdf.com/download/harlan-carvey-registry-analysis s pdf

© 2021 Robert M. Lee 95
 95
 Dati altamente volatili

¢ Memoria di sistema:
* È abbastanza importante da avere una sezione dedicata verso la fine di questa sezione.
* Alto valore e altamente volatile poiché le cose entrano ed escono costantemente dalla memoria
* Malware, file eseguibili, chiavi crittografiche, ecc. vengono tutti passati nella e attraverso la memoria.
* La memoria è notevolmente più piccola (512 MB-8 GB nella maggior parte degli ambienti I.C.S.) rispetto ai dischi rigidi
(250+ GB), rendendolo più rapidamente analizzabile.

* Informazioni sulla rete:
» I percorsi e le tabelle ARP su un sistema rivelano dove è connesso e con quali sistemi ha interagito; rivela potenzialmente movimenti laterali da parte di avversari o scansioni.
* Il traffico di rete è volatile, ma il malware spesso comunica regolarmente, rendendo il traffico di rete meno volatile ma estremamente prezioso, dati i modelli rilevati da I.C.S. minacce prima. e Processi di sistema:
* I processi e i loro handle (risorse come i PID) mostrano cosa è realmente in esecuzione.
 I.C.S.515 | I.C.S. % di visibilità, rilevamento e risposta
 Ripensa all’Ordine della Volatilità. È importante raccogliere prima i dati più volatili per preservare quante più prove possibili. Ecco alcune delle ragioni dietro OoV e le fonti/valore delle prove.
 Filesystem temporanei, pagine di swap e così via sono tutti volatili ma hanno meno probabilità di essere utili per I.C.S. minacce di
 le informazioni sopra citate. Pertanto, mantieni la flessibilità riguardo alla priorità di raccolta per la tua organizzazione.
 96 © 2021 Robert M. Lee

@
 oo © © © @&
 og @®@ @® @ OO OC
 agw@owwwwo ww
 S| | io! | eee
 essere debitore
 4a
 aU)
 Cloud e risorse virtuali
 Se utilizzi risorse cloud, coinvolgi i fornitori e chiedi loro di verificare la presenza di compromessi e acquisire prove digitali.
 Le risorse "cloud" o le macchine virtuali in loco si basano in gran parte sulla memoria di sistema che può essere raccolta e analizzata.
 I sistemi spenti memorizzano gli stati salvati:

* .vmem in VMWare è il file di paging e di backup della memoria principale dell'host
¢ .vmdk in VMWare è il disco virtuale. Copiare i file può essere altrettanto utile (e potenzialmente meno impattante) quanto caricare i sistemi e tentare di eseguire software di acquisizione forense.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Per l'utilizzo del cloud fuori sede, le policy e la scrittura del contratto richiedono ai fornitori di fornire accesso o prove quando si verifica un incidente. Le risorse cloud in loco e le risorse virtuali possono essere ottime fonti di dati. Le macchine virtuali fanno molto affidamento sulla memoria che, come discusso, è una grande risorsa e quindi raccogliere i file di memoria salvati o utilizzati per ultimi è perfetto per l'analisi.

© 2021 Robert M. Lee 97
 97
 e file vmss
 L'immagine a destra è prima dell'accensione
* Notare la mancanza del file .vmem da 3 GB. L'immagine seguente ha il file .vmem
+ Non è stato ancora messo in pausa e quindi non contiene tutti i dati Anche l'immagine in basso a destra ha il file .vmss
+ Questo file da 134.402 KB è la modifica rispetto al file .vmem di base. Per ottenere il valore completo dalla memoria, è necessario tutto
* cioè. assicurati di mettere in pausa la VM prima della raccolta
 2 cc

() PCCHMIT
 GApccHmit
 1) HMI PCC
 Py PCC HMI 1-4b02629.7mem
 B PCCHMI tediskt-c2 vmuare
 vmwares
 demo
 occHM
 PCCM T
 AY PCC HME
 2)PCHME
 Disco PCC HM cl? vorweare
 Bi Pcc Monte
 pezzo Calore
 PCCHM t
 3 PCC HME t BCC HMI 1-<d02680¥.vmem:
 2PCC Htt-db26aot
 B PCC Hen todick etd vente
 verweare-0
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Quando si esegue l'acquisizione dei dati di risposta agli incidenti da un ambiente virtuale, in genere si copia il percorso completo della cartella VM. Sfortunatamente, se non metti prima in pausa il sistema, non otterrai tutti i dati. Ad esempio, in alto a destra, l'immagine mostra cosa c'è nel percorso della cartella mentre il sistema è spento (non c'è il file .vmem). L'immagine in basso a sinistra mostra quando il sistema è in esecuzione (c'è un file .vmem) e in basso a destra mostra cosa c'è dentro quando
 il sistema è in pausa (sono presenti .vmem e .vmss).
 Il vmss è essenzialmente la modifica rispetto alla memoria di base (vmem) con cui è stato caricato il sistema. Tutte le azioni, i processi, le applicazioni e le attività dell'utente relative agli avversari che desideri si trovano in vmss. Ma devi farlo
 combinalo per ottenere quel valore.
 98 © 2021 Robert M. Lee

@
 oOo @
 wo WD
 ooh Ww
 oeff@OO OP

)
 wm@¢
 ohm@
 aogWwa@ owwewwwseewe wes wb w&
 oh wo
 COME
 e Qualsiasi sistema con VMWare dispone dell'utilità vmss2core
* Questo strumento combina .vmem e .vmss in un unico file di dump della memoria per l'analisi
* Questo file memory.dmp può essere utilizzato con strumenti forensi della memoria

¢ L'argomento —W è per Windows e —N per i sistemi Linux
 ry memory.dmp
!) PCC HMI 1-db02689f.vmem
[& PCC HMI 1-db02689F
 I.C.S.515| I.C.S. Visibilità, rilevamento e risposta
 Qualsiasi sistema su cui è installato VMWare verrà fornito con vmss2core. Ciò ti consentirà di combinare i file vmem e vmss in un singolo file di memoria (puoi nominarlo come preferisci ma per impostazione predefinita diventa memory.dmp). Questo file viene quindi facilmente elaborato negli strumenti di cui parleremo in questo corso, come Volatility.
 Anche se in questo corso non ci occupiamo specificatamente di analisi forense dei dischi poiché si tratta più di analisi forense che di risposta agli incidenti,
 capire che il vmdk è l'immagine digitale. Collezionarlo è ancora vitale. In questo modo, puoi anche utilizzare lo strumento gemuimg per convertire il vmdk in un'immagine disco grezza che può essere analizzata con strumenti tradizionali.

© 2021 Robert M. Lee 99 Come funziona la memoria

* Quando un sistema operativo deve eseguire un processo o eseguire un file, deve passare dal disco fisico alla memoria fisica. (Tutto passa attraverso la memoria ad accesso casuale.)

+ Chiavi di crittografia per crittografare/decrittografare, chiavi di registro modificate, esecuzione di file come malware e così via.

* Man mano che processi e thread vengono assegnati alle varie modifiche in corso nel sistema, vengono continuamente aggiunti o rimossi dalla memoria in base allo spazio consentito:
 Se il sistema dispone di 8 GB di RAM, è possibile archiviare 8 GB di informazioni; quando i processi/thread vengono chiusi e la memoria RAM si riempie, i dati escono dalla RAM.
 La RAM è incredibilmente volatile e le informazioni entrano ed escono costantemente dalla memoria.
 Pensa alla RAM come a un secchio; man mano che viene aggiunta acqua (informazione), altra acqua viene espulsa quando il secchio trabocca.

* Poiché tutto ciò che viene eseguito sul sistema operativo passa attraverso la memoria, è possibile raccogliere e analizzare una grande quantità di dati:

+ I dischi fisici contengono tutte le informazioni salvate sul sistema, ma la memoria è una buona immagine di ciò che è accaduto di recente.
 I.C.S.515 | Visibilità, rilevamento e risposta I.C.S. - 100
 Senza approfondire troppo il funzionamento interno della memoria fisica (RAM), il punto importante è che la RAM gestisce dati estremamente volatili ma raccoglie tutto ciò che accade sul sistema che passa attraverso il sistema operativo, come malware, chiavi di crittografia e file modificati.
 Risorse utili:
 Ecco un video di due ore sull'analisi forense della memoria da uno degli sviluppatori principali di Rekall. (Sebbene questo video sia stato realizzato prima della creazione di Rekall e utilizza la volatilità nel video):
 https://www.youtube.com/watch? v=9aC7ylYwvA Y
 A volte sentirai la memoria virtuale rispetto a quella fisica. La memoria fisica è la memoria in esecuzione sul sistema mappata agli indirizzi fisici (ad esempio, RAM). Il sistema operativo gestisce queste mappature tramite file di paging e assegnazione di thread ed elabora le risorse tramite il kernel.
 La memoria virtuale è destinata principalmente agli sforzi di programmazione e sviluppo e fa riferimento ai file di paging come una struttura astratta. La memoria virtuale consente al programmatore di determinare quanto potrebbe richiedere un programma o un processo, mentre la memoria fisica è la memoria effettivamente utilizzata da quel programma.
 Valore dell'analisi della memoria
 Poiché tutto passa attraverso la memoria, è una fonte estremamente valida di prove forensi. Per l'analisi del malware è fondamentale. Invece di cercare malware nell'intero disco fisico (e il malware è diventato davvero bravo a nascondersi sul disco fisico), è possibile analizzare la memoria e vedere semplicemente il malware in esecuzione. Non è così facile come sembra, ma non è in alcun modo così difficile. Con un po' di formazione, l'analisi forense della memoria può, e dovrebbe, diventare una competenza fondamentale per il personale TEM in un I.C.S. ambiente.
 100 © 2021 Robert M. Lee

€ s
 o@ww?@wergm? © @* @®@ @®@ @ Ww
 wv
 ow wowewewewwwew
 Li
 7
 40
 Considerazioni forensi sulla memoria La memoria decade rapidamente e perde il suo valore quando non è alimentata: se un sistema viene spento o riavviato, il valore della memoria viene distrutto.
 Poiché la memoria è così volatile, visualizza solo le informazioni recenti su un sistema: ottenere informazioni di più settimane fa spesso non è pratico. Non appena si verificano incidenti, gli addetti alla risposta agli incidenti devono raccogliere la memoria dai sistemi in modo che il personale TEM possa analizzarla e fornire dati rilevanti.
 Lezione di storia sull'analisi forense della memoria Negli anni '90, le persone iniziarono a sostenere l'acquisizione di immagini di memoria durante l'IR: l'unico modo per analizzare questi campioni era estrarre stringhe. Negli anni '90-2005 non è stato fatto molto pubblicamente in termini di sviluppo della memoria forense.
 Nel 2004, Michael Ford ha scritto due strumenti (memget e mempeek).
 Nel 2005, Chris Betz, George M. Garner, Jr. e Robert-Jan Mora hanno vinto la DFRWS Forensics Challenge: Memparser (realizzato da Chris) ha consentito ai dump della memoria fisica dei sistemi Windows di ricostruire ed estrarre le informazioni sui processi.
 Nel 2005, l'analisi forense della memoria ha iniziato a guadagnare molta attenzione con lo strumento Memoryze di Mandiant.
 Nel 2007 è stata rilasciata la prima versione del Volatility Framework, che ha reso l’analisi forense della memoria accessibile a un pubblico più ampio.
 Nel 2010+ sono stati sviluppati strumenti e classi specifici per l'analisi forense della memoria, tra cui SANS FORS26.Malware di sola memoria È bene essere consapevoli del malware di sola memoria, perché nei casi in cui una minaccia è ben nascosta in una rete, è possibile che solo l'analisi della memoria possa identificarla.
 Il malware basato solo sulla memoria non è estremamente popolare per alcuni motivi:
* Non può sopravvivere al riavvio del sistema.
¢ Il software antivirus spesso esegue prima la scansione della memoria; il malware sconfigge AV ottenendo l'accesso a un anello inferiore (root,
 driver, BIOS e altro) rispetto al programma in esecuzione, quindi può nascondersi; questo non è fattibile con la sola memoria
 presenza.
 Attenzione:

* Uno dei maggiori punti deboli del malware basato solo sulla memoria è l'incapacità di sopravvivere al riavvio, quindi non è utile
 negli ambienti informatici. I.C.S. gli ambienti di solito non hanno frequenti riavvii dei sistemi, rendendo il malware basato solo sulla memoria abbastanza utile in I.C.S..

© 2021 Robert M. Lee 101 Quadro sulla volatilità
 Appena
 Creato e supportato dalla Volatility Foundation, guidata da Aaron Walters, Jamie Levy, Andrew Case e Michael Hale Ligh. Uno degli strumenti di analisi della memoria di fatto (open source e gratuito). Le versioni precedenti (precedenti alla v2.2) supportavano solo Windows ma dal 2012 sono stati apportati aggiornamenti:
« 2.2 ha fornito il supporto per la maggior parte dei sistemi Linux.
¢ 2.3 ha introdotto il supporto per Mac OS e Android ARM.
* 2.4 ha introdotto il supporto per Windows 8 e Windows 8.1.
* Attualmente su V3+ con un'ampia gamma di plugin e supporto. Può analizzare la memoria in vari formati tra cui immagini di memoria grezza (dump), Firewire, crash dump, file di ibernazione, sessioni VirtualBox e VMware, LiME,
 QEMU e altro ancora.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 102
 chiunque esegua analisi forensi sulla memoria ha familiarità con la volatilità. È lo strumento di fatto e completamente gratuito
 usare. È reso potente da un elenco di plugin che chiunque può sviluppare e contribuire al prodotto (una volta testato/convalidato). Questo sarà il framework che utilizzeremo in laboratorio e nel caso di studio.
 Riferimento:
 http:

//www.volatilityfoundation.org/
 https://github.com/volatilityfondazione
 Post del blog SANS Forensics sull'analisi della memoria per i sistemi Linux: https://www.sans.org/blog/getting-started-
 con
 102

-linux-memory-forensics/

© 2021 Robert M. Lee
 wo
 oO @ @ @D @ DM OO WD HO w
 wo @
 o@g@wga@eQ @ @® @ @ ooewwewewweww
 ab
 wW
 Caso di studio: analisi della memoria Stuxnet
 Il malware estremamente avanzato e distruttivo si distingue davvero
 memoria. La maggior parte dei malware sono relativamente facili da rilevare in memoria purché l'analista abbia un'idea di cosa dovrebbe essere già presente in memoria:

* Cioè, è utile avere una comprensione dei sistemi e di cosa significa "buono".

*Tuttavia, non è necessario avere una linea di base perché molti autori di minacce non se ne preoccupano
 la maggior parte dei difensori utilizza analisi e analisi forensi della memoria. Nel libro Malware Analyst's Cookbook è presente un CD di accompagnamento che contiene un dump della memoria di una macchina infettata da Stuxnet. Per dimostrare il potere dell'analisi forense della memoria e per istruire su alcune delle funzionalità, l'analisi pubblica verrà ricreata per il corso e visualizzata nelle prossime diapositive.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 103
 Il libro Malware Analyst's Cookbook fornisce un campione di memoria di un sistema che è stato infettato (a fini di analisi) da Stuxnet. Questo presenta un entusiasmante caso di studio per esaminare Stuxnet nella volatilità e, più avanti nella lezione, utilizzare alcune informazioni per gli IOC. In generale, se puoi esercitarti su Stuxnet, perché no? Ciò dimostra anche il potere della condivisione delle informazioni sulle minacce allo scopo di istruire e formare difensori migliori.
 Il file discusso è a disposizione degli studenti come laboratorio facoltativo.

© 2021 Robert M. Lee 103
* Le finestre di comando. info è spesso una delle prime esecuzioni e ci fornisce informazioni sul sistema da cui è stato raccolto il dump della memoria.
 Fa
 terminale
 1CS515| I.C.S. Visibilità, rilevamento e risposta 104
 Questo è uno dei primi comandi che dovrebbero essere eseguiti in Volatility. Fornisce informazioni sul sistema da cui è stata raccolta l'immagine della memoria ed è necessaria per alcuni plugin.
 Possiamo vedere che la "Versione principale" è 5 e la Versione minore è 1, rendendo questa 5.1 che è un sistema Windows XP.
 Vediamo anche che l'ora locale del sistema è 18:31:06 e raccolta il 13 aprile 2008 per il fantastico libro Malware Analyst's Cookbook
 104 © 2021 Robert M. Lee

®
 o> @
 wm annuncio
 Oo @f@ @ @ @ ® @ ® Di OD OP OD OD ww
 LD
 v,.am wowowsewewwewesws wv w&
 Hoo AA aaa W
 AY)
 UN)
 Au

¢ Uno dei prossimi comandi da eseguire in Volatility è generalmente pslist per identificare i processi in esecuzione.

¢ La chiave è identificare il PID (ID processo) e l'ID processo principale (PPID) per identificare se il percorso di esecuzione è appropriato (ad esempio, l'avvio di smss.exe dal sistema è corretto).
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 105
 Identificare i processi in esecuzione su un sistema al momento della raccolta della memoria è un ottimo modo per determinare quali programmi erano in esecuzione. Il malware può offuscare queste informazioni, ma ogni offuscamento e cambiamento lascia una traccia.Una delle cose più importanti di pslist, oltre a determinare eventuali processi dai nomi strani, è comprendere la catena di esecuzione. Una volta compreso un sistema e come dovrebbe funzionare, capirai come dovrebbero generarsi i processi, quindi anche il processo con il nome giusto generato dalla posizione sbagliata sarà un enorme indizio che qualcosa non va.

© 2021 Robert M. Lee 105 Analisi rapida di pslist

* Attraverso una rapida analisi, possiamo vedere VMWareUser.exe che mostra che questo era
 yxB126b660 Utente VHware. esecu 10-29 17:11:50 UTC#0600
 7 . fox@1feSda0 VMwareTray.exe analizzato in una VM: [: ae ents
 come 1961 5G) 2010
 155 96 9 HL NB
 Inoltre, alcuni strumenti di analisi funzionano come Process Monitor:
 foxeicS43a0 Procnon. ex 601196
[ps-03 04:25:50 UTe+9860
 Doli
 Ancora più importante, possiamo esaminare PID e PPID (ID processo e ID processo padre) per determinare i processi che hanno generato processi specifici
 Un processo si distingue in questa analisi: Isass.exe
 Lsass.exe viene generato da winlogon.exe per applicare le politiche di sicurezza, ma esistono due processi Isass.exe generati dal PID 668 (services.exe):
 loxeic498c@ Isass. exe jos-02 04:26:55 UTC+0000 Joxsicd7c00 Isass.exe los-03 94:26:55 uTt-+0000
 6 oll
 6 2011
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Anche se non capisci tutte le informazioni sullo schermo, puoi identificare rapidamente le anomalie.
 Informazioni aggiuntive:
 Local Security Authority Subsystem Service (LSASS) è un processo nei sistemi Microsoft di cui è responsabile
 applicare la politica di sicurezza del sistema.
 Inoltre, questi Isass.exe sono stati generati successivamente (sembra non all'avvio); pertanto, è stato assegnato loro un ID processo più elevato.
 Questi file Isass.exe ora sono sospetti.
 106 © 2021 Robert M. Lee
 106
 rT oD OD OD © wD ww
 Nucleo wv Ww
 ew wim wv wm @#
 UN
 o wo @woweoeu#swuwo wv
 Vv Vw wo Ww Ww Ww WY YH HY wy WH ww
 Ay)
 Malfi

¢ Il comando malfind in Volatility cerca DLL iniettate e codice nascosto
(di solito dannoso) e invia i file potenzialmente dannosi in una cartella di tua scelta.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta _ 107
 Il comando malfind è un potente plugin che cerca processi che hanno inserito codice, un comportamento tipicamente dannoso che ha poche ragioni per verificarsi. Questo aiuta a eliminare processi potenzialmente dannosi.

© 2021 Robert M. Lee
 107

“»oo®
 Analisi rapida di malfind

* Una rapida ispezione mostra che services.exe (il processo che ha generato il potenzialmente dannoso lsass.exe) è stato considerato come soggetto ad attività potenzialmente dannose in corso:
 file Modifica schede Aiuto
 Tocess: services.exe Pid: 668 Indirizzo; 0x940008 Tag Vad: Protezione Vad: PAGE_EXECUTE_READWRITE
'lag: Protezione: 6
 w.m

)x08940000 90 06 94 00 c6 07 94 00 24 00 O4 OD ab 04 00 00
 100940010 £2 04 94 00 48 06 09 OG cO 04 94 00 29 00 06 00 su x00940020 00 00 c5 00 28 13 00 00 00 5a 77 4d 61 705669 Zwtlap¥1 100940 030 65 77 4f 66 53 65 63 74 69 Gf Ge 00 5a 51 B1cl ewdfSezione.20..
 wwW

* Allo stesso modo, è stato osservato anche lsass.exe (entrambe le versioni generate da services.exe):

@
 file Edt Schede Guida Processo: Isass,exe Pid: 1928 Indirizzo: 0x680000 fad Tag: Vad Protezione: PAGE_EXECUTE_READWRITE IFlags: Protezione: 6
 ox00680006 90 06 68 00 c6 07 68 OO 24 09 68 OD a5 04 00 00 0x00680019 f2 04 68 60 48 66 00 08 cO 04 68 60 29.00 60 00 ..h, 00 00 Gf 60 28 13 00 00 00 5a 77 4d 61 70 56.69 ..0, 65 77 4f 66 53 65 63 74 69 Sf Ge 60 5a 51 81 cl ew0fSection.20,.

€
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta: tes
 w.m
 Qui vediamo che è stato evidenziato services.exe, che è stato il processo che ha generato i due file sospetti Isass.exe. Allo stesso modo, entrambi i processi Isass.exe sono evidenziati.
 Oo®? @ Pe Pp DP

,
 UN
 108 © 2021 Robert M. Lee
 a @owvwnonoweww
 9 HH HHHHHUHUHBHHUH
 Ww
 Raccolta di file dmp

¢ Questi file .dmp possono quindi essere sottoposti ad hashing per "_ Reenter Baht

©. A [fonstcnnnDedke
 creazione di IOC e sottoposti ad analisi successive in un luogo online come Olan
 Virus Total. fies 'auc Appheazioni 15 GB Fesy..
 Se si sospetta che questo sia precedentemente pres
 Oec7eB.O255 47%
 malware sconosciuto, sarebbe bene coinvolgere qualcuno che abbia competenze nell'analisi di e
 processo.0¥B2

File .dmp, che di solito riguardano Foeetoao statici

; analisi onaria.
 processo Oxf] 498¢8.05800 odmp
 process.0x81 process.0v#l ATCOO.Ax6I0 e61da0.0<d8
 000.dmp
 06.d
 4
 Process.0x81 processo.0«81 ATO0.0x800 A700. 0%680
 o.dmp
 processi.0v82 073020.064 00 dp
 600 morti
 9000.dmp.
 900.dmp
 0900.dmp
 processi. 0x81
 0 e61da0.cxbl0
 o60.dme
 processi. 0x81 eblda0oxb? 000.dmp
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 Malfind esporta i processi in una cartella di tua scelta. Vengono salvati come file .dmp. Questi file non possono essere
 eseguito in modo nativo per l'analisi del malware; tuttavia, possono essere utilizzati per raccogliere informazioni, ad esempio per acquisire un hash digitale di ciascuno da utilizzare successivamente in un IOC.Inoltre, se il malware è già noto e stai cercando di vedere se si tratta di una nuova variante, a quel punto è ragionevole utilizzare la guida in linea, ad esempio inviando il file a VirusTotal. Tuttavia,
 se hai la possibilità di eseguire una farm antivirus (discussa più avanti) sarebbe preferibile.

© 2021 Robert M. Lee
 109
 109
 Altri comandi utili sulla volatilità

* Esistono molti plugin e comandi diversi per Volatility, ma eccone alcuni che vale la pena menzionare:
» netscan trova gli IP locali/remoti e il processo che ha generato la connessione
* pstree può aiutare a rilevare i processi nascosti confrontando i processi osservati in luoghi diversi
* cmdline stampa ciò a cui si è avuto accesso tramite cmdline
* Esiste un elenco pubblico di plugin, puoi sviluppare plugin personalizzati e il comando —h elenca tutti i comandi
 I.C.S.515 | (Visibilità, rilevamento e risposta del CS 110
 Ecco alcuni altri comandi utili per analizzare la memoria. Ce ne sono molti disponibili, ma questi sono abbastanza popolari. C'è un altro comando, però, che non è necessariamente popolare per la sua funzionalità, ma per quanto sia chiaro il concetto.
 110 © 2021 Robert M. Lee
 7"
 ro wD ww
 Oo @ @ @ @® @ @®© @® © Di © OW OO OD DO WH
 ae @wowwewewwowesww
 sì, sì sì sì wW

)
 7)
 Laboratorio 4.4
 Analisi forense della memoria HMI
 
 Raffineria di Calistoga ©
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta

© 2021 Robert M. Lee
 mi
 Obiettivi dello scenario del corso (4)

* Raffineria di Calistoga

* Quale file dannoso è stato eseguito sull'HMI e quando?
 Beacon.exe alle 17:36:38 ora locale
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 
 112 © 2021 Robert M. Lee
 412

“ooh®
 oer ae @ @ DM OD OP OW OD DOD DM DMD DH ww uowwuwewowewoww
 wo Ws ywBVyyVvyvyvypy ys
 w
 Obiettivi dello scenario del corso (5)

* Qual è la routine dannosa nella logica e cosa fa?
* Qual è la causa principale dell'attacco?
* L’incidente è collegato all’incidente di C3PO?

°C3PO:
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 

© 2021 Robert M. Lee 113 Gli avversari umani tendono a gravitare verso l'HMI.
 Gli eventi di Windows o Syslog devono essere ottenuti dal sistema.
 Le applicazioni HMI spesso dispongono di registrazioni che possono essere abilitate e raccolte per quali comandi sono stati emessi e quando.
 Dovrebbero essere prese in considerazione anche le condizioni allarmanti.
 I sistemi che eseguono HMI sono spesso basati su Windows. In questo modo, non sono veramente unici rispetto ad altri sistemi Windows, ma il tipo di interazioni che gli avversari potrebbero avere con loro tendono ad esserlo. Gli avversari ben istruiti tratteranno il sistema in modo più sensibile e come una risorsa preziosa con controllo diretto su sistemi spesso sensibili. La registrazione dovrebbe essere abilitata per questi sistemi e dovrebbero essere raccolti elementi come gli eventi di Windows e i registri di sicurezza. Prima o poi l'HM1 diventerà un bersaglio, quindi è importante assicurarsi di poterlo analizzare. L'HMI avrà spesso anche la registrazione di quali comandi e pulsanti sono stati cliccati, allarmi disattivati, ecc. e quando ciò si è verificato. Questo può essere disabilitato per impostazione predefinita, quindi controlla, abilitalo e raccogli i dati.
 114 © 2021 Robert M. Lee
 7
 a @ @ @& @ @& @ ee ff oo 8 OO oO OO OO OO OD DD OD HD ww ww w
 Oh
 ww
 9HUUHHYVUYYYVIUEYYYWY

=)
 Richiesta di risposta ident

« Produttore indipendente di energia (IPP) i
* Operatore del sistema di trasmissione (TSO) società diversa con Automatic |
 Controllo della generazione (AGC) |
 Era in manutenzione e si è avviato da solo
¢ Il personale operativo ha avviato la risoluzione dei problemi ma non è riuscito a determinare la causa principale dell'avvio

«Mentre le operazioni funzionavano, l'IR è stato avviato

* I collegamenti ICCP di AGC sono stati esaminati ma non è stato riscontrato alcun problema

« Monitoraggio della rete implementato e rilevato che l'HMI inviava comandi
« L'HMI era touchscreen ed era eccessivamente pressurizzato
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta 115
 La visibilità tende ad essere un importante valore aggiunto anche per i casi di risposta agli incidenti in cui gli attacchi informatici non sono il problema. Il nostro mondo industriale sta diventando sempre più complesso e l’impronta dell’automazione è più complicata che mai. Ciò significa che gli operatori e gli ingegneri che erano abituati a comprendere appieno il processo possono comprendere solo alcuni circuiti di controllo o componenti dello stesso. Ciò porta a difficoltà nell’analisi delle cause profonde. Essendo un sistema di sistemi, è fondamentale avere visibilità della rete con una comprensione dell'I.C.S. protocolli.
 In questo caso si è verificato un IPP a cui è stato attivato inaspettatamente un circuito di controllo, attivando un'unità di generazione. Questo è a dir poco anormale. Il team ha indagato sulle comunicazioni ICCP tramite il collegamento AGC, poiché il sistema di gestione dell’energia (EMS) del TSO avrebbe potuto essere il problema o addirittura compromesso, ma non ha trovato nulla. Dopo aver implementato una soluzione di visibilità della rete con I.C.S. analisi del protocollo, hanno potuto vedere che c'erano comandi HMI inviati all'unità di generazione. Tuttavia, non potevano installare alcuno strumento sull’HMI o interagire con esso con strumenti non nativi.Non potevano essere sicuri finché l'addetto alla risposta all'incidente, Lesley Carhart, non ha brillantemente pensato di utilizzare Windows Paint poiché era nativo. Ha avviato Windows Paint e visibilmente si poteva dire che piccole linee hanno iniziato ad apparire su Paint mostrando che l'HMI era eccessivamente pressurizzato e quindi "faceva clic" casualmente sui pulsanti sull'HMI, che portavano ai comandi. Senza visibilità e un po’ di creatività, ci sarebbe voluto molto più tempo per ottenere l’analisi delle cause profonde e ripristinare le operazioni in modo sicuro.

© 2021 Robert M. Lee 115 Workstation di ingegneria Workstation di ingegneria oor ail
(soprattutto laptop da viaggio) sono importanti per comprendere il processo e i sistemi.
 Fai attenzione al trasferimento dei dati, in particolare ai dispositivi USB.
 Identificare il tipo di file di progetto e software e cercare questi che escono dall'ambiente.
 I.C.S.SIS | I.C.S. Visibilità, rilevamento e risposta
 Un vettore di attacco comune osservato in vari sistemi I.C.S. le intrusioni sono state USB e computer portatili. Per questo motivo le postazioni di ingegneria tendono ad essere coinvolte nelle infezioni. La capacità di raccogliere dati dal laptop (ad esempio una politica in atto secondo cui i fornitori devono consentire l'accesso ai dati in caso di incidente) è fondamentale. Anche la ricerca dell'utilizzo dell'USB sul laptop potrebbe indicare un problema se è contrario alla policy o successivo a un incidente.
 Se un avversario vuole veramente comprendere il processo, una cosa fondamentale da cercare è la postazione di lavoro di ingegneria e trovare i file di progetto e i documenti di ingegneria. Comprenderli può aiutare un avversario a raggiungere una fase 2 I.C.S. Cibernetico
 Attacco. Cerca l'accesso ai sistemi e ai documenti che escono dal sistema.
 Riferimento immagine: mondo dell'automazione
 116 © 2021 Robert M. Lee
 116
 oo)®
 nm
 eoeowrerwrg? ®ve @©@ OO DM OD OD DM Ww wow wvwowww ww
 oH9HvHHYUHMUH¥YVUUYUYUYVMyY
 UN)
 Controllori (PLC/RTU)

* Traffico di rete. + Molti controller hanno ¢ Registra hash. :
¢ Protocolli proprietari. registri che possono indicare ¢ Archiviazione sicura dei file

— 4 errori e problemi sulla rete. Registrazione sul campo. il controllore.

¢ I registri delle comunicazioni di rete interrotte possono derivare dall'attività di scansione da parte degli avversari.
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta
 La scienza forense digitale non ha fatto molti progressi, se non nessuno, con la ricerca forense sui controllori. Anche i sistemi proprietari rendono tutto questo difficile. Tuttavia, la registrazione può essere vitale. Ancora più importante, i dati di rete e l’interazione sotto forma di acquisizione di pacchetti possono rivelare molto. Gli incidenti più gravi spesso riguardano l’accesso remoto. Gli aggressori devono accedere al sistema tramite la rete, identificare e acquisire i dati lì.
 L’acquisizione digitale e l’analisi forense a livello sul campo sono difficili, soprattutto a causa dei protocolli e dei sistemi operativi proprietari.
 Concentrati su aree conosciute, come protocolli comuni e ben compresi, cerca manipolazioni o stranezze. Essere in grado e disposti a estrarre file di progetto e informazioni logiche, eseguirne l'hashing e confrontarli con file noti (o

informazioni "vaulted").
 Nel raro caso in cui la registrazione sul dispositivo sia possibile e abilitata, assicurati che la raccolta venga eseguita in anticipo dato lo spazio di archiviazione limitato.

© 2021 Robert M. Lee 117
 7
 File di progetto/logica

| | I file di progetto sono meno
 probabilmente contiene malware

}, e più probabile che lo abbia
| Manipolazioni
 pee este be Sonie Gli OEM hanno formati di proprietà del progetto ma: sates
 di voi 4 strumenti di confronto dei file in declino della tabella e talvolta anche ~
 F ; Altri che puoi utilizzare
| Strumenti basati su XML o HTML come Notepad++
 I.C.S.515 | I.C.S. Visibilità, rilevamento e risposta: 110
 File di progetto
 I file di progetto e la logica sui controller non vengono spesso in mente quando si pensa a malware e minacce. Tuttavia, qualsiasi avversario che voglia effettivamente manipolare il processo di un sistema o causare danni, prima o poi dovrà manipolare la logica o i file di progetto. Si sapeva che Stuxnet aveva manipolato i file di progetto dei controllori Siemens. Non esiste un modo semplice e veloce per analizzare routine dannose o indicatori di compromissione. Il concetto sembra che non sarebbe fattibile. (Piccoli cambiamenti possono significare grandi danni e non c'è nulla che sembri o sia intrinsecamente dannoso.) Tuttavia, la raccolta degli hash di questi file e il personale di Incident Response che esegue l'hashing dei file di progetto durante un incidente consentirà al personale TEM di identificare se sono presenti manipolazioni che hanno si è verificato. Quindi, gli ingegneri possono essere coinvolti per determinare cosa sta cercando di fare la minaccia e come fermarla. Inoltre, valuta la possibilità di discutere con i tuoi avvocati per garantire che i problemi di conservazione dei record e di eDiscovery non siano in conflitto con le esigenze dei file di progetto o con i requisiti del programma di protezione delle informazioni nella tua organizzazione.
 118 © 2021 Robert M. Lee
 oo®
 OC @ PP DP DP De DD eee OD wh
 a @ oOo menmneneemnth o& & & &@& BWM B&H BS B&BS HH & HO #&